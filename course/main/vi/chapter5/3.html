<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;sp-xp-d-liu&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;sp-xp-d-liu-ca-chng-ta&quot;,&quot;title&quot;:&quot;Sáº¯p xáº¿p dá»¯ liá»‡u cá»§a chÃºng ta&quot;},{&quot;local&quot;:&quot;to-ra-cc-ct-mi&quot;,&quot;title&quot;:&quot;Táº¡o ra cÃ¡c cá»™t má»›i&quot;},{&quot;local&quot;:&quot;siu-sc-mnh-ca-hm-map&quot;,&quot;title&quot;:&quot;SiÃªu sá»©c máº¡nh cá»§a hÃ m `map()`&quot;},{&quot;local&quot;:&quot;t-dataset-ti-dataframe-v-ngc-li&quot;,&quot;title&quot;:&quot;Tá»« `Dataset` tá»›i `DataFrame` vÃ  ngÆ°á»£c láº¡i&quot;},{&quot;local&quot;:&quot;to-ra-mt-tp-kim-nh&quot;,&quot;title&quot;:&quot;Táº¡o ra má»™t tá»‡p kiá»ƒm Ä‘á»‹nh&quot;},{&quot;local&quot;:&quot;lu-mt-b-d-liu&quot;,&quot;title&quot;:&quot;LÆ°u má»™t bá»™ dá»¯ liá»‡u&quot;}],&quot;title&quot;:&quot;Sáº¯p xáº¿p dá»¯ liá»‡u&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter5/3.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CourseFloatingBanner-hf-doc-builder.js"> 





<h1 class="relative group"><a id="sp-xp-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sp-xp-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sáº¯p xáº¿p dá»¯ liá»‡u
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://discuss.huggingface.co/t/chapter-5-questions" target="_blank"><img alt="Ask a Question" class="!m-0" src="https://img.shields.io/badge/Ask%20a%20question-ffcb4c.svg?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgLTEgMTA0IDEwNiI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMyMzFmMjA7fS5jbHMtMntmaWxsOiNmZmY5YWU7fS5jbHMtM3tmaWxsOiMwMGFlZWY7fS5jbHMtNHtmaWxsOiMwMGE5NGY7fS5jbHMtNXtmaWxsOiNmMTVkMjI7fS5jbHMtNntmaWxsOiNlMzFiMjM7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5EaXNjb3Vyc2VfbG9nbzwvdGl0bGU+PGcgaWQ9IkxheWVyXzIiPjxnIGlkPSJMYXllcl8zIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik01MS44NywwQzIzLjcxLDAsMCwyMi44MywwLDUxYzAsLjkxLDAsNTIuODEsMCw1Mi44MWw1MS44Ni0uMDVjMjguMTYsMCw1MS0yMy43MSw1MS01MS44N1M4MCwwLDUxLjg3LDBaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNTIuMzcsMTkuNzRBMzEuNjIsMzEuNjIsMCwwLDAsMjQuNTgsNjYuNDFsLTUuNzIsMTguNEwzOS40LDgwLjE3YTMxLjYxLDMxLjYxLDAsMSwwLDEzLTYwLjQzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMyIgZD0iTTc3LjQ1LDMyLjEyYTMxLjYsMzEuNiwwLDAsMS0zOC4wNSw0OEwxOC44Niw4NC44MmwyMC45MS0yLjQ3QTMxLjYsMzEuNiwwLDAsMCw3Ny40NSwzMi4xMloiLz48cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Ik03MS42MywyNi4yOUEzMS42LDMxLjYsMCwwLDEsMzguOCw3OEwxOC44Niw4NC44MiwzOS40LDgwLjE3QTMxLjYsMzEuNiwwLDAsMCw3MS42MywyNi4yOVoiLz48cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Ik0yNi40Nyw2Ny4xMWEzMS42MSwzMS42MSwwLDAsMSw1MS0zNUEzMS42MSwzMS42MSwwLDAsMCwyNC41OCw2Ni40MWwtNS43MiwxOC40WiIvPjxwYXRoIGNsYXNzPSJjbHMtNiIgZD0iTTI0LjU4LDY2LjQxQTMxLjYxLDMxLjYxLDAsMCwxLDcxLjYzLDI2LjI5YTMxLjYxLDMxLjYxLDAsMCwwLTQ5LDM5LjYzbC0zLjc2LDE4LjlaIi8+PC9nPjwvZz48L3N2Zz4="></a>
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter5/section3.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter5/section3.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Háº§u háº¿t thá»i gian, dá»¯ liá»‡u báº¡n lÃ m viá»‡c sáº½ chÆ°a Ä‘Æ°á»£c chuáº©n bá»‹ hoÃ n háº£o cho cÃ¡c mÃ´ hÃ¬nh huáº¥n luyá»‡n. Trong pháº§n nÃ y, chÃºng ta sáº½ khÃ¡m phÃ¡ cÃ¡c tÃ­nh nÄƒng khÃ¡c nhau mÃ  ğŸ¤— Datasets cung cáº¥p Ä‘á»ƒ lÃ m sáº¡ch cÃ¡c táº­p dá»¯ liá»‡u cá»§a báº¡n.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/tqfSFcPMgOI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 class="relative group"><a id="sp-xp-d-liu-ca-chng-ta" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sp-xp-d-liu-ca-chng-ta"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sáº¯p xáº¿p dá»¯ liá»‡u cá»§a chÃºng ta
	</span></h2>

<p>TÆ°Æ¡ng tá»± nhÆ° Pandas, ğŸ¤— Datasets cung cáº¥p má»™t sá»‘ tÃ­nh nÄƒng Ä‘á»ƒ thao tÃºng ná»™i dung cá»§a <code>Dataset</code> vÃ  <code>DatasetDict</code>. ChÃºng ta Ä‘Ã£ gáº·p phÆ°Æ¡ng thá»©c <code>Dataset.map()</code> trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a> vÃ  trong pháº§n nÃ y, chÃºng ta sáº½ khÃ¡m phÃ¡ má»™t sá»‘ hÃ m khÃ¡c theo Ã½ cá»§a chÃºng ta.</p>
<p>Äá»‘i vá»›i vÃ­ dá»¥ nÃ y, chÃºng tÃ´i sáº½ sá»­ dá»¥ng <a href="https://archive.ics.uci.edu/ml/datasets/Drug+Review+Dataset+%28Drugs.com%29" rel="nofollow">Bá»™ dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡ thuá»‘c</a> Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn <a href="https://archive.ics.uci.edu/ml/index.php" rel="nofollow">Kho lÆ°u trá»¯ Há»c mÃ¡y UC Irvine</a>, chá»©a cÃ¡c Ä‘Ã¡nh giÃ¡ cá»§a bá»‡nh nhÃ¢n vá» cÃ¡c loáº¡i thuá»‘c khÃ¡c nhau, cÃ¹ng vá»›i tÃ¬nh tráº¡ng Ä‘ang Ä‘Æ°á»£c Ä‘iá»u trá»‹ vÃ  xáº¿p háº¡ng 10 sao vá» má»©c Ä‘á»™ hÃ i lÃ²ng cá»§a bá»‡nh nhÃ¢n.</p>
<p>TrÆ°á»›c tiÃªn, chÃºng ta cáº§n táº£i xuá»‘ng vÃ  giáº£i nÃ©n dá»¯ liá»‡u, cÃ³ thá»ƒ thá»±c hiá»‡n báº±ng lá»‡nh <code>wget</code> vÃ   <code>unzip</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!wget <span class="hljs-string">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00462/drugsCom_raw.zip&quot;</span>
!unzip drugsCom_raw.<span class="hljs-built_in">zip</span><!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ TSV chá»‰ lÃ  má»™t biáº¿n thá»ƒ cá»§a CSV sá»­ dá»¥ng dáº¥u tab thay vÃ¬ dáº¥u pháº©y lÃ m dáº¥u phÃ¢n cÃ¡ch, chÃºng ta cÃ³ thá»ƒ táº£i cÃ¡c tá»‡p nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng táº­p lá»‡nh táº£i <code>csv</code> vÃ  chá»‰ Ä‘á»‹nh Ä‘á»‘i sá»‘ <code>delimiter</code> trong hÃ m <code>load_dataset()</code> nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

data_files = {<span class="hljs-string">&quot;train&quot;</span>: <span class="hljs-string">&quot;drugsComTrain_raw.tsv&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;drugsComTest_raw.tsv&quot;</span>}
<span class="hljs-comment"># \t is the tab character in Python</span>
drug_dataset = load_dataset(<span class="hljs-string">&quot;csv&quot;</span>, data_files=data_files, delimiter=<span class="hljs-string">&quot;\t&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Má»™t thá»±c tiá»…n khi thá»±c hiá»‡n báº¥t ká»³ loáº¡i phÃ¢n tÃ­ch dá»¯ liá»‡u nÃ o lÃ  láº¥y má»™t máº«u ngáº«u nhiÃªn nhá» Ä‘á»ƒ cÃ³ thá»ƒ cáº£m nháº­n nhanh vá» loáº¡i dá»¯ liá»‡u báº¡n Ä‘ang lÃ m viá»‡c. Trong ğŸ¤— Datasets, chÃºng ta cÃ³ thá»ƒ táº¡o má»™t máº«u ngáº«u nhiÃªn báº±ng cÃ¡ch xÃ¢u chuá»—i cÃ¡c hÃ m <code>Dataset.shuffle()</code> vÃ  <code>Dataset.select()</code> vá»›i nhau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_sample = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].shuffle(seed=<span class="hljs-number">42</span>).select(<span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>))
<span class="hljs-comment"># Xem qua má»™t sá»‘ vÃ­ dá»¥ Ä‘áº§u tiÃªn</span>
drug_sample[:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;Unnamed: 0&#x27;</span>: [<span class="hljs-number">87571</span>, <span class="hljs-number">178045</span>, <span class="hljs-number">80482</span>],
 <span class="hljs-string">&#x27;drugName&#x27;</span>: [<span class="hljs-string">&#x27;Naproxen&#x27;</span>, <span class="hljs-string">&#x27;Duloxetine&#x27;</span>, <span class="hljs-string">&#x27;Mobic&#x27;</span>],
 <span class="hljs-string">&#x27;condition&#x27;</span>: [<span class="hljs-string">&#x27;Gout, Acute&#x27;</span>, <span class="hljs-string">&#x27;ibromyalgia&#x27;</span>, <span class="hljs-string">&#x27;Inflammatory Conditions&#x27;</span>],
 <span class="hljs-string">&#x27;review&#x27;</span>: [<span class="hljs-string">&#x27;&quot;like the previous person mention, I&amp;#039;m a strong believer of aleve, it works faster for my gout than the prescription meds I take. No more going to the doctor for refills.....Aleve works!&quot;&#x27;</span>,
  <span class="hljs-string">&#x27;&quot;I have taken Cymbalta for about a year and a half for fibromyalgia pain. It is great\r\nas a pain reducer and an anti-depressant, however, the side effects outweighed \r\nany benefit I got from it. I had trouble with restlessness, being tired constantly,\r\ndizziness, dry mouth, numbness and tingling in my feet, and horrible sweating. I am\r\nbeing weaned off of it now. Went from 60 mg to 30mg and now to 15 mg. I will be\r\noff completely in about a week. The fibro pain is coming back, but I would rather deal with it than the side effects.&quot;&#x27;</span>,
  <span class="hljs-string">&#x27;&quot;I have been taking Mobic for over a year with no side effects other than an elevated blood pressure.  I had severe knee and ankle pain which completely went away after taking Mobic.  I attempted to stop the medication however pain returned after a few days.&quot;&#x27;</span>],
 <span class="hljs-string">&#x27;rating&#x27;</span>: [<span class="hljs-number">9.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">10.0</span>],
 <span class="hljs-string">&#x27;date&#x27;</span>: [<span class="hljs-string">&#x27;September 2, 2015&#x27;</span>, <span class="hljs-string">&#x27;November 7, 2011&#x27;</span>, <span class="hljs-string">&#x27;June 5, 2013&#x27;</span>],
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: [<span class="hljs-number">36</span>, <span class="hljs-number">13</span>, <span class="hljs-number">128</span>]}<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng chÃºng ta Ä‘Ã£ sá»­a seed trong <code>Dataset.shuffle()</code> cho má»¥c Ä‘Ã­ch tÃ¡i táº¡o.  <code>Dataset.select()</code> mong Ä‘á»£i má»™t chá»‰ sá»‘ cÃ³ thá»ƒ láº·p láº¡i, vÃ¬ váº­y chÃºng ta truyá»n vÃ o khoáº£ng <code>range(1000)</code> Ä‘á»ƒ láº¥y 1,000 máº«u Ä‘áº§u tiÃªn tá»« táº­p dá»¯ liá»‡u Ä‘Ã£ xÃ¡o trá»™n. Tá»« máº«u nÃ y, ta Ä‘Ã£ cÃ³ thá»ƒ tháº¥y má»™t sá»‘ Ä‘iá»u ká»³ quáº·c trong táº­p dá»¯ liá»‡u:</p>
<ul><li>Cá»™t <code>Unnamed: 0</code>  trÃ´ng Ä‘Ã¡ng ngá» giá»‘ng nhÆ° má»™t ID áº©n danh cho má»—i bá»‡nh nhÃ¢n.</li>
<li>Cá»™t <code>condition</code> bao gá»“m sá»± káº¿t há»£p giá»¯a cÃ¡c nhÃ£n chá»¯ hoa vÃ  chá»¯ thÆ°á»ng.</li>
<li>CÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cÃ³ Ä‘á»™ dÃ i khÃ¡c nhau vÃ  chá»©a há»—n há»£p cÃ¡c dáº¥u phÃ¢n tÃ¡ch dÃ²ng Python (<code>\r\n</code>) cÅ©ng nhÆ° cÃ¡c mÃ£ kÃ½ tá»± HTML nhÆ° <code>&amp;\#039;</code>.</li></ul>
<p>HÃ£y xem cÃ¡ch chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng ğŸ¤— Datasets Ä‘á»ƒ giáº£i quyáº¿t tá»«ng váº¥n Ä‘á» nÃ y. Äá»ƒ kiá»ƒm tra giáº£ thuyáº¿t ID bá»‡nh nhÃ¢n cho cá»™t <code>Unnamed: 0</code>, ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m  <code>Dataset.unique()</code> Ä‘á»ƒ xÃ¡c minh ráº±ng sá»‘ lÆ°á»£ng ID khá»›p vá»›i sá»‘ hÃ ng trong má»—i láº§n tÃ¡ch:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> split <span class="hljs-keyword">in</span> drug_dataset.keys():
    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(drug_dataset[split]) == <span class="hljs-built_in">len</span>(drug_dataset[split].unique(<span class="hljs-string">&quot;Unnamed: 0&quot;</span>))<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y dÆ°á»ng nhÆ° xÃ¡c nháº­n giáº£ thuyáº¿t cá»§a chÃºng tÃ´i, vÃ¬ váº­y hÃ£y dá»n dáº¹p táº­p dá»¯ liá»‡u má»™t chÃºt báº±ng cÃ¡ch Ä‘á»•i tÃªn cá»™t <code>Unname: 0</code> thÃ nh má»™t cÃ¡i gÃ¬ Ä‘Ã³ dá»… hiá»ƒu hÆ¡n má»™t chÃºt. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m <code>DatasetDict.rename_column()</code> Ä‘á»ƒ Ä‘á»•i tÃªn cá»™t trÃªn cáº£ hai táº­p con trong má»™t láº§n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.rename_column(
    original_column_name=<span class="hljs-string">&quot;Unnamed: 0&quot;</span>, new_column_name=<span class="hljs-string">&quot;patient_id&quot;</span>
)
drug_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">161297</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">53766</span>
    })
})<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Sá»­ dá»¥ng hÃ m <code>Dataset.unique()</code> Ä‘á»ƒ tÃ¬m sá»‘ lÆ°á»£ng thuá»‘c Ä‘á»™c nháº¥t vÃ  Ä‘iá»u kiá»‡n trong táº­p huáº¥n luyá»‡n vÃ  kiá»ƒm thá»­.</p></div>
<p>Tiáº¿p theo, hÃ£y chuáº©n hÃ³a táº¥t cáº£ cÃ¡c nhÃ£n <code>condition</code> báº±ng cÃ¡ch sá»­ dá»¥ng <code>Dataset.map()</code>. NhÆ° chÃºng ta Ä‘Ã£ lÃ m vá»›i tokenize trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>, chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh má»™t hÃ m Ä‘Æ¡n giáº£n cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng trÃªn táº¥t cáº£ cÃ¡c hÃ ng cá»§a má»—i táº­p trong <code>drug_dataset</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">lowercase_condition</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;condition&quot;</span>: example[<span class="hljs-string">&quot;condition&quot;</span>].lower()}


drug_dataset.<span class="hljs-built_in">map</span>(lowercase_condition)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->AttributeError: <span class="hljs-string">&#x27;NoneType&#x27;</span> <span class="hljs-built_in">object</span> has no attribute <span class="hljs-string">&#x27;lower&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>á»’ khÃ´ng, chÃºng ta Ä‘Ã£ gáº·p sá»± cá»‘ vá»›i chá»©c nÄƒng ná»‘i cá»§a mÃ¬nh! Tá»« lá»—i, chÃºng ta cÃ³ thá»ƒ suy ra ráº±ng má»™t sá»‘ má»¥c nháº­p trong cá»™t <code>condition</code> lÃ  <code>None</code>, khÃ´ng thá»ƒ viáº¿t thÆ°á»ng vÃ¬ chÃºng khÃ´ng pháº£i lÃ  chuá»—i. HÃ£y bá» cÃ¡c hÃ ng nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng <code>Dataset.filter()</code>, hoáº¡t Ä‘á»™ng theo cÃ¡ch tÆ°Æ¡ng tá»± nhÆ° <code>Dataset.map()</code> vÃ  mong Ä‘á»£i má»™t hÃ m nháº­n Ä‘Æ°á»£c má»™t máº«u vá» táº­p dá»¯ liá»‡u. Thay vÃ¬ viáº¿t má»™t hÃ m rÃµ rÃ ng nhÆ°:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_nones</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> x[<span class="hljs-string">&quot;condition&quot;</span>] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><!-- HTML_TAG_END --></pre></div>
<p>vÃ  sau Ä‘Ã³ cháº¡y <code>drug_dataset.filter(filter_nones)</code>, chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n viá»‡c nÃ y trong má»™t dÃ²ng báº±ng cÃ¡ch sá»­ dá»¥ng <em>hÃ m lambda</em>. Trong Python, cÃ¡c hÃ m lambda lÃ  cÃ¡c hÃ m nhá» mÃ  báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a mÃ  khÃ´ng cáº§n Ä‘áº·t tÃªn rÃµ rÃ ng. ChÃºng cÃ³ dáº¡ng chung:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->lambda <span class="hljs-tag">&lt;<span class="hljs-name">arguments</span>&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">expression</span>&gt;</span><!-- HTML_TAG_END --></pre></div>
<p>á»Ÿ Ä‘Ã¢y <code>lambda</code> lÃ  má»™t trong nhá»¯ng <a href="https://docs.python.org/3/reference/lexical_analysis.html#keywords" rel="nofollow">tá»« khÃ³a</a> Ä‘áº·c biá»‡t cá»§a Python, <code>&lt;arguments&gt;</code> lÃ  danh sÃ¡ch / táº­p há»£p cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y xÃ¡c Ä‘á»‹nh cÃ¡c Ä‘áº§u vÃ o cho hÃ m vÃ  <code>&lt;expression&gt;</code>  Ä‘áº¡i diá»‡n cho cÃ¡c hoáº¡t Ä‘á»™ng báº¡n muá»‘n thá»±c hiá»‡n. VÃ­ dá»¥, chÃºng ta cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a má»™t hÃ m lambda Ä‘Æ¡n giáº£n bÃ¬nh phÆ°Æ¡ng má»™t sá»‘ nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->lambda <span class="hljs-keyword">x</span> : <span class="hljs-keyword">x</span> * <span class="hljs-keyword">x</span><!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ Ã¡p dá»¥ng hÃ m nÃ y cho má»™t Ä‘áº§u vÃ o, chÃºng ta cáº§n Ä‘áº·t nÃ³ vÃ  Ä‘áº§u vÃ o trong dáº¥u ngoáº·c Ä‘Æ¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-keyword">lambda</span> x: x * x)(<span class="hljs-number">3</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">9</span><!-- HTML_TAG_END --></pre></div>
<p>TÆ°Æ¡ng tá»±, chÃºng ta cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c hÃ m lambda vá»›i nhiá»u tham sá»‘ báº±ng cÃ¡ch phÃ¢n tÃ¡ch chÃºng báº±ng dáº¥u pháº©y. VÃ­ dá»¥, chÃºng ta cÃ³ thá»ƒ tÃ­nh diá»‡n tÃ­ch cá»§a má»™t tam giÃ¡c nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-keyword">lambda</span> base, height: <span class="hljs-number">0.5</span> * base * height)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">16.0</span><!-- HTML_TAG_END --></pre></div>
<p>CÃ¡c hÃ m Lambda ráº¥t há»¯u Ã­ch khi báº¡n muá»‘n Ä‘á»‹nh nghÄ©a cÃ¡c hÃ m nhá», sá»­ dá»¥ng má»™t láº§n (Ä‘á»ƒ biáº¿t thÃªm thÃ´ng tin vá» chÃºng, chÃºng tÃ´i khuyÃªn báº¡n nÃªn Ä‘á»c <a href="https://realpython.com/python-lambda/" rel="nofollow">HÆ°á»›ng dáº«n Python Ä‘Ã­ch thá»±c</a> cá»§a Andre Burgaud). Trong ngá»¯ cáº£nh ğŸ¤— Datasets, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c hÃ m lambda Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c hoáº¡t Ä‘á»™ng ná»‘i vÃ  lá»c Ä‘Æ¡n giáº£n, vÃ¬ váº­y hÃ£y sá»­ dá»¥ng thá»§ thuáº­t nÃ y Ä‘á»ƒ loáº¡i bá» cÃ¡c pháº§n <code>None</code> trong táº­p dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;condition&quot;</span>] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>)<!-- HTML_TAG_END --></pre></div>
<p>Vá»›i <code>None</code> Ä‘Ã£ bá»‹ xÃ³a, chÃºng ta  cÃ³ thá»ƒ chuáº©n hÃ³a cá»™t <code>condition</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(lowercase_condition)
<span class="hljs-comment"># Kiá»ƒm tra xem chá»¯ viáº¿t thÆ°á»ng Ä‘Ã£ hoáº¡t Ä‘á»™ng chÆ°a</span>
drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-string">&quot;condition&quot;</span>][:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;left ventricular dysfunction&#x27;</span>, <span class="hljs-string">&#x27;adhd&#x27;</span>, <span class="hljs-string">&#x27;birth control&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>NÃ³ hoáº¡t Ä‘á»™ng! Váº­y lÃ  chÃºng ta Ä‘Ã£ lÃ m sáº¡ch cÃ¡c nhÃ£n, giá» chÃºng ta hÃ£y xem xÃ©t viá»‡c lÃ m sáº¡ch cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡.</p>
<h2 class="relative group"><a id="to-ra-cc-ct-mi" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#to-ra-cc-ct-mi"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Táº¡o ra cÃ¡c cá»™t má»›i
	</span></h2>

<p>Báº¥t cá»© khi nÃ o báº¡n xá»­ lÃ½ cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cá»§a khÃ¡ch hÃ ng, má»™t phÆ°Æ¡ng phÃ¡p hay Ä‘Ã³ lÃ  kiá»ƒm tra sá»‘ lÆ°á»£ng tá»« trong má»—i bÃ i Ä‘Ã¡nh giÃ¡. BÃ i Ä‘Ã¡nh giÃ¡ cÃ³ thá»ƒ chá»‰ lÃ  má»™t tá»« duy nháº¥t nhÆ° â€œTuyá»‡t vá»i!â€ hoáº·c má»™t bÃ i luáº­n Ä‘áº§y Ä‘á»§ vá»›i hÃ ng nghÃ¬n tá»«, vÃ  tÃ¹y thuá»™c vÃ o trÆ°á»ng há»£p sá»­ dá»¥ng, báº¡n sáº½ cáº§n xá»­ lÃ½ nhá»¯ng thÃ¡i cá»±c nÃ y theo cÃ¡ch khÃ¡c nhau. Äá»ƒ tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng tá»« trong má»—i bÃ i Ä‘Ã¡nh giÃ¡, chÃºng tÃ´i sáº½ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p phá»ng Ä‘oÃ¡n sÆ¡ bá»™ dá»±a trÃªn viá»‡c tÃ¡ch tá»«ng vÄƒn báº£n theo khoáº£ng tráº¯ng.</p>
<p>HÃ£y Ä‘á»‹nh nghÄ©a má»™t hÃ m Ä‘Æ¡n giáº£n Ä‘áº¿m sá»‘ tá»« trong má»—i bÃ i Ä‘Ã¡nh giÃ¡:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_review_length</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;review_length&quot;</span>: <span class="hljs-built_in">len</span>(example[<span class="hljs-string">&quot;review&quot;</span>].split())}<!-- HTML_TAG_END --></pre></div>
<p>KhÃ´ng giá»‘ng nhÆ° hÃ m <code>lowercase_condition()</code>, <code>compute_review_length()</code> tráº£ vá» má»™t tá»« Ä‘iá»ƒn cÃ³ khÃ³a khÃ´ng tÆ°Æ¡ng á»©ng vá»›i má»™t trong cÃ¡c tÃªn cá»™t trong táº­p dá»¯ liá»‡u. Trong trÆ°á»ng há»£p nÃ y, khi <code>compute_review_length()</code> Ä‘Æ°á»£c truyá»n vÃ o <code>Dataset.map()</code>, nÃ³ sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng cho táº¥t cáº£ cÃ¡c hÃ ng trong táº­p dá»¯ liá»‡u Ä‘á»ƒ táº¡o cá»™t má»›i <code>review_length</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(compute_review_length)
<span class="hljs-comment"># Kiá»ƒm tra máº«u huáº¥n luyá»‡n Ä‘áº§u tiÃªn</span>
drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;patient_id&#x27;</span>: <span class="hljs-number">206461</span>,
 <span class="hljs-string">&#x27;drugName&#x27;</span>: <span class="hljs-string">&#x27;Valsartan&#x27;</span>,
 <span class="hljs-string">&#x27;condition&#x27;</span>: <span class="hljs-string">&#x27;left ventricular dysfunction&#x27;</span>,
 <span class="hljs-string">&#x27;review&#x27;</span>: <span class="hljs-string">&#x27;&quot;It has no side effect, I take it in combination of Bystolic 5 Mg and Fish Oil&quot;&#x27;</span>,
 <span class="hljs-string">&#x27;rating&#x27;</span>: <span class="hljs-number">9.0</span>,
 <span class="hljs-string">&#x27;date&#x27;</span>: <span class="hljs-string">&#x27;May 20, 2012&#x27;</span>,
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: <span class="hljs-number">27</span>,
 <span class="hljs-string">&#x27;review_length&#x27;</span>: <span class="hljs-number">17</span>}<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° mong Ä‘á»£i, chÃºng ta cÃ³ thá»ƒ tháº¥y cá»™t <code>review_length</code> Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o táº­p huáº¥n luyá»‡n cá»§a chÃºng ta. ChÃºng ta cÃ³ thá»ƒ sáº¯p xáº¿p cá»™t má»›i nÃ y vá»›i <code>Dataset.sort()</code> Ä‘á»ƒ xem cÃ¡c giÃ¡ trá»‹ cá»±c Ä‘áº¡i trÃ´ng nhÆ° tháº¿ nÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].sort(<span class="hljs-string">&quot;review_length&quot;</span>)[:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;patient_id&#x27;</span>: [<span class="hljs-number">103488</span>, <span class="hljs-number">23627</span>, <span class="hljs-number">20558</span>],
 <span class="hljs-string">&#x27;drugName&#x27;</span>: [<span class="hljs-string">&#x27;Loestrin 21 1 / 20&#x27;</span>, <span class="hljs-string">&#x27;Chlorzoxazone&#x27;</span>, <span class="hljs-string">&#x27;Nucynta&#x27;</span>],
 <span class="hljs-string">&#x27;condition&#x27;</span>: [<span class="hljs-string">&#x27;birth control&#x27;</span>, <span class="hljs-string">&#x27;muscle spasm&#x27;</span>, <span class="hljs-string">&#x27;pain&#x27;</span>],
 <span class="hljs-string">&#x27;review&#x27;</span>: [<span class="hljs-string">&#x27;&quot;Excellent.&quot;&#x27;</span>, <span class="hljs-string">&#x27;&quot;useless&quot;&#x27;</span>, <span class="hljs-string">&#x27;&quot;ok&quot;&#x27;</span>],
 <span class="hljs-string">&#x27;rating&#x27;</span>: [<span class="hljs-number">10.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">6.0</span>],
 <span class="hljs-string">&#x27;date&#x27;</span>: [<span class="hljs-string">&#x27;November 4, 2008&#x27;</span>, <span class="hljs-string">&#x27;March 24, 2017&#x27;</span>, <span class="hljs-string">&#x27;August 20, 2016&#x27;</span>],
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span>],
 <span class="hljs-string">&#x27;review_length&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]}<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° ta Ä‘Ã£ nghi váº¥n, má»™t sá»‘ Ä‘Ã¡nh giÃ¡ chá»‰ chá»©a má»™t tá»« duy nháº¥t, máº·c dÃ¹ cÃ³ thá»ƒ á»•n Ä‘á»ƒ phÃ¢n tÃ­ch sáº¯c thÃ¡i, nhÆ°ng sáº½ khÃ´ng cÃ³ nhiá»u thÃ´ng tin náº¿u chÃºng tÃ´i muá»‘n dá»± Ä‘oÃ¡n tÃ¬nh tráº¡ng bá»‡nh.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ™‹ Má»™t cÃ¡ch thay tháº¿ Ä‘á»ƒ thÃªm cÃ¡c cá»™t má»›i vÃ o táº­p dá»¯ liá»‡u lÃ  sá»­ dá»¥ng hÃ m <code>Dataset.add_column()</code>. Äiá»u nÃ y cho phÃ©p báº¡n cung cáº¥p cá»™t dÆ°á»›i dáº¡ng danh sÃ¡ch Python hoáº·c máº£ng NumPy vÃ  cÃ³ thá»ƒ há»¯u Ã­ch trong cÃ¡c trÆ°á»ng há»£p mÃ  <code>Dataset.map()</code> khÃ´ng phÃ¹ há»£p cho phÃ¢n tÃ­ch cá»§a báº¡n.</p></div>
<p>HÃ£y sá»­ dá»¥ng hÃ m <code>Dataset.filter()</code> Ä‘á»ƒ xÃ³a cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cÃ³ Ã­t hÆ¡n 30 tá»«. TÆ°Æ¡ng tá»± nhÆ° nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ lÃ m vá»›i cá»™t <code>condition</code>, chÃºng ta cÃ³ thá»ƒ lá»c ra cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ ráº¥t ngáº¯n báº±ng cÃ¡ch yÃªu cáº§u cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cÃ³ Ä‘á»™ dÃ i trÃªn ngÆ°á»¡ng nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;review_length&quot;</span>] &gt; <span class="hljs-number">30</span>)
<span class="hljs-built_in">print</span>(drug_dataset.num_rows)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;train&#x27;</span>: <span class="hljs-number">138514</span>, <span class="hljs-string">&#x27;test&#x27;</span>: <span class="hljs-number">46108</span>}<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, Ä‘iá»u nÃ y Ä‘Ã£ loáº¡i bá» khoáº£ng 15% bÃ i Ä‘Ã¡nh giÃ¡ khá»i bá»™ huáº¥n luyá»‡n vÃ  kiá»ƒm thá»­ ban Ä‘áº§u.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Sá»­ dá»¥ng hÃ m <code>Dataset.sort()</code> Ä‘á»ƒ kiá»ƒm tra cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cÃ³ sá»‘ lÆ°á»£ng tá»« lá»›n nháº¥t. Tham kháº£o <a href="https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Dataset.sort" rel="nofollow">tÃ i liá»‡u</a> Ä‘á»ƒ biáº¿t báº¡n cáº§n sá»­ dá»¥ng tham sá»‘ nÃ o Ä‘á»ƒ sáº¯p xáº¿p cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ theo thá»© tá»± giáº£m dáº§n.</p></div>
<p>Äiá»u cuá»‘i cÃ¹ng chÃºng ta cáº§n giáº£i quyáº¿t lÃ  sá»± hiá»‡n diá»‡n cá»§a kÃ½ tá»± HTML trong cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cá»§a chÃºng ta. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng mÃ´-Ä‘un <code>html</code> cá»§a Python Ä‘á»ƒ loáº¡i bá» qua cÃ¡c kÃ½ tá»± nÃ y, nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> html

text = <span class="hljs-string">&quot;I&amp;#039;m a transformer called BERT&quot;</span>
html.unescape(text)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&quot;I&#x27;m a transformer called BERT&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>Ta sáº½ sá»­ dá»¥ng <code>Dataset.map()</code> Ä‘á»ƒ há»§y táº¥t cáº£ cÃ¡c kÃ½ tá»± HTML trong kho tÃ i liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: {<span class="hljs-string">&quot;review&quot;</span>: html.unescape(x[<span class="hljs-string">&quot;review&quot;</span>])})<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, phÆ°Æ¡ng thá»©c <code>Dataset.map()</code> khÃ¡ há»¯u Ã­ch Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u - vÃ  chÃºng ta tháº­m chÃ­ cÃ²n chÆ°a rÃµ táº¥t má»i thá»© mÃ  nÃ³ cÃ³ thá»ƒ lÃ m!</p>
<h2 class="relative group"><a id="siu-sc-mnh-ca-hm-map" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#siu-sc-mnh-ca-hm-map"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>SiÃªu sá»©c máº¡nh cá»§a hÃ m <code>map()</code></span></h2>

<p>PhÆ°Æ¡ng thá»©c <code>Dataset.map ()</code> nháº­n tham sá»‘ <code>batched</code>, náº¿u Ä‘Æ°á»£c Ä‘áº·t thÃ nh <code>True</code>, nÃ³ sáº½ gá»­i má»™t loáº¡t cÃ¡c máº«u Ä‘áº¿n hÃ m map cÃ¹ng má»™t lÃºc (ta cÃ³ thá»ƒ cáº¥u hÃ¬nh kÃ­ch thÆ°á»›c lÃ´ nhÆ°ng máº·c Ä‘á»‹nh lÃ  1,000). VÃ­ dá»¥: hÃ m map trÆ°á»›c Ä‘Ã³ loáº¡i bá» táº¥t cáº£ HTML Ä‘Ã£ máº¥t má»™t chÃºt thá»i gian Ä‘á»ƒ cháº¡y (báº¡n cÃ³ thá»ƒ Ä‘á»c thá»i gian thá»±c hiá»‡n tá»« cÃ¡c thanh tiáº¿n trÃ¬nh). ChÃºng ta cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™ nÃ y báº±ng cÃ¡ch xá»­ lÃ½ má»™t sá»‘ pháº§n tá»­ cÃ¹ng lÃºc thÃ´ng qua sá»­ dá»¥ng bao hÃ m.</p>
<p>Khi báº¡n chá»‰ Ä‘á»‹nh <code>batched=True</code>, hÃ m sáº½ nháº­n má»™t tá»« Ä‘iá»ƒn vá»›i cÃ¡c trÆ°á»ng cá»§a táº­p dá»¯ liá»‡u, nhÆ°ng má»—i giÃ¡ trá»‹ bÃ¢y giá» lÃ  má»™t <em>danh sÃ¡ch cÃ¡c giÃ¡ trá»‹</em> vÃ  khÃ´ng chá»‰ lÃ  má»™t giÃ¡ trá»‹ duy nháº¥t. GiÃ¡ trá»‹ tráº£ vá» cá»§a <code>Dataset.map()</code> pháº£i giá»‘ng nhau: má»™t tá»« Ä‘iá»ƒn vá»›i cÃ¡c trÆ°á»ng ta muá»‘n cáº­p nháº­t hoáº·c thÃªm vÃ o táº­p dá»¯ liá»‡u cá»§a mÃ¬nh vÃ  má»™t danh sÃ¡ch cÃ¡c giÃ¡ trá»‹. VÃ­ dá»¥: Ä‘Ã¢y lÃ  má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ há»§y táº¥t cáº£ cÃ¡c kÃ½ tá»± HTML, nhÆ°ng sá»­ dá»¥ng <code>batched=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->new_drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(
    <span class="hljs-keyword">lambda</span> x: {<span class="hljs-string">&quot;review&quot;</span>: [html.unescape(o) <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> x[<span class="hljs-string">&quot;review&quot;</span>]]}, batched=<span class="hljs-literal">True</span>
)<!-- HTML_TAG_END --></pre></div>
<p>Náº¿u báº¡n Ä‘ang cháº¡y Ä‘oáº¡n mÃ£ nÃ y trÃªn notebook, báº¡n sáº½ tháº¥y ráº±ng lá»‡nh nÃ y thá»±c thi nhanh hÆ¡n lá»‡nh trÆ°á»›c Ä‘Ã³. VÃ  Ä‘Ã³ khÃ´ng pháº£i lÃ  do cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ cá»§a chÃºng tÃ´i Ä‘Ã£ Ä‘Æ°á»£c loáº¡i Ä‘i HTML - náº¿u báº¡n thá»±c hiá»‡n láº¡i hÆ°á»›ng dáº«n tá»« pháº§n trÆ°á»›c (khÃ´ng cÃ³ <code>batch = True</code>), nÃ³ sáº½ máº¥t cÃ¹ng má»™t khoáº£ng thá»i gian nhÆ° trÆ°á»›c. Äiá»u nÃ y lÃ  do viá»‡c bao hÃ m thÆ°á»ng nhanh hÆ¡n viá»‡c thá»±c thi cÃ¹ng má»™t Ä‘oáº¡n mÃ£ trong vÃ²ng láº·p <code>for</code> vÃ  chÃºng ta cÅ©ng Ä‘áº¡t Ä‘Æ°á»£c má»™t sá»‘ hiá»‡u suáº¥t báº±ng cÃ¡ch truy cáº­p nhiá»u pháº§n tá»­ cÃ¹ng má»™t lÃºc thay vÃ¬ tá»«ng pháº§n tá»­ má»™t.</p>
<p>Sá»­ dá»¥ng <code>Dataset.map()</code> vá»›i <code>batched=True</code> sáº½ lÃ  Ä‘iá»u cáº§n thiáº¿t Ä‘á»ƒ má»Ÿ khÃ³a tá»‘c Ä‘á»™ cá»§a cÃ¡c trÃ¬nh tokenize â€œnhanhâ€ mÃ  chÃºng ta sáº½ gáº·p trong <a href="/course/chap6">ChÆ°Æ¡ng 6</a>, cÃ³ thá»ƒ nhanh chÃ³ng tokenize cÃ¡c danh sÃ¡ch lá»›n cÃ¡c vÄƒn báº£n. VÃ­ dá»¥: Ä‘á»ƒ tokenize táº¥t cáº£ cÃ¡c Ä‘Ã¡nh giÃ¡ thuá»‘c báº±ng trÃ¬nh tokenize nhanh, ta cÃ³ thá»ƒ sá»­ dá»¥ng má»™t hÃ m nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;bert-base-cased&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;review&quot;</span>], truncation=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n Ä‘Ã£ tháº¥y trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>, chÃºng ta cÃ³ thá»ƒ truyá»n vÃ o má»™t hoáº·c nhiá»u máº«u cho tokenizer, vÃ¬ váº­y ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m nÃ y vá»›i <code>batched=True</code> hoáº·c khÃ´ng. HÃ£y cÅ©ng coi Ä‘Ã¢y lÃ  má»™t cÆ¡ há»™i Ä‘á»ƒ so sÃ¡nh hiá»‡u nÄƒng cá»§a hai tuá»³ chá»n nÃ y. Trong má»™t notebook, báº¡n cÃ³ thá»ƒ báº¥m giá» chá»‰ vá»›i má»™t dÃ²ng lá»‡nh <code>%time</code> trÆ°á»›c dÃ²ng mÃ£ báº¡n muá»‘n tÃ¬nh thá»i gian:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->%time tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n cÅ©ng cÃ³ thá»ƒ tÃ­nh thá»i gian cho toÃ n bá»™ Ã´ báº±ng cÃ¡ch Ä‘áº·t <code>%%time</code> á»Ÿ Ä‘áº§u cá»§a Ã´ mÃ£. TrÃªn pháº§n cá»©ng mÃ  chÃºng ta thá»±c hiá»‡n, nÃ³ hiá»ƒn thá»‹ 10.8 giÃ¢y cho lá»‡nh nÃ y (Ä‘Ã³ lÃ  sá»‘ Ä‘Æ°á»£c viáº¿t sau â€œWall timeâ€).</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Thá»±c hiá»‡n cÃ¹ng má»™t hÆ°á»›ng dáº«n cÃ³ vÃ  khÃ´ng cÃ³ <code>batched=True</code>, sau Ä‘Ã³ thá»­ nÃ³ vá»›i tokenizer cháº­m (thÃªm <code>use_fast=False</code> vÃ o <code>AutoTokenizer.from_pretrained()</code>) Ä‘á»ƒ báº¡n cÃ³ thá»ƒ tháº¥y giÃ¡ trá»‹ báº¡n nháº­n Ä‘Æ°á»£c trÃªn pháº§n cá»©ng cá»§a mÃ¬nh.</p></div>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  káº¿t quáº£ thu Ä‘Æ°á»£c khi cÃ³ vÃ  khÃ´ng cÃ³ tÃ­nh nÄƒng phÃ¢n lÃ´, vá»›i tokenizer nhanh vÃ  cháº­m:</p>
<table><thead><tr><th align="center">Tuá»³ chá»n</th>
<th align="center">Tokenizer nhanh</th>
<th align="center">Tokenizer cháº­m</th></tr></thead>
<tbody><tr><td align="center"><code>batched=True</code></td>
<td align="center">10.8s</td>
<td align="center">4min41s</td></tr>
<tr><td align="center"><code>batched=False</code></td>
<td align="center">59.2s</td>
<td align="center">5min3s</td></tr></tbody></table>
<p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  viá»‡c sá»­ dá»¥ng má»™t tokenizer nhanh vá»›i tÃ¹y chá»n <code>batched=True</code> sáº½ nhanh hÆ¡n 30 láº§n so vá»›i phiÃªn báº£n cháº­m mÃ  khÃ´ng cÃ³ lÃ´ - Ä‘iá»u nÃ y thá»±c sá»± tuyá»‡t vá»i! ÄÃ³ lÃ  lÃ½ do chÃ­nh táº¡i sao tokenizer nhanh lÃ  máº·c Ä‘á»‹nh khi sá»­ dá»¥ng <code>AutoTokenizer</code> (vÃ  táº¡i sao chÃºng Ä‘Æ°á»£c gá»i lÃ  â€œnhanhâ€). ChÃºng cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ nhÆ° váº­y bá»Ÿi vÃ¬ phÃ­a sau, Ä‘oáº¡n mÃ£ token hÃ³a Ä‘Æ°á»£c thá»±c thi báº±ng Rust, Ä‘Ã¢y lÃ  má»™t ngÃ´n ngá»¯ giÃºp dá»… dÃ ng thá»±c hiá»‡n Ä‘oáº¡n mÃ£ song song.</p>
<p>Song song hÃ³a cÅ©ng lÃ  lÃ½ do giáº£i thÃ­ch cho tá»‘c Ä‘á»™ tÄƒng gáº§n gáº¥p 6 láº§n mÃ  trÃ¬nh tokenize nhanh Ä‘áº¡t Ä‘Æ°á»£c vá»›i viá»‡c phÃ¢n lÃ´: báº¡n khÃ´ng thá»ƒ song song má»™t thao tÃ¡c tokenize Ä‘Æ¡n láº», nhÆ°ng khi báº¡n muá»‘n tokenize nhiá»u vÄƒn báº£n cÃ¹ng má»™t lÃºc, báº¡n cÃ³ thá»ƒ chá»‰ cáº§n chia nhá» viá»‡c thá»±c thi trÃªn nhiá»u quy trÃ¬nh, má»—i ngÆ°á»i chá»‹u trÃ¡ch nhiá»‡m vá» cÃ¡c vÄƒn báº£n cá»§a riÃªng mÃ¬nh.</p>
<p><code>Dataset.map()</code> cÅ©ng tá»± cÃ³ má»™t sá»‘ kháº£ nÄƒng tÃ­nh toÃ¡n song song. VÃ¬ chÃºng khÃ´ng Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Rust, nÃªn chÃºng sáº½ khÃ´ng Ä‘á»ƒ má»™t trÃ¬nh tokenizer cháº­m báº¯t ká»‹p vá»›i má»™t tokenizer nhanh, nhÆ°ng chÃºng váº«n cÃ³ thá»ƒ há»¯u Ã­ch (Ä‘áº·c biá»‡t náº¿u báº¡n Ä‘ang sá»­ dá»¥ng má»™t tokenizer khÃ´ng cÃ³ phiÃªn báº£n nhanh). Äá»ƒ báº­t xá»­ lÃ½ Ä‘a luá»“ng, hÃ£y sá»­ dá»¥ng tham sá»‘ <code>num_proc</code> vÃ  chá»‰ Ä‘á»‹nh sá»‘ lÆ°á»£ng quy trÃ¬nh sáº½ sá»­ dá»¥ng trong lá»‡nh gá»i cá»§a báº¡n tá»›i <code>Dataset.map()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->slow_tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;bert-base-cased&quot;</span>, use_fast=<span class="hljs-literal">False</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">slow_tokenize_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> slow_tokenizer(examples[<span class="hljs-string">&quot;review&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(slow_tokenize_function, batched=<span class="hljs-literal">True</span>, num_proc=<span class="hljs-number">8</span>)<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n cÃ³ thá»ƒ thá»­ nghiá»‡m má»™t chÃºt vá»›i thá»i gian Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng quy trÃ¬nh tá»‘i Æ°u Ä‘á»ƒ sá»­ dá»¥ng; trong trÆ°á»ng há»£p cá»§a chÃºng ta, 8 dÆ°á»ng nhÆ° táº¡o ra tá»‘c Ä‘á»™ tÄƒng tá»‘t nháº¥t. DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng con sá»‘ chÃºng tÃ´i nháº­n Ä‘Æ°á»£c khi cÃ³ vÃ  khÃ´ng cÃ³ xá»­ lÃ½ Ä‘a luá»“ng:</p>
<table><thead><tr><th align="center">Tuá»³ chá»n</th>
<th align="center">Tokenizer nhanh</th>
<th align="center">Tokenizer cháº­m</th></tr></thead>
<tbody><tr><td align="center"><code>batched=True</code></td>
<td align="center">10.8s</td>
<td align="center">4min41s</td></tr>
<tr><td align="center"><code>batched=False</code></td>
<td align="center">59.2s</td>
<td align="center">5min3s</td></tr>
<tr><td align="center"><code>batched=True</code>, <code>num_proc=8</code></td>
<td align="center">6.52s</td>
<td align="center">41.3s</td></tr>
<tr><td align="center"><code>batched=False</code>, <code>num_proc=8</code></td>
<td align="center">9.49s</td>
<td align="center">45.2s</td></tr></tbody></table>
<p>ÄÃ³ lÃ  nhá»¯ng káº¿t quáº£ há»£p lÃ½ hÆ¡n nhiá»u Ä‘á»‘i vá»›i tokenizer cháº­m, nhÆ°ng hiá»‡u suáº¥t cá»§a tokenizer nhanh cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ. Tuy nhiÃªn, lÆ°u Ã½ ráº±ng Ä‘iá»u Ä‘Ã³ khÃ´ng pháº£i lÃºc nÃ o cÅ©ng Ä‘Ãºng - Ä‘á»‘i vá»›i cÃ¡c giÃ¡ trá»‹ cá»§a <code>num_proc</code> khÃ¡c 8, cÃ¡c thá»­ nghiá»‡m cá»§a chÃºng tÃ´i cho tháº¥y ráº±ng sá»­ dá»¥ng <code>batched=True</code> mÃ  khÃ´ng cÃ³ tÃ¹y chá»n nÃ y sáº½ nhanh hÆ¡n. NÃ³i chung, chÃºng tÃ´i khuyÃªn báº¡n khÃ´ng nÃªn sá»­ dá»¥ng xá»­ lÃ½ Ä‘a luá»“ng Python cho cÃ¡c trÃ¬nh tokenize nhanh vá»›i <code>batched=True</code>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>Sá»­ dá»¥ng <code>num_proc</code> Ä‘á»ƒ tÄƒng tá»‘c quÃ¡ trÃ¬nh xá»­ lÃ½ cá»§a báº¡n thÆ°á»ng lÃ  má»™t Ã½ tÆ°á»Ÿng tuyá»‡t vá»i, miá»…n lÃ  hÃ m báº¡n Ä‘ang sá»­ dá»¥ng chÆ°a thá»±c hiá»‡n má»™t sá»‘ kiá»ƒu xá»­ lÃ½ Ä‘a xá»­ lÃ½ cá»§a riÃªng nÃ³.</p></div>
<p>Táº¥t cáº£ cÃ¡c chá»©c nÄƒng nÃ y Ä‘Æ°á»£c cÃ´ Ä‘á»ng trong má»™t phÆ°Æ¡ng phÃ¡p Ä‘Ã£ khÃ¡ tuyá»‡t vá»i, nhÆ°ng cÃ²n nhiá»u hÆ¡n tháº¿ ná»¯a! Vá»›i <code>Dataset.map()</code> vÃ  <code>batched=True</code>, báº¡n cÃ³ thá»ƒ thay Ä‘á»•i sá»‘ lÆ°á»£ng pháº§n tá»­ trong táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. Äiá»u nÃ y cá»±c ká»³ há»¯u Ã­ch trong nhiá»u trÆ°á»ng há»£p mÃ  báº¡n muá»‘n táº¡o má»™t sá»‘ Ä‘áº·c trÆ°ng huáº¥n luyá»‡n tá»« má»™t máº«u vÃ  chÃºng ta sáº½ cáº§n thá»±c hiá»‡n Ä‘iá»u nÃ y nhÆ° má»™t pháº§n cá»§a quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ cho má»™t sá»‘ tÃ¡c vá»¥ NLP sáº½ thá»±c hiá»‡n trong <a href="/course/chapter7">ChÆ°Æ¡ng 7</a>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Trong há»c mÃ¡y, má»™t <em>máº«u</em> thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  táº­p há»£p <em>Ä‘áº·c trÆ°ng</em> mÃ  chÃºng ta cung cáº¥p cho mÃ´ hÃ¬nh. Trong má»™t sá»‘ ngá»¯ cáº£nh, cÃ¡c Ä‘áº·c trÆ°ng nÃ y sáº½ lÃ  táº­p há»£p thÃ nh cÃ¡c cá»™t trong <code>Dataset</code>, nhÆ°ng trong cÃ¡c trÆ°á»ng há»£p khÃ¡c (nhÆ° á»Ÿ Ä‘Ã¢y vÃ  Ä‘á»ƒ phá»¥c vá»¥ há»i Ä‘Ã¡p), nhiá»u Ä‘áº·c trÆ°ng cÃ³ thá»ƒ Ä‘Æ°á»£c trÃ­ch xuáº¥t tá»« má»™t máº«u vÃ  thuá»™c vá» má»™t cá»™t duy nháº¥t.</p></div>
<p>ChÃºng ta hÃ£y xem nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o! á» Ä‘Ã¢y, ta sáº½ tokenize cÃ¡c máº«u cá»§a mÃ¬nh vÃ  cáº¯t chÃºng vá» Ä‘á»™ dÃ i tá»‘i Ä‘a lÃ  128, nhÆ°ng ta sáº½ yÃªu cáº§u trÃ¬nh tokenize tráº£ vá» <em>táº¥t cáº£</em> cÃ¡c Ä‘oáº¡n vÄƒn báº£n thay vÃ¬ chá»‰ Ä‘oáº¡n vÄƒn báº£n Ä‘áº§u tiÃªn. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i <code>return_overflowing_tokens=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_and_split</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(
        examples[<span class="hljs-string">&quot;review&quot;</span>],
        truncation=<span class="hljs-literal">True</span>,
        max_length=<span class="hljs-number">128</span>,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
    )<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y kiá»ƒm tra Ä‘iá»u nÃ y trÃªn má»™t máº«u trÆ°á»›c khi sá»­ dá»¥ng <code>Dataset.map()</code> trÃªn toÃ n bá»™ táº­p dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->result = tokenize_and_split(drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>])
[<span class="hljs-built_in">len</span>(inp) <span class="hljs-keyword">for</span> inp <span class="hljs-keyword">in</span> result[<span class="hljs-string">&quot;input_ids&quot;</span>]]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">128</span>, <span class="hljs-number">49</span>]<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, máº«u Ä‘áº§u tiÃªn trong táº­p huáº¥n luyá»‡n Ä‘Ã£ trá»Ÿ thÃ nh hai Ä‘áº·c trÆ°ng vÃ¬ nÃ³ Ä‘Ã£ Ä‘Æ°á»£c tokenize nhiá»u hÆ¡n sá»‘ lÆ°á»£ng token tá»‘i Ä‘a mÃ  chÃºng tÃ´i Ä‘Ã£ chá»‰ Ä‘á»‹nh: cÃ¡i Ä‘áº§u tiÃªn cÃ³ Ä‘á»™ dÃ i 128 vÃ  cÃ¡i thá»© hai cÃ³ Ä‘á»™ dÃ i 49. BÃ¢y giá» hÃ£y lÃ m Ä‘iá»u nÃ y cho táº¥t cáº£ cÃ¡c pháº§n tá»­ cá»§a táº­p dá»¯ liá»‡u!</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_and_split, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->ArrowInvalid: Column <span class="hljs-number">1</span> named condition expected length <span class="hljs-number">1463</span> but got length <span class="hljs-number">1000</span><!-- HTML_TAG_END --></pre></div>
<p>Ã”i khÃ´ng! NÃ³ Ä‘Ã£ khÃ´ng hoáº¡t Ä‘á»™ng! Táº¡i sao khÃ´ng? NhÃ¬n vÃ o thÃ´ng bÃ¡o lá»—i sáº½ cho chÃºng ta manh má»‘i: cÃ³ sá»± khÃ´ng khá»›p vá» Ä‘á»™ dÃ i cá»§a má»™t trong cÃ¡c cá»™t, má»™t cá»™t cÃ³ Ä‘á»™ dÃ i 1,463 vÃ  cá»™t cÃ²n láº¡i cÃ³ Ä‘á»™ dÃ i 1,000. Náº¿u báº¡n Ä‘Ã£ xem <a href="https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Dataset.map" rel="nofollow">tÃ i liá»‡u</a> vá» <code>Dataset.map()</code>, báº¡n cÃ³ thá»ƒ nhá»› ráº±ng Ä‘Ã³ lÃ  sá»‘ cÃ¡c máº«u Ä‘Æ°á»£c truyá»n vÃ o hÃ m mÃ  chÃºng ta Ä‘ang Ã¡nh xáº¡; á»Ÿ Ä‘Ã¢y 1,000 máº«u Ä‘Ã³ Ä‘Ã£ cung cáº¥p 1,463 Ä‘áº·c trÆ°ng má»›i, dáº«n Ä‘áº¿n lá»—i hÃ¬nh dáº¡ng.</p>
<p>Váº¥n Ä‘á» lÃ  chÃºng ta Ä‘ang cá»‘ gáº¯ng káº¿t há»£p hai táº­p dá»¯ liá»‡u khÃ¡c nhau vá»›i cÃ¡c kÃ­ch thÆ°á»›c khÃ¡c nhau: cá»™t <code>drug_dataset</code> sáº½ cÃ³ má»™t sá»‘ máº«u nháº¥t Ä‘á»‹nh (lá»—i phÃ­a chÃºng ta lÃ  1,000), nhÆ°ng <code>tokenized_dataset</code>  mÃ  chÃºng ta Ä‘ang xÃ¢y dá»±ng sáº½ cÃ³ nhiá»u hÆ¡n (1,463 trong thÃ´ng bÃ¡o lá»—i). Äiá»u nÃ y khÃ´ng hoáº¡t Ä‘á»™ng Ä‘á»‘i vá»›i <code>Dataset</code>, vÃ¬ váº­y chÃºng ta cáº§n xÃ³a cÃ¡c cá»™t khá»i táº­p dá»¯ liá»‡u cÅ© hoáº·c lÃ m cho chÃºng cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c vá»›i chÃºng trong táº­p dá»¯ liá»‡u má»›i. ChÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘iá»u Ä‘áº§u thÃ´ng qua tham sá»‘ <code>remove_columns</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(
    tokenize_and_split, batched=<span class="hljs-literal">True</span>, remove_columns=drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].column_names
)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» nÃ³ hoáº¡t Ä‘á»™ng mÃ  khÃ´ng cÃ³ lá»—i. ChÃºng ta cÃ³ thá»ƒ kiá»ƒm tra xem táº­p dá»¯ liá»‡u má»›i cá»§a mÃ¬nh cÃ³ nhiá»u pháº§n tá»­ hÆ¡n táº­p dá»¯ liá»‡u gá»‘c hay khÃ´ng báº±ng cÃ¡ch so sÃ¡nh Ä‘á»™ dÃ i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">len</span>(tokenized_dataset[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-built_in">len</span>(drug_dataset[<span class="hljs-string">&quot;train&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">206772</span>, <span class="hljs-number">138514</span>)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng tÃ´i Ä‘Ã£ Ä‘á» cáº­p ráº±ng chÃºng ta cÅ©ng cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» chiá»u dÃ i khÃ´ng khá»›p báº±ng cÃ¡ch lÃ m cho cÃ¡c cá»™t cÅ© cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c vá»›i cÃ¡c cá»™t má»›i. Äá»ƒ thá»±c hiá»‡n viá»‡c nÃ y, chÃºng ta sáº½ cáº§n trÆ°á»ng <code>overflow_to_sample_mapping</code> mÃ  tokenizer tráº£ vá» khi chÃºng ta Ä‘áº·t <code>return_overflowing_tokens=True</code>. NÃ³ cung cáº¥p cho chÃºng ta má»™t Ã¡nh xáº¡ tá»« má»™t chá»‰ má»¥c Ä‘áº·c trÆ°ng má»›i Ä‘áº¿n chá»‰ má»¥c cá»§a máº«u mÃ  nÃ³ báº¯t nguá»“n tá»« Ä‘Ã³. Sá»­ dá»¥ng Ä‘iá»u nÃ y, chÃºng ta cÃ³ thá»ƒ liÃªn káº¿t má»—i khÃ³a cÃ³ trong táº­p dá»¯ liá»‡u ban Ä‘áº§u vá»›i má»™t danh sÃ¡ch cÃ¡c giÃ¡ trá»‹ cÃ³ kÃ­ch thÆ°á»›c phÃ¹ há»£p báº±ng cÃ¡ch láº·p láº¡i cÃ¡c giÃ¡ trá»‹ cá»§a má»—i vÃ­ dá»¥ nhiá»u láº§n khi nÃ³ táº¡o ra cÃ¡c Ä‘áº·c trÆ°ng má»›i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_and_split</span>(<span class="hljs-params">examples</span>):
    result = tokenizer(
        examples[<span class="hljs-string">&quot;review&quot;</span>],
        truncation=<span class="hljs-literal">True</span>,
        max_length=<span class="hljs-number">128</span>,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
    )
    <span class="hljs-comment"># Extract mapping between new and old indices</span>
    sample_map = result.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    <span class="hljs-keyword">for</span> key, values <span class="hljs-keyword">in</span> examples.items():
        result[key] = [values[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sample_map]
    <span class="hljs-keyword">return</span> result<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ tháº¥y nÃ³ hoáº¡t Ä‘á»™ng vá»›i <code>Dataset.map()</code> mÃ  chÃºng ta khÃ´ng cáº§n xÃ³a cÃ¡c cá»™t cÅ©:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_and_split, batched=<span class="hljs-literal">True</span>)
tokenized_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">206772</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">68876</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta nháº­n Ä‘Æ°á»£c cÃ¹ng sá»‘ Ä‘áº·c trÆ°ng huáº¥n luyá»‡n nhÆ° trÆ°á»›c Ä‘Ã³, nhÆ°ng á»Ÿ Ä‘Ã¢y ta Ä‘Ã£ giá»¯ láº¡i táº¥t cáº£ cÃ¡c trÆ°á»ng cÅ©. Náº¿u báº¡n cáº§n chÃºng Ä‘á»ƒ háº­u xá»­ lÃ½ sau khi Ã¡p dá»¥ng mÃ´ hÃ¬nh cá»§a mÃ¬nh, báº¡n cÃ³ thá»ƒ muá»‘n sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p nÃ y.</p>
<p>BÃ¢y giá» báº¡n Ä‘Ã£ tháº¥y cÃ¡ch ğŸ¤— Datasets cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tiá»n xá»­ lÃ½ má»™t táº­p dá»¯ liá»‡u theo nhiá»u cÃ¡ch khÃ¡c nhau. Máº·c dÃ¹ cÃ¡c chá»©c nÄƒng xá»­ lÃ½ cá»§a ğŸ¤— Datasets sáº½ Ä‘Ã¡p á»©ng háº§u háº¿t cÃ¡c nhu cáº§u huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a báº¡n,
cÃ³ thá»ƒ Ä‘Ã´i khi báº¡n cáº§n chuyá»ƒn sang Pandas Ä‘á»ƒ truy cáº­p cÃ¡c tÃ­nh nÄƒng máº¡nh máº½ hÆ¡n, cháº³ng háº¡n nhÆ°  <code>DataFrame.groupby()</code> hoáº·c cÃ¡c API cáº¥p cao Ä‘á»ƒ trá»±c quan hÃ³a. May máº¯n thay, ğŸ¤— Datasets Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c thÆ° viá»‡n nhÆ° Pandas, NumPy, PyTorch, TensorFlow vÃ  JAX. ChÃºng ta hÃ£y xem cÃ¡ch nÃ y hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o.</p>
<h2 class="relative group"><a id="t-dataset-ti-dataframe-v-ngc-li" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#t-dataset-ti-dataframe-v-ngc-li"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tá»« <code>Dataset</code> tá»›i <code>DataFrame</code> vÃ  ngÆ°á»£c láº¡i
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/tfcY1067A5Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Äá»ƒ cho phÃ©p chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c thÆ° viá»‡n bÃªn thá»© ba khÃ¡c nhau, ğŸ¤— Datasets cung cáº¥p hÃ m <code>Dataset.set_format()</code>. HÃ m nÃ y chá»‰ thay Ä‘á»•i <em>Ä‘á»‹nh dáº¡ng Ä‘áº§u ra</em> cá»§a táº­p dá»¯ liá»‡u, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ dá»… dÃ ng chuyá»ƒn sang Ä‘á»‹nh dáº¡ng khÃ¡c mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n <em>Ä‘á»‹nh dáº¡ng Ä‘áº§u ra</em> bÃªn dÆ°á»›i, Ä‘Ã³ lÃ  Apache Arrow. Viá»‡c Ä‘á»‹nh dáº¡ng Ä‘Æ°á»£c thá»±c hiá»‡n táº¡i chá»—. Äá»ƒ chá»©ng minh, hÃ£y chuyá»ƒn Ä‘á»•i táº­p dá»¯ liá»‡u cá»§a chÃºng tÃ´i thÃ nh Pandas:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset.set_format(<span class="hljs-string">&quot;pandas&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Giá» khi chÃºng ta truy cáº­p cÃ¡c pháº§n tá»­ cá»§a táº­p dá»¯ liá»‡u, ta nháº­n Ä‘Æ°á»£c <code>pandas.DataFrame</code> thay vÃ¬ tá»« Ä‘iá»ƒn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>
<table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th>
      <th>patient_id</th>
      <th>drugName</th>
      <th>condition</th>
      <th>review</th>
      <th>rating</th>
      <th>date</th>
      <th>usefulCount</th>
      <th>review_length</th></tr></thead>
  <tbody><tr><th>0</th>
      <td>95260</td>
      <td>Guanfacine</td>
      <td>adhd</td>
      <td>&quot;My son is halfway through his fourth week of Intuniv...&quot;</td>
      <td>8.0</td>
      <td>April 27, 2010</td>
      <td>192</td>
      <td>141</td></tr>
    <tr><th>1</th>
      <td>92703</td>
      <td>Lybrel</td>
      <td>birth control</td>
      <td>&quot;I used to take another oral contraceptive, which had 21 pill cycle, and was very happy- very light periods, max 5 days, no other side effects...&quot;</td>
      <td>5.0</td>
      <td>December 14, 2009</td>
      <td>17</td>
      <td>134</td></tr>
    <tr><th>2</th>
      <td>138000</td>
      <td>Ortho Evra</td>
      <td>birth control</td>
      <td>&quot;This is my first time using any form of birth control...&quot;</td>
      <td>8.0</td>
      <td>November 3, 2015</td>
      <td>10</td>
      <td>89</td></tr></tbody></table>
<p>HÃ£y táº¡o ra má»™t <code>pandas.DataFrame</code> cho toÃ n bá»™ táº­p huáº¥n luyá»‡n báº±ng cÃ¡ch chá»n táº¥t cáº£ cÃ¡c pháº§n tá»­ trong <code>drug_dataset[&quot;train&quot;]</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->train_df = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][:]<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸš¨ BÃªn dÆ°á»›i <code>Dataset.set_format()</code> thay Ä‘á»•i Ä‘á»‹nh dáº¡ng tráº£ vá» cho phÆ°Æ¡ng thá»©c <code>__getitem __()</code> cá»§a táº­p dá»¯ liá»‡u. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khi chÃºng ta muá»‘n táº¡o má»™t Ä‘á»‘i tÆ°á»£ng má»›i nhÆ° <code>train_df</code> tá»« <code>Dataset</code> á»Ÿ Ä‘á»‹nh dáº¡ng <code>&quot;pandas&quot;</code>, chÃºng ta cáº§n cáº¯t toÃ n bá»™ táº­p dá»¯ liá»‡u Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c má»™t <code>pandas.DataFrame</code>. Báº¡n cÃ³ thá»ƒ tá»± xÃ¡c minh xem kiá»ƒu dá»¯ liá»‡u cá»§a <code>drug_dataset[&quot;train&quot;]</code> cÃ³ pháº£i lÃ  <code>Dataset</code>, báº¥t ká»ƒ Ä‘á»‹nh dáº¡ng Ä‘áº§u ra lÃ  gÃ¬.</p></div>
<p>Tá»« Ä‘Ã¢y, ta cÃ³ thá»ƒ sá»­ dá»¥ng táº¥t cáº£ cÃ¡c chá»©c nÄƒng cá»§a Pandas mÃ  ta muá»‘n. VÃ­ dá»¥, chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n chuá»—i láº¡ máº¯t Ä‘á»ƒ tÃ­nh toÃ¡n phÃ¢n phá»‘i lá»›p giá»¯a cÃ¡c <code>condition</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->frequencies = (
    train_df[<span class="hljs-string">&quot;condition&quot;</span>]
    .value_counts()
    .to_frame()
    .reset_index()
    .rename(columns={<span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-string">&quot;condition&quot;</span>, <span class="hljs-string">&quot;condition&quot;</span>: <span class="hljs-string">&quot;frequency&quot;</span>})
)
frequencies.head()<!-- HTML_TAG_END --></pre></div>
<table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th>
      <th>condition</th>
      <th>frequency</th></tr></thead>
  <tbody><tr><th>0</th>
      <td>birth control</td>
      <td>27655</td></tr>
    <tr><th>1</th>
      <td>depression</td>
      <td>8023</td></tr>
    <tr><th>2</th>
      <td>acne</td>
      <td>5209</td></tr>
    <tr><th>3</th>
      <td>anxiety</td>
      <td>4991</td></tr>
    <tr><th>4</th>
      <td>pain</td>
      <td>4744</td></tr></tbody></table>
<p>VÃ  khi chÃºng ta hoÃ n thÃ nh phÃ¢n tÃ­ch Pandas cá»§a mÃ¬nh, chÃºng ta luÃ´n cÃ³ thá»ƒ táº¡o má»™t Ä‘á»‘i tÆ°á»£ng <code>Dataset</code> má»›i báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>Dataset.from_pandas()</code> nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> Dataset

freq_dataset = Dataset.from_pandas(frequencies)
freq_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Dataset({
    features: [<span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;frequency&#x27;</span>],
    num_rows: <span class="hljs-number">819</span>
})<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> TÃ­nh xáº¿p háº¡ng trung bÃ¬nh cho má»—i loáº¡i thuá»‘c vÃ  lÆ°u trá»¯ káº¿t quáº£ á»Ÿ dáº¡ng <code>Dataset</code> má»›i.</p></div>
<p>Pháº§n nÃ y káº¿t thÃºc chuyáº¿n tham quan cá»§a chÃºng ta vá» cÃ¡c ká»¹ thuáº­t tiá»n xá»­ lÃ½ khÃ¡c nhau cÃ³ sáºµn trong ğŸ¤— Datasets. Äá»ƒ hoÃ n thiá»‡n pháº§n nÃ y, hÃ£y táº¡o má»™t tá»‡p kiá»ƒm Ä‘á»‹nh Ä‘á»ƒ chuáº©n bá»‹ táº­p dá»¯ liá»‡u cho viá»‡c huáº¥n luyá»‡n má»™t trÃ¬nh phÃ¢n loáº¡i. TrÆ°á»›c khi lÃ m nhÆ° váº­y, chÃºng ta sáº½ Ä‘áº·t láº¡i Ä‘á»‹nh dáº¡ng Ä‘áº§u ra cá»§a <code>drug_dataset</code> tá»« <code>&quot;pandas&quot;</code> thÃ nh <code>&quot;arrow&quot;</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset.reset_format()<!-- HTML_TAG_END --></pre></div>
<h2 class="relative group"><a id="to-ra-mt-tp-kim-nh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#to-ra-mt-tp-kim-nh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Táº¡o ra má»™t tá»‡p kiá»ƒm Ä‘á»‹nh
	</span></h2>

<p>Máº·c dÃ¹ chÃºng ta cÃ³ má»™t bá»™ dá»¯ liá»‡u kiá»ƒm thá»­ cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡, nhÆ°ng báº¡n nÃªn giá»¯ nguyÃªn bá»™ kiá»ƒm thá»­ vÃ  táº¡o má»™t bá»™ kiá»ƒm Ä‘á»‹nh riÃªng trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn. Khi báº¡n hÃ i lÃ²ng vá»›i hiá»‡u suáº¥t cá»§a cÃ¡c mÃ´ hÃ¬nh cá»§a mÃ¬nh trÃªn bá»™ kiá»ƒm Ä‘á»‹nh, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n kiá»ƒm tra láº§n cuá»‘i Ä‘á»‘i vá»›i bá»™ kiá»ƒm thá»­. Quy trÃ¬nh nÃ y giÃºp giáº£m thiá»ƒu rá»§i ro ráº±ng báº¡n sáº½ trang bá»‹ quÃ¡ má»©c cho bá»™ kiá»ƒm thá»­ vÃ  triá»ƒn khai má»™t mÃ´ hÃ¬nh khÃ´ng thÃ nh cÃ´ng trÃªn dá»¯ liá»‡u trong tháº¿ giá»›i thá»±c.</p>
<p>ğŸ¤— Datasets cung cáº¥p má»™t hÃ m <code>Dataset.train_test_split()</code> dá»±a trÃªn tÃ­nh nÄƒng ná»•i tiáº¿ng tá»« <code>scikit-learn</code>. HÃ£y cÃ¹ng dÃ¹ng nÃ³ Ä‘á»ƒ chia táº­p huáº¥n luyá»‡n thÃ nh cÃ¡c táº­p <code>train</code> vÃ  <code>validation</code> (ta Ä‘áº·t tham sá»‘ <code>seed</code> cho má»¥c Ä‘Ã­nh tÃ¡i táº¡o):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset_clean = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].train_test_split(train_size=<span class="hljs-number">0.8</span>, seed=<span class="hljs-number">42</span>)
<span class="hljs-comment"># Thay Ä‘á»•i tÃªn máº·c Ä‘á»‹nh &quot;test&quot; thÃ nh &quot;validation&quot;</span>
drug_dataset_clean[<span class="hljs-string">&quot;validation&quot;</span>] = drug_dataset_clean.pop(<span class="hljs-string">&quot;test&quot;</span>)
<span class="hljs-comment"># ThÃªm &quot;test&quot; vÃ o `DatasetDict`</span>
drug_dataset_clean[<span class="hljs-string">&quot;test&quot;</span>] = drug_dataset[<span class="hljs-string">&quot;test&quot;</span>]
drug_dataset_clean<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">110811</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">27703</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">46108</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t vá»i, ta hiá»‡n Ä‘Ã£ chuáº©n bá»‹ má»™t táº­p dá»¯ liá»‡u sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n má»™t sá»‘ mÃ´ hÃ¬nh! Trong <a href="/course/chapter5/5">pháº§n 5</a>, chÃºng tÃ´i sáº½ chá»‰ cho báº¡n cÃ¡ch táº£i táº­p dá»¯ liá»‡u lÃªn Hugging Face Hub, nhÆ°ng bÃ¢y giá» hÃ£y quen vá»›i phÃ¢n tÃ­ch cá»§a chÃºng tÃ´i báº±ng cÃ¡ch xem xÃ©t má»™t sá»‘ cÃ¡ch báº¡n cÃ³ thá»ƒ lÆ°u táº­p dá»¯ liá»‡u trÃªn mÃ¡y cá»¥c bá»™ cá»§a mÃ¬nh.</p>
<h2 class="relative group"><a id="lu-mt-b-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#lu-mt-b-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>LÆ°u má»™t bá»™ dá»¯ liá»‡u
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/blF9uxYcKHo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Máº·c dÃ¹ ğŸ¤— Datasets sáº½ lÆ°u vÃ o bá»™ nhá»› cache má»i táº­p dá»¯ liá»‡u Ä‘Ã£ táº£i xuá»‘ng vÃ  cÃ¡c hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn nÃ³, nhÆ°ng Ä‘Ã´i khi báº¡n sáº½ muá»‘n lÆ°u táº­p dá»¯ liá»‡u vÃ o Ä‘Ä©a (vÃ­ dá»¥: trong trÆ°á»ng há»£p bá»™ nhá»› cache bá»‹ xÃ³a). NhÆ° thá»ƒ hiá»‡n trong báº£ng bÃªn dÆ°á»›i, ğŸ¤— Datasets cung cáº¥p ba chá»©c nÄƒng chÃ­nh Ä‘á»ƒ lÆ°u táº­p dá»¯ liá»‡u cá»§a báº¡n á»Ÿ cÃ¡c Ä‘á»‹nh dáº¡ng khÃ¡c nhau:</p>
<table><thead><tr><th align="center">Äá»‹nh dáº¡ng dá»¯ liá»‡u</th>
<th align="center">HÃ m</th></tr></thead>
<tbody><tr><td align="center">Arrow</td>
<td align="center"><code>Dataset.save_to_disk()</code></td></tr>
<tr><td align="center">CSV</td>
<td align="center"><code>Dataset.to_csv()</code></td></tr>
<tr><td align="center">JSON</td>
<td align="center"><code>Dataset.to_json()</code></td></tr></tbody></table>
<p>VÃ­ dá»¥, hÃ£y cÃ¹ng lÆ°u dá»¯ liá»‡u sáº¡ch cá»§a chÃºng ta vá» Ä‘á»‹nh dáº¡ng Arrow:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset_clean.save_to_disk(<span class="hljs-string">&quot;drug-reviews&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>NÃ³ sáº½ táº¡o ra má»™t kho lÆ°u trá»¯ vá»›i cáº¥u trÃºc nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug-reviews/
â”œâ”€â”€ dataset_dict.json
â”œâ”€â”€ test
â”‚   â”œâ”€â”€ dataset.arrow
â”‚   â”œâ”€â”€ dataset_info.json
â”‚   â””â”€â”€ <span class="hljs-keyword">state</span>.json
â”œâ”€â”€ train
â”‚   â”œâ”€â”€ dataset.arrow
â”‚   â”œâ”€â”€ dataset_info.json
â”‚   â”œâ”€â”€ indices.arrow
â”‚   â””â”€â”€ <span class="hljs-keyword">state</span>.json
â””â”€â”€ validation
    â”œâ”€â”€ dataset.arrow
    â”œâ”€â”€ dataset_info.json
    â”œâ”€â”€ indices.arrow
    â””â”€â”€ <span class="hljs-keyword">state</span>.json<!-- HTML_TAG_END --></pre></div>
<p>nÆ¡i chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng má»—i pháº§n tÃ¡ch ra Ä‘Æ°á»£c liÃªn káº¿t vá»›i báº£ng <em>dataset.arrow</em> cá»§a riÃªng nÃ³ vÃ  má»™t sá»‘ siÃªu dá»¯ liá»‡u trong <em>dataset_info.json</em> vÃ  <em>state.json</em>. Báº¡n cÃ³ thá»ƒ coi Ä‘á»‹nh dáº¡ng Arrow nhÆ° má»™t báº£ng gá»“m cÃ¡c cá»™t vÃ  hÃ ng Æ°a thÃ­ch Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng hiá»‡u suáº¥t cao xá»­ lÃ½ vÃ  váº­n chuyá»ƒn cÃ¡c táº­p dá»¯ liá»‡u lá»›n.</p>
<p>Sau khi táº­p dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u, chÃºng ta cÃ³ thá»ƒ táº£i nÃ³ báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>load_from_disk()</code> nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_from_disk

drug_dataset_reloaded = load_from_disk(<span class="hljs-string">&quot;drug-reviews&quot;</span>)
drug_dataset_reloaded<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">110811</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">27703</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">46108</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Äá»‘i vá»›i Ä‘á»‹nh dáº¡ng CSV vÃ  JSON, chÃºng ta pháº£i lÆ°u trá»¯ tá»«ng pháº§n thÃ nh má»™t tá»‡p riÃªng biá»‡t. Má»™t cÃ¡ch Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y lÃ  láº·p láº¡i cÃ¡c khÃ³a vÃ  giÃ¡ trá»‹ trong Ä‘á»‘i tÆ°á»£ng <code>DatasetDict</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> split, dataset <span class="hljs-keyword">in</span> drug_dataset_clean.items():
    dataset.to_json(<span class="hljs-string">f&quot;drug-reviews-<span class="hljs-subst">{split}</span>.jsonl&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>NÃ³ sáº½ lÆ°u má»—i pháº§n dá»¯ liá»‡u vÃ o<a href="https://jsonlines.org" rel="nofollow">Ä‘á»‹nh dáº¡ng JSON Lines</a>, nÆ¡i má»—i dÃ²ng trong bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn má»™t dÃ²ng JSON. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» hÃ¬nh hÃ i cua nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!head -n <span class="hljs-number">1</span> drug-reviews-train.jsonl<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&quot;patient_id&quot;</span>:<span class="hljs-number">141780</span>,<span class="hljs-string">&quot;drugName&quot;</span>:<span class="hljs-string">&quot;Escitalopram&quot;</span>,<span class="hljs-string">&quot;condition&quot;</span>:<span class="hljs-string">&quot;depression&quot;</span>,<span class="hljs-string">&quot;review&quot;</span>:<span class="hljs-string">&quot;\&quot;I seemed to experience the regular side effects of LEXAPRO, insomnia, low sex drive, sleepiness during the day. I am taking it at night because my doctor said if it made me tired to take it at night. I assumed it would and started out taking it at night. Strange dreams, some pleasant. I was diagnosed with fibromyalgia. Seems to be helping with the pain. Have had anxiety and depression in my family, and have tried quite a few other medications that haven&#x27;t worked. Only have been on it for two weeks but feel more positive in my mind, want to accomplish more in my life. Hopefully the side effects will dwindle away, worth it to stick with it from hearing others responses. Great medication.\&quot;&quot;</span>,<span class="hljs-string">&quot;rating&quot;</span>:<span class="hljs-number">9.0</span>,<span class="hljs-string">&quot;date&quot;</span>:<span class="hljs-string">&quot;May 29, 2011&quot;</span>,<span class="hljs-string">&quot;usefulCount&quot;</span>:<span class="hljs-number">10</span>,<span class="hljs-string">&quot;review_length&quot;</span>:<span class="hljs-number">125</span>}<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta sau Ä‘Ã³ cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t trong <a href="/course/chapter5/2">pháº§n 2</a> Ä‘á»ƒ táº£i tá»‡p JSON nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->data_files = {
    <span class="hljs-string">&quot;train&quot;</span>: <span class="hljs-string">&quot;drug-reviews-train.jsonl&quot;</span>,
    <span class="hljs-string">&quot;validation&quot;</span>: <span class="hljs-string">&quot;drug-reviews-validation.jsonl&quot;</span>,
    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;drug-reviews-test.jsonl&quot;</span>,
}
drug_dataset_reloaded = load_dataset(<span class="hljs-string">&quot;json&quot;</span>, data_files=data_files)<!-- HTML_TAG_END --></pre></div>
<p>VÃ  Ä‘Ã³ lÃ  nÃ³ cho chuyáº¿n du ngoáº¡n cá»§a chÃºng ta vá»›i sáº¯p xáº¿p dá»¯ liá»‡u sá»­ dá»¥ng ğŸ¤— Datasets! Giá» ta Ä‘Ã£ cÃ³ má»™t táº­p dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÃ m sáº¡ch Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh, Ä‘Ã¢y lÃ  má»™t vÃ i Ã½ tÆ°á»Ÿng mÃ  báº¡n cÃ³ thá»ƒ thá»­:</p>
<ol><li>Sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t tá»« <a href="/course/chapter3">ChÆ°Æ¡ng 3</a> Ä‘á»ƒ huáº¥n luyá»‡n má»™t bá»™ phÃ¢n loáº¡i cÃ³ thá»ƒ dá»± Ä‘oÃ¡n tÃ¬nh tráº¡ng bá»‡nh nhÃ¢n dá»±a trÃªn cÃ¡c pháº£n há»“i vá» thuá»‘c.</li>
<li>Sá»­ dá»¥ng pipeline <code>summarization</code> tá»« <a href="/course/chapter1">ChÆ°Æ¡ng 1</a> Ä‘á»ƒ táº¡o cÃ¡c báº£n tÃ³m táº¯t cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡.</li></ol>
<p>Tiáº¿p theo, chÃºng ta sáº½ xem xÃ©t cÃ¡ch ğŸ¤— Datasets cÃ³ thá»ƒ cho phÃ©p báº¡n lÃ m viá»‡c vá»›i nhá»¯ng táº­p dá»¯ liá»‡u khá»•ng lá»“ mÃ  khÃ´ng lÃ m há»ng mÃ¡y tÃ­nh xÃ¡ch tay cá»§a báº¡n!</p>


		<script type="module" data-hydrate="h5dk0y">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="h5dk0y"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter5/3.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
