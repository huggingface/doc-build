<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;g-li-quy-trnh-hun-luyn&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;g-li-quy-trnh-hun-luyn&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;kim-tra-d-liu-ca-bn&quot;,&quot;title&quot;:&quot;Kiá»ƒm tra dá»¯ liá»‡u cá»§a báº¡n&quot;},{&quot;local&quot;:&quot;t-b-d-liu-thnh-dataloader&quot;,&quot;title&quot;:&quot;Tá»« bá»™ dá»¯ liá»‡u thÃ nh dataloader&quot;},{&quot;local&quot;:&quot;xem-qua-m-hnh&quot;,&quot;title&quot;:&quot;Xem qua mÃ´ hÃ¬nh&quot;},{&quot;local&quot;:&quot;thc-hin-mt-bc-ti-u-ha&quot;,&quot;title&quot;:&quot;Thá»±c hiá»‡n má»™t bÆ°á»›c tá»‘i Æ°u hÃ³a&quot;},{&quot;local&quot;:&quot;x-l-li-ht-b-nh-cuda&quot;,&quot;title&quot;:&quot;Xá»­ lÃ½ lá»—i háº¿t bá»™ nhá»› CUDA&quot;},{&quot;local&quot;:&quot;nh-gi-m-hnh&quot;,&quot;title&quot;:&quot;ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh&quot;}],&quot;title&quot;:&quot;Gá»¡ lá»—i quy trÃ¬nh huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;debugging-silent-errors-during-training&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;kim-tra-li-d-liu-ca-bn-mt-ln-na&quot;,&quot;title&quot;:&quot;Kiá»ƒm tra láº¡i dá»¯ liá»‡u cá»§a báº¡n (má»™t láº§n ná»¯a!)&quot;},{&quot;local&quot;:&quot;hc-k-m-hnh-ca-bn-trong-mt-l&quot;,&quot;title&quot;:&quot;Há»c kÄ© mÃ´ hÃ¬nh cá»§a báº¡n trong má»™t lÃ´&quot;},{&quot;local&quot;:&quot;khng-iu-chnh-bt-c-th-g-cho-n-khi-bn-c-m-hnh-c-s-u-tin&quot;,&quot;title&quot;:&quot;KhÃ´ng Ä‘iá»u chá»‰nh báº¥t cá»© thá»© gÃ¬ cho Ä‘áº¿n khi báº¡n cÃ³ mÃ´ hÃ¬nh cÆ¡ sá»Ÿ Ä‘áº§u tiÃªn&quot;},{&quot;local&quot;:&quot;yu-cu-gip&quot;,&quot;title&quot;:&quot;YÃªu cáº§u giÃºp Ä‘á»¡&quot;}],&quot;title&quot;:&quot;Debugging silent errors during training&quot;}],&quot;title&quot;:&quot;Gá»¡ lá»—i quy trÃ¬nh huáº¥n luyá»‡n&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter8/4.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="g-li-quy-trnh-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#g-li-quy-trnh-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Gá»¡ lá»—i quy trÃ¬nh huáº¥n luyá»‡n
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/vi/chapter8/section4_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/vi/chapter8/section4_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Báº¡n Ä‘Ã£ viáº¿t má»™t ká»‹ch báº£n tuyá»‡t Ä‘áº¹p Ä‘á»ƒ huáº¥n luyá»‡n hoáº·c tinh chá»‰nh má»™t mÃ´ hÃ¬nh trong má»™t tÃ¡c vá»¥ nháº¥t Ä‘á»‹nh, tuÃ¢n thá»§ má»™t cÃ¡ch nghiÃªm tÃºc lá»i khuyÃªn tá»« <a href="/course/chapter7">ChÆ°Æ¡ng 7</a>. NhÆ°ng khi báº¡n khá»Ÿi cháº¡y lá»‡nh <code>trainr.train()</code>, má»™t Ä‘iá»u kinh khá»§ng xáº£y ra: báº¡n gáº·p lá»—i ğŸ˜±! Hoáº·c tá»‡ hÆ¡n, má»i thá»© dÆ°á»ng nhÆ° á»•n vÃ  quÃ¡ trÃ¬nh huáº¥n luyá»‡n cháº¡y mÃ  khÃ´ng cÃ³ lá»—i, nhÆ°ng mÃ´ hÃ¬nh káº¿t quáº£ lÃ  tá»“i tá»‡. Trong pháº§n nÃ y, chÃºng tÃ´i sáº½ chá»‰ cho báº¡n nhá»¯ng gÃ¬ báº¡n cÃ³ thá»ƒ lÃ m Ä‘á»ƒ gá»¡ lá»—i cÃ¡c loáº¡i váº¥n Ä‘á» nÃ y.</p>
<h2 class="relative group"><a id="g-li-quy-trnh-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#g-li-quy-trnh-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Gá»¡ lá»—i quy trÃ¬nh huáº¥n luyá»‡n
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/L-WSwUWde1U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Váº¥n Ä‘á» khi báº¡n gáº·p lá»—i trong <code>trainr.train()</code> cÃ³ thá»ƒ Ä‘áº¿n tá»« nhiá»u nguá»“n, vÃ¬ <code>Trainer</code> thÆ°á»ng táº­p há»£p ráº¥t nhiá»u thá»© láº¡i vá»›i nhau. NÃ³ chuyá»ƒn Ä‘á»•i bá»™ dá»¯ liá»‡u thÃ nh cÃ¡c dataloader, do Ä‘Ã³, váº¥n Ä‘á» cÃ³ thá»ƒ lÃ  má»™t cÃ¡i gÃ¬ Ä‘Ã³ sai trong bá»™ dá»¯ liá»‡u cá»§a báº¡n hoáº·c má»™t sá»‘ váº¥n Ä‘á» khi cá»‘ gáº¯ng káº¿t há»£p hÃ ng loáº¡t cÃ¡c pháº§n tá»­ cá»§a bá»™ dá»¯ liá»‡u vá»›i nhau. Sau Ä‘Ã³, nÃ³ láº¥y má»™t loáº¡t dá»¯ liá»‡u vÃ  Ä‘Æ°a nÃ³ vÃ o mÃ´ hÃ¬nh, vÃ¬ váº­y váº¥n Ä‘á» cÃ³ thá»ƒ náº±m á»Ÿ mÃ£ mÃ´ hÃ¬nh. Sau Ä‘Ã³, nÃ³ tÃ­nh toÃ¡n cÃ¡c Ä‘á»™ dá»‘c vÃ  thá»±c hiá»‡n bÆ°á»›c tá»‘i Æ°u hÃ³a, vÃ¬ váº­y váº¥n Ä‘á» cÅ©ng cÃ³ thá»ƒ náº±m trong trÃ¬nh tá»‘i Æ°u hÃ³a cá»§a báº¡n. VÃ  ngay cáº£ khi má»i thá»© diá»…n ra tá»‘t Ä‘áº¹p cho quÃ¡ trÃ¬nh huáº¥n luyá»‡n, váº«n cÃ³ thá»ƒ xáº£y ra sá»± cá»‘ trong quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡ náº¿u cÃ³ váº¥n Ä‘á» vá»›i chá»‰ sá»‘ cá»§a báº¡n.</p>
<p>CÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ gá»¡ lá»—i phÃ¡t sinh trong <code>trainr.train()</code> lÃ  Ä‘i qua toÃ n pipeline nÃ y theo cÃ¡ch thá»§ cÃ´ng Ä‘á»ƒ xem má»i thá»© diá»…n ra nhÆ° tháº¿ nÃ o. Sau Ä‘Ã³, lá»—i thÆ°á»ng ráº¥t dá»… giáº£i quyáº¿t.</p>
<p>Äá»ƒ chá»©ng minh Ä‘iá»u nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng táº­p lá»‡nh (cá»‘ gáº¯ng) tinh chá»‰nh mÃ´ hÃ¬nh DistilBERT trÃªn <a href="https://huggingface.co/datasets/glue" rel="nofollow">táº­p dá»¯ liá»‡u MNLI</a>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">import</span> evaluate
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    AutoModelForSequenceClassification,
    TrainingArguments,
    Trainer,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)
model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint)

args = TrainingArguments(
    <span class="hljs-string">f&quot;distilbert-finetuned-mnli&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
)

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


trainer = Trainer(
    model,
    args,
    train_dataset=raw_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=raw_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>],
    compute_metrics=compute_metrics,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>Náº¿u báº¡n cá»‘ gáº¯ng thá»±c thi nÃ³, báº¡n sáº½ gáº·p pháº£i má»™t lá»—i khÃ¡ khÃ³ hiá»ƒu:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;ValueError: You have to specify either input_ids or inputs_embeds&#x27;</span><!-- HTML_TAG_END --></pre></div>
<h3 class="relative group"><a id="kim-tra-d-liu-ca-bn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#kim-tra-d-liu-ca-bn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Kiá»ƒm tra dá»¯ liá»‡u cá»§a báº¡n
	</span></h3>

<p>Äiá»u nÃ y khÃ´ng cáº§n pháº£i nÃ³i, nhÆ°ng náº¿u dá»¯ liá»‡u cá»§a báº¡n bá»‹ há»ng, <code>Trainer</code> sáº½ khÃ´ng thá»ƒ táº¡o ra cÃ¡c lÃ´ chá»© Ä‘á»«ng nÃ³i Ä‘áº¿n viá»‡c huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a báº¡n. VÃ¬ váº­y, Ä‘iá»u Ä‘áº§u tiÃªn, báº¡n cáº§n pháº£i xem xÃ©t nhá»¯ng gÃ¬ bÃªn trong bá»™ huáº¥n luyá»‡n cá»§a báº¡n.</p>
<p>Äá»ƒ trÃ¡nh máº¥t vÃ´ sá»‘ giá» Ä‘á»ƒ cá»‘ gáº¯ng sá»­a má»™t cÃ¡i gÃ¬ Ä‘Ã³ khÃ´ng pháº£i lÃ  nguá»“n gá»‘c cá»§a lá»—i, chÃºng tÃ´i khuyÃªn báº¡n nÃªn sá»­ dá»¥ng <code>trainr.train_dataset</code> Ä‘á»ƒ kiá»ƒm tra. VÃ¬ váº­y, hÃ£y lÃ m Ä‘iá»u Ä‘Ã³ á»Ÿ Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train_dataset[<span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;hypothesis&#x27;</span>: <span class="hljs-string">&#x27;Product and geography are what make cream skimming work. &#x27;</span>,
 <span class="hljs-string">&#x27;idx&#x27;</span>: <span class="hljs-number">0</span>,
 <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-number">1</span>,
 <span class="hljs-string">&#x27;premise&#x27;</span>: <span class="hljs-string">&#x27;Conceptually cream skimming has two basic dimensions - product and geography.&#x27;</span>}<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n cÃ³ nháº­n tháº¥y Ä‘iá»u gÃ¬ Ä‘Ã³ sai khÃ´ng? Äiá»u nÃ y, cÃ¹ng vá»›i thÃ´ng bÃ¡o lá»—i vá» viá»‡c thiáº¿u <code>input_ids</code>, sáº½ khiáº¿n báº¡n nháº­n ra Ä‘Ã³ lÃ  cÃ¡c vÄƒn báº£n chá»© khÃ´ng pháº£i sá»‘ mÃ  mÃ´ hÃ¬nh cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c. á» Ä‘Ã¢y, lá»—i ban Ä‘áº§u ráº¥t dá»… gÃ¢y hiá»ƒu nháº§m bá»Ÿi vÃ¬ <code>Trainer</code> tá»± Ä‘á»™ng loáº¡i bá» cÃ¡c cá»™t khÃ´ng khá»›p vá»›i Ä‘áº·c trÆ°ng cá»§a mÃ´ hÃ¬nh (nghÄ©a lÃ  cÃ¡c tham sá»‘ mÃ  mÃ´ hÃ¬nh mong Ä‘á»£i). Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  á»Ÿ Ä‘Ã¢y, má»i thá»© ngoáº¡i trá»« nhÃ£n Ä‘á»u bá»‹ loáº¡i bá». Do Ä‘Ã³, khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ vá»›i viá»‡c táº¡o cÃ¡c lÃ´ vÃ  sau Ä‘Ã³ gá»­i chÃºng Ä‘áº¿n mÃ´ hÃ¬nh, Ä‘iá»u nÃ y do Ä‘Ã³ phÃ n nÃ n ráº±ng nÃ³ khÃ´ng nháº­n Ä‘Æ°á»£c Ä‘áº§u vÃ o thÃ­ch há»£p.</p>
<p>Táº¡i sao dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c xá»­ lÃ½? ChÃºng ta Ä‘Ã£ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>Dataset.map()</code> trÃªn cÃ¡c táº­p dá»¯ liá»‡u Ä‘á»ƒ Ã¡p dá»¥ng tokenizer trÃªn má»—i máº«u. NhÆ°ng náº¿u báº¡n xem ká»¹ mÃ£, báº¡n sáº½ tháº¥y ráº±ng chÃºng ta Ä‘Ã£ máº¯c sai láº§m khi chuyá»ƒn cÃ¡c bá»™ huáº¥n luyá»‡n vÃ  kiá»ƒm Ä‘á»‹nh cho <code>Trainer</code>. Thay vÃ¬ sá»­ dá»¥ng <code>tokenized_datasets</code> á»Ÿ Ä‘Ã¢y, chÃºng ta Ä‘Ã£ sá»­ dá»¥ng <code>raw_datasets</code> ğŸ¤¦. VÃ¬ váº­y, hÃ£y cÃ¹ng sá»­a chá»¯a Ä‘iá»u nÃ y!</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">import</span> evaluate
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    AutoModelForSequenceClassification,
    TrainingArguments,
    Trainer,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)
model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint)

args = TrainingArguments(
    <span class="hljs-string">f&quot;distilbert-finetuned-mnli&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
)

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


trainer = Trainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>],
    compute_metrics=compute_metrics,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>MÃ£ má»›i nÃ y bÃ¢y giá» sáº½ Ä‘Æ°a ra má»™t lá»—i khÃ¡c (cÃ³ tiáº¿n triá»ƒn!):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;ValueError: expected sequence of length 43 at dim 1 (got 37)&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÃ¬n vÃ o dáº¥u truy váº¿t, chÃºng ta cÃ³ thá»ƒ tháº¥y lá»—i xáº£y ra trong bÆ°á»›c Ä‘á»‘i chiáº¿u dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->~/git/transformers/src/transformers/data/data_collator.py <span class="hljs-keyword">in</span> torch_default_data_collator(features)
    <span class="hljs-number">105</span>                 batch[k] = torch.stack([f[k] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features])
    <span class="hljs-number">106</span>             <span class="hljs-keyword">else</span>:
--&gt; <span class="hljs-number">107</span>                 batch[k] = torch.tensor([f[k] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features])
    <span class="hljs-number">108</span> 
    <span class="hljs-number">109</span>     <span class="hljs-keyword">return</span> batch<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, chÃºng ta nÃªn chuyá»ƒn sang Ä‘iá»u Ä‘Ã³. Tuy nhiÃªn, trÆ°á»›c khi thá»±c hiá»‡n, chÃºng ta hÃ£y hoÃ n thÃ nh viá»‡c kiá»ƒm tra dá»¯ liá»‡u cá»§a mÃ¬nh, Ä‘á»ƒ cháº¯c cháº¯n ráº±ng nÃ³ chÃ­nh xÃ¡c 100%.</p>
<p>Má»™t Ä‘iá»u báº¡n luÃ´n nÃªn lÃ m khi gá»¡ lá»—i má»™t phiÃªn huáº¥n luyá»‡n lÃ  xem xÃ©t cÃ¡c Ä‘áº§u vÃ o Ä‘Æ°á»£c giáº£i mÃ£ cá»§a mÃ´ hÃ¬nh cá»§a báº¡n. ChÃºng ta khÃ´ng thá»ƒ hiá»ƒu Ä‘Æ°á»£c nhá»¯ng con sá»‘ mÃ  chÃºng ta cung cáº¥p trá»±c tiáº¿p cho nÃ³, vÃ¬ váº­y chÃºng ta nÃªn xem nhá»¯ng con sá»‘ Ä‘Ã³ Ä‘áº¡i diá»‡n cho Ä‘iá»u gÃ¬. VÃ­ dá»¥: trong thá»‹ giÃ¡c mÃ¡y tÃ­nh, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  nhÃ¬n vÃ o hÃ¬nh áº£nh Ä‘Æ°á»£c giáº£i mÃ£ cá»§a cÃ¡c pixel báº¡n chuyá»ƒn qua, trong lá»i nÃ³i, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  nghe cÃ¡c máº«u Ã¢m thanh Ä‘Æ°á»£c giáº£i mÃ£ vÃ  Ä‘á»‘i vá»›i vÃ­ dá»¥ NLP cá»§a chÃºng ta á»Ÿ Ä‘Ã¢y, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  sá»­ dá»¥ng trÃ¬nh tokenizer Ä‘á»ƒ giáº£i mÃ£ Ä‘áº§u vÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.decode(trainer.train_dataset[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;input_ids&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;[CLS] conceptually cream skimming has two basic dimensions - product and geography. [SEP] product and geography are what make cream skimming work. [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, Ä‘iá»u Ä‘Ã³ cÃ³ váº» chÃ­nh xÃ¡c. Báº¡n nÃªn lÃ m Ä‘iá»u nÃ y cho táº¥t cáº£ cÃ¡c phÃ­m trong Ä‘áº§u vÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train_dataset[<span class="hljs-number">0</span>].keys()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->dict_keys([<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;hypothesis&#x27;</span>, <span class="hljs-string">&#x27;idx&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;label&#x27;</span>, <span class="hljs-string">&#x27;premise&#x27;</span>])<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng cÃ¡c khÃ³a khÃ´ng tÆ°Æ¡ng á»©ng vá»›i Ä‘áº§u vÃ o Ä‘Æ°á»£c mÃ´ hÃ¬nh cháº¥p nháº­n sáº½ tá»± Ä‘á»™ng bá»‹ loáº¡i bá», vÃ¬ váº­y á»Ÿ Ä‘Ã¢y chÃºng tÃ´i sáº½ chá»‰ giá»¯ láº¡i <code>input_ids</code>, <code>attention_mask</code>, vÃ  <code>label</code> (sáº½ Ä‘Æ°á»£c Ä‘á»•i tÃªn thÃ nh <code>labels</code>). Äá»ƒ kiá»ƒm tra ká»¹ mÃ´ hÃ¬nh, báº¡n cÃ³ thá»ƒ in loáº¡i mÃ´ hÃ¬nh cá»§a mÃ¬nh, sau Ä‘Ã³ kiá»ƒm tra tÃ i liá»‡u cá»§a nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">type</span>(trainer.model)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->transformers.models.distilbert.modeling_distilbert.DistilBertForSequenceClassification<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, trong trÆ°á»ng há»£p cá»§a mÃ¬nh, chÃºng ta cÃ³ thá»ƒ kiá»ƒm tra cÃ¡c tham sá»‘ Ä‘Æ°á»£c cháº¥p nháº­n trÃªn <a href="https://huggingface.co/transformers/model_doc/distilbert.html#distilbertforsequenceclassification" rel="nofollow">trang nÃ y</a>. <code>Trainer</code> cÅ©ng sáº½ ghi láº¡i cÃ¡c cá»™t mÃ  nÃ³ Ä‘ang loáº¡i bá».</p>
<p>ChÃºng ta Ä‘Ã£ kiá»ƒm tra xem cÃ¡c ID Ä‘áº§u vÃ o cÃ³ chÃ­nh xÃ¡c hay khÃ´ng báº±ng cÃ¡ch giáº£i mÃ£ chÃºng. Tiáº¿p theo lÃ  <code>attention_mask</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train_dataset[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;attention_mask&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ chÃºng ta khÃ´ng Ã¡p dá»¥ng Ä‘á»‡m trong quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ cá»§a mÃ¬nh, Ä‘iá»u nÃ y cÃ³ váº» hoÃ n toÃ n tá»± nhiÃªn. Äá»ƒ Ä‘áº£m báº£o khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ vá»›i attention mask Ä‘Ã³, hÃ£y kiá»ƒm tra xem nÃ³ cÃ³ cÃ¹ng Ä‘á»™ dÃ i vá»›i ID Ä‘áº§u vÃ o cá»§a chÃºng ta khÃ´ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">len</span>(trainer.train_dataset[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;attention_mask&quot;</span>]) == <span class="hljs-built_in">len</span>(
    trainer.train_dataset[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;input_ids&quot;</span>]
)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-literal">True</span><!-- HTML_TAG_END --></pre></div>
<p>Tá»‘t Ä‘áº¥y! Cuá»‘i cÃ¹ng, hÃ£y kiá»ƒm tra nhÃ£n cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train_dataset[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;label&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">1</span><!-- HTML_TAG_END --></pre></div>
<p>Giá»‘ng nhÆ° cÃ¡c ID Ä‘áº§u vÃ o, Ä‘Ã¢y lÃ  má»™t con sá»‘ khÃ´ng thá»±c sá»± cÃ³ Ã½ nghÄ©a. NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã¢y, Ã¡nh xáº¡ giá»¯a cÃ¡c sá»‘ nguyÃªn vÃ  tÃªn nhÃ£n Ä‘Æ°á»£c lÆ°u trá»¯ bÃªn trong thuá»™c tÃ­nh <code>names</code> cá»§a <em>Ä‘áº·c trÆ°ng</em> tÆ°Æ¡ng á»©ng cá»§a táº­p dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train_dataset.features[<span class="hljs-string">&quot;label&quot;</span>].names<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;entailment&#x27;</span>, <span class="hljs-string">&#x27;neutral&#x27;</span>, <span class="hljs-string">&#x27;contradiction&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, <code>1</code> cÃ³ nghÄ©a lÃ  <code>neutral</code>, cÃ³ nghÄ©a lÃ  hai cÃ¢u chÃºng ta Ä‘Ã£ tháº¥y á»Ÿ trÃªn khÃ´ng mÃ¢u thuáº«n vá»›i nhau vÃ  cÃ¢u Ä‘áº§u tiÃªn khÃ´ng bao hÃ m cÃ¢u thá»© hai. Äiá»u Ä‘Ã³ cÃ³ váº» Ä‘Ãºng!</p>
<p>ChÃºng ta khÃ´ng cÃ³ token ID á»Ÿ Ä‘Ã¢y, vÃ¬ DistilBERT khÃ´ng mong Ä‘á»£i chÃºng; náº¿u báº¡n cÃ³ má»™t sá»‘ trong mÃ´ hÃ¬nh cá»§a mÃ¬nh, báº¡n cÅ©ng nÃªn Ä‘áº£m báº£o ráº±ng chÃºng khá»›p Ä‘Ãºng vá»›i vá»‹ trÃ­ cá»§a cÃ¢u Ä‘áº§u tiÃªn vÃ  cÃ¢u thá»© hai trong Ä‘áº§u vÃ o.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> Kiá»ƒm tra xem má»i thá»© cÃ³ chÃ­nh xÃ¡c khÃ´ng vá»›i pháº§n tá»­ thá»© hai cá»§a táº­p dá»¯ liá»‡u huáº¥n luyá»‡n.</p></div>
<p>ChÃºng ta chá»‰ thá»±c hiá»‡n kiá»ƒm tra táº­p huáº¥n luyá»‡n á»Ÿ Ä‘Ã¢y, nhÆ°ng táº¥t nhiÃªn báº¡n nÃªn kiá»ƒm tra ká»¹ cÃ¡c táº­p kiá»ƒm Ä‘á»‹nh vÃ  kiá»ƒm tra theo cÃ¹ng má»™t cÃ¡ch.</p>
<p>BÃ¢y giá» chÃºng ta biáº¿t bá»™ dá»¯ liá»‡u cá»§a mÃ¬nh trÃ´ng á»•n, Ä‘Ã£ Ä‘áº¿n lÃºc kiá»ƒm tra bÆ°á»›c tiáº¿p theo cá»§a quy trÃ¬nh huáº¥n luyá»‡n.</p>
<h3 class="relative group"><a id="t-b-d-liu-thnh-dataloader" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#t-b-d-liu-thnh-dataloader"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tá»« bá»™ dá»¯ liá»‡u thÃ nh dataloader
	</span></h3>

<p>Äiá»u tiáº¿p theo cÃ³ thá»ƒ xáº£y ra sai sÃ³t trong quy trÃ¬nh huáº¥n luyá»‡n lÃ  khi <code>Trainer</code> cá»‘ gáº¯ng táº¡o cÃ¡c lÃ´ tá»« táº­p huáº¥n luyá»‡n hoáº·c kiá»ƒm Ä‘á»‹nh. Khi báº¡n cháº¯c cháº¯n ráº±ng táº­p dá»¯ liá»‡u cá»§a <code>Trainer</code> lÃ  chÃ­nh xÃ¡c, báº¡n cÃ³ thá»ƒ thá»­ táº¡o má»™t loáº¡t theo cÃ¡ch thá»§ cÃ´ng báº±ng cÃ¡ch thá»±c hiá»‡n nhÆ° sau (thay tháº¿ <code>train</code> báº±ng <code>eval</code> cho dataloader kiá»ƒm Ä‘á»‹nh):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> trainer.get_train_dataloader():
    <span class="hljs-keyword">break</span><!-- HTML_TAG_END --></pre></div>
<p>MÃ£ nÃ y táº¡o ra dataloader huáº¥n luyá»‡n, sau Ä‘Ã³ láº·p qua nÃ³, dá»«ng láº¡i á»Ÿ láº§n láº·p Ä‘áº§u tiÃªn. Náº¿u mÃ£ thá»±c thi mÃ  khÃ´ng cÃ³ lá»—i, báº¡n cÃ³ lÃ´ huáº¥n luyá»‡n Ä‘áº§u tiÃªn mÃ  báº¡n cÃ³ thá»ƒ kiá»ƒm tra vÃ  náº¿u mÃ£ lá»—i xáº£y ra, báº¡n biáº¿t cháº¯c cháº¯n váº¥n Ä‘á» náº±m trong dataloader, nhÆ° trÆ°á»ng há»£p á»Ÿ Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->~/git/transformers/src/transformers/data/data_collator.py <span class="hljs-keyword">in</span> torch_default_data_collator(features)
    <span class="hljs-number">105</span>                 batch[k] = torch.stack([f[k] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features])
    <span class="hljs-number">106</span>             <span class="hljs-keyword">else</span>:
--&gt; <span class="hljs-number">107</span>                 batch[k] = torch.tensor([f[k] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features])
    <span class="hljs-number">108</span> 
    <span class="hljs-number">109</span>     <span class="hljs-keyword">return</span> batch

ValueError: expected sequence of length <span class="hljs-number">45</span> at dim <span class="hljs-number">1</span> (got <span class="hljs-number">76</span>)<!-- HTML_TAG_END --></pre></div>
<p>Viá»‡c kiá»ƒm tra khung cuá»‘i cÃ¹ng cá»§a quÃ¡ trÃ¬nh truy xuáº¥t sáº½ Ä‘á»§ Ä‘á»ƒ cung cáº¥p cho báº¡n manh má»‘i, nhÆ°ng hÃ£y tÃ¬m hiá»ƒu ká»¹ hÆ¡n má»™t chÃºt. Háº§u háº¿t cÃ¡c váº¥n Ä‘á» trong quÃ¡ trÃ¬nh táº¡o lÃ´ Ä‘á»u phÃ¡t sinh do viá»‡c Ä‘á»‘i chiáº¿u cÃ¡c vÃ­ dá»¥ thÃ nh má»™t lÃ´ duy nháº¥t, vÃ¬ váº­y, Ä‘iá»u Ä‘áº§u tiÃªn cáº§n kiá»ƒm tra khi nghi ngá» lÃ  <code>collate_fn</code> mÃ  <code>DataLoader</code> cá»§a báº¡n Ä‘ang sá»­ dá»¥ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->data_collator = trainer.get_train_dataloader().collate_fn
data_collator<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->&lt;function transformers.data.data_collator.default_data_collator(features: <span class="hljs-type">List</span>[InputDataClass], return_tensors=<span class="hljs-string">&#x27;pt&#x27;</span>) -&gt; <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]&gt;<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, Ä‘Ã¢y lÃ  <code>default_data_collator</code>, nhÆ°ng Ä‘Ã³ khÃ´ng pháº£i lÃ  nhá»¯ng gÃ¬ chÃºng ta muá»‘n trong trÆ°á»ng há»£p nÃ y. ChÃºng ta muá»‘n Ä‘Æ°a cÃ¡c vÃ­ dá»¥ cá»§a mÃ¬nh vÃ o cÃ¢u dÃ i nháº¥t trong lÃ´, Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi trÃ¬nh Ä‘á»‘i chiáº¿u <code>DataCollatorWithPadding</code>. VÃ  trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u nÃ y Ä‘Æ°á»£c cho lÃ  Ä‘Æ°á»£c sá»­ dá»¥ng theo máº·c Ä‘á»‹nh bá»Ÿi <code>Trainer</code>, váº­y táº¡i sao nÃ³ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y?</p>
<p>CÃ¢u tráº£ lá»i lÃ  vÃ¬ chÃºng ta Ä‘Ã£ khÃ´ng chuyá»ƒn <code>tokenizer</code> cho <code>Trainer</code>, vÃ¬ váº­y nÃ³ khÃ´ng thá»ƒ táº¡o <code>DataCollatorWithPadding</code> mÃ  chÃºng ta muá»‘n. Trong thá»±c táº¿, báº¡n Ä‘á»«ng bao giá» ngáº§n ngáº¡i chuyá»ƒn má»™t cÃ¡ch rÃµ rÃ ng bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u mÃ  báº¡n muá»‘n sá»­ dá»¥ng, Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng báº¡n trÃ¡nh Ä‘Æ°á»£c nhá»¯ng loáº¡i lá»—i nÃ y. HÃ£y Ä‘iá»u chá»‰nh mÃ£ cá»§a chÃºng ta Ä‘á»ƒ thá»±c hiá»‡n chÃ­nh xÃ¡c Ä‘iá»u Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">import</span> evaluate
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    AutoModelForSequenceClassification,
    DataCollatorWithPadding,
    TrainingArguments,
    Trainer,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)
model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint)

args = TrainingArguments(
    <span class="hljs-string">f&quot;distilbert-finetuned-mnli&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
)

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


data_collator = DataCollatorWithPadding(tokenizer=tokenizer)

trainer = Trainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>],
    compute_metrics=compute_metrics,
    data_collator=data_collator,
    tokenizer=tokenizer,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>Tin tá»‘t? ChÃºng ta khÃ´ng gáº·p lá»—i nhÆ° trÆ°á»›c ná»¯a, Ä‘Ã³ cháº¯c cháº¯n lÃ  sá»± tiáº¿n bá»™. CÃ¡c tin xáº¥u? Thay vÃ o Ä‘Ã³, chÃºng ta nháº­n Ä‘Æ°á»£c má»™t lá»—i CUDA khÃ©t tiáº¿ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->RuntimeError: CUDA error: CUBLAS_STATUS_ALLOC_FAILED when calling `cublasCreate(handle)`<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y tháº­t tá»‡ vÃ¬ lá»—i CUDA nÃ³i chung ráº¥t khÃ³ gá»¡ lá»—i. ChÃºng ta sáº½ xem trong má»™t phÃºt ná»¯a cÃ¡ch giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, nhÆ°ng trÆ°á»›c tiÃªn hÃ£y káº¿t thÃºc phÃ¢n tÃ­ch cá»§a chÃºng ta vá» táº¡o lÃ´.</p>
<p>Náº¿u báº¡n cháº¯c cháº¯n trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u cá»§a mÃ¬nh lÃ  Ä‘Ãºng, báº¡n nÃªn thá»­ Ã¡p dá»¥ng nÃ³ trÃªn má»™t vÃ i máº«u cá»§a táº­p dá»¯ liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->data_collator = trainer.get_train_dataloader().collate_fn
batch = data_collator([trainer.train_dataset[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<!-- HTML_TAG_END --></pre></div>
<p>MÃ£ nÃ y sáº½ khÃ´ng thÃ nh cÃ´ng vÃ¬ <code>train_dataset</code> chá»©a cÃ¡c cá»™t chuá»—i mÃ  <code>Trainer</code> thÆ°á»ng loáº¡i bá». Báº¡n cÃ³ thá»ƒ xÃ³a chÃºng theo cÃ¡ch thá»§ cÃ´ng hoáº·c náº¿u báº¡n muá»‘n sao chÃ©p chÃ­nh xÃ¡c nhá»¯ng gÃ¬ mÃ  <code>Trainer</code> Ä‘ang lÃ m á»Ÿ háº­u trÆ°á»ng, báº¡n cÃ³ thá»ƒ gá»i phÆ°Æ¡ng thá»©c riÃªng  <code>Trainer._remove_unused_columns()</code> Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->data_collator = trainer.get_train_dataloader().collate_fn
actual_train_set = trainer._remove_unused_columns(trainer.train_dataset)
batch = data_collator([actual_train_set[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, báº¡n sáº½ cÃ³ thá»ƒ gá»¡ lá»—i theo cÃ¡ch thá»§ cÃ´ng nhá»¯ng gÃ¬ xáº£y ra bÃªn trong bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u náº¿u lá»—i váº«n tiáº¿p diá»…n.</p>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ gá»¡ lá»—i quy trÃ¬nh táº¡o lÃ´, Ä‘Ã£ Ä‘áº¿n lÃºc chuyá»ƒn qua mÃ´ hÃ¬nh!</p>
<h3 class="relative group"><a id="xem-qua-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#xem-qua-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xem qua mÃ´ hÃ¬nh
	</span></h3>

<p>Báº¡n sáº½ cÃ³ thá»ƒ nháº­n Ä‘Æ°á»£c má»™t lÃ´ báº±ng cÃ¡ch thá»±c hiá»‡n lá»‡nh sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> trainer.get_train_dataloader():
    <span class="hljs-keyword">break</span><!-- HTML_TAG_END --></pre></div>
<p>Náº¿u báº¡n Ä‘ang cháº¡y mÃ£ nÃ y trong notebook, báº¡n cÃ³ thá»ƒ gáº·p lá»—i CUDA tÆ°Æ¡ng tá»± nhÆ° lá»—i Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã³, trong trÆ°á»ng há»£p Ä‘Ã³, báº¡n cáº§n khá»Ÿi Ä‘á»™ng láº¡i notebook cá»§a mÃ¬nh vÃ  thá»±c hiá»‡n láº¡i Ä‘oáº¡n mÃ£ cuá»‘i cÃ¹ng mÃ  khÃ´ng cÃ³ dÃ²ng <code>trainer.train()</code>. ÄÃ³ lÃ  Ä‘iá»u khÃ³ chá»‹u thá»© hai vá» lá»—i CUDA: chÃºng phÃ¡ vá»¡ kernel cá»§a báº¡n má»™t cÃ¡ch khÃ´ng thá»ƒ kháº¯c phá»¥c Ä‘Æ°á»£c. Äiá»u khÃ³ chá»‹u nháº¥t vá» chÃºng lÃ  thá»±c táº¿ lÃ  chÃºng ráº¥t khÃ³ Ä‘á»ƒ gá»¡ lá»—i.</p>
<p>Táº¡i sao váº­y? NÃ³ liÃªn quan Ä‘áº¿n cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a GPU. ChÃºng cá»±c ká»³ hiá»‡u quáº£ trong viá»‡c thá»±c hiá»‡n song song nhiá»u thao tÃ¡c, nhÆ°ng háº¡n cháº¿ lÃ  khi má»™t trong cÃ¡c lá»‡nh Ä‘Ã³ dáº«n Ä‘áº¿n lá»—i, báº¡n sáº½ khÃ´ng biáº¿t ngay láº­p tá»©c. Chá»‰ khi chÆ°Æ¡ng trÃ¬nh gá»i Ä‘á»“ng bá»™ hÃ³a nhiá»u quy trÃ¬nh trÃªn GPU thÃ¬ nÃ³ má»›i nháº­n ra cÃ³ gÃ¬ Ä‘Ã³ khÃ´ng á»•n, vÃ¬ váº­y lá»—i thá»±c sá»± Ä‘Æ°á»£c phÃ¡t sinh á»Ÿ má»™t nÆ¡i khÃ´ng liÃªn quan gÃ¬ Ä‘áº¿n nhá»¯ng gÃ¬ Ä‘Ã£ táº¡o ra nÃ³. VÃ­ dá»¥, náº¿u chÃºng ta xem láº¡i láº§n truy xuáº¥t trÆ°á»›c cá»§a mÃ¬nh, lá»—i Ä‘Ã£ Ä‘Æ°á»£c phÃ¡t sinh trong quÃ¡ trÃ¬nh truyá»n ngÆ°á»£c, nhÆ°ng chÃºng ta sáº½ tháº¥y trong má»™t phÃºt ráº±ng nÃ³ thá»±c sá»± báº¯t nguá»“n tá»« má»™t cÃ¡i gÃ¬ Ä‘Ã³ trong truyá»n tháº³ng.</p>
<p>Váº­y lÃ m cÃ¡ch nÃ o Ä‘á»ƒ gá»¡ nhá»¯ng lá»—i Ä‘Ã³? CÃ¢u tráº£ lá»i ráº¥t dá»… dÃ ng: chÃºng tÃ´i khÃ´ng. Trá»« khi lá»—i CUDA cá»§a báº¡n lÃ  lá»—i háº¿t bá»™ nhá»› (cÃ³ nghÄ©a lÃ  khÃ´ng cÃ³ Ä‘á»§ bá»™ nhá»› trong GPU cá»§a báº¡n), báº¡n nÃªn quay láº¡i CPU Ä‘á»ƒ gá»¡ lá»—i.</p>
<p>Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y trong trÆ°á»ng há»£p cá»§a mÃ¬nh, chÃºng ta chá»‰ cáº§n Ä‘áº·t mÃ´ hÃ¬nh trá»Ÿ láº¡i CPU vÃ  gá»i nÃ³ vÃ o lÃ´ cá»§a mÃ¬nh - lÃ´ Ä‘Æ°á»£c tráº£ vá» bá»Ÿi <code>DataLoader</code> váº«n chÆ°a Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n GPU:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->outputs = trainer.model.cpu()(**batch)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->~/.pyenv/versions/<span class="hljs-number">3.7</span><span class="hljs-number">.9</span>/envs/base/lib/python3<span class="hljs-number">.7</span>/site-packages/torch/nn/functional.py <span class="hljs-keyword">in</span> nll_loss(<span class="hljs-built_in">input</span>, target, weight, size_average, ignore_index, reduce, reduction)
   <span class="hljs-number">2386</span>         )
   <span class="hljs-number">2387</span>     <span class="hljs-keyword">if</span> dim == <span class="hljs-number">2</span>:
-&gt; <span class="hljs-number">2388</span>         ret = torch._C._nn.nll_loss(<span class="hljs-built_in">input</span>, target, weight, _Reduction.get_enum(reduction), ignore_index)
   <span class="hljs-number">2389</span>     <span class="hljs-keyword">elif</span> dim == <span class="hljs-number">4</span>:
   <span class="hljs-number">2390</span>         ret = torch._C._nn.nll_loss2d(<span class="hljs-built_in">input</span>, target, weight, _Reduction.get_enum(reduction), ignore_index)

IndexError: Target <span class="hljs-number">2</span> <span class="hljs-keyword">is</span> out of bounds.<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, bá»©c tranh ngÃ y cÃ ng rÃµ rÃ ng. Thay vÃ¬ gáº·p lá»—i CUDA, bÃ¢y giá» chÃºng ta cÃ³ <code>IndexError</code> trong tÃ­nh toÃ¡n máº¥t mÃ¡t (vÃ¬ váº­y khÃ´ng liÃªn quan gÃ¬ Ä‘áº¿n lan truyá»n ngÆ°á»£c, nhÆ° ta Ä‘Ã£ nÃ³i trÆ°á»›c Ä‘Ã³). ChÃ­nh xÃ¡c hÆ¡n, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng nhÃ£n 2 táº¡o ra lá»—i, vÃ¬ váº­y Ä‘Ã¢y lÃ  thá»i Ä‘iá»ƒm ráº¥t tá»‘t Ä‘á»ƒ kiá»ƒm tra sá»‘ lÆ°á»£ng nhÃ£n cá»§a mÃ´ hÃ¬nh cá»§a ta:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.model.config.num_labels<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">2</span><!-- HTML_TAG_END --></pre></div>
<p>Vá»›i hai nhÃ£n, chá»‰ cÃ³ 0 vÃ  1 Ä‘Æ°á»£c phÃ©p lÃ m nhÃ£n, nhÆ°ng theo thÃ´ng bÃ¡o lá»—i, chÃºng tÃ´i nháº­n Ä‘Æ°á»£c 2. Nháº­n Ä‘Æ°á»£c 2 thá»±c ra lÃ  bÃ¬nh thÆ°á»ng: náº¿u chÃºng ta nhá»› tÃªn nhÃ£n mÃ  chÃºng ta Ä‘Ã£ trÃ­ch xuáº¥t trÆ°á»›c Ä‘Ã³, cÃ³ ba, vÃ¬ váº­y chÃºng ta cÃ³ chá»‰ sá»‘ 0 , 1 vÃ  2 trong táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. Váº¥n Ä‘á» lÃ  chÃºng ta Ä‘Ã£ khÃ´ng nÃ³i Ä‘iá»u Ä‘Ã³ vá»›i mÃ´ hÃ¬nh cá»§a mÃ¬nh, mÃ´ hÃ¬nh nÃ y láº½ ra pháº£i Ä‘Æ°á»£c táº¡o vá»›i ba nhÃ£n. VÃ¬ váº­y, chÃºng ta hÃ£y kháº¯c phá»¥c Ä‘iá»u Ä‘Ã³!</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">import</span> evaluate
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    AutoModelForSequenceClassification,
    DataCollatorWithPadding,
    TrainingArguments,
    Trainer,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)
model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint, num_labels=<span class="hljs-number">3</span>)

args = TrainingArguments(
    <span class="hljs-string">f&quot;distilbert-finetuned-mnli&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
)

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


data_collator = DataCollatorWithPadding(tokenizer=tokenizer)

trainer = Trainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>],
    compute_metrics=compute_metrics,
    data_collator=data_collator,
    tokenizer=tokenizer,
)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta chÆ°a bao gá»“m dÃ²ng <code>trainer.train()</code>, Ä‘á»ƒ dÃ nh thá»i gian kiá»ƒm tra xem má»i thá»© cÃ³ á»•n khÃ´ng. Náº¿u chÃºng ta yÃªu cáº§u má»™t lÃ´ vÃ  chuyá»ƒn nÃ³ vÃ o mÃ´ hÃ¬nh cá»§a mÃ¬nh, nÃ³ hiá»‡n hoáº¡t Ä‘á»™ng mÃ  khÃ´ng cÃ³ lá»—i!</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> trainer.get_train_dataloader():
    <span class="hljs-keyword">break</span>

outputs = trainer.model.cpu()(**batch)<!-- HTML_TAG_END --></pre></div>
<p>BÆ°á»›c tiáº¿p theo lÃ  quay láº¡i GPU vÃ  kiá»ƒm tra xem má»i thá»© váº«n hoáº¡t Ä‘á»™ng khÃ´ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch

device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span>) <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> torch.device(<span class="hljs-string">&quot;cpu&quot;</span>)
batch = {k: v.to(device) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> batch.items()}

outputs = trainer.model.to(device)(**batch)<!-- HTML_TAG_END --></pre></div>
<p>Náº¿u báº¡n váº«n gáº·p lá»—i, hÃ£y Ä‘áº£m báº£o ráº±ng báº¡n khá»Ÿi Ä‘á»™ng láº¡i notebook cá»§a mÃ¬nh vÃ  chá»‰ thá»±c thi phiÃªn báº£n cuá»‘i cÃ¹ng cá»§a táº­p lá»‡nh.</p>
<h3 class="relative group"><a id="thc-hin-mt-bc-ti-u-ha" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#thc-hin-mt-bc-ti-u-ha"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Thá»±c hiá»‡n má»™t bÆ°á»›c tá»‘i Æ°u hÃ³a
	</span></h3>

<p>BÃ¢y giá» ta biáº¿t ráº±ng chÃºng ta cÃ³ thá»ƒ xÃ¢y dá»±ng cÃ¡c lÃ´ thá»±c sá»± Ä‘i qua mÃ´ hÃ¬nh, chÃºng ta Ä‘Ã£ sáºµn sÃ ng cho bÆ°á»›c tiáº¿p theo cá»§a quy trÃ¬nh huáº¥n luyá»‡n: tÃ­nh toÃ¡n Ä‘á»™ dá»‘c vÃ  thá»±c hiá»‡n bÆ°á»›c tá»‘i Æ°u hÃ³a.</p>
<p>Pháº§n Ä‘áº§u tiÃªn chá»‰ lÃ  váº¥n Ä‘á» gá»i phÆ°Æ¡ng thá»©c <code>backward()</code> khi tÃ­nh máº¥t mÃ¡t:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->loss = outputs.loss
loss.backward()<!-- HTML_TAG_END --></pre></div>
<p>Ráº¥t hiáº¿m khi gáº·p lá»—i á»Ÿ giai Ä‘oáº¡n nÃ y, nhÆ°ng náº¿u báº¡n gáº·p lá»—i, hÃ£y Ä‘áº£m báº£o quay láº¡i CPU Ä‘á»ƒ nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o lá»—i há»¯u Ã­ch.</p>
<p>To perform the optimization step, we just need to create the <code>optimizer</code> and call its <code>step()</code> method:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.create_optimizer()
trainer.optimizer.step()<!-- HTML_TAG_END --></pre></div>
<p>Má»™t láº§n ná»¯a, náº¿u báº¡n Ä‘ang sá»­ dá»¥ng trÃ¬nh tá»‘i Æ°u hÃ³a máº·c Ä‘á»‹nh trong <code>Trainer</code>, báº¡n sáº½ khÃ´ng gáº·p lá»—i á»Ÿ giai Ä‘oáº¡n nÃ y, nhÆ°ng náº¿u báº¡n cÃ³ trÃ¬nh tá»‘i Æ°u hÃ³a tÃ¹y chá»‰nh, cÃ³ thá»ƒ cÃ³ má»™t sá»‘ váº¥n Ä‘á» cáº§n gá»¡ lá»—i á»Ÿ Ä‘Ã¢y. Äá»«ng quÃªn quay láº¡i CPU náº¿u báº¡n gáº·p lá»—i CUDA láº¡ á»Ÿ giai Ä‘oáº¡n nÃ y. NÃ³i vá» lá»—i CUDA, trÆ°á»›c Ä‘Ã³ chÃºng ta Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n má»™t trÆ°á»ng há»£p Ä‘áº·c biá»‡t. BÃ¢y giá» chÃºng ta hÃ£y xem xÃ©t Ä‘iá»u Ä‘Ã³.</p>
<h3 class="relative group"><a id="x-l-li-ht-b-nh-cuda" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#x-l-li-ht-b-nh-cuda"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xá»­ lÃ½ lá»—i háº¿t bá»™ nhá»› CUDA
	</span></h3>

<p>Báº¥t cá»© khi nÃ o báº¡n nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o lá»—i báº¯t Ä‘áº§u báº±ng <code>RuntimeError: CUDA out of memory</code>, Ä‘iá»u nÃ y cho biáº¿t báº¡n Ä‘Ã£ háº¿t bá»™ nhá»› GPU. Äiá»u nÃ y khÃ´ng Ä‘Æ°á»£c liÃªn káº¿t trá»±c tiáº¿p vá»›i mÃ£ cá»§a báº¡n vÃ  nÃ³ cÃ³ thá»ƒ xáº£y ra vá»›i má»™t táº­p lá»‡nh cháº¡y hoÃ n toÃ n tá»‘t. Lá»—i nÃ y cÃ³ nghÄ©a lÃ  báº¡n Ä‘Ã£ cá»‘ gáº¯ng Ä‘Æ°a quÃ¡ nhiá»u thá»© vÃ o bá»™ nhá»› trong cá»§a GPU vÃ  dáº«n Ä‘áº¿n lá»—i. Giá»‘ng nhÆ° vá»›i cÃ¡c lá»—i CUDA khÃ¡c, báº¡n sáº½ cáº§n khá»Ÿi Ä‘á»™ng láº¡i kernel cá»§a mÃ¬nh Ä‘á»ƒ á»Ÿ vá»‹ trÃ­ mÃ  báº¡n cÃ³ thá»ƒ cháº¡y láº¡i quÃ¡ trÃ¬nh huáº¥n luyá»‡n cá»§a mÃ¬nh.</p>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, báº¡n chá»‰ cáº§n sá»­ dá»¥ng Ã­t dung lÆ°á»£ng GPU hÆ¡n - Ä‘iá»u mÃ  nÃ³i thÃ¬ dá»… hÆ¡n lÃ m. TrÆ°á»›c tiÃªn, hÃ£y Ä‘áº£m báº£o ráº±ng báº¡n khÃ´ng cÃ³ hai mÃ´ hÃ¬nh GPU trÃªn cÃ¹ng má»™t lÃºc (táº¥t nhiÃªn lÃ  trá»« khi Ä‘Ã³ lÃ  yÃªu cáº§u cho váº¥n Ä‘á» cá»§a báº¡n). Sau Ä‘Ã³, báº¡n cÃ³ thá»ƒ nÃªn giáº£m kÃ­ch thÆ°á»›c lÃ´ cá»§a mÃ¬nh, vÃ¬ nÃ³ áº£nh hÆ°á»Ÿng trá»±c tiáº¿p Ä‘áº¿n kÃ­ch thÆ°á»›c cá»§a táº¥t cáº£ cÃ¡c Ä‘áº§u ra trung gian cá»§a mÃ´ hÃ¬nh vÃ  Ä‘á»™ dá»‘c cá»§a chÃºng. Náº¿u sá»± cá»‘ váº«n tiáº¿p diá»…n, hÃ£y xem xÃ©t sá»­ dá»¥ng phiÃªn báº£n mÃ´ hÃ¬nh nhá» hÆ¡n cá»§a báº¡n.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>Trong pháº§n tiáº¿p theo cá»§a khÃ³a há»c, chÃºng ta sáº½ xem xÃ©t cÃ¡c ká»¹ thuáº­t nÃ¢ng cao hÆ¡n cÃ³ thá»ƒ giÃºp báº¡n giáº£m dung lÆ°á»£ng bá»™ nhá»› vÃ  cho phÃ©p báº¡n tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh lá»›n nháº¥t.</p></div>
<h3 class="relative group"><a id="nh-gi-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#nh-gi-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh
	</span></h3>

<p>BÃ¢y giá» chÃºng tÃ´i Ä‘Ã£ giáº£i quyáº¿t táº¥t cáº£ cÃ¡c váº¥n Ä‘á» vá»›i mÃ£ cá»§a mÃ¬nh, má»i thá»© Ä‘á»u hoÃ n háº£o vÃ  quÃ¡ trÃ¬nh huáº¥n luyá»‡n sáº½ diá»…n ra suÃ´n sáº», pháº£i khÃ´ng? KhÃ´ng quÃ¡ nhanh! Náº¿u báº¡n cháº¡y lá»‡nh <code>trainer.train()</code>, lÃºc Ä‘áº§u má»i thá»© sáº½ á»•n, nhÆ°ng sau má»™t thá»i gian, báº¡n sáº½ nháº­n Ä‘Æ°á»£c nhá»¯ng Ä‘iá»u sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-comment"># QuÃ¡ trÃ¬nh nÃ y sáº½ máº¥t nhiá»u thá»i gian vÃ  xáº£y ra lá»—i, vÃ¬ váº­y báº¡n khÃ´ng nÃªn cháº¡y Ã´ nÃ y</span>
trainer.train()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->TypeError: only size-<span class="hljs-number">1</span> arrays can be converted to Python scalars<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n sáº½ nháº­n ra lá»—i nÃ y xuáº¥t hiá»‡n trong giai Ä‘oáº¡n kiá»ƒm Ä‘á»‹nh, vÃ¬ váº­y Ä‘Ã¢y lÃ  Ä‘iá»u cuá»‘i cÃ¹ng chÃºng tÃ´i sáº½ cáº§n gá»¡ lá»—i.</p>
<p>Báº¡n cÃ³ thá»ƒ cháº¡y vÃ²ng láº·p kiá»ƒm Ä‘á»‹nh cá»§a <code>Trainer</code> má»™t cÃ¡ch Ä‘á»™c láº­p Ä‘á»ƒ hÃ¬nh thÃ nh khÃ³a huáº¥n luyá»‡n nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.evaluate()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->TypeError: only size-<span class="hljs-number">1</span> arrays can be converted to Python scalars<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Báº¡n pháº£i luÃ´n Ä‘áº£m báº£o ráº±ng mÃ¬nh cÃ³ thá»ƒ cháº¡y <code>trainr.evaluate()</code> trÆ°á»›c khi khá»Ÿi cháº¡y <code>trainer.train()</code>, Ä‘á»ƒ trÃ¡nh lÃ£ng phÃ­ nhiá»u tÃ i nguyÃªn mÃ¡y tÃ­nh trÆ°á»›c khi gáº·p lá»—i.</p></div>
<p>TrÆ°á»›c khi cá»‘ gáº¯ng gá»¡ lá»—i má»™t váº¥n Ä‘á» trong vÃ²ng kiá»ƒm Ä‘á»‹nh, trÆ°á»›c tiÃªn báº¡n nÃªn Ä‘áº£m báº£o ráº±ng báº¡n Ä‘Ã£ xem xÃ©t dá»¯ liá»‡u, cÃ³ thá»ƒ táº¡o má»™t lÃ´ Ä‘Ãºng cÃ¡ch vÃ  cÃ³ thá»ƒ cháº¡y mÃ´ hÃ¬nh cá»§a báº¡n trÃªn Ä‘Ã³. ChÃºng ta Ä‘Ã£ hoÃ n thÃ nh táº¥t cáº£ cÃ¡c bÆ°á»›c Ä‘Ã³, vÃ¬ váº­y mÃ£ sau cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c thi mÃ  khÃ´ng cÃ³ lá»—i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> trainer.get_eval_dataloader():
    <span class="hljs-keyword">break</span>

batch = {k: v.to(device) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> batch.items()}

<span class="hljs-keyword">with</span> torch.no_grad():
    outputs = trainer.model(**batch)<!-- HTML_TAG_END --></pre></div>
<p>Lá»—i xuáº¥t hiá»‡n sau Ä‘Ã³, vÃ o cuá»‘i giai Ä‘oáº¡n Ä‘Ã¡nh giÃ¡ vÃ  náº¿u chÃºng ta xem láº¡i báº£n ghi láº¡i, chÃºng ta tháº¥y Ä‘iá»u nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->~/git/datasets/src/datasets/metric.py <span class="hljs-keyword">in</span> add_batch(self, predictions, references)
    <span class="hljs-number">431</span>         <span class="hljs-string">&quot;&quot;&quot;
    432         batch = {&quot;predictions&quot;: predictions, &quot;references&quot;: references}
--&gt; 433         batch = self.info.features.encode_batch(batch)
    434         if self.writer is None:
    435             self._init_writer()</span><!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y cho chÃºng tÃ´i biáº¿t ráº±ng lá»—i báº¯t nguá»“n tá»« mÃ´-Ä‘un <code>datasets/metric.py</code> - vÃ¬ váº­y Ä‘Ã¢y lÃ  sá»± cá»‘ vá»›i hÃ m <code>compute_metrics()</code> cá»§a mÃ¬nh. NÃ³ cáº§n má»™t bá»™ dá»¯ liá»‡u vá»›i cÃ¡c logits vÃ  cÃ¡c nhÃ£n dÆ°á»›i dáº¡ng máº£ng NumPy, vÃ¬ váº­y chÃºng ta hÃ£y thá»­ cung cáº¥p cho nÃ³ ráº±ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions = outputs.logits.cpu().numpy()
labels = batch[<span class="hljs-string">&quot;labels&quot;</span>].cpu().numpy()

compute_metrics((predictions, labels))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->TypeError: only size-<span class="hljs-number">1</span> arrays can be converted to Python scalars<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta nháº­n Ä‘Æ°á»£c cÃ¹ng má»™t lá»—i, vÃ¬ váº­y váº¥n Ä‘á» cháº¯c cháº¯n náº±m á»Ÿ hÃ m Ä‘Ã³. Náº¿u chÃºng ta nhÃ¬n láº¡i mÃ£ cá»§a nÃ³, chÃºng ta tháº¥y nÃ³ chá»‰ chuyá»ƒn tiáº¿p cÃ¡c  <code>predictions</code> vÃ  <code>labels</code>  Ä‘áº¿n <code>metric.compute()</code>. Váº­y cÃ³ váº¥n Ä‘á» gÃ¬ vá»›i phÆ°Æ¡ng phÃ¡p Ä‘Ã³ khÃ´ng? KhÃ´ng háº³n váº­y. ChÃºng ta hÃ£y xem nhanh cÃ¡c hÃ¬nh dáº¡ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions.shape, labels.shape<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->((<span class="hljs-number">8</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">8</span>,))<!-- HTML_TAG_END --></pre></div>
<p>CÃ¡c dá»± Ä‘oÃ¡n cá»§a chÃºng tÃ´i váº«n lÃ  logit, khÃ´ng pháº£i dá»± Ä‘oÃ¡n thá»±c táº¿, Ä‘Ã³ lÃ  lÃ½ do táº¡i sao sá»‘ liá»‡u tráº£ vá» lá»—i (hÆ¡i tá»‘i nghÄ©a) nÃ y. Viá»‡c sá»­a chá»¯a khÃ¡ dá»… dÃ ng; chÃºng ta chá»‰ cáº§n thÃªm má»™t argmax trong hÃ m <code>compute_metrics()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    predictions = np.argmax(predictions, axis=<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


compute_metrics((predictions, labels))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.625</span>}<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» lá»—i cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c sá»­a chá»¯a! ÄÃ¢y lÃ  láº§n cuá»‘i cÃ¹ng, vÃ¬ váº­y ká»‹ch báº£n cá»§a chÃºng ta bÃ¢y giá» sáº½ Ä‘Ã o táº¡o má»™t mÃ´ hÃ¬nh Ä‘Ãºng cÃ¡ch.</p>
<p>Äá»ƒ tham kháº£o, Ä‘Ã¢y lÃ  táº­p lá»‡nh hoÃ n toÃ n cá»‘ Ä‘á»‹nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">import</span> evaluate
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    AutoModelForSequenceClassification,
    DataCollatorWithPadding,
    TrainingArguments,
    Trainer,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)
model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint, num_labels=<span class="hljs-number">3</span>)

args = TrainingArguments(
    <span class="hljs-string">f&quot;distilbert-finetuned-mnli&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
)

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    predictions = np.argmax(predictions, axis=<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)


data_collator = DataCollatorWithPadding(tokenizer=tokenizer)

trainer = Trainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>],
    compute_metrics=compute_metrics,
    data_collator=data_collator,
    tokenizer=tokenizer,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>Trong trÆ°á»ng há»£p nÃ y, khÃ´ng cÃ²n váº¥n Ä‘á» gÃ¬ ná»¯a vÃ  táº­p lá»‡nh cá»§a chÃºng ta sáº½ tinh chá»‰nh má»™t mÃ´ hÃ¬nh sáº½ cho káº¿t quáº£ há»£p lÃ½. NhÆ°ng chÃºng ta cÃ³ thá»ƒ lÃ m gÃ¬ khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n diá»…n ra mÃ  khÃ´ng cÃ³ báº¥t ká»³ lá»—i nÃ o, vÃ  mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n khÃ´ng hoáº¡t Ä‘á»™ng tá»‘t chÃºt nÃ o? ÄÃ³ lÃ  pháº§n khÃ³ nháº¥t cá»§a há»c mÃ¡y vÃ  chÃºng ta sáº½ chá»‰ cho báº¡n má»™t vÃ i ká»¹ thuáº­t cÃ³ thá»ƒ há»¯u Ã­ch.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng vÃ²ng láº·p huáº¥n luyá»‡n thá»§ cÃ´ng, cÃ¡c bÆ°á»›c tÆ°Æ¡ng tá»± sáº½ Ã¡p dá»¥ng Ä‘á»ƒ gá»¡ lá»—i quy trÃ¬nh huáº¥n luyá»‡n cá»§a báº¡n, nhÆ°ng viá»‡c tÃ¡ch chÃºng ra sáº½ dá»… dÃ ng hÆ¡n. Tuy nhiÃªn, hÃ£y Ä‘áº£m báº£o ráº±ng báº¡n khÃ´ng quÃªn <code>model.eval()</code> hoáº·c <code>model.train()</code> á»Ÿ Ä‘Ãºng nÆ¡i, hoáº·c <code>zero_grad()</code> á»Ÿ má»—i bÆ°á»›c!</p></div>
<h2 class="relative group"><a id="debugging-silent-errors-during-training" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#debugging-silent-errors-during-training"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Debugging silent errors during training
	</span></h2>

<p>What can we do to debug a training that completes without error but doesnâ€™t get good results? Weâ€™ll give you some pointers here, but be aware that this kind of debugging is the hardest part of machine learning, and there is no magical answer.</p>
<h3 class="relative group"><a id="kim-tra-li-d-liu-ca-bn-mt-ln-na" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#kim-tra-li-d-liu-ca-bn-mt-ln-na"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Kiá»ƒm tra láº¡i dá»¯ liá»‡u cá»§a báº¡n (má»™t láº§n ná»¯a!)
	</span></h3>

<p>MÃ´ hÃ¬nh cá»§a báº¡n sáº½ chá»‰ há»c Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³ náº¿u nÃ³ thá»±c sá»± cÃ³ thá»ƒ há»c Ä‘Æ°á»£c báº¥t cá»© Ä‘iá»u gÃ¬ tá»« dá»¯ liá»‡u cá»§a báº¡n. Náº¿u cÃ³ lá»—i lÃ m há»ng dá»¯ liá»‡u hoáº·c cÃ¡c nhÃ£n Ä‘Æ°á»£c gÃ¡n ngáº«u nhiÃªn, ráº¥t cÃ³ thá»ƒ báº¡n sáº½ khÃ´ng huáº¥n luyá»‡n Ä‘Æ°á»£c mÃ´ hÃ¬nh nÃ o vá» táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. VÃ¬ váº­y, hÃ£y luÃ´n báº¯t Ä‘áº§u báº±ng cÃ¡ch kiá»ƒm tra ká»¹ cÃ¡c Ä‘áº§u vÃ o vÃ  nhÃ£n Ä‘Ã£ Ä‘Æ°á»£c giáº£i mÃ£ cá»§a báº¡n vÃ  tá»± há»i báº£n thÃ¢n nhá»¯ng cÃ¢u há»i sau:</p>
<ul><li>Dá»¯ liá»‡u Ä‘Æ°á»£c giáº£i mÃ£ cÃ³ dá»… hiá»ƒu khÃ´ng?</li>
<li>Báº¡n cÃ³ Ä‘á»“ng Ã½ vá»›i cÃ¡c nhÃ£n?</li>
<li>CÃ³ má»™t nhÃ£n nÃ o phá»• biáº¿n hÆ¡n nhá»¯ng nhÃ£n khÃ¡c khÃ´ng?</li>
<li>Máº¥t mÃ¡t/Chá»‰ sá»‘ sáº½ lÃ  bao nhiÃªu náº¿u mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n má»™t cÃ¢u tráº£ lá»i ngáº«u nhiÃªn/luÃ´n lÃ  má»™t cÃ¢u tráº£ lá»i giá»‘ng nhau?</li></ul>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>âš ï¸ Náº¿u báº¡n Ä‘ang thá»±c hiá»‡n huáº¥n luyá»‡n phÃ¢n tÃ¡n, hÃ£y in cÃ¡c máº«u táº­p dá»¯ liá»‡u cá»§a báº¡n trong má»—i quy trÃ¬nh vÃ  kiá»ƒm tra ba láº§n Ä‘á»ƒ Ä‘áº£m báº£o báº¡n nháº­n Ä‘Æ°á»£c Ä‘iá»u tÆ°Æ¡ng tá»±. Má»™t lá»—i phá»• biáº¿n lÃ  cÃ³ má»™t sá»‘ nguá»“n ngáº«u nhiÃªn trong quÃ¡ trÃ¬nh táº¡o dá»¯ liá»‡u khiáº¿n má»—i quy trÃ¬nh cÃ³ má»™t phiÃªn báº£n khÃ¡c nhau cá»§a táº­p dá»¯ liá»‡u.</p></div>
<p>Sau khi xem xÃ©t dá»¯ liá»‡u cá»§a báº¡n, hÃ£y xem qua má»™t sá»‘ dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh vÃ  giáº£i mÃ£ chÃºng. Náº¿u mÃ´ hÃ¬nh luÃ´n dá»± Ä‘oÃ¡n cÃ¹ng má»™t Ä‘iá»u, cÃ³ thá»ƒ lÃ  do táº­p dá»¯ liá»‡u cá»§a báº¡n thiÃªn vá» má»™t loáº¡i (Ä‘á»‘i vá»›i cÃ¡c váº¥n Ä‘á» phÃ¢n loáº¡i); cÃ¡c ká»¹ thuáº­t nhÆ° láº¥y máº«u quÃ¡ má»©c cÃ¡c lá»›p hiáº¿m cÃ³ thá»ƒ há»¯u Ã­ch.</p>
<p>Náº¿u máº¥t mÃ¡t/chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡ báº¡n nháº­n Ä‘Æ°á»£c trÃªn mÃ´ hÃ¬nh ban Ä‘áº§u cá»§a mÃ¬nh ráº¥t khÃ¡c vá»›i cÃ¡i báº¡n mong Ä‘á»£i cho cÃ¡c dá»± Ä‘oÃ¡n ngáº«u nhiÃªn, hÃ£y kiá»ƒm tra ká»¹ cÃ¡ch tÃ­nh toÃ¡n tá»•n tháº¥t hoáº·c sá»‘ liá»‡u cá»§a báº¡n, vÃ¬ cÃ³ thá»ƒ cÃ³ má»™t lá»—i á»Ÿ Ä‘Ã³. Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng má»™t sá»‘ máº¥t mÃ¡t mÃ  báº¡n thÃªm vÃ o cuá»‘i, hÃ£y Ä‘áº£m báº£o ráº±ng chÃºng cÃ³ cÃ¹ng quy mÃ´.</p>
<p>Khi báº¡n cháº¯c cháº¯n dá»¯ liá»‡u cá»§a mÃ¬nh lÃ  hoÃ n háº£o, báº¡n cÃ³ thá»ƒ xem liá»‡u mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng huáº¥n luyá»‡n vá» nÃ³ hay khÃ´ng báº±ng má»™t bÃ i kiá»ƒm tra Ä‘Æ¡n giáº£n.</p>
<h3 class="relative group"><a id="hc-k-m-hnh-ca-bn-trong-mt-l" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hc-k-m-hnh-ca-bn-trong-mt-l"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Há»c kÄ© mÃ´ hÃ¬nh cá»§a báº¡n trong má»™t lÃ´
	</span></h3>

<p>Viá»‡c há»c quÃ¡ nhiá»u thÆ°á»ng lÃ  Ä‘iá»u chÃºng ta cá»‘ gáº¯ng trÃ¡nh khi huáº¥n luyá»‡n, vÃ¬ nÃ³ cÃ³ nghÄ©a lÃ  mÃ´ hÃ¬nh khÃ´ng há»c cÃ¡ch nháº­n ra cÃ¡c Ä‘áº·c Ä‘iá»ƒm chung ta muá»‘n mÃ  thay vÃ o Ä‘Ã³ chá»‰ lÃ  ghi nhá»› cÃ¡c máº«u huáº¥n luyá»‡n. Tuy nhiÃªn, cá»‘ gáº¯ng huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a báº¡n láº·p Ä‘i láº·p láº¡i lÃ  má»™t bÃ i kiá»ƒm tra tá»‘t Ä‘á»ƒ kiá»ƒm tra xem váº¥n Ä‘á» nhÆ° báº¡n Ä‘Ã£ Ä‘á»‹nh hÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng mÃ´ hÃ¬nh mÃ  báº¡n Ä‘ang cá»‘ gáº¯ng huáº¥n luyá»‡n hay khÃ´ng. NÃ³ cÅ©ng sáº½ giÃºp báº¡n xem liá»‡u tá»‘c Ä‘á»™ há»c ban Ä‘áº§u cá»§a báº¡n cÃ³ quÃ¡ cao hay khÃ´ng.</p>
<p>Thá»±c hiá»‡n Ä‘iá»u nÃ y khi báº¡n Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c <code>Trainer</code> cá»§a mÃ¬nh thá»±c sá»± dá»… dÃ ng; chá»‰ cáº§n láº¥y má»™t loáº¡t dá»¯ liá»‡u huáº¥n luyá»‡n, sau Ä‘Ã³ cháº¡y má»™t vÃ²ng huáº¥n luyá»‡n thá»§ cÃ´ng nhá» chá»‰ sá»­ dá»¥ng lÃ´ Ä‘Ã³ cho má»™t cÃ¡i gÃ¬ Ä‘Ã³ giá»‘ng nhÆ° 20 bÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> trainer.get_train_dataloader():
    <span class="hljs-keyword">break</span>

batch = {k: v.to(device) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> batch.items()}
trainer.create_optimizer()

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):
    outputs = trainer.model(**batch)
    loss = outputs.loss
    loss.backward()
    trainer.optimizer.step()
    trainer.optimizer.zero_grad()<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u dá»¯ liá»‡u huáº¥n luyá»‡n cá»§a báº¡n khÃ´ng cÃ¢n báº±ng, hÃ£y Ä‘áº£m báº£o táº¡o má»™t loáº¡t dá»¯ liá»‡u huáº¥n luyá»‡n cÃ³ chá»©a táº¥t cáº£ cÃ¡c nhÃ£n.</p></div>
<p>MÃ´ hÃ¬nh pháº£i cÃ³ káº¿t quáº£ tráº£ vá» gáº§n nhÆ° hoÃ n háº£o trÃªn cÃ¹ng má»™t <code>lÃ´</code>. HÃ£y tÃ­nh toÃ¡n cÃ¡c chá»‰ sá»‘ trÃªn cÃ¡c dá»± Ä‘oÃ¡n káº¿t quáº£:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">with</span> torch.no_grad():
    outputs = trainer.model(**batch)
preds = outputs.logits
labels = batch[<span class="hljs-string">&quot;labels&quot;</span>]

compute_metrics((preds.cpu().numpy(), labels.cpu().numpy()))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">1.0</span>}<!-- HTML_TAG_END --></pre></div>
<p>ChÃ­nh xÃ¡c 100%, Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh vá» viá»‡c overfitt(cÃ³ nghÄ©a lÃ  náº¿u báº¡n thá»­ mÃ´ hÃ¬nh cá»§a mÃ¬nh trÃªn báº¥t ká»³ cÃ¢u nÃ o khÃ¡c, ráº¥t cÃ³ thá»ƒ nÃ³ sáº½ Ä‘Æ°a ra cÃ¢u tráº£ lá»i sai)!</p>
<p>Náº¿u báº¡n khÃ´ng quáº£n lÃ½ Ä‘á»ƒ mÃ´ hÃ¬nh cá»§a mÃ¬nh cÃ³ Ä‘Æ°á»£c káº¿t quáº£ hoÃ n háº£o nhÆ° tháº¿ nÃ y, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  cÃ³ Ä‘iá»u gÃ¬ Ä‘Ã³ khÃ´ng á»•n trong cÃ¡ch báº¡n Ä‘á»‹nh khung váº¥n Ä‘á» hoáº·c dá»¯ liá»‡u cá»§a mÃ¬nh, vÃ¬ váº­y báº¡n nÃªn kháº¯c phá»¥c Ä‘iá»u Ä‘Ã³. Chá»‰ khi báº¡n vÆ°á»£t qua Ä‘Æ°á»£c bÃ i kiá»ƒm tra overfit, báº¡n má»›i cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng mÃ´ hÃ¬nh cá»§a mÃ¬nh thá»±c sá»± cÃ³ thá»ƒ há»c Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³.</p>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>âš ï¸ Báº¡n sáº½ pháº£i táº¡o láº¡i mÃ´ hÃ¬nh vÃ  <code>Trainer</code>cá»§a mÃ¬nh sau bÃ i kiá»ƒm tra overfitt nÃ y, vÃ¬ mÃ´ hÃ¬nh thu Ä‘Æ°á»£c cÃ³ thá»ƒ sáº½ khÃ´ng thá»ƒ khÃ´i phá»¥c vÃ  há»c Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³ há»¯u Ã­ch trÃªn táº­p dá»¯ liá»‡u Ä‘áº§y Ä‘á»§ cá»§a báº¡n.</p></div>
<h3 class="relative group"><a id="khng-iu-chnh-bt-c-th-g-cho-n-khi-bn-c-m-hnh-c-s-u-tin" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#khng-iu-chnh-bt-c-th-g-cho-n-khi-bn-c-m-hnh-c-s-u-tin"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>KhÃ´ng Ä‘iá»u chá»‰nh báº¥t cá»© thá»© gÃ¬ cho Ä‘áº¿n khi báº¡n cÃ³ mÃ´ hÃ¬nh cÆ¡ sá»Ÿ Ä‘áº§u tiÃªn
	</span></h3>

<p>Äiá»u chá»‰nh siÃªu tham sá»‘ luÃ´n Ä‘Æ°á»£c nháº¥n máº¡nh lÃ  pháº§n khÃ³ nháº¥t cá»§a há»c mÃ¡y, nhÆ°ng nÃ³ chá»‰ lÃ  bÆ°á»›c cuá»‘i cÃ¹ng giÃºp báº¡n hiá»ƒu Ä‘Æ°á»£c má»™t chÃºt vá» chá»‰ sá»‘ nÃ y. Háº§u háº¿t thá»i gian, cÃ¡c siÃªu tham sá»‘ máº·c Ä‘á»‹nh cá»§a <code>Trainer</code> sáº½ hoáº¡t Ä‘á»™ng tá»‘t Ä‘á»ƒ cung cáº¥p cho báº¡n káº¿t quáº£ tá»‘t, vÃ¬ váº­y Ä‘á»«ng khá»Ÿi cháº¡y tÃ¬m kiáº¿m siÃªu tham sá»‘ tá»‘n thá»i gian vÃ  tá»‘n kÃ©m cho Ä‘áº¿n khi báº¡n cÃ³ thá»© gÃ¬ Ä‘Ã³ vÆ°á»£t qua mÃ´ hÃ¬nh cÆ¡ sá»Ÿ mÃ  báº¡n cÃ³ trÃªn táº­p dá»¯ liá»‡u cá»§a mÃ¬nh.</p>
<p>Khi báº¡n Ä‘Ã£ cÃ³ má»™t mÃ´ hÃ¬nh Ä‘á»§ tá»‘t, báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u Ä‘iá»u chá»‰nh má»™t chÃºt. Äá»«ng thá»­ khá»Ÿi cháº¡y má»™t nghÃ¬n láº§n cháº¡y vá»›i cÃ¡c siÃªu tham sá»‘ khÃ¡c nhau, nhÆ°ng hÃ£y so sÃ¡nh má»™t vÃ i láº§n cháº¡y vá»›i cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau cho má»™t siÃªu thÃ´ng sá»‘ Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c Ã½ tÆ°á»Ÿng vá» giÃ¡ trá»‹ nÃ o cÃ³ tÃ¡c Ä‘á»™ng lá»›n nháº¥t.</p>
<p>Náº¿u báº¡n Ä‘ang Ä‘iá»u chá»‰nh chÃ­nh mÃ´ hÃ¬nh, hÃ£y giá»¯ nÃ³ Ä‘Æ¡n giáº£n vÃ  Ä‘á»«ng thá»­ báº¥t cá»© Ä‘iá»u gÃ¬ mÃ  báº¡n khÃ´ng thá»ƒ biá»‡n minh má»™t cÃ¡ch há»£p lÃ½. LuÃ´n Ä‘áº£m báº£o ráº±ng báº¡n quay láº¡i kiá»ƒm tra overfit Ä‘á»ƒ xÃ¡c minh ráº±ng thay Ä‘á»•i cá»§a báº¡n khÃ´ng gÃ¢y ra báº¥t ká»³ háº­u quáº£ ngoÃ i Ã½ muá»‘n nÃ o.</p>
<h3 class="relative group"><a id="yu-cu-gip" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#yu-cu-gip"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>YÃªu cáº§u giÃºp Ä‘á»¡
	</span></h3>

<p>Hy vá»ng ráº±ng báº¡n sáº½ tÃ¬m tháº¥y má»™t sá»‘ lá»i khuyÃªn trong pháº§n nÃ y Ä‘á»ƒ giÃºp báº¡n giáº£i quyáº¿t váº¥n Ä‘á» cá»§a mÃ¬nh, nhÆ°ng náº¿u khÃ´ng pháº£i váº­y, hÃ£y nhá»› ráº±ng báº¡n luÃ´n cÃ³ thá»ƒ há»i cá»™ng Ä‘á»“ng trÃªn <a href="https://discuss.huggingface.co/" rel="nofollow">diá»…n Ä‘Ã n</a>.</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tÃ i liá»‡u bá»• sung cÃ³ thá»ƒ há»¯u Ã­ch:</p>
<ul><li><a href="https://docs.google.com/presentation/d/1yHLPvPhUs2KGI5ZWo0sU-PKU3GimAk3iTsI38Z-B5Gw/edit#slide=id.p" rel="nofollow">â€œReproducibility as a vehicle for engineering best practicesâ€</a> bá»Ÿi Joel Grus</li>
<li><a href="https://towardsdatascience.com/checklist-for-debugging-neural-networks-d8b2a9434f21" rel="nofollow">â€œChecklist for debugging neural networksâ€</a> bá»Ÿi Cecelia Shao</li>
<li><a href="https://medium.com/@keeper6928/how-to-unit-test-machine-learning-code-57cf6fd81765" rel="nofollow">â€œHow to unit test machine learning codeâ€</a> bá»Ÿi Chase Roberts</li>
<li><a href="http://karpathy.github.io/2019/04/25/recipe/" rel="nofollow">â€œA Recipe for Training Neural Networksâ€</a> bá»Ÿi Andrej Karpathy</li></ul>
<p>Táº¥t nhiÃªn, khÃ´ng pháº£i má»i váº¥n Ä‘á» báº¡n gáº·p pháº£i khi huáº¥n luyá»‡n máº¡ng tháº§n kinh Ä‘á»u lÃ  lá»—i cá»§a chÃ­nh báº¡n! Náº¿u báº¡n gáº·p Ä‘iá»u gÃ¬ Ä‘Ã³ trong thÆ° viá»‡n ğŸ¤— Transformers hoáº·c ğŸ¤— Datasets cÃ³ váº» khÃ´ng á»•n, cÃ³ thá»ƒ báº¡n Ä‘Ã£ gáº·p lá»—i. Báº¡n cháº¯c cháº¯n nÃªn cho chÃºng tÃ´i biáº¿t táº¥t cáº£ vá» Ä‘iá»u Ä‘Ã³ vÃ  trong pháº§n tiáº¿p theo, chÃºng tÃ´i sáº½ giáº£i thÃ­ch chÃ­nh xÃ¡c cÃ¡ch thá»±c hiá»‡n Ä‘iá»u Ä‘Ã³.</p>


		<script type="module" data-hydrate="1erslr5">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="1erslr5"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter8/4.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
