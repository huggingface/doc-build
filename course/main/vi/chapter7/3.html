<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;tinh-chnh-mt-m-hnh-ngn-ng-b-n-i&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chn-mt-m-hnh-hun-luyn-trc-cho-m-hnh-ngn-ng-b-n-i&quot;,&quot;title&quot;:&quot;Chá»n má»™t mÃ´ hÃ¬nh huáº¥n luyá»‡n trÆ°á»›c cho mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i&quot;},{&quot;local&quot;:&quot;b-d-liu&quot;,&quot;title&quot;:&quot;Bá»™ dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;tin-x-l-d-liu&quot;,&quot;title&quot;:&quot;Tiá»n xá»­ lÃ½ dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;tinh-chnh-distilbert-vi-api-trainer&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;perplexity-cho-m-hnh-ngn-ng&quot;,&quot;title&quot;:&quot;Perplexity cho mÃ´ hÃ¬nh ngÃ´n ngá»¯&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh DistilBERT vá»›i API `Trainer`&quot;},{&quot;local&quot;:&quot;tinh-chnh-distilbert-vi-accelerate&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh DistilBERT vá»›i ğŸ¤— Accelerate&quot;},{&quot;local&quot;:&quot;s-dng-m-hnh-tinh-chnh-ca-mnh&quot;,&quot;title&quot;:&quot;Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh cá»§a mÃ¬nh&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter7/3.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="tinh-chnh-mt-m-hnh-ngn-ng-b-n-i" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-mt-m-hnh-ngn-ng-b-n-i"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/vi/chapter7/section3_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/vi/chapter7/section3_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Äá»‘i vá»›i nhiá»u á»©ng dá»¥ng NLP liÃªn quan Ä‘áº¿n cÃ¡c mÃ´ hÃ¬nh Transformer, báº¡n cÃ³ thá»ƒ chá»‰ cáº§n láº¥y má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c tá»« Hugging Face Hub vÃ  tinh chá»‰nh trá»±c tiáº¿p trÃªn dá»¯ liá»‡u cá»§a báº¡n cho tÃ¡c vá»¥ hiá»‡n táº¡i. Vá»›i Ä‘iá»u kiá»‡n lÃ  ngá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n trÆ°á»›c khÃ´ng quÃ¡ khÃ¡c biá»‡t vá»›i ngá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tinh chá»‰nh, viá»‡c há»c chuyá»ƒn tiáº¿p thÆ°á»ng sáº½ mang láº¡i káº¿t quáº£ tá»‘t.</p>
<p>Tuy nhiÃªn, cÃ³ má»™t vÃ i trÆ°á»ng há»£p mÃ  trÆ°á»›c tiÃªn báº¡n sáº½ muá»‘n tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ trÃªn dá»¯ liá»‡u cá»§a mÃ¬nh, trÆ°á»›c khi huáº¥n luyá»‡n Ä‘áº§u tÃ¡c vá»¥ cá»¥ thá»ƒ. VÃ­ dá»¥: náº¿u táº­p dá»¯ liá»‡u cá»§a báº¡n chá»©a cÃ¡c há»£p Ä‘á»“ng phÃ¡p lÃ½ hoáº·c cÃ¡c bÃ i bÃ¡o khoa há»c, thÃ¬ mÃ´ hÃ¬nh thuáº§n Transformer nhÆ° BERT thÆ°á»ng sáº½ coi cÃ¡c tá»« chuyÃªn mÃ´n trong kho dá»¯ liá»‡u cá»§a báº¡n lÃ  token hiáº¿m vÃ  hiá»‡u suáº¥t káº¿t quáº£ cÃ³ thá»ƒ kÃ©m hÆ¡n. Báº±ng cÃ¡ch tinh chá»‰nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ trÃªn dá»¯ liá»‡u chuyÃªn mÃ´n, báº¡n cÃ³ thá»ƒ tÄƒng hiá»‡u suáº¥t cá»§a nhiá»u tÃ¡c vá»¥ xuÃ´i dÃ²ng, cÃ³ nghÄ©a lÃ  báº¡n thÆ°á»ng chá»‰ pháº£i thá»±c hiá»‡n bÆ°á»›c nÃ y má»™t láº§n!</p>
<p>QuÃ¡ trÃ¬nh tinh chá»‰nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c trÃªn dá»¯ liá»‡u trong máº£ng nÃ y thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <em>domain adapt</em> hay <em>thÃ­ch á»©ng chuyÃªn mÃ´n</em>. NÃ³ Ä‘Æ°á»£c phá»• biáº¿n vÃ o nÄƒm 2018 bá»Ÿi <a href="https://arxiv.org/abs/1801.06146" rel="nofollow">ULMFiT</a>, lÃ  má»™t trong nhá»¯ng kiáº¿n â€‹â€‹trÃºc máº¡ng tháº§n kinh Ä‘áº§u tiÃªn (dá»±a trÃªn LSTM) Ä‘á»ƒ lÃ m cho viá»‡c há»c chuyá»ƒn tiáº¿p thá»±c sá»± hiá»‡u quáº£ cho NLP. Má»™t vÃ­ dá»¥ vá» thÃ­ch á»©ng chuyÃªn mÃ´n vá»›i ULMFiT Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh dÆ°á»›i Ä‘Ã¢y; trong pháº§n nÃ y, chÃºng ta sáº½ lÃ m Ä‘iá»u tÆ°Æ¡ng tá»±, nhÆ°ng vá»›i Transformer thay vÃ¬ LSTM!</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/ulmfit.svg" alt="ULMFiT.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/ulmfit-dark.svg" alt="ULMFiT."></div>
<p>Äáº¿n cuá»‘i pháº§n nÃ y, báº¡n sáº½ cÃ³ má»™t <a href="https://huggingface.co/huggingface-course/distilbert-base-uncased-finetuned-imdb?text=This+is+a+great+%5BMASK%5D." rel="nofollow">mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i</a> trÃªn Hub cÃ³ thá»ƒ tá»± Ä‘á»™ng hoÃ n thiá»‡n cÃ¢u nhÆ° dÆ°á»›i Ä‘Ã¢y:</p>
<iframe src="https://hf.space/gradioiframe/course-demos/distilbert-base-uncased-finetuned-imdb/+" frameborder="0" height="300" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<p>CÃ¹ng Ä‘i sÃ¢u vÃ o thÃ´i!</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/mqElG5QJWUg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ™‹ Náº¿u cÃ¡c thuáº­t ngá»¯ â€œmÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘iâ€ vÃ  â€œmÃ´ hÃ¬nh huáº¥n luyá»‡n trÆ°á»›câ€ nghe cÃ³ váº» xa láº¡ vá»›i báº¡n, hÃ£y xem <a href="/course/chapter1">ChÆ°Æ¡ng 1</a>, nÆ¡i chÃºng tÃ´i giáº£i thÃ­ch táº¥t cáº£ cÃ¡c khÃ¡i niá»‡m cá»‘t lÃµi nÃ y, kÃ¨m theo video!</p></div>
<h2 class="relative group"><a id="chn-mt-m-hnh-hun-luyn-trc-cho-m-hnh-ngn-ng-b-n-i" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chn-mt-m-hnh-hun-luyn-trc-cho-m-hnh-ngn-ng-b-n-i"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chá»n má»™t mÃ´ hÃ¬nh huáº¥n luyá»‡n trÆ°á»›c cho mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i
	</span></h2>

<p>Äá»ƒ báº¯t Ä‘áº§u, hÃ£y chá»n má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c phÃ¹ há»£p Ä‘á»ƒ táº¡o mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong áº£nh chá»¥p mÃ n hÃ¬nh dÆ°á»›i Ä‘Ã¢y, báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y danh sÃ¡ch cÃ¡c á»©ng cá»­ viÃªn báº±ng cÃ¡ch Ã¡p dá»¥ng bá»™ lá»c â€œFill-Maskâ€ trÃªn <a href="https://huggingface.co/models?pipeline_tag=fill-mask&sort=downloads" rel="nofollow">Hugging Face Hub</a>:</p>
<div class="flex justify-center"><img src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/mlm-models.png" alt="Hub models." width="80%"></div>
<p>Máº·c dÃ¹ dÃ²ng mÃ´ hÃ¬nh BERT vÃ  RoBERTa Ä‘Æ°á»£c táº£i xuá»‘ng nhiá»u nháº¥t, chÃºng ta sáº½ sá»­ dá»¥ng mÃ´ hÃ¬nh cÃ³ tÃªn <a href="https://huggingface.co/distilbert-base-uncased" rel="nofollow">DistilBERT</a>
cÃ³ thá»ƒ huáº¥n luyá»‡n nhanh hÆ¡n nhiá»u mÃ  Ã­t hoáº·c khÃ´ng bá»‹ máº¥t hiá»‡u suáº¥t. MÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c huáº¥n luyá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng má»™t ká»¹ thuáº­t Ä‘áº·c biá»‡t cÃ³ tÃªn lÃ  <a href="https://en.wikipedia.org/wiki/Knowledge_distillation" rel="nofollow"><em>knowledge distillation</em></a>, trong Ä‘Ã³ má»™t â€œmÃ´ hÃ¬nh giÃ¡o viÃªnâ€ lá»›n nhÆ° BERT Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hÆ°á»›ng dáº«n huáº¥n luyá»‡n â€œmÃ´ hÃ¬nh sinh viÃªnâ€ cÃ³ Ã­t tham sá»‘ hÆ¡n nhiá»u. Pháº§n giáº£i thÃ­ch chi tiáº¿t vá» quÃ¡ trÃ¬nh cháº¯t lá»c kiáº¿n â€‹â€‹thá»©c sáº½ Ä‘Æ°a chÃºng ta Ä‘i quÃ¡ xa trong pháº§n nÃ y, nhÆ°ng náº¿u báº¡n quan tÃ¢m, báº¡n cÃ³ thá»ƒ Ä‘á»c táº¥t cáº£ vá» nÃ³ trong <a href="https://learning.oreilly.com/library/view/natural-language-processing/9781098103231/ch05.html" rel="nofollow"><em>Natural Language Processing with Transformers</em></a> (thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  sÃ¡ch giÃ¡o khoa vá» Transformer).</p>
<p>HÃ£y tiáº¿p tá»¥c vÃ  táº£i xuá»‘ng DistilBERT báº±ng cÃ¡ch sá»­ dá»¥ng lá»›p <code>AutoModelForMaskedLM</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForMaskedLM

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
model = AutoModelForMaskedLM.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ xem mÃ´ hÃ¬nh nÃ y cÃ³ bao nhiÃªu tham sá»‘ báº±ng cÃ¡ch gá»i phÆ°Æ¡ng thá»©c <code>num_parameters()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->distilbert_num_parameters = model.num_parameters() / <span class="hljs-number">1_000_000</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; DistilBERT number of parameters: <span class="hljs-subst">{<span class="hljs-built_in">round</span>(distilbert_num_parameters)}</span>M&#x27;&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; BERT number of parameters: 110M&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; DistilBERT number of parameters: 67M&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; BERT number of parameters: 110M&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Vá»›i khoáº£ng 67 triá»‡u tham sá»‘, DistilBERT nhá» hÆ¡n khoáº£ng hai láº§n so vá»›i mÃ´ hÃ¬nh cÆ¡ sá»Ÿ BERT, gáº§n nhÆ° Ä‘Æ°á»£c hiá»ƒu lÃ  tÄƒng tá»‘c gáº¥p hai láº§n khi huáº¥n luyá»‡n - tháº­t tuyá»‡t! BÃ¢y giá» chÃºng ta hÃ£y xem nhá»¯ng loáº¡i token nÃ o mÃ´ hÃ¬nh nÃ y dá»± Ä‘oÃ¡n lÃ  cÃ³ nhiá»u kháº£ nÄƒng hoÃ n thÃ nh má»™t máº«u vÄƒn báº£n nhá»:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->text = <span class="hljs-string">&quot;This is a great [MASK].&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>LÃ  con ngÆ°á»i, chÃºng ta cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng ra nhiá»u kháº£ nÄƒng Ä‘á»‘i vá»›i token <code>[MASK]</code>, vÃ­ dá»¥ â€œdayâ€, â€œrideâ€, hoáº·c â€œpaintingâ€. Äá»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c, cÃ¡c dá»± Ä‘oÃ¡n phá»¥ thuá»™c vÃ o kho ngá»¯ liá»‡u mÃ´ hÃ¬nh Ä‘Ã³ huáº¥n luyá»‡n, vÃ¬ nÃ³ há»c cÃ¡ch chá»n cÃ¡c máº«u thá»‘ng kÃª cÃ³ trong dá»¯ liá»‡u. Giá»‘ng BERT, DistilBERT Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c trÃªn bá»™ dá»¯ liá»‡u <a href="https://huggingface.co/datasets/wikipedia" rel="nofollow">English Wikipedia</a> vÃ  <a href="https://huggingface.co/datasets/bookcorpus" rel="nofollow">BookCorpus</a>, nÃªn ta kÃ¬ vá»ng cÃ¡c dá»± Ä‘oÃ¡n cho <code>[MASK]</code> sáº½ pháº£n Ã¡nh cÃ¡c máº£ng nÃ y. Äá»ƒ dá»± Ä‘oÃ¡n ta cáº§n trÃ¬nh tokenizer cá»§a DistilBERT táº¡o ra cÃ¡c Ä‘áº§u vÃ o cho mÃ´ hÃ¬nh, vÃ¬ váº­y hÃ£y táº£i tá»« Hub:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>Vá»›i má»™t tokenizer vÃ  má»™t mÃ´ hÃ¬nh, ta cÃ³ thá»ƒ truyá»n cÃ¡c Ä‘oáº¡n vÄƒn vÃ­ dá»¥ tá»›i mÃ´ hÃ¬nh, trÃ­ch xuáº¥t logits, vÃ  xin ra 5 á»©ng cá»­ viÃªn: </p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch

inputs = tokenizer(text, return_tensors=<span class="hljs-string">&quot;pt&quot;</span>)
token_logits = model(**inputs).logits
<span class="hljs-comment"># TÃ¬m vá»‹ trÃ­ [MASK] vÃ  trÃ­ch xuáº¥t logit</span>
mask_token_index = torch.where(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>] == tokenizer.mask_token_id)[<span class="hljs-number">1</span>]
mask_token_logits = token_logits[<span class="hljs-number">0</span>, mask_token_index, :]
<span class="hljs-comment"># Chá»n á»©ng viÃªn cho [MASK] vá»›i logit cao nháº¥t</span>
top_5_tokens = torch.topk(mask_token_logits, <span class="hljs-number">5</span>, dim=<span class="hljs-number">1</span>).indices[<span class="hljs-number">0</span>].tolist()

<span class="hljs-keyword">for</span> token <span class="hljs-keyword">in</span> top_5_tokens:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; <span class="hljs-subst">{text.replace(tokenizer.mask_token, tokenizer.decode([token]))}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; This is a great deal.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; This is a great success.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; This is a great adventure.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; This is a great idea.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; This is a great feat.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ tháº¥y tá»« káº¿t quáº£ Ä‘áº§u ra ráº±ng cÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh Ä‘á» cáº­p Ä‘áº¿n cÃ¡c thuáº­t ngá»¯ hÃ ng ngÃ y, Ä‘iá»u nÃ y cÃ³ láº½ khÃ´ng cÃ³ gÃ¬ Ä‘Ã¡ng ngáº¡c nhiÃªn khi dá»±a trÃªn ná»n táº£ng cá»§a Wikipedia tiáº¿ng Anh. HÃ£y xem cÃ¡ch chÃºng ta cÃ³ thá»ƒ thay Ä‘á»•i máº£ng nÃ y thÃ nh má»™t thá»© gÃ¬ Ä‘Ã³ thÃ­ch há»£p hÆ¡n má»™t chÃºt - cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ phim phÃ¢n cá»±c cao!</p>
<h2 class="relative group"><a id="b-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#b-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Bá»™ dá»¯ liá»‡u
	</span></h2>

<p>Äá»ƒ giá»›i thiá»‡u viá»‡c thÃ­ch á»©ng chuyÃªn mÃ´n, chÃºng ta sáº½ sá»­ dá»¥ng bá»™ dá»¯ liá»‡u ná»•i tiáº¿ng <a href="https://huggingface.co/datasets/imdb" rel="nofollow">Large Movie Review Dataset</a>(hay viáº¿t táº¯t lÃ  IMDb), lÃ  táº­p há»£p cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ phim thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh phÃ¢n tÃ­ch cáº£m xÃºc. Báº±ng cÃ¡ch tinh chá»‰nh DistilBERT trÃªn kho ngá»¯ liá»‡u nÃ y, chÃºng ta hy vá»ng mÃ´ hÃ¬nh ngÃ´n ngá»¯ sáº½ Ä‘iá»u chá»‰nh vá»‘n tá»« vá»±ng cá»§a nÃ³ tá»« dá»¯ liá»‡u thá»±c táº¿ cá»§a Wikipedia mÃ  nÃ³ Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c Ä‘á»ƒ phÃ¹ há»£p vá»›i cÃ¡c yáº¿u tá»‘ chá»§ quan hÆ¡n cá»§a cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ phim. ChÃºng ta cÃ³ thá»ƒ láº¥y dá»¯ liá»‡u tá»« Hugging Face Hub báº±ng hÃ m <code>load_dataset()</code> tá»« ğŸ¤— Datasets:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

imdb_dataset = load_dataset(<span class="hljs-string">&quot;imdb&quot;</span>)
imdb_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;text&#x27;</span>, <span class="hljs-string">&#x27;label&#x27;</span>],
        num_rows: <span class="hljs-number">25000</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;text&#x27;</span>, <span class="hljs-string">&#x27;label&#x27;</span>],
        num_rows: <span class="hljs-number">25000</span>
    })
    unsupervised: Dataset({
        features: [<span class="hljs-string">&#x27;text&#x27;</span>, <span class="hljs-string">&#x27;label&#x27;</span>],
        num_rows: <span class="hljs-number">50000</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng má»—i pháº§n <code>huáº¥n luyá»‡n</code> vÃ  <code>kiá»ƒm thá»­</code> bao gá»“m 25,000 Ä‘Ã¡nh giÃ¡, trong khi pháº§n khÃ´ng Ä‘Æ°á»£c gáº¯n nhÃ£n Ä‘Æ°á»£c gá»i lÃ  <code>phi giÃ¡m sÃ¡t</code> chá»©a 50,000 Ä‘Ã¡nh giÃ¡. ChÃºng ta hÃ£y xem má»™t vÃ i máº«u Ä‘á»ƒ cÃ³ Ã½ tÆ°á»Ÿng vá» loáº¡i vÄƒn báº£n mÃ  ta Ä‘ang xá»­ lÃ½. NhÆ° chÃºng ta Ä‘Ã£ thá»±c hiá»‡n trong cÃ¡c chÆ°Æ¡ng trÆ°á»›c cá»§a khÃ³a há»c, chÃºng ta sáº½ xÃ¢u chuá»—i cÃ¡c hÃ m <code>Dataset.shuffle()</code> vÃ  <code>Dataset.select()</code> Ä‘á»ƒ táº¡o má»™t máº«u ngáº«u nhiÃªn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->sample = imdb_dataset[<span class="hljs-string">&quot;train&quot;</span>].shuffle(seed=<span class="hljs-number">42</span>).select(<span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>))

<span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> sample:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; Review: <span class="hljs-subst">{row[<span class="hljs-string">&#x27;text&#x27;</span>]}</span>&#x27;&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Label: <span class="hljs-subst">{row[<span class="hljs-string">&#x27;label&#x27;</span>]}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->
<span class="hljs-string">&#x27;&gt;&gt;&gt; Review: This is your typical Priyadarshan movie--a bunch of loony characters out on some silly mission. His signature climax has the entire cast of the film coming together and fighting each other in some crazy moshpit over hidden money. Whether it is a winning lottery ticket in Malamaal Weekly, black money in Hera Pheri, &quot;kodokoo&quot; in Phir Hera Pheri, etc., etc., the director is becoming ridiculously predictable. Don\&#x27;t get me wrong; as clichÃ©d and preposterous his movies may be, I usually end up enjoying the comedy. However, in most his previous movies there has actually been some good humor, (Hungama and Hera Pheri being noteworthy ones). Now, the hilarity of his films is fading as he is using the same formula over and over again.&lt;br /&gt;&lt;br /&gt;Songs are good. Tanushree Datta looks awesome. Rajpal Yadav is irritating, and Tusshar is not a whole lot better. Kunal Khemu is OK, and Sharman Joshi is the best.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Label: 0&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Review: Okay, the story makes no sense, the characters lack any dimensionally, the best dialogue is ad-libs about the low quality of movie, the cinematography is dismal, and only editing saves a bit of the muddle, but Sam&quot; Peckinpah directed the film. Somehow, his direction is not enough. For those who appreciate Peckinpah and his great work, this movie is a disappointment. Even a great cast cannot redeem the time the viewer wastes with this minimal effort.&lt;br /&gt;&lt;br /&gt;The proper response to the movie is the contempt that the director San Peckinpah, James Caan, Robert Duvall, Burt Young, Bo Hopkins, Arthur Hill, and even Gig Young bring to their work. Watch the great Peckinpah films. Skip this mess.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Label: 0&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Review: I saw this movie at the theaters when I was about 6 or 7 years old. I loved it then, and have recently come to own a VHS version. &lt;br /&gt;&lt;br /&gt;My 4 and 6 year old children love this movie and have been asking again and again to watch it. &lt;br /&gt;&lt;br /&gt;I have enjoyed watching it again too. Though I have to admit it is not as good on a little TV.&lt;br /&gt;&lt;br /&gt;I do not have older children so I do not know what they would think of it. &lt;br /&gt;&lt;br /&gt;The songs are very cute. My daughter keeps singing them over and over.&lt;br /&gt;&lt;br /&gt;Hope this helps.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Label: 1&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ÄÃºng, Ä‘Ã¢y cháº¯c cháº¯n lÃ  nhá»¯ng bÃ i Ä‘Ã¡nh giÃ¡ phim, vÃ  náº¿u báº¡n Ä‘á»§ lá»›n, báº¡n tháº­m chÃ­ cÃ³ thá»ƒ hiá»ƒu nháº­n xÃ©t trong bÃ i Ä‘Ã¡nh giÃ¡ cuá»‘i cÃ¹ng vá» viá»‡c sá»Ÿ há»¯u phiÃªn báº£n VHS ğŸ˜œ! Máº·c dÃ¹ chÃºng ta sáº½ khÃ´ng cáº§n nhÃ£n Ä‘á»ƒ cho mÃ´ hÃ¬nh ngÃ´n ngá»¯, nhÆ°ng chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng <code>0</code> biá»ƒu thá»‹ má»™t Ä‘Ã¡nh giÃ¡ tiÃªu cá»±c, trong khi <code>1</code> tÆ°Æ¡ng á»©ng vá»›i má»™t Ä‘Ã¡nh giÃ¡ tÃ­ch cá»±c.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Táº¡o ra cÃ¡c máº«u ngáº«u nhiá»n tá»« pháº§n <code>phi giÃ¡m sÃ¡t</code> vÃ  kiá»ƒm Ä‘á»‹nh xem nhÃ£n cá»§a chÃºng lÃ  <code>0</code> hay <code>1</code>. Khi Ä‘ang á»Ÿ Ä‘Ã³, báº¡n cÅ©ng cÃ³ thá»ƒ kiá»ƒm tra xem cÃ¡c nhÃ£n trong pháº§n <code>huáº¥n luyá»‡n</code> vÃ  <code>kiá»ƒm thá»­</code> cÃ³ thá»±c sá»­ lÃ  <code>0</code> hoáº·c <code>1</code> khÃ´ng â€” Ä‘Ã¢y lÃ  má»™t pháº§n kiá»ƒm tra há»¯u Ã­ch mÃ nhá»¯ng nhÃ  NLP nÃªn thá»±c hiá»‡n Ä‘áº§u dá»± Ã¡n!. </p></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ má»™t cÃ¡i nhÃ¬n nhanh vá» dá»¯ liá»‡u, hÃ£y Ä‘i sÃ¢u vÃ o viá»‡c chuáº©n bá»‹ nÃ³ cho viá»‡c láº­p mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i. NhÆ° chÃºng ta sáº½ tháº¥y, cÃ³ má»™t sá»‘ bÆ°á»›c bá»• sung mÃ  ngÆ°á»i ta cáº§n thá»±c hiá»‡n so vá»›i cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i chuá»—i mÃ  chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>. Äi thÃ´i!</p>
<h2 class="relative group"><a id="tin-x-l-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tin-x-l-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tiá»n xá»­ lÃ½ dá»¯ liá»‡u
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/8PmhEIXhBvI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Äá»‘i vá»›i cáº£ mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»± Ä‘á»™ng há»“i quy vÃ  bá»‹ áº©n Ä‘i, má»™t bÆ°á»›c tiá»n xá»­ lÃ½ phá»• biáº¿n lÃ  ná»‘i táº¥t cáº£ cÃ¡c máº«u vÃ  sau Ä‘Ã³ chia toÃ n bá»™ ngá»¯ liá»‡u thÃ nh cÃ¡c pháº§n cÃ³ kÃ­ch thÆ°á»›c báº±ng nhau. Äiá»u nÃ y hoÃ n toÃ n khÃ¡c vá»›i cÃ¡ch tiáº¿p cáº­n thÃ´ng thÆ°á»ng, khi chÃºng ta chá»‰ cáº§n tokenize cÃ¡c máº«u riÃªng láº». Táº¡i sao láº¡i ná»‘i má»i thá»© láº¡i vá»›i nhau? LÃ½ do lÃ  cÃ¡c máº«u riÃªng láº» cÃ³ thá»ƒ bá»‹ cáº¯t ngáº¯n náº¿u chÃºng quÃ¡ dÃ i vÃ  Ä‘iá»u Ä‘Ã³ sáº½ dáº«n Ä‘áº¿n viá»‡c máº¥t thÃ´ng tin cÃ³ thá»ƒ há»¯u Ã­ch cho tÃ¡c vá»¥ mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯!</p>
<p>VÃ¬ váº­y, Ä‘á»ƒ báº¯t Ä‘áº§u, trÆ°á»›c tiÃªn chÃºng ta sáº½ tokenize kho tÃ i liá»‡u cá»§a mÃ¬nh nhÆ° bÃ¬nh thÆ°á»ng, nhÆ°ng <em>khÃ´ng</em> Ä‘áº·t tÃ¹y chá»n <code>truncation=True</code> trong trÃ¬nh tokenize cá»§a chÃºng ta. ChÃºng ta cÅ©ng sáº½ láº¥y cÃ¡c ID tá»« náº¿u chÃºng cÃ³ sáºµn ((chÃºng sáº½ cÃ³ sáºµn náº¿u ta Ä‘ang sá»­ dá»¥ng cÃ´ng cá»¥ tokenize nhanh, nhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong <a href="/course/chap6/3">ChÆ°Æ¡ng 6</a>), vÃ¬ ta sáº½ cáº§n chÃºng sau nÃ y Ä‘á»ƒ thá»±c hiá»‡n che toÃ n bá»™ tá»«. ChÃºng ta sáº½ gÃ³i nÃ³ trong má»™t hÃ m Ä‘Æ¡n giáº£n vÃ  trong khi thá»±c hiá»‡n, ta sáº½ xÃ³a cÃ¡c cá»™t <code>text</code> vÃ  <code>label</code> vÃ¬ khÃ´ng cáº§n chÃºng ná»¯a:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">examples</span>):
    result = tokenizer(examples[<span class="hljs-string">&quot;text&quot;</span>])
    <span class="hljs-keyword">if</span> tokenizer.is_fast:
        result[<span class="hljs-string">&quot;word_ids&quot;</span>] = [result.word_ids(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(result[<span class="hljs-string">&quot;input_ids&quot;</span>]))]
    <span class="hljs-keyword">return</span> result


<span class="hljs-comment"># DÃ¹ng batched=True Ä‘á»ƒ kÃ­ch hoáº¡t Ä‘a luá»“ng nhanh!</span>
tokenized_datasets = imdb_dataset.<span class="hljs-built_in">map</span>(
    tokenize_function, batched=<span class="hljs-literal">True</span>, remove_columns=[<span class="hljs-string">&quot;text&quot;</span>, <span class="hljs-string">&quot;label&quot;</span>]
)
tokenized_datasets<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">25000</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">25000</span>
    })
    unsupervised: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">50000</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ DistilBERT lÃ  má»™t mÃ´ hÃ¬nh giá»‘ng nhÆ° BERT, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng cÃ¡c vÄƒn báº£n Ä‘Æ°á»£c tokenize bao gá»“m <code>input_ids</code> vÃ  <code>attention_mask</code> ta Ä‘Ã£ tháº¥y trong cÃ¡c chÆ°Æ¡ng khÃ¡c, cÅ©ng nhÆ° <code>word_ids</code> mÃ  ta Ä‘Ã£ thÃªm vÃ o.</p>
<p>Gá» chÃºng ta Ä‘Ã£ tokenize cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ phim cá»§a mÃ¬nh, bÆ°á»›c tiáº¿p theo lÃ  nhÃ³m táº¥t cáº£ chÃºng láº¡i vá»›i nhau vÃ  chia káº¿t quáº£ thÃ nh nhiá»u pháº§n. NhÆ°ng nhá»¯ng khá»‘i nÃ y pháº£i lá»›n Ä‘áº¿n má»©c nÃ o? Äiá»u nÃ y cuá»‘i cÃ¹ng sáº½ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi dung lÆ°á»£ng bá»™ nhá»› GPU mÃ  báº¡n cÃ³ sáºµn, nhÆ°ng Ä‘iá»ƒm khá»Ÿi Ä‘áº§u tá»‘t lÃ  xem kÃ­ch thÆ°á»›c ngá»¯ cáº£nh tá»‘i Ä‘a cá»§a mÃ´ hÃ¬nh lÃ  bao nhiÃªu. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c suy ra báº±ng cÃ¡ch kiá»ƒm tra thuá»™c tÃ­nh <code>model_max_length</code> cá»§a tokenizer:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.model_max_length<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">512</span><!-- HTML_TAG_END --></pre></div>
<p>GiÃ¡ trá»‹ nÃ y cÃ³ nguá»“n gá»‘c tá»« tá»‡p <em>tokenizer_config.json</em> Ä‘Æ°á»£c liÃªn káº¿t vá»›i má»™t checkpoint; trong trÆ°á»ng há»£p nÃ y, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng kÃ­ch thÆ°á»›c ngá»¯ cáº£nh lÃ  512 token, giá»‘ng nhÆ° vá»›i BERT.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Má»™t sá»‘ mÃ´ hÃ¬nh Transformer, nhÆ°<a href="https://huggingface.co/google/bigbird-roberta-base" rel="nofollow">BigBird</a> vÃ  <a href="hf.co/allenai/longformer-base-4096">Longformer</a>,cÃ³ Ä‘á»™ dÃ i ngá»¯ cáº£nh dÃ i hÆ¡n nhiá»u so vá»›i BERT vÃ  cÃ¡c mÃ´ hÃ¬nh Transformer Ä‘á»i Ä‘áº§u khÃ¡c. Khá»Ÿi táº¡o tokenizer cho má»™t trong nhá»¯ng checkpoint vÃ  xÃ¡c minh ráº±ng <code>model_max_length</code> tÆ°Æ¡ng á»©ng vá»›i nhá»¯ng gÃ¬ Ä‘Æ°á»£c trÃ­ch dáº«n trÃªn tháº» mÃ´ hÃ¬nh cá»§a nÃ³.</p></div>
<p>VÃ¬ váº­y, Ä‘á»ƒ cháº¡y cÃ¡c thá»­ nghiá»‡m trÃªn GPU nhÆ° nhá»¯ng GPU Ä‘Æ°á»£c tÃ¬m tháº¥y trÃªn Google Colab, chÃºng ta sáº½ chá»n thá»© gÃ¬ Ä‘Ã³ nhá» hÆ¡n má»™t chÃºt cÃ³ thá»ƒ vá»«a vá»›i bá»™ nhá»›:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->chunk_size = <span class="hljs-number">128</span><!-- HTML_TAG_END --></pre></div>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>LÆ°u Ã½ ráº±ng viá»‡c sá»­ dá»¥ng kÃ­ch thÆ°á»›c phÃ¢n Ä‘oáº¡n nhá» cÃ³ thá»ƒ gÃ¢y báº¥t lá»£i trong cÃ¡c tÃ¬nh huá»‘ng thá»±c táº¿, vÃ¬ váº­y báº¡n nÃªn sá»­ dá»¥ng kÃ­ch thÆ°á»›c tÆ°Æ¡ng á»©ng vá»›i trÆ°á»ng há»£p sá»­ dá»¥ng mÃ  báº¡n sáº½ Ã¡p dá»¥ng mÃ´ hÃ¬nh cá»§a mÃ¬nh.</p></div>
<p>BÃ¢y giá» Ä‘áº¿n pháº§n thÃº vá»‹. Äá»ƒ cho biáº¿t cÃ¡ch ná»‘i hoáº¡t Ä‘á»™ng, hÃ£y láº¥y má»™t vÃ i bÃ i Ä‘Ã¡nh giÃ¡ tá»« bá»™ huáº¥n luyá»‡n Ä‘Æ°á»£c tokenize vÃ  in ra sá»‘ lÆ°á»£ng token cho má»—i bÃ i Ä‘Ã¡nh giÃ¡:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-comment"># Táº¡o ra má»™t danh sÃ¡ch cÃ¡c danh sÃ¡ch cho tá»«ng Ä‘áº·c trÆ°ng</span>
tokenized_samples = tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>][:<span class="hljs-number">3</span>]

<span class="hljs-keyword">for</span> idx, sample <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(tokenized_samples[<span class="hljs-string">&quot;input_ids&quot;</span>]):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Review <span class="hljs-subst">{idx}</span> length: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(sample)}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Review 0 length: 200&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Review 1 length: 559&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Review 2 length: 192&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>We can then concatenate all these examples with a simple dictionary comprehension, as follows:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->concatenated_examples = {
    k: <span class="hljs-built_in">sum</span>(tokenized_samples[k], []) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> tokenized_samples.keys()
}
total_length = <span class="hljs-built_in">len</span>(concatenated_examples[<span class="hljs-string">&quot;input_ids&quot;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Concatenated reviews length: <span class="hljs-subst">{total_length}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Concatenated reviews length: 951&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t vá»i, tá»•ng Ä‘á»™ dÃ i Ä‘Ã£ Ä‘Æ°á»£c kiá»ƒm tra - vÃ¬ váº­y bÃ¢y giá» hÃ£y chia cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ Ä‘Æ°á»£c ná»‘i thÃ nh cÃ¡c pháº§n cÃ³ kÃ­ch thÆ°á»›c Ä‘Æ°á»£c cung cáº¥p bá»Ÿi <code>block_size</code>. Äá»ƒ lÃ m nhÆ° váº­y, chÃºng ta láº·p qua cÃ¡c Ä‘áº·c trÆ°ng trong <code>concatenated_examples</code> vÃ  sá»­ dá»¥ng kháº£ nÄƒng hiá»ƒu danh sÃ¡ch Ä‘á»ƒ táº¡o cÃ¡c pháº§n cá»§a tá»«ng Ä‘áº·c trÆ°ng. Káº¿t quáº£ lÃ  má»™t tá»« Ä‘iá»ƒn cÃ¡c khá»‘i cho tá»«ng Ä‘áº·c trÆ°ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->chunks = {
    k: [t[i : i + chunk_size] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, total_length, chunk_size)]
    <span class="hljs-keyword">for</span> k, t <span class="hljs-keyword">in</span> concatenated_examples.items()
}

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chunks[<span class="hljs-string">&quot;input_ids&quot;</span>]:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Chunk length: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(chunk)}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 128&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; Chunk length: 55&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y trong vÃ­ dá»¥ nÃ y, Ä‘oáº¡n cuá»‘i thÆ°á»ng sáº½ nhá» hÆ¡n kÃ­ch thÆ°á»›c Ä‘oáº¡n tá»‘i Ä‘a. CÃ³ hai chiáº¿n lÆ°á»£c chÃ­nh Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y:</p>
<ul><li>Bá» Ä‘oáº¡n cuá»‘i cÃ¹ng náº¿u nÃ³ nhá» hÆ¡n <code>chunk_size</code>.</li>
<li>Äá»‡m Ä‘oáº¡n cuá»‘i cÃ¹ng cho Ä‘áº¿n khi Ä‘á»™ dÃ i cá»§a nÃ³ báº±ng <code>chunk_size</code>.</li></ul>
<p>ChÃºng tÃ´i sáº½ thá»±c hiá»‡n cÃ¡ch tiáº¿p cáº­n Ä‘áº§u tiÃªn á»Ÿ Ä‘Ã¢y, vÃ¬ váº­y hÃ£y gÃ³i táº¥t cáº£ logic á»Ÿ trÃªn trong má»™t hÃ m duy nháº¥t mÃ  chÃºng tÃ´i cÃ³ thá»ƒ Ã¡p dá»¥ng cho táº­p dá»¯ liá»‡u Ä‘Æ°á»£c tokenize cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">group_texts</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-comment"># Ná»‘i táº¥t cáº£ cÃ¡c vÄƒn báº£n</span>
    concatenated_examples = {k: <span class="hljs-built_in">sum</span>(examples[k], []) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> examples.keys()}
    <span class="hljs-comment"># TÃ­nh Ä‘á»™ dÃ i cá»§a cÃ¡c vÄƒn báº£n Ä‘Æ°á»£c ná»‘i</span>
    total_length = <span class="hljs-built_in">len</span>(concatenated_examples[<span class="hljs-built_in">list</span>(examples.keys())[<span class="hljs-number">0</span>]])
    <span class="hljs-comment"># ChÃºng tÃ´i bá» Ä‘oáº¡n cuá»‘i cÃ¹ng náº¿u nÃ³ nhá» hÆ¡n chunk_size</span>
    total_length = (total_length // chunk_size) * chunk_size
    <span class="hljs-comment"># Chia pháº§n theo max_len</span>
    result = {
        k: [t[i : i + chunk_size] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, total_length, chunk_size)]
        <span class="hljs-keyword">for</span> k, t <span class="hljs-keyword">in</span> concatenated_examples.items()
    }
    <span class="hljs-comment"># Táº¡o cá»™t nhÃ£n má»›i</span>
    result[<span class="hljs-string">&quot;labels&quot;</span>] = result[<span class="hljs-string">&quot;input_ids&quot;</span>].copy()
    <span class="hljs-keyword">return</span> result<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng trong bÆ°á»›c cuá»‘i cÃ¹ng cá»§a <code>group_texts()</code>, chÃºng ta táº¡o má»™t cá»™t má»›i <code>labels</code> lÃ  báº£n sao cá»§a cá»™t <code>input_ids</code>. NhÆ° chÃºng ta sáº½ tháº¥y ngay sau Ä‘Ã¢y, Ä‘Ã³ lÃ  bá»Ÿi vÃ¬ trong mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i, má»¥c tiÃªu lÃ  dá»± Ä‘oÃ¡n cÃ¡c token Ä‘Æ°á»£c che ngáº«u nhiÃªn trong lÃ´ Ä‘áº§u vÃ o vÃ  báº±ng cÃ¡ch táº¡o cá»™t <code>labels</code>, chÃºng ta cung cáº¥p sá»± tháº­t cÆ¡ báº£n cho mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘á»ƒ há»c há»i.</p>
<p>BÃ¢y giá», hÃ£y Ã¡p dá»¥ng <code>group_texts()</code> cho cÃ¡c táº­p dá»¯ liá»‡u Ä‘Æ°á»£c tokenize cá»§a mÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>Dataset.map()</code> Ä‘Ã¡ng tin cáº­y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->lm_datasets = tokenized_datasets.<span class="hljs-built_in">map</span>(group_texts, batched=<span class="hljs-literal">True</span>)
lm_datasets<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;labels&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">61289</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;labels&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">59905</span>
    })
    unsupervised: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;labels&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">122963</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng viá»‡c nhÃ³m vÃ  sau Ä‘Ã³ phÃ¢n chia cÃ¡c Ä‘oáº¡n vÄƒn báº£n Ä‘Ã£ táº¡o ra nhiá»u máº«u hÆ¡n so vá»›i 25,000 máº«u ban Ä‘áº§u cá»§a chÃºng ta cho pháº§n tÃ¡ch <code>huáº¥n luyá»‡n</code> vÃ  <code>kiá»ƒm thá»­</code>. ÄÃ³ lÃ  bá»Ÿi vÃ¬ chÃºng ta hiá»‡n cÃ³ cÃ¡c máº«u liÃªn quan Ä‘áº¿n <em>token liÃªn tá»¥c</em> tráº£i dÃ i trÃªn nhiá»u máº«u tá»« kho tÃ i liá»‡u gá»‘c. Báº¡n cÃ³ thá»ƒ tháº¥y Ä‘iá»u nÃ y má»™t cÃ¡ch rÃµ rÃ ng báº±ng cÃ¡ch tÃ¬m kiáº¿m cÃ¡c token Ä‘áº·c biá»‡t <code>[SEP]</code> vÃ  <code>[CLS]</code> trong má»™t trong cÃ¡c pháº§n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.decode(lm_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;input_ids&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&quot;.... at.......... high. a classic line : inspector : i&#x27;m here to sack one of your teachers. student : welcome to bromwell high. i expect that many adults of my age think that bromwell high is far fetched. what a pity that it isn&#x27;t! [SEP] [CLS] homelessness ( or houselessness as george carlin stated ) has been an issue for years but never a plan to help those on the street that were once considered human who did everything from going to school, work, or vote for the matter. most people think of the homeless&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>Trong vÃ­ dá»¥ nÃ y, báº¡n cÃ³ thá»ƒ tháº¥y hai bÃ i Ä‘Ã¡nh giÃ¡ phim trÃ¹ng nhau, má»™t bÃ i vá» phim cáº¥p ba vÃ  bÃ i cÃ²n láº¡i vá» tÃ¬nh tráº¡ng vÃ´ gia cÆ°. HÃ£y cÅ©ng xem cÃ¡c nhÃ£n trÃ´ng nhÆ° tháº¿ nÃ o cho mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.decode(lm_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;labels&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&quot;.... at.......... high. a classic line : inspector : i&#x27;m here to sack one of your teachers. student : welcome to bromwell high. i expect that many adults of my age think that bromwell high is far fetched. what a pity that it isn&#x27;t! [SEP] [CLS] homelessness ( or houselessness as george carlin stated ) has been an issue for years but never a plan to help those on the street that were once considered human who did everything from going to school, work, or vote for the matter. most people think of the homeless&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÆ° mong Ä‘á»£i tá»« hÃ m <code>group_texts()</code> cá»§a chÃºng ta á»Ÿ trÃªn, hÃ m nÃ y trÃ´ng giá»‘ng há»‡t vá»›i <code>input_ids</code> Ä‘Ã£ Ä‘Æ°á»£c giáº£i mÃ£ - nhÆ°ng sau Ä‘Ã³ lÃ m tháº¿ nÃ o Ä‘á»ƒ mÃ´ hÃ¬nh cá»§a chÃºng ta cÃ³ thá»ƒ há»c Ä‘Æ°á»£c báº¥t cá»© Ä‘iá»u gÃ¬? ChÃºng ta Ä‘ang thiáº¿u má»™t bÆ°á»›c quan trá»ng: chÃ¨n token <code>[MASK]</code> á»Ÿ cÃ¡c vá»‹ trÃ­ ngáº«u nhiÃªn trong Ä‘áº§u vÃ o! HÃ£y xem cÃ¡ch chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y má»™t cÃ¡ch nhanh chÃ³ng trong quÃ¡ trÃ¬nh tinh chá»‰nh báº±ng cÃ´ng cá»¥ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u Ä‘áº·c biá»‡t.</p>
<h2 class="relative group"><a id="tinh-chnh-distilbert-vi-api-trainer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-distilbert-vi-api-trainer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh DistilBERT vá»›i API <code>Trainer</code></span></h2>

<p>Tinh chá»‰nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i gáº§n giá»‘ng nhÆ° tinh chá»‰nh mÃ´ hÃ¬nh phÃ¢n loáº¡i chuá»—i, giá»‘ng nhÆ° chÃºng ta Ä‘Ã£ lÃ m trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>. Sá»± khÃ¡c biá»‡t duy nháº¥t lÃ  chÃºng ta cáº§n má»™t trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u Ä‘áº·c biá»‡t cÃ³ thá»ƒ che giáº¥u ngáº«u nhiÃªn má»™t sá»‘ token trong má»—i lÃ´ vÄƒn báº£n. May máº¯n thay, ğŸ¤— Transformers Ä‘Æ°á»£c chuáº©n bá»‹ vá»›i má»™t <code>DataCollatorForLanguageModeling</code> dÃ nh riÃªng cho tÃ¡c vá»¥ nÃ y. ChÃºng ta chá»‰ cáº§n chuyá»ƒn nÃ³ vÃ o tokenizer vÃ  tham sá»‘ <code>mlm_probability</code> Ä‘á»ƒ chá»‰ Ä‘á»‹nh pháº§n nÃ o trong sá»‘ cÃ¡c token cáº§n che. ChÃºng tÃ´i sáº½ chá»n 15%, lÃ  sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng cho BERT vÃ  má»™t lá»±a chá»n phá»• biáº¿n trong cÃ¡c tÃ i liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> DataCollatorForLanguageModeling

data_collator = DataCollatorForLanguageModeling(tokenizer=tokenizer, mlm_probability=<span class="hljs-number">0.15</span>)<!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ xem cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a viá»‡c che ngáº«u nhiÃªn, hÃ£y cung cáº¥p má»™t vÃ i máº«u cho trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u. VÃ¬ nÃ³ mong Ä‘á»£i má»™t danh sÃ¡ch cÃ¡c <code>dict</code>, trong Ä‘Ã³ má»—i <code>dict</code> Ä‘áº¡i diá»‡n cho má»™t Ä‘oáº¡n vÄƒn báº£n liá»n ká», Ä‘áº§u tiÃªn chÃºng ta láº·p táº­p dá»¯ liá»‡u trÆ°á»›c khi cung cáº¥p lÃ´ cho bá»™ Ä‘á»‘i chiáº¿u. ChÃºng ta xÃ³a khÃ³a <code>&quot;word_ids&quot;</code> cho trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u nÃ y vÃ¬ nÃ³ khÃ´ng cáº§n chÃºng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->samples = [lm_datasets[<span class="hljs-string">&quot;train&quot;</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]
<span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> samples:
    _ = sample.pop(<span class="hljs-string">&quot;word_ids&quot;</span>)

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> data_collator(samples)[<span class="hljs-string">&quot;input_ids&quot;</span>]:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; <span class="hljs-subst">{tokenizer.decode(chunk)}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; [CLS] bromwell [MASK] is a cartoon comedy. it ran at the same [MASK] as some other [MASK] about school life, [MASK] as &quot; teachers &quot;. [MASK] [MASK] [MASK] in the teaching [MASK] lead [MASK] to believe that bromwell high\&#x27;[MASK] satire is much closer to reality than is &quot; teachers &quot;. the scramble [MASK] [MASK] financially, the [MASK]ful students whogn [MASK] right through [MASK] pathetic teachers\&#x27;pomp, the pettiness of the whole situation, distinction remind me of the schools i knew and their students. when i saw [MASK] episode in [MASK] a student repeatedly tried to burn down the school, [MASK] immediately recalled. [MASK]...&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; .... at.. [MASK]... [MASK]... high. a classic line plucked inspector : i\&#x27;[MASK] here to [MASK] one of your [MASK]. student : welcome to bromwell [MASK]. i expect that many adults of my age think that [MASK]mwell [MASK] is [MASK] fetched. what a pity that it isn\&#x27;t! [SEP] [CLS] [MASK]ness ( or [MASK]lessness as george å®‡in stated )å…¬ been an issue for years but never [MASK] plan to help those on the street that were once considered human [MASK] did everything from going to school, [MASK], [MASK] vote for the matter. most people think [MASK] the homeless&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Tá»‘t, nÃ³ Ä‘Ã£ hoáº¡t Ä‘á»™ng! ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng <code>[MASK]</code> Ä‘Ã£ Ä‘Æ°á»£c chÃ¨n ngáº«u nhiÃªn táº¡i cÃ¡c vá»‹ trÃ­ khÃ¡c nhau trong vÄƒn báº£n. ÄÃ¢y sáº½ lÃ  nhá»¯ng token mÃ  mÃ´ hÃ¬nh sáº½ pháº£i dá»± Ä‘oÃ¡n trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n - vÃ  cÃ¡i hay cá»§a cÃ´ng cá»¥ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u lÃ  nÃ³ sáº½ ngáº«u nhiÃªn chÃ¨n <code>[MASK]</code> vá»›i má»i lÃ´!</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Cháº¡y Ä‘oáº¡n mÃ£ trÃªn vÃ i láº§n Ä‘á»ƒ xem viá»‡c che ngáº«u nhiÃªn diá»…n ra ngay trÆ°á»›c máº¯t báº¡n! Äá»“ng thá»i  thá»­ thay tháº¿ phÆ°Æ¡ng thá»©c <code>tokenizer.decode()</code> báº±ng <code>tokenizer.convert_ids_to_tokens()</code> Ä‘á»ƒ tháº¥y ráº±ng Ä‘Ã´i khi má»™t token tá»« má»™t tá»« nháº¥t Ä‘á»‹nh bá»‹ che, chá»© khÃ´ng pháº£i nhá»¯ng cÃ¡i khÃ¡c.</p></div>
<p>Má»™t tÃ¡c dá»¥ng phá»¥ cá»§a viá»‡c che ngáº«u nhiÃªn lÃ  cÃ¡c chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡ cá»§a chÃºng ta sáº½ khÃ´ng xÃ¡c Ä‘á»‹nh khi sá»­ dá»¥ng <code>Trainer</code>, vÃ¬ chÃºng ta sá»­ dá»¥ng cÃ¹ng má»™t cÃ´ng cá»¥ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u cho cÃ¡c táº­p huáº¥n luyá»‡n vÃ  kiá»ƒm thá»§. ChÃºng ta sáº½ tháº¥y á»Ÿ pháº§n sau, khi chÃºng ta xem xÃ©t viá»‡c tinh chá»‰nh vá»›i ğŸ¤— Accelerate, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tÃ­nh linh hoáº¡t cá»§a vÃ²ng Ä‘Ã¡nh giÃ¡ tÃ¹y chá»‰nh nhÆ° tháº¿ nÃ o Ä‘á»ƒ Ä‘Ã³ng bÄƒng tÃ­nh ngáº«u nhiÃªn.</p>
<p>Khi huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh Ä‘á»ƒ táº¡o mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº©n Ä‘i, má»™t ká»¹ thuáº­t cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  ghÃ©p cÃ¡c tá»« láº¡i vá»›i nhau, khÃ´ng chá»‰ cÃ¡c token riÃªng láº». CÃ¡ch tiáº¿p cáº­n nÃ y Ä‘Æ°á»£c gá»i lÃ  <em>whole word masking</em> hay <em>che toÃ n bá»™ tá»«</em>. Náº¿u chÃºng ta muá»‘n che toÃ n bá»™ tá»«, chÃºng ta sáº½ cáº§n pháº£i tá»± xÃ¢y dá»±ng má»™t bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u. Bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u chá»‰ lÃ  má»™t chá»©c nÄƒng láº¥y danh sÃ¡ch cÃ¡c máº«u vÃ  chuyá»ƒn Ä‘á»•i chÃºng thÃ nh má»™t lÃ´, vÃ¬ váº­y hÃ£y lÃ m Ä‘iá»u nÃ y ngay bÃ¢y giá»! ChÃºng ta sáº½ sá»­ dá»¥ng cÃ¡c ID tá»« Ä‘Ã£ tÃ­nh toÃ¡n trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ táº¡o báº£n Ä‘á»“ giá»¯a cÃ¡c chá»‰ sá»‘ tá»« vÃ  cÃ¡c mÃ£ thÃ´ng bÃ¡o tÆ°Æ¡ng á»©ng, sau Ä‘Ã³ quyáº¿t Ä‘á»‹nh ngáº«u nhiÃªn nhá»¯ng tá»« nÃ o cáº§n che vÃ  che cÃ¡c Ä‘áº§u vÃ o. LÆ°u Ã½ ráº±ng táº¥t cáº£ cÃ¡c nhÃ£n Ä‘á»u lÃ  <code>-100</code> ngoáº¡i trá»« cÃ¡c nhÃ£n tÆ°Æ¡ng á»©ng vá»›i cÃ¡c tá»« bá»‹ che.</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> collections
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> default_data_collator

wwm_probability = <span class="hljs-number">0.2</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">whole_word_masking_data_collator</span>(<span class="hljs-params">features</span>):
    <span class="hljs-keyword">for</span> feature <span class="hljs-keyword">in</span> features:
        word_ids = feature.pop(<span class="hljs-string">&quot;word_ids&quot;</span>)

        <span class="hljs-comment"># Táº¡o ra Ã¡nh xáº¡ giá»¯a cÃ¡c tá»« vÃ  chá»‰ má»¥c token tÆ°Æ¡ng á»©ng</span>
        mapping = collections.defaultdict(<span class="hljs-built_in">list</span>)
        current_word_index = -<span class="hljs-number">1</span>
        current_word = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">for</span> idx, word_id <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(word_ids):
            <span class="hljs-keyword">if</span> word_id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
                <span class="hljs-keyword">if</span> word_id != current_word:
                    current_word = word_id
                    current_word_index += <span class="hljs-number">1</span>
                mapping[current_word_index].append(idx)

        <span class="hljs-comment"># Che ngáº«u nhiá»n tá»«</span>
        mask = np.random.binomial(<span class="hljs-number">1</span>, wwm_probability, (<span class="hljs-built_in">len</span>(mapping),))
        input_ids = feature[<span class="hljs-string">&quot;input_ids&quot;</span>]
        labels = feature[<span class="hljs-string">&quot;labels&quot;</span>]
        new_labels = [-<span class="hljs-number">100</span>] * <span class="hljs-built_in">len</span>(labels)
        <span class="hljs-keyword">for</span> word_id <span class="hljs-keyword">in</span> np.where(mask)[<span class="hljs-number">0</span>]:
            word_id = word_id.item()
            <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> mapping[word_id]:
                new_labels[idx] = labels[idx]
                input_ids[idx] = tokenizer.mask_token_id
        feature[<span class="hljs-string">&quot;labels&quot;</span>] = new_labels

    <span class="hljs-keyword">return</span> default_data_collator(features)<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, ta cso thá»ƒ thá»­ trÃªn má»™t vÃ i máº«u nhÆ° trÃªn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->samples = [lm_datasets[<span class="hljs-string">&quot;train&quot;</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]
batch = whole_word_masking_data_collator(samples)

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> batch[<span class="hljs-string">&quot;input_ids&quot;</span>]:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; <span class="hljs-subst">{tokenizer.decode(chunk)}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; [CLS] bromwell high is a cartoon comedy [MASK] it ran at the same time as some other programs about school life, such as &quot; teachers &quot;. my 35 years in the teaching profession lead me to believe that bromwell high\&#x27;s satire is much closer to reality than is &quot; teachers &quot;. the scramble to survive financially, the insightful students who can see right through their pathetic teachers\&#x27;pomp, the pettiness of the whole situation, all remind me of the schools i knew and their students. when i saw the episode in which a student repeatedly tried to burn down the school, i immediately recalled.....&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; .... [MASK] [MASK] [MASK] [MASK]....... high. a classic line : inspector : i\&#x27;m here to sack one of your teachers. student : welcome to bromwell high. i expect that many adults of my age think that bromwell high is far fetched. what a pity that it isn\&#x27;t! [SEP] [CLS] homelessness ( or houselessness as george carlin stated ) has been an issue for years but never a plan to help those on the street that were once considered human who did everything from going to school, work, or vote for the matter. most people think of the homeless&#x27;</span><!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Cháº¡y Ä‘oáº¡n mÃ£ trÃªn vÃ i láº§n Ä‘á»ƒ xem viá»‡c che ngáº«u nhiÃªn diá»…n ra ngay trÆ°á»›c máº¯t báº¡n! Äá»“ng thá»i  thá»­ thay tháº¿ phÆ°Æ¡ng thá»©c <code>tokenizer.decode()</code> báº±ng <code>tokenizer.convert_ids_to_tokens()</code> Ä‘á»ƒ tháº¥y ráº±ng Ä‘Ã´i khi má»™t token tá»« má»™t tá»« nháº¥t Ä‘á»‹nh bá»‹ che, chá»© khÃ´ng pháº£i nhá»¯ng cÃ¡i khÃ¡c.</p></div>
<p>Giá» chÃºng ta cÃ³ hai trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u, pháº§n cÃ²n láº¡i cá»§a cÃ¡c bÆ°á»›c tinh chá»‰nh lÃ  tiÃªu chuáº©n. QuÃ¡ trÃ¬nh huáº¥n luyá»‡n cÃ³ thá»ƒ máº¥t má»™t khoáº£ng thá»i gian trÃªn Google Colab náº¿u báº¡n khÃ´ng Ä‘á»§ may máº¯n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c GPU P100 tháº§n thoáº¡i ğŸ˜­, vÃ¬ váº­y, trÆ°á»›c tiÃªn chÃºng ta sáº½ giáº£m kÃ­ch thÆ°á»›c cá»§a táº­p huáº¥n luyá»‡n xuá»‘ng cÃ²n vÃ i nghÃ¬n máº«u. Äá»«ng lo láº¯ng, chÃºng ta sáº½ váº«n nháº­n Ä‘Æ°á»£c má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ khÃ¡ tá»‘t! Má»™t cÃ¡ch nhanh chÃ³ng Ä‘á»ƒ giáº£m máº«u má»™t táº­p dá»¯ liá»‡u trong ğŸ¤— Datasets lÃ  thÃ´ng qua hÃ m <code>Dataset.train_test_split()</code> mÃ  chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter5">Chapter 5</a>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->train_size = <span class="hljs-number">10_000</span>
test_size = <span class="hljs-built_in">int</span>(<span class="hljs-number">0.1</span> * train_size)

downsampled_dataset = lm_datasets[<span class="hljs-string">&quot;train&quot;</span>].train_test_split(
    train_size=train_size, test_size=test_size, seed=<span class="hljs-number">42</span>
)
downsampled_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;labels&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">10000</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;labels&#x27;</span>, <span class="hljs-string">&#x27;word_ids&#x27;</span>],
        num_rows: <span class="hljs-number">1000</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y Ä‘Ã£ tá»± Ä‘á»™ng táº¡o cÃ¡c pháº§n tÃ¡ch <code>huáº¥n luyá»‡n</code> vÃ  <code>kiá»ƒm thá»­</code> má»›i, vá»›i kÃ­ch thÆ°á»›c táº­p huáº¥n luyá»‡n Ä‘Æ°á»£c Ä‘áº·t thÃ nh 10,000 máº«u vÃ  xÃ¡c thá»±c Ä‘Æ°á»£c Ä‘áº·t thÃ nh 10% - vui lÃ²ng tÄƒng Ä‘iá»u nÃ y náº¿u báº¡n cÃ³ GPU máº¡nh! Äiá»u tiáº¿p theo chÃºng ta cáº§n lÃ m lÃ  Ä‘Äƒng nháº­p vÃ o Hugging Face Hub. Náº¿u báº¡n Ä‘ang cháº¡y mÃ£ nÃ y trong notebook, báº¡n cÃ³ thá»ƒ lÃ m nhÆ° váº­y vá»›i chá»©c nÄƒng tiá»‡n Ã­ch sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>sáº½ hiá»ƒn thá»‹ má»™t tiá»‡n Ã­ch mÃ  báº¡n cÃ³ thá»ƒ nháº­p thÃ´ng tin Ä‘Äƒng nháº­p cá»§a mÃ¬nh. NgoÃ i ra, báº¡n cÃ³ thá»ƒ cháº¡y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-<span class="hljs-keyword">cli</span> login<!-- HTML_TAG_END --></pre></div>
<p>trong thiáº¿t bá»‹ Ä‘áº§u cuá»‘i yÃªu thÃ­ch cá»§a báº¡n vÃ  Ä‘Äƒng nháº­p á»Ÿ Ä‘Ã³.</p>
<p>Khi Ä‘Ã£ Ä‘Äƒng nháº­p, chÃºng ta cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c tham sá»‘ cho <code>Trainer</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

batch_size = <span class="hljs-number">64</span>
<span class="hljs-comment"># In ra sá»± máº¥t mÃ¡t khi huáº¥n luyá»‡n á»Ÿ má»—i epoch</span>
logging_steps = <span class="hljs-built_in">len</span>(downsampled_dataset[<span class="hljs-string">&quot;train&quot;</span>]) // batch_size
model_name = model_checkpoint.split(<span class="hljs-string">&quot;/&quot;</span>)[-<span class="hljs-number">1</span>]

training_args = TrainingArguments(
    output_dir=<span class="hljs-string">f&quot;<span class="hljs-subst">{model_name}</span>-finetuned-imdb&quot;</span>,
    overwrite_output_dir=<span class="hljs-literal">True</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
    per_device_train_batch_size=batch_size,
    per_device_eval_batch_size=batch_size,
    push_to_hub=<span class="hljs-literal">True</span>,
    fp16=<span class="hljs-literal">True</span>,
    logging_steps=logging_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>á» Ä‘Ã¢y, chÃºng ta Ä‘Ã£ Ä‘iá»u chá»‰nh má»™t sá»‘ tÃ¹y chá»n máº·c Ä‘á»‹nh, bao gá»“m <code>log_steps</code> Ä‘á»ƒ Ä‘áº£m báº£o theo dÃµi sá»± máº¥t mÃ¡t trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n theo tá»«ng epoch. ChÃºng ta cÅ©ng Ä‘Ã£ sá»­ dá»¥ng <code>fp16=True</code> Ä‘á»ƒ cho phÃ©p huáº¥n luyá»‡n chÃ­nh xÃ¡c há»—n há»£p, giÃºp tÄƒng tá»‘c Ä‘á»™. Theo máº·c Ä‘á»‹nh, <code>Trainer</code> sáº½ loáº¡i bá» báº¥t ká»³ cá»™t nÃ o khÃ´ng pháº£i lÃ  má»™t pháº§n cá»§a phÆ°Æ¡ng thá»©c <code>forward()</code> cá»§a mÃ´ hÃ¬nh. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u báº¡n Ä‘ang sá»­ dá»¥ng cÃ´ng cá»¥ che toÃ n bá»™ tá»«, báº¡n cÅ©ng cáº§n Ä‘áº·t <code>remove_unused_columns=False</code> Ä‘á»ƒ Ä‘áº£m báº£o chÃºng ta khÃ´ng máº¥t cá»™t <code>word_ids</code> trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n.</p>
<p>LÆ°u Ã½ ráº±ng báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh tÃªn cá»§a kho lÆ°u trá»¯ mÃ  báº¡n muá»‘n Ä‘áº©y Ä‘áº¿n báº±ng tham sá»‘ <code>hub_model_id</code> (cá»¥ thá»ƒ lÃ  báº¡n sáº½ pháº£i sá»­ dá»¥ng tham sá»‘ nÃ y Ä‘á»ƒ Ä‘áº©y Ä‘áº¿n má»™t tá»• chá»©c). VÃ­ dá»¥: khi chÃºng ta Ä‘áº©y mÃ´ hÃ¬nh vÃ o tá»• chá»©c <a href="https://huggingface.co/huggingface-course" rel="nofollow"><code>huggingface-course</code></a>, chÃºng ta Ä‘Ã£ thÃªm <code>hub_model_id=&quot;huggingface-course/distilbert-finetuned-imdb&quot;</code> vÃ o <code>TrainingArguments</code>. Theo máº·c Ä‘á»‹nh, kho lÆ°u trá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng sáº½ náº±m trong khÃ´ng gian tÃªn cá»§a báº¡n vÃ  Ä‘Æ°á»£c Ä‘áº·t tÃªn theo thÆ° má»¥c Ä‘áº§u ra mÃ  báº¡n Ä‘Ã£ Ä‘áº·t, vÃ¬ váº­y trong trÆ°á»ng há»£p cá»§a chÃºng ta, nÃ³ sáº½ lÃ <code>&quot;lewtun/distilbert-finetuned-imdb&quot;</code>.</p>
<p>BÃ¢y giá» chÃºng ta cÃ³ táº¥t cáº£ cÃ¡c thÃ nh pháº§n Ä‘á»ƒ táº¡o ra <code>Trainer</code>. á» Ä‘Ã¢y chÃºng ta chá»‰ sá»­ dá»¥ng <code>data_collator</code> tiÃªu chuáº©n, nhÆ°ng báº¡n cÃ³ thá»ƒ thá»­ toÃ n bá»™ cÃ´ng cá»¥ che toÃ n bá»™ tá»« vÃ  so sÃ¡nh káº¿t quáº£ nhÆ° má»™t bÃ i táº­p:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=downsampled_dataset[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=downsampled_dataset[<span class="hljs-string">&quot;test&quot;</span>],
    data_collator=data_collator,
)<!-- HTML_TAG_END --></pre></div>
<p>Giá» chÃºng ta Ä‘Ã£ sáºµn sÃ ng cháº¡y <code>trainer.train()</code> - nhÆ°ng trÆ°á»›c khi lÃ m nhÆ° váº­y, chÃºng ta hÃ£y xem xÃ©t ngáº¯n gá»n <em>perplexity</em>, lÃ  má»™t chá»‰ sá»‘ phá»• biáº¿n Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯.</p>
<h3 class="relative group"><a id="perplexity-cho-m-hnh-ngn-ng" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#perplexity-cho-m-hnh-ngn-ng"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Perplexity cho mÃ´ hÃ¬nh ngÃ´n ngá»¯
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/NURcDHhYe98" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>KhÃ´ng giá»‘ng nhÆ° cÃ¡c tÃ¡c vá»¥ khÃ¡c nhÆ° phÃ¢n loáº¡i vÄƒn báº£n hoáº·c há»i Ä‘Ã¡p mÃ  chÃºng ta Ä‘Æ°á»£c cung cáº¥p má»™t kho ngá»¯ liá»‡u Ä‘Æ°á»£c gáº¯n nhÃ£n Ä‘á»ƒ huáº¥n luyá»‡n, vá»›i mÃ´ hÃ¬nh ngÃ´n ngá»¯, ta khÃ´ng cÃ³ báº¥t ká»³ nhÃ£n rÃµ rÃ ng nÃ o. Váº­y lÃ m cÃ¡ch nÃ o Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘iá»u gÃ¬ táº¡o nÃªn má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»‘t? Giá»‘ng nhÆ° tÃ­nh nÄƒng tá»± Ä‘á»™ng sá»­a lá»—i trong Ä‘iá»‡n thoáº¡i cá»§a báº¡n, má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»‘t lÃ  má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ chá»‰ Ä‘á»‹nh xÃ¡c suáº¥t cao cho cÃ¡c cÃ¢u Ä‘Ãºng ngá»¯ phÃ¡p vÃ  xÃ¡c suáº¥t tháº¥p cho cÃ¡c cÃ¢u vÃ´ nghÄ©a. Äá»ƒ giÃºp báº¡n biáº¿t rÃµ hÆ¡n vá» hÃ¬nh thá»©c nÃ y, báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y toÃ n bá»™ táº­p há»£p â€œtá»± Ä‘á»™ng sá»­a lá»—iâ€ trá»±c tuyáº¿n, trong Ä‘Ã³ mÃ´ hÃ¬nh trong Ä‘iá»‡n thoáº¡i Ä‘Ã£ táº¡o ra má»™t sá»‘ hoÃ n thÃ nh khÃ¡ hÃ i hÆ°á»›c (vÃ  thÆ°á»ng khÃ´ng phÃ¹ há»£p)!</p>
<p>Giáº£ sá»­ bá»™ kiá»ƒm thá»­ cá»§a chÃºng ta bao gá»“m háº§u háº¿t cÃ¡c cÃ¢u Ä‘Ãºng ngá»¯ phÃ¡p, thÃ¬ má»™t cÃ¡ch Ä‘á»ƒ Ä‘o lÆ°á»ng cháº¥t lÆ°á»£ng cá»§a mÃ´ hÃ¬nh ngÃ´n ngá»¯ lÃ  tÃ­nh toÃ¡n xÃ¡c suáº¥t nÃ³ gÃ¡n cho tá»« tiáº¿p theo trong táº¥t cáº£ cÃ¡c cÃ¢u cá»§a bá»™ kiá»ƒm thá»­. Kháº£ nÄƒng xáº£y ra cao chá»‰ ra ráº±ng mÃ´ hÃ¬nh khÃ´ng bá»‹ â€œngáº¡c nhiÃªnâ€ hoáº·c â€œbá»‘i rá»‘iâ€ bá»Ÿi cÃ¡c máº«u khÃ´ng nhÃ¬n tháº¥y vÃ  cho tháº¥y nÃ³ Ä‘Ã£ há»c Ä‘Æ°á»£c cÃ¡c máº«u ngá»¯ phÃ¡p cÆ¡ báº£n trong ngÃ´n ngá»¯. CÃ³ nhiá»u Ä‘á»‹nh nghÄ©a toÃ¡n há»c khÃ¡c nhau vá» perplexity, nhÆ°ng chÃºng ta sáº½ sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a lÃ  hÃ m mÅ© cá»§a máº¥t mÃ¡t entropy chÃ©o. Do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ tÃ­nh toÃ¡n perplexity cá»§a mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c cá»§a mÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m <code>Trainer.evaluate()</code> Ä‘á»ƒ tÃ­nh toÃ¡n máº¥t mÃ¡t entropy chÃ©o trÃªn táº­p kiá»ƒm thá»­ vÃ  sau Ä‘Ã³ láº¥y theo cáº¥p sá»‘ nhÃ¢n cá»§a káº¿t quáº£:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> math

eval_results = trainer.evaluate()
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&gt;&gt;&gt; Perplexity: <span class="hljs-subst">{math.exp(eval_results[<span class="hljs-string">&#x27;eval_loss&#x27;</span>]):<span class="hljs-number">.2</span>f}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-meta">&gt;&gt;&gt; </span>Perplexity: <span class="hljs-number">21.75</span><!-- HTML_TAG_END --></pre></div>
<p>Perplexity tháº¥p hÆ¡n cÃ³ nghÄ©a lÃ  má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»‘t hÆ¡n vÃ  chÃºng ta cÃ³ thá»ƒ tháº¥y á»Ÿ Ä‘Ã¢y ráº±ng mÃ´ hÃ¬nh báº¯t Ä‘áº§u cá»§a chÃºng ta cÃ³ má»™t giÃ¡ trá»‹ hÆ¡i lá»›n. HÃ£y xem liá»‡u chÃºng ta cÃ³ thá»ƒ háº¡ tháº¥p nÃ³ báº±ng cÃ¡ch tinh chá»‰nh khÃ´ng! Äá»ƒ lÃ m Ä‘iá»u Ä‘Ã³, trÆ°á»›c tiÃªn chÃºng ta cháº¡y vÃ²ng láº·p huáº¥n luyá»‡n:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>vÃ  sau Ä‘Ã³ tÃ­nh káº¿t quáº£ perplexity trÃªn táº­p kiá»ƒm thá»­:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->eval_results = trainer.evaluate()
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&gt;&gt;&gt; Perplexity: <span class="hljs-subst">{math.exp(eval_results[<span class="hljs-string">&#x27;eval_loss&#x27;</span>]):<span class="hljs-number">.2</span>f}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-meta">&gt;&gt;&gt; </span>Perplexity: <span class="hljs-number">11.32</span><!-- HTML_TAG_END --></pre></div>
<p>Tá»‘t â€” nÃ³ giáº£m perplexity, cho tháº¥y mÃ´ hÃ¬nh Ä‘Ã£ há»c Ä‘Æ°á»£c Ä‘iá»u gÃ¬ Ä‘Ã³ vá» máº£ng Ä‘Ã¡nh giÃ¡ phim!</p>
<p>Sau khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n káº¿t thÃºc, chÃºng ta cÃ³ thá»ƒ Ä‘áº©y tháº» mÃ´ hÃ¬nh cÃ³ thÃ´ng tin huáº¥n luyá»‡n vÃ o Hub (cÃ¡c checkpoint Ä‘Æ°á»£c lÆ°u trong quÃ¡ trÃ¬nh tá»± huáº¥n luyá»‡n):</p>
<p>Once training is finished, we can push the model card with the training information to the Hub (the checkpoints are saved during training itself):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub()<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> Cháº¡y bÆ°á»›chuáº¥n luyá»‡n trÃªn sau khi thay Ä‘á»•i trÃ¬nh thu tháº­p dá»¯ liá»‡u thÃ nh che toÃ n bá»™ tá»«. Báº¡n cÃ³ nháº­n Ä‘Æ°á»£c káº¿t quáº£ tá»‘t hÆ¡n khÃ´ng?</p></div>
<p>Trong trÆ°á»ng há»£p cá»§a mÃ¬nh, chÃºng ta khÃ´ng cáº§n lÃ m gÃ¬ Ä‘áº·c biá»‡t vá»›i vÃ²ng huáº¥n luyá»‡n, nhÆ°ng má»™t sá»‘ trÆ°á»ng há»£p báº¡n sáº½ cáº§n pháº£i triá»ƒn khai má»™t sá»‘ logic tuá»³ chá»‰nh. Vá»›i nhá»¯ng á»©ng dá»¥ng nÃ y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng ğŸ¤— Accelerate â€” hÃ£y cÅ©ng xem xem!</p>
<h2 class="relative group"><a id="tinh-chnh-distilbert-vi-accelerate" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-distilbert-vi-accelerate"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh DistilBERT vá»›i ğŸ¤— Accelerate
	</span></h2>

<p>NhÆ° chÃºng ta Ä‘Ã£ tháº¥y vá»›i <code>Trainer</code>, viá»‡c tinh chá»‰nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ bá»‹ áº£n Ä‘i ráº¥t giá»‘ng vá»›i vÃ­ dá»¥ phÃ¢n loáº¡i vÄƒn báº£n tá»« <a href="/course/chapter3">Chapter 3</a>. TrÃªn thá»±c táº¿, sá»± tinh táº¿ duy nháº¥t lÃ  viá»‡c sá»­ dá»¥ng má»™t cÃ´ng cá»¥ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u Ä‘áº·c biá»‡t vÃ  chÃºng ta Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n Ä‘iá»u Ä‘Ã³ trÆ°á»›c Ä‘Ã³ trong pháº§n nÃ y!</p>
<p>Tuy nhiÃªn, chÃºng ta tháº¥y ráº±ng <code>DataCollatorForLanguageModeling</code> cÅ©ng Ã¡p dá»¥ng tÃ­nh nÄƒng che ngáº«u nhiÃªn vá»›i má»—i láº§n Ä‘Ã¡nh giÃ¡, vÃ¬ váº­y chÃºng ta sáº½ tháº¥y má»™t sá»‘ biáº¿n Ä‘á»™ng vá» perplexity vá»›i má»—i láº§n cháº¡y huáº¥n luyá»‡n. Má»™t cÃ¡ch Ä‘á»ƒ loáº¡i bá» tÃ­nh ngáº«u nhiÃªn nÃ y lÃ  Ã¡p dá»¥ng  che <em>chá»‰ má»™t láº§n</em> trÃªn toÃ n bá»™ táº­p kiá»ƒm thá»­, sau Ä‘Ã³ sá»­ dá»¥ng trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u máº·c Ä‘á»‹nh trong ğŸ¤— Transformers Ä‘á»ƒ thu tháº­p cÃ¡c lÃ´ trong quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡. Äá»ƒ xem cÃ¡ch nÃ y hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o, hÃ£y triá»ƒn khai má»™t chá»©c nÄƒng Ä‘Æ¡n giáº£n Ã¡p dá»¥ng che trÃªn má»™t lÃ´, tÆ°Æ¡ng tá»± nhÆ° láº§n Ä‘áº§u cá»§a chÃºng ta vá»›i <code>DataCollatorForLanguageModeling</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">insert_random_mask</span>(<span class="hljs-params">batch</span>):
    features = [<span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(batch, t)) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(*batch.values())]
    masked_inputs = data_collator(features)
    <span class="hljs-comment"># Táº¡o ra má»™t cá»™t &quot;masked&quot; má»›i cho má»—i cá»™t trong bá»™ dá»¯ liá»‡u</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;masked_&quot;</span> + k: v.numpy() <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> masked_inputs.items()}<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, chÃºng ta sáº½ Ã¡p dá»¥ng chá»©c nÄƒng nÃ y cho táº­p kiá»ƒm thá»­ cá»§a mÃ¬nh vÃ  bá» cÃ¡c cá»™t khÃ´ng che Ä‘á»ƒ cÃ³ thá»ƒ thay tháº¿ chÃºng báº±ng nhá»¯ng cá»™t bá»‹ che. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng che toÃ n bá»™ tá»« báº±ng cÃ¡ch thay tháº¿ <code>data_collator</code> á»Ÿ trÃªn báº±ng cÃ¡i thÃ­ch há»£p, trong trÆ°á»ng há»£p Ä‘Ã³, báº¡n nÃªn xÃ³a dÃ²ng Ä‘áº§u tiÃªn táº¡i Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->downsampled_dataset = downsampled_dataset.remove_columns([<span class="hljs-string">&quot;word_ids&quot;</span>])
eval_dataset = downsampled_dataset[<span class="hljs-string">&quot;test&quot;</span>].<span class="hljs-built_in">map</span>(
    insert_random_mask,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=downsampled_dataset[<span class="hljs-string">&quot;test&quot;</span>].column_names,
)
eval_dataset = eval_dataset.rename_columns(
    {
        <span class="hljs-string">&quot;masked_input_ids&quot;</span>: <span class="hljs-string">&quot;input_ids&quot;</span>,
        <span class="hljs-string">&quot;masked_attention_mask&quot;</span>: <span class="hljs-string">&quot;attention_mask&quot;</span>,
        <span class="hljs-string">&quot;masked_labels&quot;</span>: <span class="hljs-string">&quot;labels&quot;</span>,
    }
)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ thiáº¿t láº­p bá»™ lÆ°u dá»¯ liá»‡u nhÆ° bÃ¬nh thÆ°á»ng, nhÆ°ng ta sáº½ sá»­ dá»¥ng <code>default_data_collator</code> tá»« ğŸ¤— Transformers cho táº­p kiá»ƒm Ä‘á»‹nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> default_data_collator

batch_size = <span class="hljs-number">64</span>
train_dataloader = DataLoader(
    downsampled_dataset[<span class="hljs-string">&quot;train&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    batch_size=batch_size,
    collate_fn=data_collator,
)
eval_dataloader = DataLoader(
    eval_dataset, batch_size=batch_size, collate_fn=default_data_collator
)<!-- HTML_TAG_END --></pre></div>
<p>Tá»« Ä‘Ã¢y, chÃºng ta lÃ m theo cÃ¡c bÆ°á»›c tiÃªu chuáº©n vá»›i ğŸ¤— Accelerate. YÃªu cáº§u Ä‘áº§u tiÃªn cá»§a cÃ´ng viá»‡c lÃ  táº£i má»™t phiÃªn báº£n má»›i cá»§a mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AutoModelForMaskedLM</span>.</span></span>from<span class="hljs-constructor">_pretrained(<span class="hljs-params">model_checkpoint</span>)</span><!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cáº§n chá»‰ Ä‘á»‹nh trÃ¬nh tá»‘i Æ°u hÃ³a; chÃºng ta sáº½ sá»­ dá»¥ng tiÃªu chuáº©n <code>AdamW</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">5e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>Vá»›i nhá»¯ng Ä‘á»‘i tÆ°á»£ng nÃ y, bÃ¢y giá» chÃºng ta cÃ³ thá»ƒ chuáº©n bá»‹ má»i thá»© cho quÃ¡ trÃ¬nh huáº¥n luyá»‡n vá»›i Ä‘á»‘i tÆ°á»£ng <code>Accelerator</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator()
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» mÃ´ hÃ¬nh, trÃ¬nh tá»‘i Æ°u hÃ³a vÃ  bá»™ ghi dá»¯ liá»‡u cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh cáº¥u hÃ¬nh, chÃºng ta cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh bá»™ láº­p lá»‹ch tá»‘c Ä‘á»™ há»c nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">3</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>Chá»‰ cÃ³ má»™t Ä‘iá»u cuá»‘i cÃ¹ng cáº§n lÃ m trÆ°á»›c khi huáº¥n luyá»‡n: táº¡o má»™t kho lÆ°u trá»¯ mÃ´ hÃ¬nh trÃªn Hugging Face Hub! TrÆ°á»›c tiÃªn, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng thÆ° viá»‡n ğŸ¤— Hub Ä‘á»ƒ táº¡o tÃªn Ä‘áº§y Ä‘á»§ cho repo cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> get_full_repo_name

model_name = <span class="hljs-string">&quot;distilbert-base-uncased-finetuned-imdb-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;lewtun/distilbert-base-uncased-finetuned-imdb-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>sau Ä‘Ã³ táº¡o vÃ  sao chÃ©p kho lÆ°u trá»¯ báº±ng cÃ¡ch sá»­ dá»¥ng lá»›p <code>Repository</code> tá»« ğŸ¤— Hub:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository

output_dir = model_name
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>Sau khi thá»±c hiá»‡n xong, viá»‡c viáº¿t ra toÃ n bá»™ vÃ²ng láº·p huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ chá»‰ lÃ  má»™t váº¥n Ä‘á» Ä‘Æ¡n giáº£n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> math

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Huáº¥n luyá»‡n</span>
    model.train()
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> train_dataloader:
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># ÄÃ¡nh giÃ¡</span>
    model.<span class="hljs-built_in">eval</span>()
    losses = []
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(eval_dataloader):
        <span class="hljs-keyword">with</span> torch.no_grad():
            outputs = model(**batch)

        loss = outputs.loss
        losses.append(accelerator.gather(loss.repeat(batch_size)))

    losses = torch.cat(losses)
    losses = losses[: <span class="hljs-built_in">len</span>(eval_dataset)]
    <span class="hljs-keyword">try</span>:
        perplexity = math.exp(torch.mean(losses))
    <span class="hljs-keyword">except</span> OverflowError:
        perplexity = <span class="hljs-built_in">float</span>(<span class="hljs-string">&quot;inf&quot;</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&gt;&gt;&gt; Epoch <span class="hljs-subst">{epoch}</span>: Perplexity: <span class="hljs-subst">{perplexity}</span>&quot;</span>)

    <span class="hljs-comment"># LÆ°u vÃ  táº£i</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-meta">&gt;&gt;&gt; </span>Epoch <span class="hljs-number">0</span>: Perplexity: <span class="hljs-number">11.397545307900472</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Epoch <span class="hljs-number">1</span>: Perplexity: <span class="hljs-number">10.904909330983092</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>Epoch <span class="hljs-number">2</span>: Perplexity: <span class="hljs-number">10.729503505340409</span><!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t vá»i, chÃºng tÃ´i Ä‘Ã£ cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ phá»©c táº¡p theo tá»«ng epoch vÃ  Ä‘áº£m báº£o ráº±ng nhiá»u láº§n cháº¡y huáº¥n luyá»‡n cÃ³ thá»ƒ tÃ¡i táº¡o!</p>
<h2 class="relative group"><a id="s-dng-m-hnh-tinh-chnh-ca-mnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#s-dng-m-hnh-tinh-chnh-ca-mnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh cá»§a mÃ¬nh
	</span></h2>

<p>áº¡n cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tinh chá»‰nh cá»§a mÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng tiá»‡n Ã­ch cá»§a nÃ³ trÃªn Hub hoáº·c cá»¥c bá»™ vá»›i <code>pipeline</code> tá»« ğŸ¤— Transformers. HÃ£y sá»­ dá»¥ng cÃ¡i sau Ä‘á»ƒ táº£i xuá»‘ng mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i báº±ng cÃ¡ch sá»­ dá»¥ng pipeline <code>fill-mask</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

mask_filler = pipeline(
    <span class="hljs-string">&quot;fill-mask&quot;</span>, model=<span class="hljs-string">&quot;huggingface-course/distilbert-base-uncased-finetuned-imdb&quot;</span>
)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ cung cáº¥p vÄƒn báº£n máº«u â€œThis is a great [MASK]â€ vÃ  xem 5 dá»± Ä‘oÃ¡n Ä‘áº§u lÃ  gÃ¬:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->preds = mask_filler(text)

<span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> preds:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&gt;&gt;&gt; <span class="hljs-subst">{pred[<span class="hljs-string">&#x27;sequence&#x27;</span>]}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; this is a great movie.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; this is a great film.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; this is a great story.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; this is a great movies.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt;&gt; this is a great character.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Gá»n gÃ ng - mÃ´ hÃ¬nh cá»§a chÃºng ta rÃµ rÃ ng Ä‘Ã£ Ä‘iá»u chá»‰nh trá»ng sá»‘ cá»§a nÃ³ Ä‘á»ƒ dá»± Ä‘oÃ¡n cÃ¡c tá»« liÃªn quan nhiá»u hÆ¡n Ä‘áº¿n phim!</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/0Oxphw4Q9fo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Äiá»u nÃ y káº¿t thÃºc thá»­ nghiá»‡m Ä‘áº§u tiÃªn cá»§a chÃºng ta vá»›i viá»‡c huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯. Trong <a href="/course/chapter7/section6">pháº§n 6</a>, báº¡n sáº½ há»c cÃ¡ch huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh tá»± Ä‘á»™ng há»“i quy nhÆ° GPT-2 tá»« Ä‘áº§u; hÃ£y Ä‘áº¿n Ä‘Ã³ náº¿u báº¡n muá»‘n xem cÃ¡ch báº¡n cÃ³ thá»ƒ huáº¥n luyá»‡n trÆ°á»›c mÃ´ hÃ¬nh Transformer cá»§a riÃªng mÃ¬nh!</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Äá»ƒ Ä‘á»‹nh lÆ°á»£ng lá»£i Ã­ch cá»§a viá»‡c thÃ­ch á»©ng chuyÃªn mÃ´n, hÃ£y tinh chá»‰nh bá»™ phÃ¢n loáº¡i trÃªn cÃ¡c nhÃ£n IMDb cho cáº£ cÃ¡c checkpoint DistilBERT Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vÃ  tinh chá»‰nh. Náº¿u báº¡n cáº§n bá»“i dÆ°á»¡ng vá» phÃ¢n loáº¡i vÄƒn báº£n, hÃ£y xem <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>.</p></div>


		<script type="module" data-hydrate="usy00j">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="usy00j"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter7/3.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
