<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;tm-tt&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-kho-ng-liu-a-ngn-ng&quot;,&quot;title&quot;:&quot;Chuáº©n bá»‹ kho ngá»¯ liá»‡u Ä‘a ngÃ´n ngá»¯&quot;},{&quot;local&quot;:&quot;cc-m-hnh-cho-tm-tt-vn-bn&quot;,&quot;title&quot;:&quot;CÃ¡c mÃ´ hÃ¬nh cho tÃ³m táº¯t vÄƒn báº£n&quot;},{&quot;local&quot;:&quot;tin-x-l-d-liu&quot;,&quot;title&quot;:&quot;Tiá»n xá»­ lÃ½ dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;thc-o-cho-tm-tt-vn-bn&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;to-mt-ng-c-s-mnh-m&quot;,&quot;title&quot;:&quot;Táº¡o má»™t Ä‘Æ°á»ng cÆ¡ sá»Ÿ máº¡nh máº½&quot;}],&quot;title&quot;:&quot;ThÆ°á»›c Ä‘o cho tÃ³m táº¯t vÄƒn báº£n&quot;},{&quot;local&quot;:&quot;tinh-chnh-mt5-vi-api-trainer&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mT5 vá»›i API `Trainer`&quot;},{&quot;local&quot;:&quot;tinh-chnh-mt5-vi-keras&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mT5 vá»›i Keras&quot;},{&quot;local&quot;:&quot;tinh-chnh-mt5-vi-accelerate&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-mi-th-cho-hun-luyn&quot;,&quot;title&quot;:&quot;Chuáº©n bá»‹ má»i thá»© cho huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;vng-lp-hun-luyn&quot;,&quot;title&quot;:&quot;VÃ²ng láº·p huáº¥n luyá»‡n&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh mT5 vá»›i ğŸ¤— Accelerate&quot;},{&quot;local&quot;:&quot;s-dng-m-hnh-tinh-chnh-ca-bn&quot;,&quot;title&quot;:&quot;Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh cá»§a báº¡n&quot;}],&quot;title&quot;:&quot;TÃ³m táº¯t&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter7/5.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="tm-tt" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tm-tt"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>TÃ³m táº¯t
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/vi/chapter7/section5_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/vi/chapter7/section5_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Trong pháº§n nÃ y, chÃºng ta sáº½ xem xÃ©t cÃ¡ch cÃ¡c mÃ´ hÃ¬nh Transformer cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cÃ´ Ä‘á»ng cÃ¡c tÃ i liá»‡u dÃ i thÃ nh cÃ¡c báº£n tÃ³m táº¯t, má»™t tÃ¡c vá»¥ Ä‘Æ°á»£c gá»i lÃ  <em>text summarization</em> hay <em>tÃ³m táº¯t vÄƒn báº£n</em>. ÄÃ¢y lÃ  má»™t trong nhá»¯ng tÃ¡c vá»¥ NLP thÃ¡ch thá»©c nháº¥t vÃ¬ nÃ³ Ä‘Ã²i há»i nhiá»u kháº£ nÄƒng, cháº³ng háº¡n nhÆ° hiá»ƒu cÃ¡c Ä‘oáº¡n vÄƒn dÃ i vÃ  táº¡o ra vÄƒn báº£n máº¡ch láº¡c náº¯m báº¯t cÃ¡c chá»§ Ä‘á» chÃ­nh trong tÃ i liá»‡u. Tuy nhiÃªn, khi Ä‘Æ°á»£c thá»±c hiá»‡n tá»‘t, tÃ³m táº¯t vÄƒn báº£n lÃ  má»™t cÃ´ng cá»¥ máº¡nh máº½ cÃ³ thá»ƒ tÄƒng tá»‘c cÃ¡c quy trÃ¬nh kinh doanh khÃ¡c nhau báº±ng cÃ¡ch giáº£m bá»›t gÃ¡nh náº·ng cho cÃ¡c chuyÃªn gia miá»n pháº£i Ä‘á»c chi tiáº¿t cÃ¡c tÃ i liá»‡u dÃ i.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/yHnr5Dk2zCI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Máº·c dÃ¹ Ä‘Ã£ tá»“n táº¡i nhiá»u mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh khÃ¡c nhau Ä‘á»ƒ tÃ³m táº¯t trÃªn <a href="https://huggingface.co/models?pipeline_tag=summarization&sort=downloads" rel="nofollow">Hugging Face Hub</a>, háº§u háº¿t táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh nÃ y chá»‰ phÃ¹ há»£p vá»›i cÃ¡c tÃ i liá»‡u tiáº¿ng Anh. VÃ¬ váº­y, Ä‘á»ƒ táº¡o thÃªm má»™t Ä‘iá»ƒm nháº¥n trong pháº§n nÃ y, chÃºng tÃ´i sáº½ huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh song ngá»¯ cho tiáº¿ng Anh vÃ  tiáº¿ng TÃ¢y Ban Nha. Äáº¿n cuá»‘i pháº§n nÃ y, báº¡n sáº½ cÃ³ má»™t <a href="https://huggingface.co/huggingface-course/mt5-small-finetuned-amazon-en-es" rel="nofollow">mÃ´ hÃ¬nh</a> cÃ³ thá»ƒ tÃ³m táº¯t cÃ¡c Ä‘Ã¡nh giÃ¡ cá»§a khÃ¡ch hÃ ng nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y:</p>
<iframe src="https://hf.space/gradioiframe/course-demos/mt5-small-finetuned-amazon-en-es/+" frameborder="0" height="400" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<p>NhÆ° chÃºng ta sáº½ tháº¥y, nhá»¯ng báº£n tÃ³m táº¯t nÃ y ngáº¯n gá»n vÃ¬ chÃºng Ä‘Æ°á»£c há»c tá»« cÃ¡c tiÃªu Ä‘á» mÃ  khÃ¡ch hÃ ng cung cáº¥p trong cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ sáº£n pháº©m cá»§a há». HÃ£y báº¯t Ä‘áº§u báº±ng cÃ¡ch táº­p há»£p má»™t kho ngá»¯ liá»‡u song ngá»¯ phÃ¹ há»£p cho tÃ¡c vá»¥ nÃ y.</p>
<h2 class="relative group"><a id="chun-b-kho-ng-liu-a-ngn-ng" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-kho-ng-liu-a-ngn-ng"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº©n bá»‹ kho ngá»¯ liá»‡u Ä‘a ngÃ´n ngá»¯
	</span></h2>

<p>ChÃºng ta sáº½ sá»­ dá»¥ng <a href="https://huggingface.co/datasets/amazon_reviews_multi" rel="nofollow">Multilingual Amazon Reviews Corpus</a> Ä‘á»ƒ táº¡o trÃ¬nh tÃ³m táº¯t song ngá»¯. Táº­p tÃ i liá»‡u nÃ y bao gá»“m cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ sáº£n pháº©m cá»§a Amazon báº±ng sÃ¡u ngÃ´n ngá»¯ vÃ  thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ cÃ¡c bá»™ phÃ¢n loáº¡i Ä‘a ngÃ´n ngá»¯. Tuy nhiÃªn, vÃ¬ má»—i bÃ i Ä‘Ã¡nh giÃ¡ Ä‘i kÃ¨m vá»›i má»™t tiÃªu Ä‘á» ngáº¯n, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c tiÃªu Ä‘á» nÃ y lÃ m nhÃ£n tÃ³m táº¯t cho mÃ´ hÃ¬nh cá»§a chÃºng ta Ä‘á»ƒ há»c! Äá»ƒ báº¯t Ä‘áº§u, hÃ£y táº£i xuá»‘ng cÃ¡c táº­p há»£p con tiáº¿ng Anh vÃ  tiáº¿ng TÃ¢y Ban Nha tá»« Hugging Face Hub:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

spanish_dataset = load_dataset(<span class="hljs-string">&quot;amazon_reviews_multi&quot;</span>, <span class="hljs-string">&quot;es&quot;</span>)
english_dataset = load_dataset(<span class="hljs-string">&quot;amazon_reviews_multi&quot;</span>, <span class="hljs-string">&quot;en&quot;</span>)
english_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">200000</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">5000</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">5000</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, Ä‘á»‘i vá»›i má»—i ngÃ´n ngá»¯, cÃ³ 200,000 Ä‘Ã¡nh giÃ¡ cho pháº§n <code>huáº¥n luyá»‡n</code> vÃ  5,000 nháº­n xÃ©t cho má»—i pháº§n <code>kiá»ƒm Ä‘á»‹nh</code> vÃ  <code>kiá»ƒm thá»­</code>. ThÃ´ng tin Ä‘Ã¡nh giÃ¡ mÃ  chÃºng ta quan tÃ¢m Ä‘Æ°á»£c chá»©a trong cá»™t <code>review_body</code> vÃ  <code>review_title</code>. HÃ£y xem má»™t vÃ i vÃ­ dá»¥ báº±ng cÃ¡ch táº¡o má»™t hÃ m Ä‘Æ¡n giáº£n láº¥y má»™t máº«u ngáº«u nhiÃªn tá»« táº­p huáº¥n luyá»‡n vá»›i cÃ¡c ká»¹ thuáº­t chÃºng ta Ä‘Ã£ há»c trong <a href="/course/chapter5">ChÆ°Æ¡ng 5</a>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">show_samples</span>(<span class="hljs-params">dataset, num_samples=<span class="hljs-number">3</span>, seed=<span class="hljs-number">42</span></span>):
    sample = dataset[<span class="hljs-string">&quot;train&quot;</span>].shuffle(seed=seed).select(<span class="hljs-built_in">range</span>(num_samples))
    <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> sample:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt; Title: <span class="hljs-subst">{example[<span class="hljs-string">&#x27;review_title&#x27;</span>]}</span>&#x27;&quot;</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt; Review: <span class="hljs-subst">{example[<span class="hljs-string">&#x27;review_body&#x27;</span>]}</span>&#x27;&quot;</span>)


show_samples(english_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: Worked in front position, not rear&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: 3 stars because these are not rear brakes as stated in the item description. At least the mount adapter only worked on the front fork of the bike that I got it for.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: meh&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Does itâ€™s job and itâ€™s gorgeous but mine is falling apart, I had to basically put it together again with hot glue&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Can\&#x27;t beat these for the money&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Bought this for handling miscellaneous aircraft parts and hanger &quot;stuff&quot; that I needed to organize; it really fit the bill. The unit arrived quickly, was well packaged and arrived intact (always a good sign). There are five wall mounts-- three on the top and two on the bottom. I wanted to mount it on the wall, so all I had to do was to remove the top two layers of plastic drawers, as well as the bottom corner drawers, place it when I wanted and mark it; I then used some of the new plastic screw in wall anchors (the 50 pound variety) and it easily mounted to the wall. Some have remarked that they wanted dividers for the drawers, and that they made those. Good idea. My application was that I needed something that I can see the contents at about eye level, so I wanted the fuller-sized drawers. I also like that these are the new plastic that doesn\&#x27;t get brittle and split like my older plastic drawers did. I like the all-plastic construction. It\&#x27;s heavy duty enough to hold metal parts, but being made of plastic it\&#x27;s not as heavy as a metal frame, so you can easily mount it to the wall and still load it up with heavy stuff, or light stuff. No problem there. For the money, you can\&#x27;t beat it. Best one of these I\&#x27;ve bought to date-- and I\&#x27;ve been using some version of these for over forty years.&#x27;</span><!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Thay Ä‘á»•i seed ngáº«u nhiÃªn trong lá»‡nh <code>Dataset.shuffle()</code> Ä‘á»ƒ khÃ¡m phÃ¡ cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ khÃ¡c trong kho tÃ i liá»‡u. Náº¿u báº¡n lÃ  ngÆ°á»i nÃ³i tiáº¿ng TÃ¢y Ban Nha, hÃ£y xem má»™t sá»‘ bÃ i Ä‘Ã¡nh giÃ¡ trong <code>spanish_dataset</code> Ä‘á»ƒ xem liá»‡u cÃ¡c tiÃªu Ä‘á» cÃ³ giá»‘ng nhÆ° nhá»¯ng báº£n tÃ³m táº¯t há»£p lÃ½ hay khÃ´ng.</p></div>
<p>Máº«u nÃ y cho tháº¥y sá»± Ä‘a dáº¡ng cá»§a cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ mÃ  ngÆ°á»i ta thÆ°á»ng tÃ¬m tháº¥y trÃªn máº¡ng, tá»« tÃ­ch cá»±c Ä‘áº¿n tiÃªu cá»±c (vÃ  má»i thá»© á»Ÿ giá»¯a!). Máº·c dÃ¹ vÃ­ dá»¥ vá»›i tiÃªu Ä‘á» â€œmehâ€ khÃ´ng nhiá»u thÃ´ng tin, nhÆ°ng cÃ¡c tiÃªu Ä‘á» khÃ¡c trÃ´ng giá»‘ng nhÆ° nhá»¯ng báº£n tÃ³m táº¯t phÃ¹ há»£p vá» báº£n thÃ¢n cÃ¡c Ä‘Ã¡nh giÃ¡. Viá»‡c huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh tÃ³m táº¯t cho táº¥t cáº£ 400,000 bÃ i Ä‘Ã¡nh giÃ¡ sáº½ máº¥t quÃ¡ nhiá»u thá»i gian trÃªn má»™t GPU, vÃ¬ váº­y thay vÃ o Ä‘Ã³, chÃºng ta sáº½ táº­p trung vÃ o viá»‡c táº¡o tÃ³m táº¯t cho má»™t miá»n sáº£n pháº©m. Äá»ƒ biáº¿t tÃªn miá»n mÃ  chÃºng ta cÃ³ thá»ƒ chá»n, hÃ£y chuyá»ƒn Ä‘á»•i <code>english_dataset</code> thÃ nh <code>pandas.DataFrame</code> vÃ  tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng Ä‘Ã¡nh giÃ¡ cho má»—i danh má»¥c sáº£n pháº©m:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->english_dataset.set_format(<span class="hljs-string">&quot;pandas&quot;</span>)
english_df = english_dataset[<span class="hljs-string">&quot;train&quot;</span>][:]
<span class="hljs-comment"># Hiá»ƒn thá»‹ sá»‘ lÆ°á»£ng cho 20 sáº£n pháº©m hÃ ng Ä‘áº§u</span>
english_df[<span class="hljs-string">&quot;product_category&quot;</span>].value_counts()[:<span class="hljs-number">20</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->home                      <span class="hljs-number">17679</span>
apparel                   <span class="hljs-number">15951</span>
wireless                  <span class="hljs-number">15717</span>
other                     <span class="hljs-number">13418</span>
beauty                    <span class="hljs-number">12091</span>
drugstore                 <span class="hljs-number">11730</span>
kitchen                   <span class="hljs-number">10382</span>
toy                        <span class="hljs-number">8745</span>
sports                     <span class="hljs-number">8277</span>
automotive                 <span class="hljs-number">7506</span>
lawn_and_garden            <span class="hljs-number">7327</span>
home_improvement           <span class="hljs-number">7136</span>
pet_products               <span class="hljs-number">7082</span>
digital_ebook_purchase     <span class="hljs-number">6749</span>
pc                         <span class="hljs-number">6401</span>
electronics                <span class="hljs-number">6186</span>
office_product             <span class="hljs-number">5521</span>
shoes                      <span class="hljs-number">5197</span>
grocery                    <span class="hljs-number">4730</span>
book                       <span class="hljs-number">3756</span>
Name: product_category, dtype: int64<!-- HTML_TAG_END --></pre></div>
<p>CÃ¡c sáº£n pháº©m phá»• biáº¿n nháº¥t trong táº­p dá»¯ liá»‡u tiáº¿ng Anh lÃ  vá» Ä‘á»“ gia dá»¥ng, quáº§n Ã¡o vÃ  thiáº¿t bá»‹ Ä‘iá»‡n tá»­ khÃ´ng dÃ¢y. Tuy nhiÃªn, Ä‘á»ƒ gáº¯n bÃ³ vá»›i chá»§ Ä‘á» Amazon, chÃºng ta hÃ£y táº­p trung vÃ o viá»‡c tÃ³m táº¯t cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ sÃ¡ch - xÃ©t cho cÃ¹ng, Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ cÃ´ng ty Ä‘Æ°á»£c thÃ nh láº­p! ChÃºng tÃ´i cÃ³ thá»ƒ tháº¥y hai danh má»¥c sáº£n pháº©m phÃ¹ há»£p vá»›i hÃ³a Ä‘Æ¡n (<code>book</code> vÃ  <code>digital_ebook_purchase</code>), vÃ¬ váº­y, hÃ£y lá»c táº­p dá»¯ liá»‡u báº±ng cáº£ hai ngÃ´n ngá»¯ chá»‰ cho cÃ¡c sáº£n pháº©m nÃ y. NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter5">ChÆ°Æ¡ng 5</a>, hÃ m <code>Dataset.filter()</code> cho phÃ©p chÃºng ta cáº¯t má»™t táº­p dá»¯ liá»‡u ráº¥t hiá»‡u quáº£, vÃ¬ váº­y chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh má»™t hÃ m Ä‘Æ¡n giáº£n Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_books</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> (
        example[<span class="hljs-string">&quot;product_category&quot;</span>] == <span class="hljs-string">&quot;book&quot;</span>
        <span class="hljs-keyword">or</span> example[<span class="hljs-string">&quot;product_category&quot;</span>] == <span class="hljs-string">&quot;digital_ebook_purchase&quot;</span>
    )<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» khi chÃºng ta Ã¡p dá»¥ng hÃ m nÃ y cho <code>english_dataset</code> vÃ  <code>spanish_dataset</code>, káº¿t quáº£ sáº½ chá»‰ chá»©a nhá»¯ng hÃ ng liÃªn quan Ä‘áº¿n danh má»¥c sÃ¡ch. TrÆ°á»›c khi Ã¡p dá»¥ng bá»™ lá»c, hÃ£y chuyá»ƒn Ä‘á»‹nh dáº¡ng cá»§a <code>english_dataset</code> tá»« <code>&quot;pandas&quot;</code> trá»Ÿ láº¡i <code>&quot;arrow&quot;</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->english_dataset.reset_format()<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng tÃ´i cÃ³ thá»ƒ Ã¡p dá»¥ng chá»©c nÄƒng bá»™ lá»c vÃ  Ä‘á»ƒ kiá»ƒm tra má»™t máº«u Ä‘Ã¡nh giÃ¡ Ä‘á»ƒ xem chÃºng cÃ³ thá»±c sá»± lÃ  vá» sÃ¡ch hay khÃ´ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->spanish_books = spanish_dataset.<span class="hljs-built_in">filter</span>(filter_books)
english_books = english_dataset.<span class="hljs-built_in">filter</span>(filter_books)
show_samples(english_books)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: I\&#x27;m dissapointed.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I guess I had higher expectations for this book from the reviews. I really thought I\&#x27;d at least like it. The plot idea was great. I loved Ash but, it just didnt go anywhere. Most of the book was about their radio show and talking to callers. I wanted the author to dig deeper so we could really get to know the characters. All we know about Grace is that she is attractive looking, Latino and is kind of a brat. I\&#x27;m dissapointed.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Good art, good price, poor design&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I had gotten the DC Vintage calendar the past two years, but it was on backorder forever this year and I saw they had shrunk the dimensions for no good reason. This one has good art choices but the design has the fold going through the picture, so it\&#x27;s less aesthetically pleasing, especially if you want to keep a picture to hang. For the price, a good calendar&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Helpful&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Nearly all the tips useful and. I consider myself an intermediate to advanced user of OneNote. I would highly recommend.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ÄÆ°á»£c rá»“i, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ khÃ´ng hoÃ n toÃ n vá» sÃ¡ch vÃ  cÃ³ thá»ƒ Ä‘á» cáº­p Ä‘áº¿n nhá»¯ng thá»© nhÆ° lá»‹ch vÃ  cÃ¡c á»©ng dá»¥ng Ä‘iá»‡n tá»­ nhÆ° OneNote. Tuy nhiÃªn, máº£ng nÃ y cÃ³ váº» thÃ­ch há»£p Ä‘á»ƒ huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh tÃ³m táº¯t. TrÆ°á»›c khi xem xÃ©t cÃ¡c mÃ´ hÃ¬nh khÃ¡c nhau phÃ¹ há»£p cho tÃ¡c vá»¥ nÃ y, chÃºng ta cÃ²n má»™t bÆ°á»›c chuáº©n bá»‹ dá»¯ liá»‡u cuá»‘i cÃ¹ng cáº§n lÃ m: káº¿t há»£p cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ báº±ng tiáº¿ng Anh vÃ  tiáº¿ng TÃ¢y Ban Nha dÆ°á»›i dáº¡ng má»™t Ä‘á»‘i tÆ°á»£ng <code>DatasetDict</code> duy nháº¥t. ğŸ¤— Datasets cung cáº¥p má»™t hÃ m <code>concatenate_datasets()</code> tiá»‡n dá»¥ng (nhÆ° tÃªn cho tháº¥y) sáº½ xáº¿p chá»“ng hai Ä‘á»‘i tÆ°á»£ng <code>Dataset</code> lÃªn trÃªn nhau. VÃ¬ váº­y, Ä‘á»ƒ táº¡o táº­p dá»¯ liá»‡u song ngá»¯ cá»§a mÃ¬nh, chÃºng ta sáº½ láº·p láº¡i tá»«ng pháº§n dá»¯ liá»‡u, ná»‘i cÃ¡c táº­p dá»¯ liá»‡u cho pháº§n Ä‘Ã³ vÃ  xÃ¡o trá»™n káº¿t quáº£ Ä‘á»ƒ Ä‘áº£m báº£o mÃ´ hÃ¬nh khÃ´ng quÃ¡ phÃ¹ há»£p vá»›i má»™t ngÃ´n ngá»¯ duy nháº¥t:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> concatenate_datasets, DatasetDict

books_dataset = DatasetDict()

<span class="hljs-keyword">for</span> split <span class="hljs-keyword">in</span> english_books.keys():
    books_dataset[split] = concatenate_datasets(
        [english_books[split], spanish_books[split]]
    )
    books_dataset[split] = books_dataset[split].shuffle(seed=<span class="hljs-number">42</span>)

<span class="hljs-comment"># Chá»n ra má»™t vÃ i máº«u</span>
show_samples(books_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: Easy to follow!!!!&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I loved The dash diet weight loss Solution. Never hungry. I would recommend this diet. Also the menus are well rounded. Try it. Has lots of the information need thanks.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: PARCIALMENTE DAÃ‘ADO&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Me llegÃ³ el dÃ­a que tocaba, junto a otros libros que pedÃ­, pero la caja llegÃ³ en mal estado lo cual daÃ±Ã³ las esquinas de los libros porque venÃ­an sin protecciÃ³n (forro).&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: no lo he podido descargar&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: igual que el anterior&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ÄÃ¢y cháº¯c cháº¯n lÃ  sá»± káº¿t há»£p giá»¯a cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ báº±ng tiáº¿ng Anh vÃ  tiáº¿ng TÃ¢y Ban Nha! BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ má»™t kho tÃ i liá»‡u huáº¥n luyá»‡n, má»™t Ä‘iá»u cuá»‘i cÃ¹ng cáº§n kiá»ƒm tra lÃ  sá»± phÃ¢n bá»‘ cÃ¡c tá»« trong cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ vÃ  tiÃªu Ä‘á» cá»§a chÃºng. Äiá»u nÃ y Ä‘áº·c biá»‡t quan trá»ng Ä‘á»‘i vá»›i cÃ¡c tÃ¡c vá»¥ tÃ³m táº¯t, trong Ä‘Ã³ cÃ¡c tÃ³m táº¯t tham chiáº¿u ngáº¯n trong dá»¯ liá»‡u cÃ³ thá»ƒ lÃ m sai lá»‡ch mÃ´ hÃ¬nh chá»‰ xuáº¥t ra má»™t hoáº·c hai tá»« trong cÃ¡c tÃ³m táº¯t Ä‘Ã£ táº¡o. CÃ¡c biá»ƒu Ä‘á»“ bÃªn dÆ°á»›i hiá»ƒn thá»‹ cÃ¡c phÃ¢n bá»‘ tá»« vÃ  chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng cÃ¡c tiÃªu Ä‘á» bá»‹ lá»‡ch nhiá»u vá» chá»‰ 1-2 tá»«:</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/review-lengths.svg" alt="Word count distributions for the review titles and texts.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/review-lengths-dark.svg" alt="Word count distributions for the review titles and texts."></div>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng ta sáº½ lá»c ra cÃ¡c vÃ­ dá»¥ cÃ³ tiÃªu Ä‘á» ráº¥t ngáº¯n Ä‘á»ƒ mÃ´ hÃ¬nh cÃ³ thá»ƒ táº¡o ra cÃ¡c báº£n tÃ³m táº¯t thÃº vá»‹ hÆ¡n. VÃ¬ chÃºng ta Ä‘ang xá»­ lÃ½ cÃ¡c vÄƒn báº£n tiáº¿ng Anh vÃ  tiáº¿ng TÃ¢y Ban Nha, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p thÃ´ Ä‘á»ƒ phÃ¢n chia cÃ¡c tiÃªu Ä‘á» theo dáº¥u cÃ¡ch vÃ  sau Ä‘Ã³ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p <code>Dataset.filter()</code> Ä‘Ã¡ng tin cáº­y cá»§a mÃ¬nh nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->books_dataset = books_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">len</span>(x[<span class="hljs-string">&quot;review_title&quot;</span>].split()) &gt; <span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ chuáº©n bá»‹ kho tÃ i liá»‡u cá»§a mÃ¬nh, hÃ£y cÃ¹ng xem má»™t vÃ i máº«u Transformer kháº£ thi mÃ  ngÆ°á»i ta cÃ³ thá»ƒ tinh chá»‰nh nÃ³!</p>
<h2 class="relative group"><a id="cc-m-hnh-cho-tm-tt-vn-bn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#cc-m-hnh-cho-tm-tt-vn-bn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>CÃ¡c mÃ´ hÃ¬nh cho tÃ³m táº¯t vÄƒn báº£n
	</span></h2>

<p>Náº¿u báº¡n nghÄ© vá» nÃ³, tÃ³m táº¯t vÄƒn báº£n lÃ  má»™t loáº¡i tÃ¡c vá»¥ tÆ°Æ¡ng tá»± nhÆ° dá»‹ch mÃ¡y: chÃºng ta cÃ³ má»™t pháº§n ná»™i dung vÄƒn báº£n giá»‘ng nhÆ° má»™t bÃ i Ä‘Ã¡nh giÃ¡ mÃ  ta muá»‘n â€œdá»‹châ€ thÃ nh má»™t phiÃªn báº£n ngáº¯n hÆ¡n Ä‘á»ƒ náº¯m báº¯t cÃ¡c tÃ­nh nÄƒng ná»•i báº­t cá»§a Ä‘áº§u vÃ o. Theo Ä‘Ã³, háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh Transformer Ä‘á»ƒ tÃ³m táº¯t Ä‘á»u Ã¡p dá»¥ng kiáº¿n trÃºc bá»™ mÃ£ hÃ³a-giáº£i mÃ£ mÃ  chÃºng ta Ä‘Ã£ gáº·p láº§n Ä‘áº§u tiÃªn trong <a href="/course/chapter1">ChÆ°Æ¡ng 1</a>, máº·c dÃ¹ cÃ³ má»™t sá»‘ ngoáº¡i lá»‡ nhÆ° há» mÃ´ hÃ¬nh GPT cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ³m táº¯t trong cÃ i Ä‘áº·t few-shot. Báº£ng sau Ä‘Ã¢y liá»‡t kÃª má»™t sá»‘ mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c phá»• biáº¿n cÃ³ thá»ƒ Ä‘Æ°á»£c tinh chá»‰nh Ä‘á»ƒ tÃ³m táº¯t.</p>
<table><thead><tr><th align="center">MÃ´ hÃ¬nh Transformer</th>
<th>MÃ´ táº£</th>
<th align="center">Äa ngÃ´n ngá»¯?</th></tr></thead>
<tbody><tr><td align="center"><a href="https://huggingface.co/gpt2-xl" rel="nofollow">GPT-2</a></td>
<td>Máº·c dÃ¹ Ä‘Æ°á»£c huáº¥n luyá»‡n nhÆ° má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»± há»“i quy, báº¡n cÃ³ thá»ƒ dÃ¹ng GPT-2 Ä‘á»ƒ táº¡o ra cÃ¡c báº£n tÃ³m táº¯t báº±ng cÃ¡ch ná»‘i â€œTL;DRâ€ cuá»‘i má»—i Ä‘oáº¡n Ä‘áº§u vÃ o.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/google/pegasus-large" rel="nofollow">PEGASUS</a></td>
<td>Sá»­ dá»¥ng hÃ m má»¥c tiÃªu huáº¥n luyá»‡n trÆ°á»›c Ä‘á»ƒ dá»± Ä‘oÃ¡n cÃ¡c cÃ¢u bá»‹ áº©n Ä‘i trong vÄƒn báº£n Ä‘a cÃ¢u. CÆ¡ cháº¿ nÃ y gáº§n vá»›i tÃ³m táº¯t hÆ¡n mÃ´ hÃ¬nh ngÃ´n ngá»¯ vanilla vÃ  Ä‘áº¡t Ä‘iá»ƒm cao hÆ¡n trÃªn cÃ¡c chuáº©n phá»• biáº¿n.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/t5-base" rel="nofollow">T5</a></td>
<td>Má»™t kiáº¿n trÃºc Transformer phá»• quÃ¡t táº¡o ra táº¥t cáº£ cÃ¡c tÃ¡c vá»¥ trong khung vÄƒn báº£n sang vÄƒn báº£n; vÃ­ dá»¥,Ä‘á»‹nh dáº¡ng Ä‘áº§u vÃ o cho mÃ´ hÃ¬nh Ä‘á»ƒ tÃ³m táº¯t tÃ i liá»‡u lÃ  <code>summarize: ARTICLE</code>.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/google/mt5-base" rel="nofollow">mT5</a></td>
<td>Má»™t phiÃªn báº£n Ä‘a ngÃ´n ngá»¯ cá»§a T5, Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c trÃªn kho ngá»¯ liá»‡u Common Crawl corpus (mC4), bao gá»“m 101 ngÃ´n ngá»¯.</td>
<td align="center">âœ…</td></tr>
<tr><td align="center"><a href="https://huggingface.co/facebook/bart-base" rel="nofollow">BART</a></td>
<td>Má»™t kiáº¿n trÃºc Transformer má»›i vá»›i cáº£ bá»™ mÃ£ hÃ³a vÃ  giáº£i mÃ£ Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ tÃ¡i táº¡o láº¡i Ä‘áº§u vÃ o bá»‹ phÃ¡, káº¿t há»£p cÃ¡c cÆ¡ cháº¿ huáº¥n luyá»‡n trÆ°á»›c cá»§a BERT vÃ  GPT-2.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/facebook/mbart-large-50" rel="nofollow">mBART-50</a></td>
<td>PhiÃªn báº£n Ä‘a ngÃ´n ngá»¯ cá»§a BART, huáº¥n luyá»‡n trÆ°á»›c trÃªn 50 ngÃ´n ngá»¯.</td>
<td align="center">âœ…</td></tr></tbody></table>
<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y tá»« báº£ng nÃ y, pháº§n lá»›n cÃ¡c mÃ´ hÃ¬nh Transformer Ä‘á»ƒ tÃ³m táº¯t (vÃ  thá»±c sá»± lÃ  háº§u háº¿t cÃ¡c tÃ¡c vá»¥ NLP) lÃ  Ä‘Æ¡n ngá»¯. Äiá»u nÃ y tháº­t tuyá»‡t náº¿u tÃ¡c vá»¥ cá»§a báº¡n sá»­ dá»¥ng ngÃ´n ngá»¯ â€œnhiá»u tÃ i nguyÃªnâ€ nhÆ° tiáº¿ng Anh hoáº·c tiáº¿ng Äá»©c, nhÆ°ng bá»›t dáº§n Ä‘á»‘i vá»›i hÃ ng nghÃ¬n ngÃ´n ngá»¯ khÃ¡c Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn kháº¯p tháº¿ giá»›i. May máº¯n thay, cÃ³ má»™t loáº¡i mÃ´ hÃ¬nh Transformer Ä‘a ngÃ´n ngá»¯, nhÆ° mT5 vÃ  mBART, ra Ä‘á»i Ä‘á»ƒ giáº£i cá»©u ta. Nhá»¯ng mÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c báº±ng cÃ¡ch sá»­ dá»¥ng mÃ´ hÃ¬nh ngÃ´n ngá»¯, nhÆ°ng cÃ³ má»™t Ä‘iá»ƒm khÃ¡c biá»‡t: thay vÃ¬ huáº¥n luyá»‡n ngá»¯ liá»‡u cá»§a má»™t ngÃ´n ngá»¯, chÃºng Ä‘Æ°á»£c huáº¥n luyá»‡n cÃ¹ng lÃºc vá» cÃ¡c vÄƒn báº£n báº±ng hÆ¡n 50 ngÃ´n ngá»¯ cÃ¹ng má»™t lÃºc!</p>
<p>ChÃºng ta sáº½ táº­p trung vÃ o mT5, má»™t kiáº¿n trÃºc thÃº vá»‹ dá»±a trÃªn T5 Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c trong khung vÄƒn báº£n sang vÄƒn báº£n. Trong T5, má»i tÃ¡c vá»¥ NLP Ä‘Æ°á»£c xÃ¢y dá»±ng dÆ°á»›i dáº¡ng tiá»n tá»‘ nháº¯c nhÆ° <code>summarize:</code> Ä‘iá»u kiá»‡n nÃ o Ä‘á»ƒ mÃ´ hÃ¬nh Ä‘iá»u chá»‰nh vÄƒn báº£n Ä‘Æ°á»£c táº¡o thÃ nh lá»i nháº¯c. NhÆ° thá»ƒ hiá»‡n trong hÃ¬nh bÃªn dÆ°á»›i, Ä‘iá»u nÃ y lÃ m cho T5 trá»Ÿ nÃªn cá»±c ká»³ linh hoáº¡t, vÃ¬ báº¡n cÃ³ thá»ƒ giáº£i quyáº¿t nhiá»u tÃ¡c vá»¥ chá»‰ vá»›i má»™t mÃ´ hÃ¬nh duy nháº¥t!</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/t5.svg" alt="Different tasks performed by the T5 architecture.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/t5-dark.svg" alt="Different tasks performed by the T5 architecture."></div>
<p>mT5 khÃ´ng sá»­ dá»¥ng tiá»n tá»‘, nhÆ°ng chia sáº» pháº§n lá»›n tÃ­nh linh hoáº¡t cá»§a T5 vÃ  cÃ³ lá»£i tháº¿ lÃ  Ä‘a ngÃ´n ngá»¯. Giá» ta Ä‘Ã£ chá»n má»™t mÃ´ hÃ¬nh, hÃ£y xem xÃ©t viá»‡c chuáº©n bá»‹ dá»¯ liá»‡u Ä‘á»ƒ huáº¥n luyá»‡n.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Khi báº¡n Ä‘Ã£ lÃ m qua pháº§n nÃ y, hÃ£y xem mT5 so vá»›i mBART tá»‘t nhÆ° tháº¿ nÃ o báº±ng cÃ¡ch tinh chá»‰nh pháº§n sau vá»›i cÃ¡c ká»¹ thuáº­t tÆ°Æ¡ng tá»±. Äá»ƒ cÃ³ Ä‘iá»ƒm thÆ°á»Ÿng, báº¡n cÅ©ng cÃ³ thá»ƒ thá»­ tinh chá»‰nh T5 chá»‰ trÃªn cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ tiáº¿ng Anh. VÃ¬ T5 cÃ³ tiá»n tá»‘ nháº¯c Ä‘áº·c biá»‡t, báº¡n sáº½ cáº§n thÃªm  <code>summarize:</code> vÃ o trÆ°á»›c cÃ¡c máº«u Ä‘áº§u vÃ o trong cÃ¡c bÆ°á»›c tiá»n xá»­ lÃ½ bÃªn dÆ°á»›i.</p></div>
<h2 class="relative group"><a id="tin-x-l-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tin-x-l-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tiá»n xá»­ lÃ½ dá»¯ liá»‡u
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/1m7BerpSq8A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>TÃ¡c vá»¥ tiáº¿p theo cá»§a chÃºng ta lÃ  tokenize vÃ  mÃ£ hÃ³a cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ vÃ  tiÃªu Ä‘á» cá»§a chÃºng. NhÆ° thÆ°á»ng lá»‡, ta báº¯t Ä‘áº§u báº±ng cÃ¡ch táº£i tokenizer Ä‘Æ°á»£c liÃªn káº¿t vá»›i checkpoint mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c. ChÃºng ta sáº½ sá»­ dá»¥ng <code>mt5-small</code> lÃ m checkpoint Ä‘á»ƒ cÃ³ thá»ƒ tinh chá»‰nh mÃ´ hÃ¬nh trong má»™t khoáº£ng thá»i gian há»£p lÃ½:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_checkpoint = <span class="hljs-string">&quot;google/mt5-small&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Trong giai Ä‘oáº¡n Ä‘áº§u cá»§a cÃ¡c dá»± Ã¡n NLP cá»§a báº¡n, má»™t phÆ°Æ¡ng phÃ¡p hay lÃ  huáº¥n luyá»‡n má»™t lá»›p cÃ¡c mÃ´ hÃ¬nh â€œnhá»â€ trÃªn má»™t máº«u dá»¯ liá»‡u nhá». Äiá»u nÃ y cho phÃ©p báº¡n gá»¡ lá»—i vÃ  láº·p láº¡i nhanh hÆ¡n Ä‘á»‘i vá»›i quy trÃ¬nh lÃ m viá»‡c Ä‘áº§u cuá»‘i. Má»™t khi báº¡n tá»± tin vÃ o káº¿t quáº£, báº¡n luÃ´n cÃ³ thá»ƒ má»Ÿ rá»™ng mÃ´ hÃ¬nh báº±ng cÃ¡ch thay Ä‘á»•i checkpoint cá»§a mÃ´ hÃ¬nh!</p></div>
<p>HÃ£y thá»­ nghiá»‡m mT5 tokenizer trÃªn má»™t vÃ­ dá»¥ nhá»:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(<span class="hljs-string">&quot;I loved reading the Hunger Games!&quot;</span>)
inputs<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;input_ids&#x27;</span>: [<span class="hljs-number">336</span>, <span class="hljs-number">259</span>, <span class="hljs-number">28387</span>, <span class="hljs-number">11807</span>, <span class="hljs-number">287</span>, <span class="hljs-number">62893</span>, <span class="hljs-number">295</span>, <span class="hljs-number">12507</span>, <span class="hljs-number">1</span>], <span class="hljs-string">&#x27;attention_mask&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]}<!-- HTML_TAG_END --></pre></div>
<p>á» Ä‘Ã¢y, chÃºng ta cÃ³ thá»ƒ tháº¥y <code>input_ids</code> vÃ  <code>attention_mask</code> mÃ  chÃºng ta Ä‘Ã£ gáº·p trong cÃ¡c thá»­ nghiá»‡m tinh chá»‰nh Ä‘áº§u tiÃªn cá»§a chÃºng ta trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>. HÃ£y giáº£i mÃ£ cÃ¡c ID Ä‘áº§u vÃ o nÃ y báº±ng hÃ m <code>convert_ids_to_tokens()</code> cá»§a tokenizer Ä‘á»ƒ xem chÃºng ta Ä‘ang xá»­ lÃ½ loáº¡i tokenizer nÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.convert_ids_to_tokens(inputs.input_ids)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;â–I&#x27;</span>, <span class="hljs-string">&#x27;â–&#x27;</span>, <span class="hljs-string">&#x27;loved&#x27;</span>, <span class="hljs-string">&#x27;â–reading&#x27;</span>, <span class="hljs-string">&#x27;â–the&#x27;</span>, <span class="hljs-string">&#x27;â–Hung&#x27;</span>, <span class="hljs-string">&#x27;er&#x27;</span>, <span class="hljs-string">&#x27;â–Games&#x27;</span>, <span class="hljs-string">&#x27;&lt;/s&gt;&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>KÃ½ tá»± Unicode Ä‘áº·c biá»‡t <code>â–</code> vÃ  token cuá»‘i chuá»—i <code>&lt;/s&gt;</code> cho biáº¿t ta Ä‘ang xá»­ lÃ½ SentencePiece tokenizer, dá»±a trÃªn thuáº­t toÃ¡n phÃ¢n Ä‘oáº¡n Unigram Ä‘Æ°á»£c tháº£o luáº­n trong <a href="/course/chapter6">ChÆ°Æ¡ng 6</a>. Unigram Ä‘áº·c biá»‡t há»¯u Ã­ch Ä‘á»‘i vá»›i kho ngá»¯ liá»‡u Ä‘a ngÃ´n ngá»¯ vÃ¬ nÃ³ cho phÃ©p SentencePiece báº¥t kháº£ tri vá» dáº¥u, dáº¥u cÃ¢u vÃ  thá»±c táº¿ lÃ  nhiá»u ngÃ´n ngá»¯, nhÆ° tiáº¿ng Nháº­t, khÃ´ng cÃ³ kÃ½ tá»± khoáº£ng tráº¯ng.</p>
<p>Äá»ƒ mÃ£ hÃ³a kho tÃ i liá»‡u cá»§a mÃ¬nh, chÃºng ta pháº£i xá»­ lÃ½ má»™t cÃ¡ch tÃ­nh táº¿ vá»›i tÃ³m táº¯t: bá»Ÿi vÃ¬ cÃ¡c nhÃ£n cÅ©ng lÃ  vÄƒn báº£n, cÃ³ thá»ƒ chÃºng vÆ°á»£t quÃ¡ kÃ­ch thÆ°á»›c ngá»¯ cáº£nh tá»‘i Ä‘a cá»§a mÃ´ hÃ¬nh. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cáº§n Ã¡p dá»¥ng viá»‡c cáº¯t bá»›t cho cáº£ cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ vÃ  tiÃªu Ä‘á» cá»§a chÃºng Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng truyá»n cÃ¡c Ä‘áº§u vÃ o quÃ¡ dÃ i cho mÃ´ hÃ¬nh cá»§a mÃ¬nh. CÃ¡c tokenizer trong ğŸ¤— Transformers cung cáº¥p má»™t hÃ m <code>as_target_tokenizer()</code> tiá»‡n lá»£i cho phÃ©p báº¡n mÃ£ hÃ³a cÃ¡c nhÃ£n song song vá»›i cÃ¡c Ä‘áº§u vÃ o. Äiá»u nÃ y thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng trÃ¬nh quáº£n lÃ½ ngá»¯ cáº£nh bÃªn trong má»™t chá»©c nÄƒng tiá»n xá»­ lÃ½, trÆ°á»›c tiÃªn mÃ£ hÃ³a cÃ¡c Ä‘áº§u vÃ o, sau Ä‘Ã³ mÃ£ hÃ³a cÃ¡c nhÃ£n dÆ°á»›i dáº¡ng má»™t cá»™t riÃªng biá»‡t. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ vá» má»™t hÃ m nhÆ° váº­y cho mT5:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->max_input_length = <span class="hljs-number">512</span>
max_target_length = <span class="hljs-number">30</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    model_inputs = tokenizer(
        examples[<span class="hljs-string">&quot;review_body&quot;</span>], max_length=max_input_length, truncation=<span class="hljs-literal">True</span>
    )
    <span class="hljs-comment"># Thiáº¿t láº­p tokenizer cho nhÃ£n</span>
    <span class="hljs-keyword">with</span> tokenizer.as_target_tokenizer():
        labels = tokenizer(
            examples[<span class="hljs-string">&quot;review_title&quot;</span>], max_length=max_target_length, truncation=<span class="hljs-literal">True</span>
        )

    model_inputs[<span class="hljs-string">&quot;labels&quot;</span>] = labels[<span class="hljs-string">&quot;input_ids&quot;</span>]
    <span class="hljs-keyword">return</span> model_inputs<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y xem qua Ä‘oáº¡n mÃ£ nÃ y Ä‘á»ƒ hiá»ƒu Ä‘iá»u gÃ¬ Ä‘ang xáº£y ra. Äiá»u Ä‘áº§u tiÃªn chÃºng ta Ä‘Ã£ lÃ m lÃ  xÃ¡c Ä‘á»‹nh cÃ¡c giÃ¡ trá»‹ cho <code>max_input_length</code> vÃ  <code>max_target_length</code>, Ä‘áº·t giá»›i háº¡n trÃªn cho thá»i lÆ°á»£ng cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ vÃ  tiÃªu Ä‘á» cá»§a chÃºng. VÃ¬ ná»™i dung Ä‘Ã¡nh giÃ¡ thÆ°á»ng lá»›n hÆ¡n nhiá»u so vá»›i tiÃªu Ä‘á», chÃºng ta Ä‘Ã£ Ä‘iá»u chá»‰nh cÃ¡c giÃ¡ trá»‹ nÃ y cho phÃ¹ há»£p. Sau Ä‘Ã³, trong chÃ­nh <code>preprocess_function()</code>, chÃºng ta cÃ³ thá»ƒ tháº¥y cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ Ä‘Æ°á»£c tokenize Ä‘áº§u tiÃªn, tiáº¿p theo lÃ  cÃ¡c tiÃªu Ä‘á» vá»›i <code>as_target_tokenizer()</code>.</p>
<p>Vá»›i <code>preprocess_function()</code>, viá»‡c tokenize toÃ n bá»™ kho dá»¯ liá»‡u báº±ng hÃ m <code>Dataset.map()</code> tiá»‡n dá»¥ng mÃ  chÃºng ta Ä‘Ã£ sá»­ dá»¥ng rá»™ng rÃ£i trong suá»‘t khÃ³a há»c nÃ y lÃ  má»™t váº¥n Ä‘á» Ä‘Æ¡n giáº£n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets = books_dataset.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» kho dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ trÆ°á»›c, chÃºng ta hÃ£y xem xÃ©t má»™t sá»‘ chá»‰ sá»‘ thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ³m táº¯t. NhÆ° chÃºng ta sáº½ tháº¥y, khÃ´ng cÃ³ giáº£i phÃ¡p dá»… dÃ ng vÃ  nhanh chÃ³ng khi nÃ³i Ä‘áº¿n viá»‡c Ä‘o lÆ°á»ng cháº¥t lÆ°á»£ng cá»§a vÄƒn báº£n do mÃ¡y táº¡o ra.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Báº¡n cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng chÃºng ta Ä‘Ã£ sá»­ dá»¥ng <code>batched=True</code> trong hÃ m<code>Dataset.map()</code> á»Ÿ trÃªn. Äiá»u nÃ y mÃ£ hÃ³a cÃ¡c máº«u theo lÃ´ 1,000 (máº·c Ä‘á»‹nh) vÃ  cho phÃ©p báº¡n sá»­ dá»¥ng kháº£ nÄƒng Ä‘a luá»“ng cá»§a cÃ¡c bá»™ tokenizer nhanh trong ğŸ¤— Transformers. Náº¿u cÃ³ thá»ƒ, hÃ£y thá»­ sá»­ dá»¥ng <code>batched=True</code> Ä‘á»ƒ táº­n dá»¥ng tá»‘i Ä‘a quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ cá»§a báº¡n!</p></div>
<h2 class="relative group"><a id="thc-o-cho-tm-tt-vn-bn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#thc-o-cho-tm-tt-vn-bn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ThÆ°á»›c Ä‘o cho tÃ³m táº¯t vÄƒn báº£n
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/TMshhnrEXlg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>So vá»›i háº§u háº¿t cÃ¡c tÃ¡c vá»¥ khÃ¡c mÃ  chÃºng ta Ä‘Ã£ Ä‘á» cáº­p trong khÃ³a há»c nÃ y, viá»‡c Ä‘o lÆ°á»ng hiá»‡u suáº¥t cá»§a cÃ¡c tÃ¡c vá»¥ táº¡o vÄƒn báº£n nhÆ° tÃ³m táº¯t hoáº·c dá»‹ch khÃ´ng Ä‘Æ¡n giáº£n báº±ng. VÃ­ dá»¥: Ä‘Æ°á»£c Ä‘Æ°a ra má»™t bÃ i Ä‘Ã¡nh giÃ¡ nhÆ° â€œI loved reading the Hunger Gamesâ€, cÃ³ nhiá»u báº£n tÃ³m táº¯t há»£p lá»‡, cháº³ng háº¡n nhÆ° â€œI loved the Hunger Gamesâ€ hoáº·c â€œHunger Games is a great readâ€. RÃµ rÃ ng, viá»‡c Ã¡p dá»¥ng má»™t sá»‘ loáº¡i Ä‘á»‘i sÃ¡nh chÃ­nh xÃ¡c nÃ o Ä‘Ã³ giá»¯a báº£n tÃ³m táº¯t Ä‘Æ°á»£c táº¡o vÃ  nhÃ£n khÃ´ng pháº£i lÃ  má»™t giáº£i phÃ¡p tá»‘t - ngay cáº£ con ngÆ°á»i cÅ©ng sáº½ Ä‘Ã¡nh giÃ¡ tháº¥p hÆ¡n theo má»™t chá»‰ sá»‘ nhÆ° váº­y, bá»Ÿi vÃ¬ táº¥t cáº£ chÃºng ta Ä‘á»u cÃ³ phong cÃ¡ch viáº¿t riÃªng cá»§a mÃ¬nh.</p>
<p>Äá»ƒ tÃ³m táº¯t, má»™t trong nhá»¯ng chá»‰ sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n nháº¥t lÃ  <a href="https://en.wikipedia.org/wiki/ROUGE_(metric)" rel="nofollow">Ä‘iá»ƒm ROUGE</a> (viáº¿t táº¯t cá»§a Recall-Oriented Understudy for Gisting Assessment). Ã tÆ°á»Ÿng cÆ¡ báº£n Ä‘áº±ng sau thÆ°á»›c Ä‘o nÃ y lÃ  so sÃ¡nh má»™t báº£n tÃ³m táº¯t Ä‘Ã£ táº¡o vá»›i má»™t táº­p há»£p cÃ¡c báº£n tÃ³m táº¯t tham chiáº¿u thÆ°á»ng do con ngÆ°á»i táº¡o ra. Äá»ƒ lÃ m cho Ä‘iá»u nÃ y chÃ­nh xÃ¡c hÆ¡n, giáº£ sá»­ chÃºng ta muá»‘n so sÃ¡nh hai báº£n tÃ³m táº¯t sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->generated_summary = <span class="hljs-string">&quot;I absolutely loved reading the Hunger Games&quot;</span>
reference_summary = <span class="hljs-string">&quot;I loved reading the Hunger Games&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>Má»™t cÃ¡ch Ä‘á»ƒ cÃ³ thá»ƒ so sÃ¡nh chÃºng lÃ  Ä‘áº¿m sá»‘ tá»« trÃ¹ng láº·p, trong trÆ°á»ng há»£p nÃ y sáº½ lÃ  6. Tuy nhiÃªn, Ä‘iá»u nÃ y hÆ¡i thÃ´, vÃ¬ váº­y thay vÃ o Ä‘Ã³ ROUGE dá»±a trÃªn viá»‡c tÃ­nh toÃ¡n Ä‘iá»ƒm sá»‘ <em>precision</em>  vÃ  <em>recall</em> cho sá»± trÃ¹ng láº·p.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ™‹ Äá»«ng lo láº¯ng náº¿u Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn báº¡n nghe nÃ³i vá» precision vÃ  recall - chÃºng ta sáº½ cÃ¹ng nhau Ä‘iá»ƒm qua má»™t sá»‘ vÃ­ dá»¥ rÃµ rÃ ng Ä‘á»ƒ lÃ m rÃµ táº¥t cáº£. CÃ¡c chá»‰ sá»‘ nÃ y thÆ°á»ng gáº·p trong cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i, vÃ¬ váº­y náº¿u báº¡n muá»‘n hiá»ƒu cÃ¡ch xÃ¡c Ä‘á»‹nh precision vÃ  recall trong ngá»¯ cáº£nh Ä‘Ã³, chÃºng tÃ´i khuyÃªn báº¡n nÃªn xem <a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html" rel="nofollow">hÆ°á»›ng dáº«n <code>scikit-learn</code></a>.</p></div>
<p>Äá»‘i vá»›i ROUGE, recall Ä‘o lÆ°á»ng má»©c Ä‘á»™ tÃ³m táº¯t tham chiáº¿u thu Ä‘Æ°á»£c tá»« cÃ¡i Ä‘Ã£ táº¡o. Náº¿u chÃºng ta chá»‰ so sÃ¡nh cÃ¡c tá»«, recall cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh theo cÃ´ng thá»©c sau:
<!-- HTML_TAG_START --><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi></mrow><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext>â€‰</mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mtext>â€‰</mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mtext>â€‰</mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mtext>â€‰</mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \mathrm{Recall} = \frac{\mathrm{Number\,of\,overlapping\, words}}{\mathrm{Total\, number\, of\, words\, in\, reference\, summary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Recall</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Total</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">in</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">reference</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">summary</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">overlapping</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!-- HTML_TAG_END --></p>
<p>Äá»‘i vá»›i vÃ­ dá»¥ Ä‘Æ¡n giáº£n á»Ÿ trÃªn, cÃ´ng thá»©c nÃ y cho phÃ©p nhá»› hoÃ n háº£o lÃ  6/6 = 1; tá»©c lÃ  táº¥t cáº£ cÃ¡c tá»« trong báº£n tÃ³m táº¯t tham chiáº¿u Ä‘Ã£ Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh. Äiá»u nÃ y nghe cÃ³ váº» tuyá»‡t vá»i, nhÆ°ng hÃ£y tÆ°á»Ÿng tÆ°á»£ng náº¿u báº£n tÃ³m táº¯t Ä‘Æ°á»£c táº¡o cá»§a chÃºng ta lÃ  â€œI really really loved reading the Hunger Games all nightâ€. Äiá»u nÃ y cÅ©ng sáº½ cÃ³ má»™t recall hoÃ n háº£o, nhÆ°ng Ä‘Æ°á»£c cho lÃ  má»™t báº£n tÃ³m táº¯t tá»“i tá»‡ hÆ¡n vÃ¬ nÃ³ dÃ i dÃ²ng. Äá»ƒ Ä‘á»‘i phÃ³ vá»›i nhá»¯ng tÃ¬nh huá»‘ng nÃ y, chÃºng ta cÅ©ng tÃ­nh toÃ¡n Ä‘á»™ precision, trong ngá»¯ cáº£nh ROUGE Ä‘o lÆ°á»ng má»©c Ä‘á»™ liÃªn quan cá»§a báº£n tÃ³m táº¯t Ä‘Ã£ táº¡o:
<!-- HTML_TAG_START --><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi></mrow><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext>â€‰</mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mtext>â€‰</mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mtext>â€‰</mtext><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mtext>â€‰</mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \mathrm{Precision} = \frac{\mathrm{Number\,of\,overlapping\, words}}{\mathrm{Total\, number\, of\, words\, in\, generated\, summary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">Precision</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Total</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">in</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">generated</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">summary</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">overlapping</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!-- HTML_TAG_END --></p>
<p>Ãp dá»¥ng Ä‘iá»u nÃ y cho báº£n tÃ³m táº¯t dÃ i dÃ²ng cá»§a chÃºng ta sáº½ cho precision lÃ  6/10 = 0.6, tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i precision 6/7 = 0.86 thu Ä‘Æ°á»£c báº±ng phÆ°Æ¡ng phÃ¡p ngáº¯n hÆ¡n cá»§a mÃ¬nh. Trong thá»±c táº¿, cáº£ precision vÃ  recall thÆ°á»ng Ä‘Æ°á»£c tÃ­nh toÃ¡n, vÃ  sau Ä‘Ã³ Ä‘iá»ƒm F1 (giÃ¡ trá»‹ trung bÃ¬nh hÃ i hÃ²a cá»§a precision vÃ  recall) Ä‘Æ°á»£c bÃ¡o cÃ¡o. ChÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n viá»‡c nÃ y dá»… dÃ ng trong ğŸ¤— Datasets báº±ng cÃ¡ch cÃ i Ä‘áº·t gÃ³i <code>rouge_score</code> trÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!pip install rouge_score<!-- HTML_TAG_END --></pre></div>
<p>vÃ  sau Ä‘Ã³ táº£i chá»‰ sá»‘ ROUGE nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

rouge_score = evaluate.load(<span class="hljs-string">&quot;rouge&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³ ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m <code>rouge_score.compute()</code> Ä‘á»ƒ tÃ­nh táº¥t cáº£ cÃ¡c chá»‰ sá»‘ trong má»™t láº§n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->scores = rouge_score.compute(
    predictions=[generated_summary], references=[reference_summary]
)
scores<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;rouge1&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)),
 <span class="hljs-string">&#x27;rouge2&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>), mid=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>), high=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>)),
 <span class="hljs-string">&#x27;rougeL&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)),
 <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>))}<!-- HTML_TAG_END --></pre></div>
<p>ChÃ , cÃ³ ráº¥t nhiá»u thÃ´ng tin trong Ä‘áº§u ra Ä‘Ã³ - táº¥t cáº£ cÃ³ nghÄ©a lÃ  gÃ¬? Äáº§u tiÃªn, ğŸ¤— Datasets thá»±c sá»± tÃ­nh toÃ¡n khoáº£ng tin cáº­y cho precision, recall vÃ  F1 score; Ä‘Ã¢y lÃ  cÃ¡c thuá»™c tÃ­nh <code>low</code>, <code>mid</code> vÃ  <code>high</code> mÃ  báº¡n cÃ³ thá»ƒ xem á»Ÿ Ä‘Ã¢y. HÆ¡n ná»¯a, ğŸ¤— Datasets tÃ­nh toÃ¡n nhiá»u Ä‘iá»ƒm ROUGE khÃ¡c nhau dá»±a trÃªn cÃ¡c loáº¡i vÄƒn báº£n chi tiáº¿t khÃ¡c nhau khi so sÃ¡nh cÃ¡c tÃ³m táº¯t Ä‘Ã£ táº¡o vÃ  tham chiáº¿u. Biáº¿n thá»ƒ <code>rouge1</code> lÃ  sá»± chá»“ng chÃ©o cá»§a cÃ¡c khá»‘i Ä‘Æ¡n - Ä‘Ã¢y chá»‰ lÃ  má»™t cÃ¡ch nÃ³i hoa má»¹ Ä‘á»ƒ nÃ³i vá» sá»± chá»“ng chÃ©o cá»§a cÃ¡c tá»« vÃ  chÃ­nh xÃ¡c lÃ  sá»‘ liá»‡u mÃ  chÃºng ta Ä‘Ã£ tháº£o luáº­n á»Ÿ trÃªn. Äá»ƒ xÃ¡c minh Ä‘iá»u nÃ y, chÃºng ta hÃ£y láº¥y ra giÃ¡ trá»‹ <code>mid</code> Ä‘iá»ƒm sá»‘ cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->scores[<span class="hljs-string">&quot;rouge1&quot;</span>].mid<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)<!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t vá»i, precision vÃ  recall láº¡i khá»›p vá»›i nhau! CÃ²n nhá»¯ng Ä‘iá»ƒm ROUGE khÃ¡c thÃ¬ sao? <code>rouge2</code> Ä‘o lÆ°á»ng sá»± trÃ¹ng láº·p giá»¯a cÃ¡c bigram (hÃ£y nghÄ© ráº±ng Ä‘Ã³ lÃ  sá»± chá»“ng chÃ©o cá»§a cÃ¡c cáº·p tá»«), trong khi <code>rougeL</code> vÃ  <code>rougeLsum</code> Ä‘o lÆ°á»ng cÃ¡c chuá»—i tá»« phÃ¹ há»£p dÃ i nháº¥t báº±ng cÃ¡ch tÃ¬m kiáº¿m cÃ¡c chuá»—i con chung dÃ i nháº¥t trong cÃ¡c báº£n tÃ³m táº¯t Ä‘Æ°á»£c táº¡o vÃ  tham chiáº¿u. â€œsumâ€ trong <code>rougeLsum</code> Ä‘á» cáº­p Ä‘áº¿n thá»±c táº¿ lÃ  chá»‰ sá»‘ nÃ y Ä‘Æ°á»£c tÃ­nh trÃªn toÃ n bá»™ báº£n tÃ³m táº¯t, trong khi <code>rougeL</code> Ä‘Æ°á»£c tÃ­nh lÃ  giÃ¡ trá»‹ trung bÃ¬nh trÃªn cÃ¡c cÃ¢u riÃªng láº».</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Táº¡o vÃ­ dá»¥ cá»§a riÃªng báº¡n vá» báº£n tÃ³m táº¯t Ä‘Æ°á»£c táº¡o vÃ  tham kháº£o, vÃ  xem liá»‡u Ä‘iá»ƒm káº¿t quáº£ ROUGE cÃ³ giá»‘ng vá»›i tÃ­nh toÃ¡n thá»§ cÃ´ng dá»±a trÃªn cÃ¡c cÃ´ng thá»©c vá» precision vÃ  recall hay khÃ´ng. Äá»ƒ cÃ³ Ä‘iá»ƒm thÆ°á»Ÿng, hÃ£y chia vÄƒn báº£n thÃ nh bigrams vÃ  so sÃ¡nh Ä‘á»™ chÃ­nh xÃ¡c vÃ  thu há»“i cho chá»‰ sá»‘ <code>rouge2</code>.</p></div>
<p>ChÃºng tÃ´i sáº½ sá»­ dá»¥ng cÃ¡c Ä‘iá»ƒm ROUGE nÃ y Ä‘á»ƒ theo dÃµi hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh, nhÆ°ng trÆ°á»›c khi lÃ m Ä‘iá»u Ä‘Ã³, hÃ£y lÃ m Ä‘iá»u mÃ  má»i ngÆ°á»i thá»±c hÃ nh NLP giá»i nÃªn lÃ m: táº¡o má»™t Ä‘Æ°á»ng cÆ¡ sá»Ÿ máº¡nh máº½ nhÆ°ng Ä‘Æ¡n giáº£n!</p>
<h3 class="relative group"><a id="to-mt-ng-c-s-mnh-m" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#to-mt-ng-c-s-mnh-m"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Táº¡o má»™t Ä‘Æ°á»ng cÆ¡ sá»Ÿ máº¡nh máº½
	</span></h3>

<p>MÃ´t mÃ´ hÃ¬nh cÆ¡ sá»Ÿ cho tÃ³m táº¯t vÄƒn báº£n, Ä‘Ã³ lÃ  chá»‰ cáº§n láº¥y ba cÃ¢u Ä‘áº§u tiÃªn cá»§a má»™t bÃ i bÃ¡o, thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <em>lead-3</em> hay <em>3 bÃ i Ä‘áº§u</em>. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c dáº¥u cháº¥m Ä‘á»ƒ theo dÃµi ranh giá»›i cÃ¢u, nhÆ°ng Ä‘iá»u nÃ y sáº½ khÃ´ng thÃ nh cÃ´ng Ä‘á»‘i vá»›i cÃ¡c tá»« viáº¿t táº¯t nhÆ° â€œU.S.â€ hoáº·c â€œU.N.â€ - vÃ¬ váº­y thay vÃ o Ä‘Ã³, chÃºng ta sáº½ sá»­ dá»¥ng thÆ° viá»‡n <code>nltk</code>, bao gá»“m má»™t thuáº­t toÃ¡n tá»‘t hÆ¡n Ä‘á»ƒ xá»­ lÃ½ nhá»¯ng trÆ°á»ng há»£p nÃ y. Báº¡n cÃ³ thá»ƒ cÃ i Ä‘áº·t gÃ³i báº±ng cÃ¡ch sá»­ dá»¥ng <code>pip</code> nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!pip install nltk<!-- HTML_TAG_END --></pre></div>
<p>vÃ  sau Ä‘Ã³ táº£i cÃ¡c quy táº¯c dáº¥u cÃ¢u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> nltk

nltk.download(<span class="hljs-string">&quot;punkt&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, chÃºng ta nháº­p tokenizer cÃ¢u tá»« <code>nltk</code> vÃ  táº¡o má»™t hÃ m Ä‘Æ¡n giáº£n Ä‘á»ƒ trÃ­ch xuáº¥t ba cÃ¢u Ä‘áº§u tiÃªn trong má»™t bÃ i Ä‘Ã¡nh giÃ¡. Quy Æ°á»›c trong pháº§n tÃ³m táº¯t vÄƒn báº£n lÃ  tÃ¡ch tá»«ng pháº§n tÃ³m táº¯t báº±ng má»™t dÃ²ng má»›i, vÃ¬ váº­y hÃ£y bao gá»“m pháº§n nÃ y vÃ  kiá»ƒm tra nÃ³ trÃªn má»™t vÃ­ dá»¥ huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> nltk.tokenize <span class="hljs-keyword">import</span> sent_tokenize


<span class="hljs-keyword">def</span> <span class="hljs-title function_">three_sentence_summary</span>(<span class="hljs-params">text</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(text)[:<span class="hljs-number">3</span>])


<span class="hljs-built_in">print</span>(three_sentence_summary(books_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;review_body&quot;</span>]))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;I grew up reading Koontz, and years ago, I stopped,convinced i had &quot;outgrown&quot; him.&#x27;</span>
<span class="hljs-string">&#x27;Still,when a friend was looking for something suspenseful too read, I suggested Koontz.&#x27;</span>
<span class="hljs-string">&#x27;She found Strangers.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y cÃ³ váº» hiá»‡u quáº£, vÃ¬ váº­y bÃ¢y giá» chÃºng ta hÃ£y triá»ƒn khai má»™t hÃ m trÃ­ch xuáº¥t cÃ¡c â€œtÃ³m táº¯tâ€ nÃ y tá»« táº­p dá»¯ liá»‡u vÃ  tÃ­nh toÃ¡n Ä‘iá»ƒm ROUGE cho mÃ´ hÃ¬nh cÆ¡ sá»Ÿ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_baseline</span>(<span class="hljs-params">dataset, metric</span>):
    summaries = [three_sentence_summary(text) <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> dataset[<span class="hljs-string">&quot;review_body&quot;</span>]]
    <span class="hljs-keyword">return</span> metric.compute(predictions=summaries, references=dataset[<span class="hljs-string">&quot;review_title&quot;</span>])<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng hÃ m nÃ y Ä‘á»ƒ tÃ­nh toÃ¡n Ä‘iá»ƒm ROUGE trÃªn táº­p kiá»ƒm Ä‘á»‹nh vÃ  kiá»ƒm tra chÃºng má»™t chÃºt báº±ng cÃ¡ch sá»­ dá»¥ng Pandas:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

score = evaluate_baseline(books_dataset[<span class="hljs-string">&quot;validation&quot;</span>], rouge_score)
rouge_names = [<span class="hljs-string">&quot;rouge1&quot;</span>, <span class="hljs-string">&quot;rouge2&quot;</span>, <span class="hljs-string">&quot;rougeL&quot;</span>, <span class="hljs-string">&quot;rougeLsum&quot;</span>]
rouge_dict = <span class="hljs-built_in">dict</span>((rn, <span class="hljs-built_in">round</span>(score[rn].mid.fmeasure * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> rouge_names)
rouge_dict<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">16.74</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">8.83</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">15.6</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">15.96</span>}<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng Ä‘iá»ƒm <code>rouge2</code> tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i pháº§n cÃ²n láº¡i; Ä‘iá»u nÃ y cÃ³ thá»ƒ pháº£n Ã¡nh thá»±c táº¿ lÃ  tiÃªu Ä‘á» bÃ i Ä‘Ã¡nh giÃ¡ thÆ°á»ng ngáº¯n gá»n vÃ  do Ä‘Ã³, mÃ´ hÃ¬nh cÆ¡ sá»Ÿ cá»§a 3 bÃ i Ä‘áº§u quÃ¡ dÃ i dÃ²ng. BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ má»™t cÆ¡ sá»Ÿ tá»‘t Ä‘á»ƒ lÃ m viá»‡c, hÃ£y chuyá»ƒn sá»± chÃº Ã½ cá»§a chÃºng ta sang viá»‡c tinh chá»‰nh mT5!</p>
<h2 class="relative group"><a id="tinh-chnh-mt5-vi-api-trainer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-mt5-vi-api-trainer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mT5 vá»›i API <code>Trainer</code></span></h2>

<p>Viá»‡c tinh chá»‰nh má»™t mÃ´ hÃ¬nh Ä‘á»ƒ tÃ³m táº¯t ráº¥t giá»‘ng vá»›i cÃ¡c tÃ¡c vá»¥ khÃ¡c mÃ  chÃºng ta Ä‘Ã£ Ä‘á» cáº­p trong chÆ°Æ¡ng nÃ y. Äiá»u Ä‘áº§u tiÃªn chÃºng ta cáº§n lÃ m lÃ  táº£i mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c tá»« checkpoint <code>mt5-small</code>. VÃ¬ tÃ³m táº¯t lÃ  má»™t tÃ¡c vá»¥ chuá»—i sang chuá»—i, chÃºng ta cÃ³ thá»ƒ táº£i mÃ´ hÃ¬nh báº±ng lá»›p <code>AutoModelForSeq2SeqLM</code>, lá»›p nÃ y sáº½ tá»± Ä‘á»™ng táº£i xuá»‘ng vÃ  lÆ°u vÃ o bá»™ nhá»› cache cÃ¡c trá»ng sá»‘:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForSeq2SeqLM

model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u báº¡n Ä‘ang tá»± há»i táº¡i sao báº¡n khÃ´ng tháº¥y báº¥t ká»³ cáº£nh bÃ¡o nÃ o vá» viá»‡c tinh chá»‰nh mÃ´ hÃ¬nh trÃªn má»™t tÃ¡c vá»¥ phÃ­a sau, Ä‘Ã³ lÃ  bá»Ÿi vÃ¬ Ä‘á»‘i vá»›i cÃ¡c tÃ¡c vá»¥ chuá»—i sang chuá»—i, chÃºng ta giá»¯ táº¥t cáº£ cÃ¡c trá»ng sá»‘ cá»§a máº¡ng. So sÃ¡nh mÃ´ hÃ¬nh nÃ y vá»›i mÃ´ hÃ¬nh phÃ¢n loáº¡i vÄƒn báº£n trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>, trong Ä‘Ã³ pháº§n Ä‘áº§u cá»§a mÃ´ hÃ¬nh Ä‘á»‹nh sáºµn Ä‘Æ°á»£c thay tháº¿ báº±ng má»™t máº¡ng Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn.</p></div>
<p>Äiá»u tiáº¿p theo chÃºng ta cáº§n lÃ m lÃ  Ä‘Äƒng nháº­p vÃ o Hugging Face Hub. Náº¿u báº¡n Ä‘ang cháº¡y Ä‘oáº¡n mÃ£ nÃ y trong notebook, báº¡n cÃ³ thá»ƒ lÃ m nhÆ° váº­y vá»›i hÃ m tiá»‡n Ã­ch sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>sáº½ hiá»ƒn thá»‹ má»™t tiá»‡n Ã­ch mÃ  báº¡n cÃ³ thá»ƒ nháº­p thÃ´ng tin Ä‘Äƒng nháº­p cá»§a mÃ¬nh. NgoÃ i ra, báº¡n cÃ³ thá»ƒ cháº¡y lá»‡nh nÃ y trong thiáº¿t bá»‹ Ä‘áº§u cuá»‘i cá»§a mÃ¬nh vÃ  Ä‘Äƒng nháº­p vÃ o Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-<span class="hljs-keyword">cli</span> login<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta sáº½ cáº§n táº¡o tÃ³m táº¯t Ä‘á»ƒ tÃ­nh Ä‘iá»ƒm ROUGE trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. May máº¯n thay, ğŸ¤— Transformers cung cáº¥p cÃ¡c lá»›p <code>Seq2SeqTrainingArguments</code> vÃ  <code>Seq2SeqTrainer</code> chuyÃªn dá»¥ng cÃ³ thá»ƒ tá»± Ä‘á»™ng lÃ m viá»‡c nÃ y cho chÃºng ta! Äá»ƒ xem cÃ¡ch nÃ y hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o, trÆ°á»›c tiÃªn chÃºng ta hÃ£y xÃ¡c Ä‘á»‹nh cÃ¡c siÃªu tham sá»‘ vÃ  cÃ¡c tham sá»‘ khÃ¡c cho cÃ¡c thá»­ nghiá»‡m cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Seq2SeqTrainingArguments

batch_size = <span class="hljs-number">8</span>
num_train_epochs = <span class="hljs-number">8</span>
<span class="hljs-comment"># Hiá»‡n thá»‹ máº¥t mÃ¡t huáº¥n luyá»‡n má»—i epoch</span>
logging_steps = <span class="hljs-built_in">len</span>(tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>]) // batch_size
model_name = model_checkpoint.split(<span class="hljs-string">&quot;/&quot;</span>)[-<span class="hljs-number">1</span>]

args = Seq2SeqTrainingArguments(
    output_dir=<span class="hljs-string">f&quot;<span class="hljs-subst">{model_name}</span>-finetuned-amazon-en-es&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">5.6e-5</span>,
    per_device_train_batch_size=batch_size,
    per_device_eval_batch_size=batch_size,
    weight_decay=<span class="hljs-number">0.01</span>,
    save_total_limit=<span class="hljs-number">3</span>,
    num_train_epochs=num_train_epochs,
    predict_with_generate=<span class="hljs-literal">True</span>,
    logging_steps=logging_steps,
    push_to_hub=<span class="hljs-literal">True</span>,
)<!-- HTML_TAG_END --></pre></div>
<p>á» Ä‘Ã¢y, tham sá»‘ <code>predict_with_generate</code> Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t Ä‘á»ƒ chá»‰ ra ráº±ng chÃºng ta nÃªn táº¡o cÃ¡c báº£n tÃ³m táº¯t trong quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡ Ä‘á»ƒ cÃ³ thá»ƒ tÃ­nh toÃ¡n Ä‘iá»ƒm ROUGE cho má»—i epoch. NhÆ° Ä‘Ã£ tháº£o luáº­n trong <a href="/course/chapter1">ChÆ°Æ¡ng 1</a>, bá»™ giáº£i mÃ£ thá»±c hiá»‡n luáº­n suy báº±ng cÃ¡ch dá»± Ä‘oÃ¡n tá»«ng token vÃ  Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi phÆ°Æ¡ng thá»©c <code>generate()</code> cá»§a mÃ´ hÃ¬nh. Äáº·t <code>predict_with_generate=True</code> sáº½ cho <code>Seq2SeqTrainer</code> sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Ä‘Ã³ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡. ChÃºng ta cÅ©ng Ä‘Ã£ Ä‘iá»u chá»‰nh má»™t sá»‘ siÃªu tham sá»‘ máº·c Ä‘á»‹nh, nhÆ° tá»‘c Ä‘á»™ há»c, sá»‘ epoch vÃ  giáº£m trá»ng sá»‘ vÃ  chÃºng ta Ä‘Ã£ Ä‘áº·t tÃ¹y chá»n <code>save_total_limit</code> Ä‘á»ƒ chá»‰ lÆ°u tá»‘i Ä‘a 3 checkpoint trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n - Ä‘iá»u nÃ y lÃ  do ngay cáº£ phiÃªn báº£n â€œnhá»â€ cá»§a mT5 sá»­ dá»¥ng khoáº£ng má»™t GB dung lÆ°á»£ng á»• cá»©ng vÃ  chÃºng ta cÃ³ thá»ƒ tiáº¿t kiá»‡m má»™t chÃºt dung lÆ°á»£ng báº±ng cÃ¡ch giá»›i háº¡n sá»‘ lÆ°á»£ng báº£n sao ta lÆ°u.</p>
<p>Tham sá»‘ <code>push_to_hub=True</code> sáº½ cho phÃ©p chÃºng ta Ä‘áº©y mÃ´ hÃ¬nh vÃ o Hub sau khi huáº¥n luyá»‡n; báº¡n sáº½ tÃ¬m tháº¥y kho lÆ°u trá»¯ bÃªn dÆ°á»›i há»“ sÆ¡ ngÆ°á»i dÃ¹ng cá»§a mÃ¬nh á»Ÿ vá»‹ trÃ­ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi <code>output_dir</code>. LÆ°u Ã½ ráº±ng báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh tÃªn cá»§a kho lÆ°u trá»¯ mÃ  báº¡n muá»‘n Ä‘áº©y Ä‘áº¿n báº±ng tham sá»‘ <code>hub_model_id</code> (cá»¥ thá»ƒ lÃ  báº¡n sáº½ pháº£i sá»­ dá»¥ng tham sá»‘ nÃ y Ä‘á»ƒ Ä‘áº©y Ä‘áº¿n má»™t tá»• chá»©c). VÃ­ dá»¥: khi chÃºng ta Ä‘áº©y mÃ´ hÃ¬nh vÃ o tá»• chá»©c <a href="https://huggingface.co/huggingface-course" rel="nofollow"><code>huggingface-course</code></a>, chÃºng ta Ä‘Ã£ thÃªm <code>hub_model_id=&quot;huggingface-course/mt5-finetuned-amazon-en-es&quot;</code> thÃ nh <code>Seq2SeqTrainingArguments</code>.</p>
<p>Äiá»u tiáº¿p theo chÃºng ta cáº§n lÃ m lÃ  cung cáº¥p cho ngÆ°á»i huáº¥n luyá»‡n má»™t hÃ m <code>compute_metrics()</code> Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh cá»§a mÃ¬nh trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Äá»ƒ tÃ³m táº¯t, Ä‘iá»u nÃ y cáº§n nhiá»u hÆ¡n lÃ  Ä‘Æ¡n giáº£n gá»i <code>rouge_score.compute()</code> trÃªn cÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh, vÃ¬ chÃºng ta cáº§n <em>giáº£i mÃ£</em> cÃ¡c káº¿t quáº£ Ä‘áº§u ra vÃ  nhÃ£n thÃ nh vÄƒn báº£n trÆ°á»›c khi chÃºng ta cÃ³ thá»ƒ tÃ­nh Ä‘iá»ƒm ROUGE. HÃ m sau thá»±c hiá»‡n chÃ­nh xÃ¡c Ä‘iá»u Ä‘Ã³ vÃ  cÅ©ng sá»­ dá»¥ng hÃ m <code>sent_tokenize()</code> tá»« <code>nltk</code> Ä‘á»ƒ tÃ¡ch cÃ¡c cÃ¢u tÃ³m táº¯t báº±ng cÃ¡c dÃ²ng má»›i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-comment"># Giáº£i mÃ£ cÃ¡c tÃ³m táº¯t Ä‘Æ°á»£c táº¡o ra thÃ nh vÄƒn báº£n</span>
    decoded_preds = tokenizer.batch_decode(predictions, skip_special_tokens=<span class="hljs-literal">True</span>)
    <span class="hljs-comment"># Thay -100 vÃ o nhÃ£n vÃ¬ ta khÃ´ng thá»ƒ giáº£i mÃ£ chÃºng</span>
    labels = np.where(labels != -<span class="hljs-number">100</span>, labels, tokenizer.pad_token_id)
    <span class="hljs-comment"># Giáº£i mÃ£ cÃ¡c tÃ³m táº¯t máº«u thÃ nh vÄƒn báº£n</span>
    decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=<span class="hljs-literal">True</span>)
    <span class="hljs-comment"># ROUGE kÃ¬ vá»ng dÃ²ng má»›i sau má»—i cÃ¢u</span>
    decoded_preds = [<span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(pred.strip())) <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> decoded_preds]
    decoded_labels = [<span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(label.strip())) <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> decoded_labels]
    <span class="hljs-comment"># TÃ­nh Ä‘iá»ƒm ROUGE</span>
    result = rouge_score.compute(
        predictions=decoded_preds, references=decoded_labels, use_stemmer=<span class="hljs-literal">True</span>
    )
    <span class="hljs-comment"># TrÃ­ch xuáº¥t Ä‘iá»ƒm trung vá»‹</span>
    result = {key: value.mid.fmeasure * <span class="hljs-number">100</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> result.items()}
    <span class="hljs-keyword">return</span> {k: <span class="hljs-built_in">round</span>(v, <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> result.items()}<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, chÃºng ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh má»™t bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u cho tÃ¡c vá»¥ chuá»—i sang chuá»—i cá»§a chÃºng ta. VÃ¬ mT5 lÃ  mÃ´ hÃ¬nh Transformer bá»™ mÃ£ hÃ³a-giáº£i mÃ£, má»™t Ä‘iá»u tinh táº¿ khi chuáº©n bá»‹ cÃ¡c lÃ´ lÃ  trong quÃ¡ trÃ¬nh giáº£i mÃ£, chÃºng ta cáº§n chuyá»ƒn cÃ¡c nhÃ£n sang pháº£i tá»«ng nhÃ£n. Äiá»u nÃ y lÃ  báº¯t buá»™c Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng bá»™ giáº£i mÃ£ chá»‰ nhÃ¬n tháº¥y cÃ¡c nhÃ£n trÆ°á»›c Ä‘Ã³ chá»© khÃ´ng pháº£i nhÃ£n hiá»‡n táº¡i hoáº·c tÆ°Æ¡ng lai, Ä‘iá»u nÃ y sáº½ giÃºp mÃ´ hÃ¬nh dá»… dÃ ng ghi nhá»›. Äiá»u nÃ y tÆ°Æ¡ng tá»± nhÆ° cÃ¡ch Ã¡p dá»¥ng masked self-attention cho cÃ¡c Ä‘áº§u vÃ o trong má»™t tÃ¡c vá»¥ nhÆ° <a href="/course/chapter7/6">mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£</a>.</p>
<p>May máº¯n thay, ğŸ¤— Transformers cung cáº¥p má»™t bá»™ Ä‘á»‘i chiáº¿u <code>DataCollatorForSeq2Seq</code> sáº½ tá»± Ä‘á»™ng Ä‘á»‡m cÃ¡c Ä‘áº§u vÃ o vÃ  nhÃ£n cho chÃºng ta. Äá»ƒ khá»Ÿi táº¡o bá»™ Ä‘á»‘i chiáº¿u nÃ y, chÃºng ta chá»‰ cáº§n cung cáº¥p <code>tokenizer</code> vÃ  <code>model</code>:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> DataCollatorForSeq2Seq

data_collator = DataCollatorForSeq2Seq(tokenizer, model=model)<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y xem nhá»¯ng gÃ¬ mÃ  mÃ¡y Ä‘á»‘i chiáº¿u nÃ y táº¡o ra khi Ä‘Æ°á»£c cung cáº¥p má»™t loáº¡t cÃ¡c vÃ­ dá»¥ nhá». Äáº§u tiÃªn, chÃºng ta cáº§n xÃ³a cÃ¡c cá»™t cÃ³ chuá»—i vÃ¬ trÃ¬nh Ä‘á»‘i chiáº¿u sáº½ khÃ´ng biáº¿t cÃ¡ch chÃ¨n cÃ¡c pháº§n tá»­ nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets = tokenized_datasets.remove_columns(
    books_dataset[<span class="hljs-string">&quot;train&quot;</span>].column_names
)<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ bá»™ Ä‘á»‘i chiáº¿u mong Ä‘á»£i má»™t danh sÃ¡ch cÃ¡c <code>dict</code>, trong Ä‘Ã³ má»—i <code>dict</code> Ä‘áº¡i diá»‡n cho má»™t vÃ­ dá»¥ duy nháº¥t trong táº­p dá»¯ liá»‡u, chÃºng ta cÅ©ng cáº§n cuá»™n dá»¯ liá»‡u thÃ nh Ä‘á»‹nh dáº¡ng mong Ä‘á»£i trÆ°á»›c khi chuyá»ƒn nÃ³ Ä‘áº¿n bá»™ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->features = [tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]
data_collator(features)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;attention_mask&#x27;</span>: tensor([[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>,
         <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>,
         <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;input_ids&#x27;</span>: tensor([[  <span class="hljs-number">1494</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">8622</span>,    <span class="hljs-number">390</span>,    <span class="hljs-number">259</span>,    <span class="hljs-number">262</span>,   <span class="hljs-number">2316</span>,   <span class="hljs-number">3435</span>,    <span class="hljs-number">955</span>,
            <span class="hljs-number">772</span>,    <span class="hljs-number">281</span>,    <span class="hljs-number">772</span>,   <span class="hljs-number">1617</span>,    <span class="hljs-number">263</span>,    <span class="hljs-number">305</span>,  <span class="hljs-number">14701</span>,    <span class="hljs-number">260</span>,   <span class="hljs-number">1385</span>,
           <span class="hljs-number">3031</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">24146</span>,    <span class="hljs-number">332</span>,   <span class="hljs-number">1037</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">43906</span>,    <span class="hljs-number">305</span>,    <span class="hljs-number">336</span>,
            <span class="hljs-number">260</span>,      <span class="hljs-number">1</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>],
        [   <span class="hljs-number">259</span>,  <span class="hljs-number">27531</span>,  <span class="hljs-number">13483</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">7505</span>,    <span class="hljs-number">260</span>, <span class="hljs-number">112240</span>,  <span class="hljs-number">15192</span>,    <span class="hljs-number">305</span>,
          <span class="hljs-number">53198</span>,    <span class="hljs-number">276</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">74060</span>,    <span class="hljs-number">263</span>,    <span class="hljs-number">260</span>,    <span class="hljs-number">459</span>,  <span class="hljs-number">25640</span>,    <span class="hljs-number">776</span>,
           <span class="hljs-number">2119</span>,    <span class="hljs-number">336</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">2220</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">18896</span>,    <span class="hljs-number">288</span>,   <span class="hljs-number">4906</span>,    <span class="hljs-number">288</span>,
           <span class="hljs-number">1037</span>,   <span class="hljs-number">3931</span>,    <span class="hljs-number">260</span>,   <span class="hljs-number">7083</span>, <span class="hljs-number">101476</span>,   <span class="hljs-number">1143</span>,    <span class="hljs-number">260</span>,      <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;labels&#x27;</span>: tensor([[ <span class="hljs-number">7483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">2364</span>, <span class="hljs-number">15695</span>,     <span class="hljs-number">1</span>,  -<span class="hljs-number">100</span>],
        [  <span class="hljs-number">259</span>, <span class="hljs-number">27531</span>, <span class="hljs-number">13483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">7505</span>,     <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;decoder_input_ids&#x27;</span>: tensor([[    <span class="hljs-number">0</span>,  <span class="hljs-number">7483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">2364</span>, <span class="hljs-number">15695</span>,     <span class="hljs-number">1</span>],
        [    <span class="hljs-number">0</span>,   <span class="hljs-number">259</span>, <span class="hljs-number">27531</span>, <span class="hljs-number">13483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">7505</span>]])}<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u chÃ­nh cáº§n chÃº Ã½ á»Ÿ Ä‘Ã¢y lÃ  máº«u Ä‘áº§u tiÃªn dÃ i hÆ¡n thá»© hai, do Ä‘Ã³, <code>input_ids</code> vÃ  <code>attention_mask</code> cá»§a máº«u thá»© hai Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‡m á»Ÿ bÃªn pháº£i báº±ng <code>[PAD]</code> (cÃ³ ID lÃ  <code>0</code>). TÆ°Æ¡ng tá»±, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng <code>labels</code> Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‡m báº±ng <code>-100</code>, Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng cÃ¡c token Ä‘á»‡m Ä‘Æ°á»£c bá» qua bá»Ÿi hÃ m máº¥t mÃ¡t. VÃ  cuá»‘i cÃ¹ng, chÃºng ta cÃ³ thá»ƒ tháº¥y má»™t <code>decoder_input_ids</code> má»›i Ä‘Ã£ chuyá»ƒn cÃ¡c nhÃ£n sang bÃªn pháº£i báº±ng cÃ¡ch chÃ¨n <code>[PAD]</code> vÃ o má»¥c nháº­p Ä‘áº§u tiÃªn.</p>
<p>Cuá»‘i cÃ¹ng thÃ¬ chÃºng ta cÅ©ng cÃ³ táº¥t cáº£ nhá»¯ng nguyÃªn liá»‡u cáº§n thiáº¿t Ä‘á»ƒ luyá»‡n táº­p! BÃ¢y giá» chÃºng ta chá»‰ cáº§n khá»Ÿi táº¡o trÃ¬nh huáº¥n luyá»‡n vá»›i cÃ¡c tham sá»‘ tiÃªu chuáº©n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Seq2SeqTrainer

trainer = Seq2SeqTrainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)<!-- HTML_TAG_END --></pre></div>
<p>vÃ  khá»Ÿi cháº¡y chÆ°Æ¡ng trÃ¬nh huáº¥n luyá»‡n cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, báº¡n sáº½ tháº¥y máº¥t mÃ¡t huáº¥n luyá»‡n giáº£m vÃ  Ä‘iá»ƒm ROUGE tÄƒng lÃªn theo tá»«ng epoch. Sau khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n hoÃ n táº¥t, báº¡n cÃ³ thá»ƒ xem Ä‘iá»ƒm ROUGE cuá»‘i cÃ¹ng báº±ng cÃ¡ch cháº¡y <code>Trainer.evaluate()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.evaluate()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;eval_loss&#x27;</span>: <span class="hljs-number">3.028524398803711</span>,
 <span class="hljs-string">&#x27;eval_rouge1&#x27;</span>: <span class="hljs-number">16.9728</span>,
 <span class="hljs-string">&#x27;eval_rouge2&#x27;</span>: <span class="hljs-number">8.2969</span>,
 <span class="hljs-string">&#x27;eval_rougeL&#x27;</span>: <span class="hljs-number">16.8366</span>,
 <span class="hljs-string">&#x27;eval_rougeLsum&#x27;</span>: <span class="hljs-number">16.851</span>,
 <span class="hljs-string">&#x27;eval_gen_len&#x27;</span>: <span class="hljs-number">10.1597</span>,
 <span class="hljs-string">&#x27;eval_runtime&#x27;</span>: <span class="hljs-number">6.1054</span>,
 <span class="hljs-string">&#x27;eval_samples_per_second&#x27;</span>: <span class="hljs-number">38.982</span>,
 <span class="hljs-string">&#x27;eval_steps_per_second&#x27;</span>: <span class="hljs-number">4.914</span>}<!-- HTML_TAG_END --></pre></div>
<p>Tá»« Ä‘iá»ƒm sá»‘, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng mÃ´ hÃ¬nh cá»§a mÃ¬nh Ä‘Ã£ vÆ°á»£t trá»™i so vá»›i mÃ´ hÃ¬nh cÆ¡ sá»Ÿ vá»›i 3 bÃ i Ä‘áº§u tiÃªn - tháº­t tuyá»‡t! Äiá»u cuá»‘i cÃ¹ng cáº§n lÃ m lÃ  Ä‘áº©y cÃ¡c trá»ng sá»‘ mÃ´ hÃ¬nh vÃ o Hub, nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub(<span class="hljs-attribute">commit_message</span>=<span class="hljs-string">&quot;Training complete&quot;</span>, <span class="hljs-attribute">tags</span>=<span class="hljs-string">&quot;summarization&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;https://huggingface.co/huggingface-course/mt5-finetuned-amazon-en-es/commit/aa0536b829b28e73e1e4b94b8a5aacec420d40e0&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Thao tÃ¡c nÃ y sáº½ lÆ°u cÃ¡c checkpoint vÃ  cÃ¡c tá»‡p cáº¥u hÃ¬nh vÃ o <code>output_dir</code>, trÆ°á»›c khi táº£i táº¥t cáº£ cÃ¡c tá»‡p lÃªn Hub. Báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh tham sá»‘ <code>tags</code>, chÃºng ta cÅ©ng Ä‘áº£m báº£o ráº±ng tiá»‡n Ã­ch con trÃªn Hub sáº½ lÃ  má»™t tiá»‡n Ã­ch con dÃ nh cho quy trÃ¬nh tÃ³m táº¯t thay vÃ¬ tiá»‡n Ã­ch táº¡o vÄƒn báº£n máº·c Ä‘á»‹nh Ä‘Æ°á»£c liÃªn káº¿t vá»›i kiáº¿n trÃºc mT5 (Ä‘á»ƒ biáº¿t thÃªm thÃ´ng tin vá» tháº» mÃ´ hÃ¬nh, hÃ£y xem tÃ i liá»‡u <a href="https://huggingface.co/docs/hub/main#how-is-a-models-type-of-inference-api-and-widget-detined" rel="nofollow">ğŸ¤— Hub </a>). Äáº§u ra tá»« <code>trainr.push_to_hub())</code> lÃ  má»™t URL tá»›i hÃ m bÄƒm cam káº¿t Git, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ dá»… dÃ ng xem cÃ¡c thay Ä‘á»•i Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»‘i vá»›i kho lÆ°u trá»¯ mÃ´ hÃ¬nh!</p>
<p>Äá»ƒ káº¿t thÃºc pháº§n nÃ y, hÃ£y xem cÃ¡ch chÃºng ta cÅ©ng cÃ³ thá»ƒ tinh chá»‰nh mT5 báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c tÃ­nh nÄƒng cáº¥p tháº¥p do ğŸ¤— Accelerate cung cáº¥p.</p>
<h2 class="relative group"><a id="tinh-chnh-mt5-vi-accelerate" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-mt5-vi-accelerate"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mT5 vá»›i ğŸ¤— Accelerate
	</span></h2>

<p>Tinh chá»‰nh mÃ´ hÃ¬nh cá»§a chÃºng ta vá»›i ğŸ¤— Accelerate ráº¥t giá»‘ng vá»›i vÃ­ dá»¥ phÃ¢n loáº¡i vÄƒn báº£n mÃ  chÃºng ta Ä‘Ã£ gáº·p trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>. Sá»± khÃ¡c biá»‡t chÃ­nh sáº½ lÃ  nhu cáº§u táº¡o tÃ³m táº¯t cá»§a chÃºng ta má»™t cÃ¡ch rÃµ rÃ ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n vÃ  xÃ¡c Ä‘á»‹nh cÃ¡ch chÃºng ta tÃ­nh Ä‘iá»ƒm ROUGE (nhá»› láº¡i ráº±ng <code>Seq2SeqTrainer</code> Ä‘Ã£ lÃ m cho chÃºng ta). HÃ£y xem cÃ¡ch chÃºng ta cÃ³ thá»ƒ thá»±c hiá»‡n hai yÃªu cáº§u nÃ y trong ğŸ¤— Accelerate!</p>
<h3 class="relative group"><a id="chun-b-mi-th-cho-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-mi-th-cho-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº©n bá»‹ má»i thá»© cho huáº¥n luyá»‡n
	</span></h3>

<p>Äiá»u Ä‘áº§u tiÃªn chÃºng ta cáº§n lÃ m lÃ  táº¡o má»™t <code>DataLoader</code> cho má»—i pháº§n tÃ¡ch cá»§a chÃºng ta. VÃ¬ cÃ¡c bá»™ lÆ°u trá»¯ dá»¯ liá»‡u PyTorch mong Ä‘á»£i hÃ ng loáº¡t cÃ¡c tensor, chÃºng ta cáº§n Ä‘áº·t Ä‘á»‹nh dáº¡ng thÃ nh <code>&quot;torch&quot;</code> trong bá»™ dá»¯ liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets.set_format(<span class="hljs-string">&quot;torch&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ táº­p dá»¯ liá»‡u chá»‰ bao gá»“m cÃ¡c tensor, viá»‡c tiáº¿p theo cáº§n lÃ m lÃ  khá»Ÿi táº¡o láº¡i <code>DataCollatorForSeq2Seq</code>. Äá»‘i vá»›i Ä‘iá»u nÃ y, chÃºng ta cáº§n cung cáº¥p má»™t phiÃªn báº£n má»›i cá»§a mÃ´ hÃ¬nh, vÃ¬ váº­y hÃ£y táº£i láº¡i tá»« bá»™ nhá»› cache cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ khá»Ÿi táº¡o trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u vÃ  sá»­ dá»¥ng cÃ´ng cá»¥ nÃ y Ä‘á»ƒ xÃ¡c Ä‘á»‹nh bá»™ lÆ°u dá»¯ liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader

batch_size = <span class="hljs-number">8</span>
train_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=data_collator,
    batch_size=batch_size,
)
eval_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>], collate_fn=data_collator, batch_size=batch_size
)<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u tiáº¿p theo cáº§n lÃ m lÃ  xÃ¡c Ä‘á»‹nh trÃ¬nh tá»‘i Æ°u hÃ³a mÃ  chÃºng ta muá»‘n sá»­ dá»¥ng. NhÆ° trong cÃ¡c vÃ­ dá»¥ khÃ¡c, chÃºng ta sáº½ sá»­ dá»¥ng <code>AdamW</code>, trÃ¬nh hoáº¡t Ä‘á»™ng tá»‘t cho háº§u háº¿t cÃ¡c váº¥n Ä‘á»:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>Cuá»‘i cÃ¹ng, chÃºng ta cung cáº¥p mÃ´ hÃ¬nh, trÃ¬nh tá»‘i Æ°u hÃ³a vÃ  bá»™ ghi dá»¯ liá»‡u cá»§a mÃ¬nh vÃ o phÆ°Æ¡ng thá»©c <code>accelerator.prepare()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator()
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸš¨ Náº¿u báº¡n Ä‘ang huáº¥n luyá»‡n trÃªn TPU, báº¡n sáº½ cáº§n chuyá»ƒn táº¥t cáº£ Ä‘oáº¡n mÃ£ á»Ÿ trÃªn vÃ o má»™t hÃ m huáº¥n luyá»‡n chuyÃªn dá»¥ng. Xem [ChÆ°Æ¡ng 3(/course/chapter3) Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.</p></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ chuáº©n bá»‹ cÃ¡c Ä‘á»‘i tÆ°á»£ng cá»§a mÃ¬nh, cÃ²n ba viá»‡c cáº§n lÃ m:</p>
<ul><li>XÃ¡c Ä‘á»‹nh lá»‹ch trÃ¬nh tá»‘c Ä‘á»™ há»c.</li>
<li>Thá»±c hiá»‡n chá»©c nÄƒng háº­u xá»­ lÃ½ cÃ¡c báº£n tÃ³m táº¯t Ä‘á»ƒ Ä‘Ã¡nh giÃ¡.</li>
<li>Táº¡o má»™t kho lÆ°u trá»¯ trÃªn Hub mÃ  ta cÃ³ thá»ƒ Ä‘áº©y mÃ´ hÃ¬nh cá»§a mÃ¬nh lÃªn Ä‘Ã³.</li></ul>
<p>Äá»‘i vá»›i lá»‹ch trÃ¬nh tá»‘c Ä‘á»™ há»c, chÃºng ta sáº½ sá»­ dá»¥ng lá»‹ch trÃ¬nh tuyáº¿n tÃ­nh tiÃªu chuáº©n tá»« cÃ¡c pháº§n trÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">10</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ háº­u xá»­ lÃ½, chÃºng ta cáº§n má»™t hÃ m chia cÃ¡c tÃ³m táº¯t Ä‘Ã£ táº¡o thÃ nh cÃ¡c cÃ¢u Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng cÃ¡c dÃ²ng má»›i. ÄÃ¢y lÃ  Ä‘á»‹nh dáº¡ng mÃ  chá»‰ sá»‘ ROUGE mong Ä‘á»£i vÃ  chÃºng ta cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y báº±ng Ä‘oáº¡n mÃ£ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">postprocess_text</span>(<span class="hljs-params">preds, labels</span>):
    preds = [pred.strip() <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> preds]
    labels = [label.strip() <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]

    <span class="hljs-comment"># ROUGE kÃ¬ vá»ng dÃ²ng má»›i sau má»—i cÃ¢u</span>
    preds = [<span class="hljs-string">&quot;\n&quot;</span>.join(nltk.sent_tokenize(pred)) <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> preds]
    labels = [<span class="hljs-string">&quot;\n&quot;</span>.join(nltk.sent_tokenize(label)) <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]

    <span class="hljs-keyword">return</span> preds, labels<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y sáº½ trÃ´ng quen thuá»™c vá»›i báº¡n náº¿u báº¡n nhá»› láº¡i cÃ¡ch chÃºng ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a hÃ m <code>compute_metrics()</code> cá»§a <code>Seq2SeqTrainer</code>.</p>
<p>Cuá»‘i cÃ¹ng, chÃºng ta cáº§n táº¡o má»™t kho lÆ°u trá»¯ mÃ´ hÃ¬nh trÃªn Hugging Face Hub. Äá»‘i vá»›i Ä‘iá»u nÃ y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng thÆ° viá»‡n ğŸ¤— Hub cÃ³ tiÃªu Ä‘á» thÃ­ch há»£p. ChÃºng ta chá»‰ cáº§n xÃ¡c Ä‘á»‹nh tÃªn cho kho lÆ°u trá»¯ cá»§a mÃ¬nh vÃ  thÆ° viá»‡n cÃ³ chá»©c nÄƒng tiá»‡n Ã­ch Ä‘á»ƒ káº¿t há»£p ID kho lÆ°u trá»¯ vá»›i há»“ sÆ¡ ngÆ°á»i dÃ¹ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> get_full_repo_name

model_name = <span class="hljs-string">&quot;test-bert-finetuned-squad-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;lewtun/mt5-finetuned-amazon-en-es-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tÃªn kho lÆ°u trá»¯ nÃ y Ä‘á»ƒ sao chÃ©p phiÃªn báº£n cá»¥c bá»™ vÃ o thÆ° má»¥c káº¿t quáº£ cá»§a chÃºng ta, nÆ¡i sáº½ lÆ°u trá»¯ cÃ¡c táº¡o tÃ¡c huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository

output_dir = <span class="hljs-string">&quot;results-mt5-finetuned-squad-accelerate&quot;</span>
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y sáº½ cho phÃ©p chÃºng ta Ä‘áº©y cÃ¡c táº¡o tÃ¡c trá»Ÿ láº¡i Hub báº±ng cÃ¡ch gá»i phÆ°Æ¡ng thá»©c <code>repo.push_to_hub()</code> trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n! BÃ¢y giá» chÃºng ta hÃ£y káº¿t thÃºc phÃ¢n tÃ­ch báº±ng cÃ¡ch viáº¿t ra vÃ²ng láº·p huáº¥n luyá»‡n.</p>
<h3 class="relative group"><a id="vng-lp-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#vng-lp-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>VÃ²ng láº·p huáº¥n luyá»‡n
	</span></h3>

<p>VÃ²ng láº·p huáº¥n luyá»‡n Ä‘á»ƒ tÃ³m táº¯t khÃ¡ giá»‘ng vá»›i cÃ¡c vÃ­ dá»¥ ğŸ¤— Accelerate khÃ¡c mÃ  chÃºng ta Ä‘Ã£ gáº·p vÃ  gáº§n nhÆ° Ä‘Æ°á»£c chia thÃ nh bá»‘n bÆ°á»›c chÃ­nh:</p>
<ol><li>Huáº¥n luyá»‡n mÃ´ hÃ¬nh báº±ng cÃ¡ch láº·p láº¡i táº¥t cáº£ cÃ¡c vÃ­ dá»¥ trong <code>train_dataloader</code> cho má»—i epoch.</li>
<li>Táº¡o tÃ³m táº¯t mÃ´ hÃ¬nh vÃ o cuá»‘i má»—i epoch, báº±ng cÃ¡ch táº¡o token Ä‘áº§u tiÃªn vÃ  sau Ä‘Ã³ giáº£i mÃ£ chÃºng (vÃ  tÃ³m táº¯t tham chiáº¿u) thÃ nh vÄƒn báº£n.</li>
<li>TÃ­nh toÃ¡n Ä‘iá»ƒm ROUGE báº±ng cÃ¡c ká»¹ thuáº­t tÆ°Æ¡ng tá»± mÃ  chÃºng ta Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã³.</li>
<li>LÆ°u cÃ¡c checkpoint vÃ  Ä‘áº©y má»i thá»© vÃ o Hub. á» Ä‘Ã¢y, chÃºng ta dá»±a vÃ o tham sá»‘ <code>blocking=False</code> tiá»‡n lá»£i cá»§a Ä‘á»‘i tÆ°á»£ng <code>Repository</code> Ä‘á»ƒ cÃ³ thá»ƒ Ä‘áº©y cÃ¡c checkpoint á»Ÿ má»—i epoch <em>báº¥t Ä‘á»“ng bá»™</em>. Äiá»u nÃ y cho phÃ©p ta tiáº¿p tá»¥c huáº¥n luyá»‡n mÃ  khÃ´ng pháº£i Ä‘á»£i táº£i lÃªn hÆ¡i cháº­m vá»›i mÃ´ hÃ¬nh cÃ³ kÃ­ch thÆ°á»›c GB!</li></ol>
<p>CÃ¡c bÆ°á»›c nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c nhÃ¬n tháº¥y trong khá»‘i mÃ£ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Huáº¥n luyá»‡n</span>
    model.train()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_dataloader):
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># ÄÃ¡nh giÃ¡</span>
    model.<span class="hljs-built_in">eval</span>()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(eval_dataloader):
        <span class="hljs-keyword">with</span> torch.no_grad():
            generated_tokens = accelerator.unwrap_model(model).generate(
                batch[<span class="hljs-string">&quot;input_ids&quot;</span>],
                attention_mask=batch[<span class="hljs-string">&quot;attention_mask&quot;</span>],
            )

            generated_tokens = accelerator.pad_across_processes(
                generated_tokens, dim=<span class="hljs-number">1</span>, pad_index=tokenizer.pad_token_id
            )
            labels = batch[<span class="hljs-string">&quot;labels&quot;</span>]

            <span class="hljs-comment"># Náº¿u ta khÃ´ng Ä‘á»‡m Ä‘áº¿n Ä‘á»™ giáº£i tá»‘i Ä‘a, ta cáº§n Ä‘á»‡m cáº£ nhÃ£n ná»¯a</span>
            labels = accelerator.pad_across_processes(
                batch[<span class="hljs-string">&quot;labels&quot;</span>], dim=<span class="hljs-number">1</span>, pad_index=tokenizer.pad_token_id
            )

            generated_tokens = accelerator.gather(generated_tokens).cpu().numpy()
            labels = accelerator.gather(labels).cpu().numpy()

            <span class="hljs-comment"># Thay -100 á»Ÿ nhÃ£n vÃ¬ ta khÃ´ng thá»ƒ  giáº£i mÃ£ chÃºng</span>
            labels = np.where(labels != -<span class="hljs-number">100</span>, labels, tokenizer.pad_token_id)
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(generated_tokens, <span class="hljs-built_in">tuple</span>):
                generated_tokens = generated_tokens[<span class="hljs-number">0</span>]
            decoded_preds = tokenizer.batch_decode(
                generated_tokens, skip_special_tokens=<span class="hljs-literal">True</span>
            )
            decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=<span class="hljs-literal">True</span>)

            decoded_preds, decoded_labels = postprocess_text(
                decoded_preds, decoded_labels
            )

            rouge_score.add_batch(predictions=decoded_preds, references=decoded_labels)

    <span class="hljs-comment"># TÃ­nh toÃ¡n cÃ¡c chá»‰ sá»‘</span>
    result = rouge_score.compute()
    <span class="hljs-comment"># TrÃ­ch xuáº¥t Ä‘iá»ƒm trung vá»‹ ROUGE</span>
    result = {key: value.mid.fmeasure * <span class="hljs-number">100</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> result.items()}
    result = {k: <span class="hljs-built_in">round</span>(v, <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> result.items()}
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">{epoch}</span>:&quot;</span>, result)

    <span class="hljs-comment"># LÆ°u vÃ  táº£i</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Epoch <span class="hljs-number">0</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">5.6351</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">1.1625</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">5.4866</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">5.5005</span>}
Epoch <span class="hljs-number">1</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">9.8646</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">3.4106</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">9.9439</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">9.9306</span>}
Epoch <span class="hljs-number">2</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">11.0872</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">3.3273</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">11.0508</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">10.9468</span>}
Epoch <span class="hljs-number">3</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">11.8587</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">4.8167</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">11.7986</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">11.7518</span>}
Epoch <span class="hljs-number">4</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">12.9842</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">5.5887</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">12.7546</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">12.7029</span>}
Epoch <span class="hljs-number">5</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.4628</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.4598</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.312</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.2913</span>}
Epoch <span class="hljs-number">6</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">12.9131</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">5.8914</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">12.6896</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">12.5701</span>}
Epoch <span class="hljs-number">7</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.3079</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.2994</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.1536</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.1194</span>}
Epoch <span class="hljs-number">8</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.96</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.5998</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.9123</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.7744</span>}
Epoch <span class="hljs-number">9</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">14.1192</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">7.0059</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">14.1172</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.9509</span>}<!-- HTML_TAG_END --></pre></div>
<p>VÃ  tháº¿ Ä‘Ã³! Khi báº¡n cháº¡y nÃ³, báº¡n sáº½ cÃ³ má»™t mÃ´ hÃ¬nh vÃ  káº¿t quáº£ khÃ¡ giá»‘ng vá»›i nhá»¯ng mÃ´ hÃ¬nh mÃ  chÃºng ta thu Ä‘Æ°á»£c vá»›i <code>Trainer</code>.</p>
<h2 class="relative group"><a id="s-dng-m-hnh-tinh-chnh-ca-bn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#s-dng-m-hnh-tinh-chnh-ca-bn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh cá»§a báº¡n
	</span></h2>

<p>Khi báº¡n Ä‘Ã£ Ä‘áº©y mÃ´ hÃ¬nh vÃ o Hub, báº¡n cÃ³ thá»ƒ chÆ¡i vá»›i nÃ³ thÃ´ng qua tiá»‡n Ã­ch luáº­n suy hoáº·c vá»›i Ä‘á»‘i tÆ°á»£ng <code>pipeline</code>, nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

hub_model_id = <span class="hljs-string">&quot;huggingface-course/mt5-small-finetuned-amazon-en-es&quot;</span>
summarizer = pipeline(<span class="hljs-string">&quot;summarization&quot;</span>, model=hub_model_id)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ cung cáº¥p má»™t sá»‘ máº«u tá»« bá»™ kiá»ƒm thá»­ (mÃ  mÃ´ hÃ¬nh chÆ°a tháº¥y) vÃ o pipeline Ä‘á»ƒ cÃ³ cáº£m nháº­n vá» cháº¥t lÆ°á»£ng cá»§a cÃ¡c báº£n tÃ³m táº¯t. TrÆ°á»›c tiÃªn, hÃ£y triá»ƒn khai má»™t chá»©c nÄƒng Ä‘Æ¡n giáº£n Ä‘á»ƒ hiá»ƒn thá»‹ bÃ i Ä‘Ã¡nh giÃ¡, tiÃªu Ä‘á» vÃ  báº£n tÃ³m táº¯t Ä‘Ã£ táº¡o cÃ¹ng nhau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_summary</span>(<span class="hljs-params">idx</span>):
    review = books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_body&quot;</span>]
    title = books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_title&quot;</span>]
    summary = summarizer(books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_body&quot;</span>])[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;summary_text&quot;</span>]
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Review: <span class="hljs-subst">{review}</span>&#x27;&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; Title: <span class="hljs-subst">{title}</span>&#x27;&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; Summary: <span class="hljs-subst">{summary}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y xem má»™t trong nhá»¯ng máº«u tiáº¿ng Anh mÃ  chÃºng ta nháº­n Ä‘Æ°á»£c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->print_summary(<span class="hljs-number">100</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Review: Nothing special at all about this product... the book is too small and stiff and hard to write in. The huge sticker on the back doesnâ€™t come off and looks super tacky. I would not purchase this again. I could have just bought a journal from the dollar store and it would be basically the same thing. Itâ€™s also really expensive for what it is.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Title: Not impressed at all... buy something else&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Summary: Nothing special at all about this product&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y khÃ´ng quÃ¡ tá»‡! ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng mÃ´ hÃ¬nh cá»§a mÃ¬nh Ä‘Ã£ thá»±c sá»± cÃ³ thá»ƒ thá»±c hiá»‡n tÃ³m táº¯t <em>trá»«u tÆ°á»£ng</em> báº±ng cÃ¡ch tÄƒng cÆ°á»ng cÃ¡c pháº§n cá»§a bÃ i Ä‘Ã¡nh giÃ¡ báº±ng cÃ¡c tá»« má»›i. VÃ  cÃ³ láº½ khÃ­a cáº¡nh thÃº vá»‹ nháº¥t cá»§a mÃ´ hÃ¬nh cá»§a chÃºng ta lÃ  nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng song ngá»¯, vÃ¬ váº­y ta cÅ©ng cÃ³ thá»ƒ táº¡o tÃ³m táº¯t cÃ¡c bÃ i Ä‘Ã¡nh giÃ¡ báº±ng tiáº¿ng TÃ¢y Ban Nha:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->print_summary(<span class="hljs-number">0</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Review: Es una trilogia que se hace muy facil de leer. Me ha gustado, no me esperaba el final para nada&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Title: Buena literatura para adolescentes&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Summary: Muy facil de leer&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Báº£n tÃ³m táº¯t Ä‘Æ°á»£c dá»‹ch thÃ nh â€œVery easy to readâ€ trong tiáº¿ng Anh, mÃ  chÃºng ta cÃ³ thá»ƒ tháº¥y trong trÆ°á»ng há»£p nÃ y Ä‘Æ°á»£c trÃ­ch trá»±c tiáº¿p tá»« Ä‘Ã¡nh giÃ¡. Tuy nhiÃªn, Ä‘iá»u nÃ y cho tháº¥y tÃ­nh linh hoáº¡t cá»§a mÃ´ hÃ¬nh mT5 vÃ  cho báº¡n biáº¿t cáº£m giÃ¡c triá»ƒn khai vá»›i kho ngá»¯ liá»‡u Ä‘a ngÃ´n ngá»¯ lÃ  nhÆ° tháº¿ nÃ o!</p>
<p>Tiáº¿p theo, chÃºng ta sáº½ chuyá»ƒn sá»± chÃº Ã½ sang má»™t tÃ¡c vá»¥ phá»©c táº¡p hÆ¡n má»™t chÃºt: huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»« Ä‘áº§u.</p>


		<script type="module" data-hydrate="1o5tb2i">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="1o5tb2i"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter7/5.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
