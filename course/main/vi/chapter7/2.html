<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;phn-loi-token&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-d-liu&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;tp-d-liu-conll2003&quot;,&quot;title&quot;:&quot;Táº­p dá»¯ liá»‡u CoNLL-2003&quot;},{&quot;local&quot;:&quot;x-l-d-liu&quot;,&quot;title&quot;:&quot;Xá»­ lÃ½ dá»¯ liá»‡u&quot;}],&quot;title&quot;:&quot;Chuáº©n bá»‹ dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hnh-trong-api-trainer&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬nh trong API `Trainer`&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hnh-vi-keras&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;i-chiu-d-liu&quot;,&quot;title&quot;:&quot;Äá»‘i chiáº¿u dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;nh-ngha-m-hnh&quot;,&quot;title&quot;:&quot;Äá»‹nh nghÄ©a mÃ´ hÃ¬nh&quot;},{&quot;local&quot;:&quot;tinh-chnh-mt-m-hnh&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh má»™t mÃ´ hÃ¬nh&quot;},{&quot;local&quot;:&quot;thc-o&quot;,&quot;title&quot;:&quot;ThÆ°á»›c Ä‘o&quot;},{&quot;local&quot;:&quot;nh-ngha-m-hnh&quot;,&quot;title&quot;:&quot;Äá»‹nh nghÄ©a mÃ´ hÃ¬nh&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hnh&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬nh&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬nh vá»›i Keras&quot;},{&quot;local&quot;:&quot;mt-vng-hun-luyn-tu-chnh&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-mi-th-hun-luyn&quot;,&quot;title&quot;:&quot;Chuáº©n bá»‹ má»i thá»© Ä‘á»ƒ huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;vng-lp-hun-luyn&quot;,&quot;title&quot;:&quot;VÃ²ng láº·p huáº¥n luyá»‡n&quot;}],&quot;title&quot;:&quot;Má»™t vÃ²ng huáº¥n luyá»‡n tuá»³ chá»‰nh&quot;},{&quot;local&quot;:&quot;s-dng-m-hnh-c-tinh-chnh&quot;,&quot;title&quot;:&quot;Sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tinh chá»‰nh&quot;}],&quot;title&quot;:&quot;PhÃ¢n loáº¡i token&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter7/2.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="phn-loi-token" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#phn-loi-token"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>PhÃ¢n loáº¡i token
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter7/section2_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter7/section2_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>á»¨ng dá»¥ng Ä‘áº§u tiÃªn chÃºng ta sáº½ cÃ¹ng khÃ¡m phÃ¡ lÃ  phÃ¢n loáº¡i token. TÃ¡c vá»¥ chung nÃ y bao gá»“m báº¥t ká»³ váº¥n Ä‘á» nÃ o cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¢y dá»±ng dÆ°á»›i dáº¡ng â€œgÃ¡n nhÃ£n cho má»—i token trong má»™t cÃ¢uâ€, cháº³ng háº¡n nhÆ°:</p>
<ul><li><strong>Nháº­n dáº¡ng thá»±c thá»ƒ Ä‘Æ°á»£c Ä‘áº·t tÃªn (NER)</strong>: TÃ¬m cÃ¡c thá»±c thá»ƒ (cháº³ng háº¡n nhÆ° ngÆ°á»i, Ä‘á»‹a Ä‘iá»ƒm hoáº·c tá»• chá»©c) trong má»™t cÃ¢u. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¢y dá»±ng nhÆ° lÃ  gÃ¡n nhÃ£n cho má»—i token báº±ng cÃ¡ch cÃ³ má»™t nhÃ£n cho má»—i thá»±c thá»ƒ vÃ  má»™t nhÃ£n cho â€œkhÃ´ng cÃ³ thá»±c thá»ƒâ€.</li>
<li><strong>GÃ¡n nhÃ£n tá»« loáº¡i (POS)</strong>: ÄÃ¡nh dáº¥u má»—i tá»« trong cÃ¢u tÆ°Æ¡ng á»©ng vá»›i má»™t tá»« loáº¡i cá»¥ thá»ƒ cá»§a vÄƒn báº£n (cháº³ng háº¡n nhÆ° danh tá»«, Ä‘á»™ng tá»«, tÃ­nh tá»«, v.v.).</li>
<li><strong>PhÃ¢n khÃºc</strong>: TÃ¬m cÃ¡c token thuá»™c cÃ¹ng má»™t thá»±c thá»ƒ. TÃ¡c vá»¥ nÃ y (cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i POS hoáº·c NER) cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¢y dá»±ng dÆ°á»›i dáº¡ng gÃ¡n má»™t nhÃ£n (thÆ°á»ng lÃ  <code>B-</code>) cho báº¥t ká»³ token nÃ o á»Ÿ Ä‘áº§u má»™t Ä‘oáº¡n, má»™t nhÃ£n khÃ¡c (thÆ°á»ng lÃ  <code>I-</code>) cho cÃ¡c token Ä‘Ã³ náº±m bÃªn trong má»™t Ä‘oáº¡n vÃ  má»™t nhÃ£n thá»© ba (thÆ°á»ng lÃ  <code>O</code>) token khÃ´ng thuá»™c báº¥t ká»³ Ä‘oáº¡n nÃ o.</li></ul>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/wVHdVlPScxA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Táº¥t nhiÃªn, cÃ³ nhiá»u loáº¡i váº¥n Ä‘á» phÃ¢n loáº¡i token khÃ¡c; Ä‘Ã³ chá»‰ lÃ  má»™t vÃ i vÃ­ dá»¥ tiÃªu biá»ƒu. Trong pháº§n nÃ y, chÃºng ta sáº½ tinh chá»‰nh má»™t mÃ´ hÃ¬nh (BERT) trÃªn má»™t tÃ¡c vá»¥ NER, sau Ä‘Ã³ sáº½ cÃ³ thá»ƒ tÃ­nh toÃ¡n cÃ¡c dá»± Ä‘oÃ¡n nhÆ° sau:</p>
<iframe src="https://hf.space/gradioiframe/course-demos/bert-finetuned-ner/+" frameborder="0" height="350" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<a class="flex justify-center" href="/huggingface-course/bert-finetuned-ner"><img class="block dark:hidden lg:w-3/5" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/model-eval-bert-finetuned-ner.png" alt="One-hot encoded labels for question answering.">
  <img class="hidden dark:block lg:w-3/5" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/model-eval-bert-finetuned-ner-dark.png" alt="One-hot encoded labels for question answering."></a>
<p>Báº¡n cÃ³ thá»ƒ tÃ¬m mÃ´ hÃ¬nh ta sáº½ huáº¥n luyá»‡n vÃ  táº£i lÃªn Hub vÃ  kiá»ƒm tra láº¡i cÃ¡c dá»± Ä‘oÃ¡n <a href="https://huggingface.co/huggingface-course/bert-finetuned-ner?text=My+name+is+Sylvain+and+I+work+at+Hugging+Face+in+Brooklyn" rel="nofollow">táº¡i Ä‘Ã¢y</a>.</p>
<h2 class="relative group"><a id="chun-b-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº©n bá»‹ dá»¯ liá»‡u
	</span></h2>

<p>Äáº§u tiÃªn, ta cáº§n bá»™ dá»¯ liá»‡u chuáº©n bá»‹ cho phÃ¢n loáº¡i token. Trong chÆ°Æ¡ng nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng bá»™ dá»¯ liá»‡u <a href="https://huggingface.co/datasets/conll2003" rel="nofollow">CoNLL-2003</a>, bao gá»“m cÃ¡c cÃ¢u chuyá»‡n tin tá»©c tá»« Reuters.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Miá»…n lÃ  táº­p dá»¯ liá»‡u cá»§a báº¡n bao gá»“m cÃ¡c vÄƒn báº£n Ä‘Æ°á»£c chia thÃ nh cÃ¡c tá»« vá»›i nhÃ£n tÆ°Æ¡ng á»©ng cá»§a chÃºng, báº¡n sáº½ cÃ³ thá»ƒ Ä‘iá»u chá»‰nh cÃ¡c quy trÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ Ä‘Ã¢y vá»›i táº­p dá»¯ liá»‡u cá»§a riÃªng báº¡n. Tham kháº£o láº¡i <a href="/course/chapter5">Chapter 5</a> náº¿u báº¡n cáº§n cáº­p nháº­t vá» cÃ¡ch táº£i dá»¯ liá»‡u tÃ¹y chá»‰nh cá»§a riÃªng báº¡n trong <code>Dataset</code>.</p></div>
<h3 class="relative group"><a id="tp-d-liu-conll2003" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tp-d-liu-conll2003"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Táº­p dá»¯ liá»‡u CoNLL-2003
	</span></h3>

<p>Äá»ƒ táº£i bá»™ dá»¯ liá»‡u CoNLL-2003, ta cáº§n sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>load_dataset()</code> tá»« thÆ° viá»‡n ğŸ¤— Datasets:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

raw_datasets = load_dataset(<span class="hljs-string">&quot;conll2003&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Ta sáº½ táº£i vÃ  lÆ°u bá»™ dá»¯ liá»‡u vÃ o cache, nhÆ° ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a> cho bá»™ dá»¯ liá»‡u GLUE MRPC. Viá»‡c kiá»ƒm tra Ä‘á»‘i tÆ°á»£ng nÃ y cho chÃºng ta tháº¥y cÃ¡c cá»™t hiá»‡n cÃ³ vÃ  sá»± phÃ¢n chia giá»¯a cÃ¡c táº­p huáº¥n luyá»‡n, kiá»ƒm Ä‘á»‹nh vÃ  kiá»ƒm thá»­:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;chunk_tags&#x27;</span>, <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;ner_tags&#x27;</span>, <span class="hljs-string">&#x27;pos_tags&#x27;</span>, <span class="hljs-string">&#x27;tokens&#x27;</span>],
        num_rows: <span class="hljs-number">14041</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;chunk_tags&#x27;</span>, <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;ner_tags&#x27;</span>, <span class="hljs-string">&#x27;pos_tags&#x27;</span>, <span class="hljs-string">&#x27;tokens&#x27;</span>],
        num_rows: <span class="hljs-number">3250</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;chunk_tags&#x27;</span>, <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;ner_tags&#x27;</span>, <span class="hljs-string">&#x27;pos_tags&#x27;</span>, <span class="hljs-string">&#x27;tokens&#x27;</span>],
        num_rows: <span class="hljs-number">3453</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Äáº·c biá»‡t, chÃºng ta cÃ³ thá»ƒ tháº¥y táº­p dá»¯ liá»‡u chá»©a cÃ¡c nhÃ£n cho ba tÃ¡c vá»¥ mÃ  chÃºng ta Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³: NER, POS vÃ  chunking. Má»™t sá»± khÃ¡c biá»‡t lá»›n so vá»›i cÃ¡c bá»™ dá»¯ liá»‡u khÃ¡c lÃ  cÃ¡c vÄƒn báº£n Ä‘áº§u vÃ o khÃ´ng Ä‘Æ°á»£c trÃ¬nh bÃ y dÆ°á»›i dáº¡ng cÃ¢u hoáº·c tÃ i liá»‡u, mÃ  lÃ  danh sÃ¡ch cÃ¡c tá»« (cá»™t cuá»‘i cÃ¹ng Ä‘Æ°á»£c gá»i lÃ  <code>tokens</code>, nhÆ°ng nÃ³ chá»©a cÃ¡c tá»« theo nghÄ©a Ä‘Ã¢y lÃ  cÃ¡c Ä‘áº§u vÃ o Ä‘Æ°á»£c tokenize trÆ°á»›c váº«n cáº§n Ä‘á»ƒ Ä‘i qua trÃ¬nh tokenize Ä‘á»ƒ tokenize tá»« phá»¥).</p>
<p>HÃ£y xem pháº§n tá»­ Ä‘áº§u tiÃªn cá»§a táº­p huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;tokens&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;EU&#x27;</span>, <span class="hljs-string">&#x27;rejects&#x27;</span>, <span class="hljs-string">&#x27;German&#x27;</span>, <span class="hljs-string">&#x27;call&#x27;</span>, <span class="hljs-string">&#x27;to&#x27;</span>, <span class="hljs-string">&#x27;boycott&#x27;</span>, <span class="hljs-string">&#x27;British&#x27;</span>, <span class="hljs-string">&#x27;lamb&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ ta muá»‘n thá»±c hiá»‡n nháº­n dáº¡ng thá»±c thá»ƒ Ä‘Æ°á»£c Ä‘áº·t tÃªn, chÃºng ta sáº½ nhÃ¬n vÃ o cÃ¡c tháº» NER:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;ner_tags&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>
<p>ÄÃ³ lÃ  nhá»¯ng nhÃ£n dÆ°á»›i dáº¡ng sá»‘ nguyÃªn sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n, nhÆ°ng chÃºng khÃ´ng nháº¥t thiáº¿t há»¯u Ã­ch khi chÃºng ta muá»‘n kiá»ƒm tra dá»¯ liá»‡u. Giá»‘ng nhÆ° phÃ¢n loáº¡i vÄƒn báº£n, chÃºng ta cÃ³ thá»ƒ truy cáº­p sá»± tÆ°Æ¡ng á»©ng giá»¯a cÃ¡c sá»‘ nguyÃªn Ä‘Ã³ vÃ  tÃªn nhÃ£n báº±ng cÃ¡ch xem thuá»™c tÃ­nh <code>features</code> cá»§a táº­p dá»¯ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->ner_feature = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].features[<span class="hljs-string">&quot;ner_tags&quot;</span>]
ner_feature<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-type">Sequence</span>(feature=ClassLabel(num_classes=<span class="hljs-number">9</span>, names=[<span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;B-PER&#x27;</span>, <span class="hljs-string">&#x27;I-PER&#x27;</span>, <span class="hljs-string">&#x27;B-ORG&#x27;</span>, <span class="hljs-string">&#x27;I-ORG&#x27;</span>, <span class="hljs-string">&#x27;B-LOC&#x27;</span>, <span class="hljs-string">&#x27;I-LOC&#x27;</span>, <span class="hljs-string">&#x27;B-MISC&#x27;</span>, <span class="hljs-string">&#x27;I-MISC&#x27;</span>], names_file=<span class="hljs-literal">None</span>, <span class="hljs-built_in">id</span>=<span class="hljs-literal">None</span>), length=-<span class="hljs-number">1</span>, <span class="hljs-built_in">id</span>=<span class="hljs-literal">None</span>)<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ váº­y, cá»™t nÃ y chá»©a cÃ¡c pháº§n tá»­ lÃ  chuá»—i cá»§a <code>ClassLabel</code>. Loáº¡i pháº§n tá»­ cá»§a chuá»—i náº±m trong thuá»™c tÃ­nh <code>feature</code> cá»§a <code>ner_feature</code> nÃ y, vÃ  chÃºng ta cÃ³ thá»ƒ truy cáº­p danh sÃ¡ch tÃªn báº±ng cÃ¡ch xem thuá»™c tÃ­nh <code>names</code> cá»§a <code>feature</code> Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->label_names = ner_feature.feature.names
label_names<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;B-PER&#x27;</span>, <span class="hljs-string">&#x27;I-PER&#x27;</span>, <span class="hljs-string">&#x27;B-ORG&#x27;</span>, <span class="hljs-string">&#x27;I-ORG&#x27;</span>, <span class="hljs-string">&#x27;B-LOC&#x27;</span>, <span class="hljs-string">&#x27;I-LOC&#x27;</span>, <span class="hljs-string">&#x27;B-MISC&#x27;</span>, <span class="hljs-string">&#x27;I-MISC&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta Ä‘Ã£ tháº¥y cÃ¡c nhÃ£n khi Ä‘Ã o sÃ¢u vÃ o pipeline <code>token-classification</code> trong <a href="/course/chapter6/3">ChÆ°Æ¡ng 6</a>, nhÆ°ng Ä‘á»ƒ cáº­p nháº­t nhanh:</p>
<ul><li><code>O</code> nghÄ©a lÃ  tá»« khÃ´ng thuá»™c báº¥t kÃ¬ thá»±c thá»ƒ nÃ o.</li>
<li><code>B-PER</code>/<code>I-PER</code> nghÄ©a lÃ  tá»« tÆ°Æ¡ng á»©ng pháº§n báº¯t Ä‘áº§u/ náº±m bÃªn trong cá»§a thá»±c thá»ƒ <em>person</em> hay <em>con ngÆ°á»i</em>.</li>
<li><code>B-ORG</code>/<code>I-ORG</code> nghÄ©a lÃ  tá»« tÆ°Æ¡ng á»©ng pháº§n báº¯t Ä‘áº§u/ náº±m bÃªn trong cá»§a thá»±c thá»ƒ <em>organization</em> hay <em>tá»• chá»©c</em>.</li>
<li><code>B-LOC</code>/<code>I-LOC</code> nghÄ©a lÃ  tá»« tÆ°Æ¡ng á»©ng pháº§n báº¯t Ä‘áº§u/ náº±m bÃªn trong cá»§a thá»±c thá»ƒ <em>location</em> hay <em>Ä‘á»‹a Ä‘iá»ƒm</em>.</li>
<li><code>B-MISC</code>/<code>I-MISC</code> nghÄ©a lÃ  tá»« tÆ°Æ¡ng á»©ng pháº§n báº¯t Ä‘áº§u/ náº±m bÃªn trong cá»§a thá»±c thá»ƒ <em>miscellaneous</em> hay <em>lá»™n xá»™n</em>.</li></ul>
<p>Giá» khi giáº£i mÃ£ cÃ¡c nhÃ£n, ta tháº¥y chÃºng cho ta:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->words = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;tokens&quot;</span>]
labels = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;ner_tags&quot;</span>]
line1 = <span class="hljs-string">&quot;&quot;</span>
line2 = <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> word, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(words, labels):
    full_label = label_names[label]
    max_length = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">len</span>(word), <span class="hljs-built_in">len</span>(full_label))
    line1 += word + <span class="hljs-string">&quot; &quot;</span> * (max_length - <span class="hljs-built_in">len</span>(word) + <span class="hljs-number">1</span>)
    line2 += full_label + <span class="hljs-string">&quot; &quot;</span> * (max_length - <span class="hljs-built_in">len</span>(full_label) + <span class="hljs-number">1</span>)

<span class="hljs-built_in">print</span>(line1)
<span class="hljs-built_in">print</span>(line2)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;EU    rejects German call to boycott British lamb .&#x27;</span>
<span class="hljs-string">&#x27;B-ORG O       B-MISC O    O  O       B-MISC  O    O&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>VÃ  Ä‘á»‘i vá»›i má»™t vÃ­ dá»¥ trá»™n nhÃ£n <code>B-</code> vÃ  <code>I-</code>, Ä‘Ã¢y lÃ  nhá»¯ng gÃ¬ mÃ  cÃ¹ng má»™t Ä‘oáº¡n mÃ£ cung cáº¥p cho chÃºng ta vá» pháº§n tá»­ cá»§a táº­p huáº¥n luyá»‡n á»Ÿ chá»‰ má»¥c 4:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Germany \&#x27;s representative to the European Union \&#x27;s veterinary committee Werner Zwingmann said on Wednesday consumers should buy sheepmeat from countries other than Britain until the scientific advice was clearer .&#x27;</span>
<span class="hljs-string">&#x27;B-LOC   O  O              O  O   B-ORG    I-ORG O  O          O         B-PER  I-PER     O    O  O         O         O      O   O         O    O         O     O    B-LOC   O     O   O          O      O   O       O&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, cÃ¡c thá»±c thá»ƒ bao gá»“m hai tá»«, nhÆ° â€œEuropean Unionâ€ vÃ  â€œWerner Zwingmannâ€, Ä‘Æ°á»£c gÃ¡n nhÃ£n <code>B-</code> cho tá»« Ä‘áº§u tiÃªn vÃ  nhÃ£n <code>I-</code> cho tá»« thá»© hai.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> In hai cÃ¢u giá»‘ng nhau báº±ng nhÃ£n POS hoáº·c phÃ¢n khÃºc cá»§a chÃºng.</p></div>
<h3 class="relative group"><a id="x-l-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#x-l-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xá»­ lÃ½ dá»¯ liá»‡u
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/iY2AZYdZAr0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>NhÆ° thÆ°á»ng lá»‡, cÃ¡c vÄƒn báº£n cá»§a chÃºng ta cáº§n Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i sang token ID trÆ°á»›c khi mÃ´ hÃ¬nh cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c chÃºng. NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter6/">ChÆ°Æ¡ng 6</a>, má»™t sá»± khÃ¡c biá»‡t lá»›n trong trÆ°á»ng há»£p tÃ¡c vá»¥ phÃ¢n loáº¡i token lÃ  chÃºng ta cÃ³ cÃ¡c Ä‘áº§u vÃ o Ä‘Æ°á»£c tokenize trÆ°á»›c. May máº¯n thay, API tokenizer cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» Ä‘Ã³ khÃ¡ dá»… dÃ ng; chÃºng ta chá»‰ cáº§n bÃ¡o <code>tokenizer</code> báº±ng má»™t lÃ¡ cá» Ä‘áº·c biá»‡t.</p>
<p>Äá»ƒ báº¯t Ä‘áº§u, hÃ£y táº¡o Ä‘á»‘i tÆ°á»£ng <code>tokenizer</code> cá»§a chÃºng ta. NhÆ° chÃºng tÃ´i Ä‘Ã£ nÃ³i trÆ°á»›c Ä‘Ã¢y, chÃºng ta sáº½ sá»­ dá»¥ng mÃ´ hÃ¬nh huáº¥n luyá»‡n trÆ°á»›c BERT, vÃ¬ váº­y chÃºng ta sáº½ báº¯t Ä‘áº§u báº±ng cÃ¡ch táº£i xuá»‘ng vÃ  lÆ°u vÃ o bá»™ nhá»› Ä‘á»‡m cá»§a tokenizer liÃªn quan:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_checkpoint = <span class="hljs-string">&quot;bert-base-cased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n cÃ³ thá»ƒ thay tháº¿ <code>model_checkpoint</code> báº±ng báº¥t ká»³ mÃ´ hÃ¬nh nÃ o khÃ¡c mÃ  báº¡n thÃ­ch tá»« <a href="https://huggingface.co/models" rel="nofollow">Hub</a> hoáº·c báº±ng má»™t thÆ° má»¥c cá»¥c bá»™ trong Ä‘Ã³ báº¡n Ä‘Ã£ lÆ°u má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vÃ  má»™t trÃ¬nh tokenize. Háº¡n cháº¿ duy nháº¥t lÃ  tokenizer cáº§n Ä‘Æ°á»£c há»— trá»£ bá»Ÿi thÆ° viá»‡n ğŸ¤— Tokenizers, vÃ¬ váº­y sáº½ cÃ³ phiÃªn báº£n â€œnhanhâ€. Báº¡n cÃ³ thá»ƒ xem táº¥t cáº£ cÃ¡c kiáº¿n trÃºc Ä‘i kÃ¨m vá»›i phiÃªn báº£n nhanh trong <a href="https://huggingface.co/transformers/#supported-frameworks" rel="nofollow">báº£ng lá»›n nÃ y</a> vÃ  Ä‘á»ƒ kiá»ƒm tra xem Ä‘á»‘i tÆ°á»£ng <code>tokenizer</code> mÃ  báº¡n Ä‘ang sá»­ dá»¥ng cÃ³ thá»±c sá»± lÃ  Ä‘Æ°á»£c há»— trá»£ bá»Ÿi ğŸ¤— Tokenizers, báº¡n cÃ³ thá»ƒ xem thuá»™c tÃ­nh <code>is_fast</code> cá»§a nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.is_fast<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-literal">True</span><!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ tokenize dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Ã£ tiá»n tokenize, ta cÃ³ thá»ƒ sá»­ dá»¥ng <code>tokenizer</code> nhÆ° thÆ°á»ng lá»‡ vÃ  chá»‰ thÃªm <code>is_split_into_words=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;tokens&quot;</span>], is_split_into_words=<span class="hljs-literal">True</span>)
inputs.tokens()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;[CLS]&#x27;</span>, <span class="hljs-string">&#x27;EU&#x27;</span>, <span class="hljs-string">&#x27;rejects&#x27;</span>, <span class="hljs-string">&#x27;German&#x27;</span>, <span class="hljs-string">&#x27;call&#x27;</span>, <span class="hljs-string">&#x27;to&#x27;</span>, <span class="hljs-string">&#x27;boycott&#x27;</span>, <span class="hljs-string">&#x27;British&#x27;</span>, <span class="hljs-string">&#x27;la&#x27;</span>, <span class="hljs-string">&#x27;##mb&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;[SEP]&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, trÃ¬nh tokenizer Ä‘Ã£ thÃªm cÃ¡c token Ä‘áº·c biá»‡t Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi mÃ´ hÃ¬nh (<code>[CLS]</code> á»Ÿ Ä‘áº§u vÃ  <code>[SEP]</code> á»Ÿ cuá»‘i) vÃ  Ä‘á»ƒ nguyÃªn háº§u háº¿t cÃ¡c tá»«. Tuy nhiÃªn, tá»« <code>lamb</code> Ä‘Ã£ Ä‘Æ°á»£c tokenize thÃ nh hai tá»« phá»¥, <code>la</code> vÃ  <code>##mb</code>. Äiá»u nÃ y dáº«n Ä‘áº¿n sá»± khÃ´ng khá»›p giá»¯a Ä‘áº§u vÃ o vÃ  cÃ¡c nhÃ£n: danh sÃ¡ch nhÃ£n chá»‰ cÃ³ 9 pháº§n tá»­, trong khi Ä‘áº§u vÃ o cá»§a chÃºng ta hiá»‡n cÃ³ 12 token. Viá»‡c tÃ­nh toÃ¡n cÃ¡c token Ä‘áº·c biá»‡t ráº¥t dá»… dÃ ng (chÃºng ta biáº¿t chÃºng náº±m á»Ÿ Ä‘áº§u vÃ  cuá»‘i), nhÆ°ng chÃºng ta cÅ©ng cáº§n Ä‘áº£m báº£o ráº±ng chÃºng ta sáº¯p xáº¿p táº¥t cáº£ cÃ¡c nhÃ£n vá»›i cÃ¡c tá»« thÃ­ch há»£p.</p>
<p>May máº¯n thay, bá»Ÿi vÃ¬ chÃºng ta Ä‘ang sá»­ dá»¥ng má»™t tokenizer nhanh, chÃºng ta cÃ³ quyá»n truy cáº­p vÃ o sá»©c máº¡nh siÃªu cÆ°á»ng ğŸ¤— Tokenizers, cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng Ã¡nh xáº¡ tá»«ng token vá»›i tá»« tÆ°Æ¡ng á»©ng cá»§a nÃ³ (nhÆ° Ä‘Ã£ tháº¥y trong <a href="/course/chapter6/3">ChÆ°Æ¡ng 6</a>):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs.word_ids()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-literal">None</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-literal">None</span>]<!-- HTML_TAG_END --></pre></div>
<p>Vá»›i má»™t chÃºt cÃ´ng viá»‡c, sau Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ má»Ÿ rá»™ng danh sÃ¡ch nhÃ£n cá»§a mÃ¬nh Ä‘á»ƒ phÃ¹ há»£p vá»›i cÃ¡c token. Quy táº¯c Ä‘áº§u tiÃªn chÃºng ta sáº½ Ã¡p dá»¥ng lÃ  cÃ¡c token Ä‘áº·c biá»‡t cÃ³ nhÃ£n lÃ  <code>-100</code>. Äiá»u nÃ y lÃ  do theo máº·c Ä‘á»‹nh <code>-100</code> lÃ  chá»‰ sá»‘ bá»‹ bá» qua trong hÃ m máº¥t mÃ¡t mÃ  chÃºng ta sáº½ sá»­ dá»¥ng (entropy chÃ©o). Sau Ä‘Ã³, má»—i token cÃ³ cÃ¹ng nhÃ£n vá»›i token báº¯t Ä‘áº§u tá»« bÃªn trong nÃ³, vÃ¬ chÃºng lÃ  má»™t pháº§n cá»§a cÃ¹ng má»™t thá»±c thá»ƒ. Äá»‘i vá»›i cÃ¡c token bÃªn trong má»™t tá»« nhÆ°ng khÃ´ng á»Ÿ Ä‘áº§u, chÃºng ta thay tháº¿ <code>B-</code> báº±ng <code>I-</code> (vÃ¬ token khÃ´ng báº¯t Ä‘áº§u thá»±c thá»ƒ):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">align_labels_with_tokens</span>(<span class="hljs-params">labels, word_ids</span>):
    new_labels = []
    current_word = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">for</span> word_id <span class="hljs-keyword">in</span> word_ids:
        <span class="hljs-keyword">if</span> word_id != current_word:
            <span class="hljs-comment"># Báº¯t Ä‘áº§u má»™t tá»« má»›i!</span>
            current_word = word_id
            label = -<span class="hljs-number">100</span> <span class="hljs-keyword">if</span> word_id <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> labels[word_id]
            new_labels.append(label)
        <span class="hljs-keyword">elif</span> word_id <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-comment"># Token Ä‘áº·c biá»‡t</span>
            new_labels.append(-<span class="hljs-number">100</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Tá»« giá»‘ng vá»›i token trÆ°á»›c Ä‘Ã³</span>
            label = labels[word_id]
            <span class="hljs-comment"># Náº¿u nhÃ£n lÃ  B-XXX, ta Ä‘á»•i sang I-XXX</span>
            <span class="hljs-keyword">if</span> label % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:
                label += <span class="hljs-number">1</span>
            new_labels.append(label)

    <span class="hljs-keyword">return</span> new_labels<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y cÃ¹ng thá»­ vá»›i cÃ¢u Ä‘áº§u tiÃªn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->labels = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;ner_tags&quot;</span>]
word_ids = inputs.word_ids()
<span class="hljs-built_in">print</span>(labels)
<span class="hljs-built_in">print</span>(align_labels_with_tokens(labels, word_ids))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]
[-<span class="hljs-number">100</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>]<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, hÃ m Ä‘Ã£ thÃªm <code>-100</code> cho hai token Ä‘áº·c biá»‡t á»Ÿ Ä‘áº§u vÃ  cuá»‘i, vÃ  dáº¥u <code>0</code> má»›i cho tá»« cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c chia thÃ nh hai token.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> Má»™t sá»‘ nhÃ  nghiÃªn cá»©u chá»‰ thÃ­ch gÃ¡n má»™t nhÃ£n cho má»—i tá»« vÃ  gÃ¡n <code>-100</code> cho cÃ¡c token con khÃ¡c trong má»™t tá»« nháº¥t Ä‘á»‹nh. Äiá»u nÃ y lÃ  Ä‘á»ƒ trÃ¡nh cÃ¡c tá»« dÃ i Ä‘Æ°á»£c chia thÃ nh nhiá»u token phá»¥ gÃ³p pháº§n lá»›n vÃ o hÃ m máº¥t mÃ¡t. Thay Ä‘á»•i chá»©c nÄƒng trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ cÄƒn chá»‰nh nhÃ£n vá»›i ID Ä‘áº§u vÃ o báº±ng cÃ¡ch tuÃ¢n theo quy táº¯c nÃ y.</p></div>
<p>Äá»ƒ xá»­ lÃ½ trÆ°á»›c toÃ n bá»™ táº­p dá»¯ liá»‡u cá»§a mÃ¬nh, chÃºng ta cáº§n tokenize táº¥t cáº£ cÃ¡c Ä‘áº§u vÃ o vÃ  Ã¡p dá»¥ng <code>align_labels_with_tokens()</code> trÃªn táº¥t cáº£ cÃ¡c nhÃ£n. Äá»ƒ táº­n dá»¥ng tá»‘c Ä‘á»™ cá»§a trÃ¬nh tokenize nhanh cá»§a mÃ¬nh, tá»‘t nháº¥t báº¡n nÃªn tokenize nhiá»u vÄƒn báº£n cÃ¹ng má»™t lÃºc, vÃ¬ váº­y chÃºng ta sáº½ viáº¿t má»™t hÃ m xá»­ lÃ½ danh sÃ¡ch cÃ¡c vÃ­ dá»¥ vÃ  sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>Dataset.map()</code> vá»›i tÃ¹y chá»n <code>batched=True</code>. Äiá»u duy nháº¥t khÃ¡c vá»›i vÃ­ dá»¥ trÆ°á»›c lÃ  hÃ m <code>word_ids()</code> cáº§n láº¥y chá»‰ má»¥c cá»§a máº«u mÃ  chÃºng ta muá»‘n cÃ¡c ID tá»« khi cÃ¡c Ä‘áº§u vÃ o cho tokenizer lÃ  danh sÃ¡ch vÄƒn báº£n (hoáº·c trong trÆ°á»ng há»£p cá»§a chÃºng ta lÃ  danh sÃ¡ch danh sÃ¡ch cÃ¡c tá»«), vÃ¬ váº­y chÃºng ta cÅ©ng thÃªm vÃ o Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_and_align_labels</span>(<span class="hljs-params">examples</span>):
    tokenized_inputs = tokenizer(
        examples[<span class="hljs-string">&quot;tokens&quot;</span>], truncation=<span class="hljs-literal">True</span>, is_split_into_words=<span class="hljs-literal">True</span>
    )
    all_labels = examples[<span class="hljs-string">&quot;ner_tags&quot;</span>]
    new_labels = []
    <span class="hljs-keyword">for</span> i, labels <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(all_labels):
        word_ids = tokenized_inputs.word_ids(i)
        new_labels.append(align_labels_with_tokens(labels, word_ids))

    tokenized_inputs[<span class="hljs-string">&quot;labels&quot;</span>] = new_labels
    <span class="hljs-keyword">return</span> tokenized_inputs<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng chÃºng ta chÆ°a Ä‘á»‡m vÃ o cá»§a mÃ¬nh; chÃºng ta sáº½ lÃ m Ä‘iá»u Ä‘Ã³ sau, khi táº¡o cÃ¡c lÃ´ báº±ng trÃ¬nh Ä‘á»‘i chiáº¿u dá»¯ liá»‡u.</p>
<p>BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng táº¥t cáº£ tiá»n xá»­ lÃ½ Ä‘Ã³ trong má»™t láº§n vÃ o cÃ¡c pháº§n khÃ¡c cá»§a táº­p dá»¯ liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(
    tokenize_and_align_labels,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].column_names,
)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta Ä‘Ã£ hoÃ n thÃ nh pháº§n khÃ³ nháº¥t! BÃ¢y giá», dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c tiá»n xá»­ lÃ½, quÃ¡ trÃ¬nh huáº¥n luyá»‡n thá»±c táº¿ sáº½ giá»‘ng nhÆ° nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ lÃ m trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>.</p>
<h2 class="relative group"><a id="tinh-chnh-m-hnh-trong-api-trainer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-m-hnh-trong-api-trainer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mÃ´ hÃ¬nh trong API <code>Trainer</code></span></h2>

<p>MÃ£ thá»±c sá»­ dá»¥ng <code>Trainer</code> sáº½ giá»‘ng nhÆ° trÆ°á»›c Ä‘Ã¢y; nhá»¯ng thay Ä‘á»•i duy nháº¥t lÃ  cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‘i chiáº¿u thÃ nh má»™t lÃ´ vÃ  chá»©c nÄƒng tÃ­nh toÃ¡n sá»‘ liá»‡u.</p>
<h3 class="relative group"><a id="i-chiu-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#i-chiu-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Äá»‘i chiáº¿u dá»¯ liá»‡u
	</span></h3>

<p>ChÃºng ta khÃ´ng thá»ƒ chá»‰ sá»­ dá»¥ng má»™t <code>DataCollatorWithPadding</code> nhÆ° trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a> vÃ¬ nÃ³ chá»‰ Ä‘á»‡m cÃ¡c Ä‘áº§u vÃ o (ID Ä‘áº§u vÃ o, attention mask vÃ  loáº¡i token ID). á» Ä‘Ã¢y, cÃ¡c nhÃ£n cá»§a chÃºng ta nÃªn Ä‘Æ°á»£c Ä‘á»‡m theo cÃ¹ng má»™t cÃ¡ch giá»‘ng nhÆ° cÃ¡c Ä‘áº§u vÃ o Ä‘á»ƒ chÃºng giá»¯ nguyÃªn kÃ­ch thÆ°á»›c, sá»­ dá»¥ng <code>-100</code> lÃ m giÃ¡ trá»‹ Ä‘á»ƒ cÃ¡c dá»± Ä‘oÃ¡n tÆ°Æ¡ng á»©ng bá»‹ bá» qua trong tÃ­nh toÃ¡n tá»•n tháº¥t.</p>
<p>Táº¥t cáº£ Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi <a href="https://huggingface.co/transformers/main_classes/data_collator.html#datacollatorfortokenclassification" rel="nofollow"><code>DataCollatorForTokenClassification</code></a>. Giá»‘ng nhÆ° <code>DataCollatorWithPadding</code>, nÃ³ sá»­ dá»¥ng <code>tokenizer</code> Ä‘á»ƒ xá»­ lÃ½ trÆ°á»›c cÃ¡c Ä‘áº§u vÃ o:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> DataCollatorForTokenClassification

data_collator = DataCollatorForTokenClassification(tokenizer=tokenizer)<!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ kiá»ƒm tra nÃ³ trÃªn vÃ i máº«u, ta cÃ³ thá»ƒ gá»i nÃ³ trÃªn danh sÃ¡ch cÃ¡c máº«u tá»« táº­p huáº¥n luyá»‡n Ä‘Ã£ Ä‘Æ°á»£c tokenize:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->batch = data_collator([tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)])
batch[<span class="hljs-string">&quot;labels&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tensor([[-<span class="hljs-number">100</span>,    <span class="hljs-number">3</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">7</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">7</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>],
        [-<span class="hljs-number">100</span>,    <span class="hljs-number">1</span>,    <span class="hljs-number">2</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>, -<span class="hljs-number">100</span>]])<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y so sÃ¡nh Ä‘iá»u nÃ y vá»›i cÃ¡c nhÃ£n cho pháº§n tá»­ Ä‘áº§u tiÃªn vÃ  thá»© hai trong táº­p dá»¯ liá»‡u cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):
    <span class="hljs-built_in">print</span>(tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>][i][<span class="hljs-string">&quot;labels&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[-<span class="hljs-number">100</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">100</span>]
[-<span class="hljs-number">100</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, -<span class="hljs-number">100</span>]<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, táº­p há»£p nhÃ£n thá»© hai Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‡m báº±ng Ä‘á»™ dÃ i cá»§a táº­p Ä‘áº§u tiÃªn báº±ng cÃ¡ch sá»­ dá»¥ng <code>-100</code>.</p>

<h3 class="relative group"><a id="thc-o" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#thc-o"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ThÆ°á»›c Ä‘o
	</span></h3>

<p>Äá»ƒ <code>Trainer</code> tÃ­nh toÃ¡n má»™t thÆ°á»›c Ä‘o cho má»—i epoch, ta sáº½ cáº§n Ä‘á»‹nh nghÄ©a hÃ m <code>compute_metrics()</code> nháº­n má»™t array cÃ¡c dá»± Ä‘oÃ¡n vÃ  nhÃ£n, vÃ  tráº£ vá» má»™t tá»« Ä‘iá»ƒn vá»›i tÃªn cÃ¡c thÆ°á»›c Ä‘o vÃ  giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng.</p>
<p>Khung truyá»n thá»‘ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ phÃ¢n loáº¡i token lÃ  <a href="https://github.com/chakki-works/seqeval" rel="nofollow"><em>seqeval</em></a>. Äá»ƒ sá»­ dá»¥ng thÆ°á»›c Ä‘o nÃ y, ta sáº½ cáº§n cÃ i Ä‘áº·t thÆ° viá»‡n <em>seqeval</em>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!pip install seqeval<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ táº£i nÃ³ qua hÃ m <code>evaluate.load()</code> nhÆ° Ä‘Ã£ lÃ m á»Ÿ <a href="/course/chapter3">ChÆ°Æ¡ng 3 3</a>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

metric = evaluate.load(<span class="hljs-string">&quot;seqeval&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ThÆ°á»›c Ä‘o nÃ y khÃ´ng giá»‘ng nhÆ° cÃ¡c thÆ°á»›c Ä‘o Ä‘á»™ chÃ­nh xÃ¡c thÃ´ng thÆ°Æ¡ng: nÃ³ sáº½ nháº­n má»™t danh sÃ¡ch cÃ¡c nhÃ£n nhÆ° lÃ  chuá»—i vÄƒn báº£n, khÃ´ng pháº£i sá»‘ nguyÃªn, nÃªn ta sáº½ cáº§n giáº£i mÃ£ toÃ n bá»™ nhá»¯ng dá»± Ä‘oÃ¡n vÃ  nhÃ£n trÆ°á»›c khi truyá»n chÃºng vÃ o thÆ°á»›c Ä‘o. HÃ£y cÃ¹ng xem nÃ³ hoáº¡t Ä‘á»™ng ra sao. Äáº§u tiÃªn, ta sáº½ láº¥y nhá»¯ng nhÃ£n tá»« máº«u huáº¥n luyá»‡n Ä‘áº§u tiÃªn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->labels = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;ner_tags&quot;</span>]
labels = [label_names[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> labels]
labels<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;B-ORG&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;B-MISC&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;B-MISC&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>Ta cÃ³ thá»ƒ táº¡o ra nhá»¯ng dá»± Ä‘oÃ¡n giáº£ cho chÃºng báº±ng cÃ¡ch thay Ä‘á»•i giÃ¡ trá»‹ á»Ÿ chá»‰ má»¥c 2:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions = labels.copy()
predictions[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;O&quot;</span>
metric.compute(predictions=[predictions], references=[labels])<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng thÆ°á»›c Ä‘o nháº­n danh sÃ¡ch cÃ¡c dá»± Ä‘oÃ¡n (khÃ´ng chá»‰ má»™t) vÃ  danh sÃ¡ch cÃ¡c nhÃ£n. ÄÃ¢y lÃ  Ä‘áº§u ra:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;MISC&#x27;</span>: {<span class="hljs-string">&#x27;precision&#x27;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&#x27;recall&#x27;</span>: <span class="hljs-number">0.5</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.67</span>, <span class="hljs-string">&#x27;number&#x27;</span>: <span class="hljs-number">2</span>},
 <span class="hljs-string">&#x27;ORG&#x27;</span>: {<span class="hljs-string">&#x27;precision&#x27;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&#x27;recall&#x27;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">1.0</span>, <span class="hljs-string">&#x27;number&#x27;</span>: <span class="hljs-number">1</span>},
 <span class="hljs-string">&#x27;overall_precision&#x27;</span>: <span class="hljs-number">1.0</span>,
 <span class="hljs-string">&#x27;overall_recall&#x27;</span>: <span class="hljs-number">0.67</span>,
 <span class="hljs-string">&#x27;overall_f1&#x27;</span>: <span class="hljs-number">0.8</span>,
 <span class="hljs-string">&#x27;overall_accuracy&#x27;</span>: <span class="hljs-number">0.89</span>}<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y Ä‘ang gá»­i láº¡i ráº¥t nhiá»u thÃ´ng tin! ChÃºng ta nháº­n Ä‘Æ°á»£c precision, recall, vÃ  Ä‘iá»ƒm F1 cho tá»«ng thá»±c thá»ƒ riÃªng biá»‡t, cÅ©ng nhÆ° tá»•ng thá»ƒ. Äá»‘i vá»›i tÃ­nh toÃ¡n sá»‘ liá»‡u cá»§a mÃ¬nh, chÃºng ta sáº½ chá»‰ giá»¯ láº¡i Ä‘iá»ƒm tá»•ng thá»ƒ, nhÆ°ng hÃ£y tinh chá»‰nh chá»©c nÄƒng <code>compute_metrics()</code> Ä‘á»ƒ tráº£ vá» táº¥t cáº£ cÃ¡c sá»‘ liá»‡u báº¡n muá»‘n bÃ¡o cÃ¡o.</p>
<p>HÃ m <code>compute_metrics()</code> nÃ y trÆ°á»›c tiÃªn láº¥y argmax cá»§a logits Ä‘á»ƒ chuyá»ƒn chÃºng thÃ nh cÃ¡c dá»± Ä‘oÃ¡n (nhÆ° thÆ°á»ng lá»‡, logits vÃ  xÃ¡c suáº¥t theo cÃ¹ng má»™t thá»© tá»±, vÃ¬ váº­y chÃºng ta khÃ´ng cáº§n Ã¡p dá»¥ng softmax). Sau Ä‘Ã³, chÃºng ta pháº£i chuyá»ƒn Ä‘á»•i cáº£ nhÃ£n vÃ  dá»± Ä‘oÃ¡n tá»« sá»‘ nguyÃªn sang chuá»—i. ChÃºng ta xÃ³a táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cÃ³ nhÃ£n lÃ  <code>-100</code>, sau Ä‘Ã³ chuyá»ƒn káº¿t quáº£ Ä‘áº¿n phÆ°Æ¡ng thá»©c <code>metric.compute()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_preds</span>):
    logits, labels = eval_preds
    predictions = np.argmax(logits, axis=-<span class="hljs-number">1</span>)

    <span class="hljs-comment"># XoÃ¡ nhá»¯ng chá»‰ má»¥c bá»‹ ngÃ³ lÆ¡ (token Ä‘áº·c biá»‡t) vÃ  chuyá»ƒn chÃºng thÃ nh nhÃ£n</span>
    true_labels = [[label_names[l] <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> label <span class="hljs-keyword">if</span> l != -<span class="hljs-number">100</span>] <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]
    true_predictions = [
        [label_names[p] <span class="hljs-keyword">for</span> (p, l) <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(prediction, label) <span class="hljs-keyword">if</span> l != -<span class="hljs-number">100</span>]
        <span class="hljs-keyword">for</span> prediction, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(predictions, labels)
    ]
    all_metrics = metric.compute(predictions=true_predictions, references=true_labels)
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">&quot;precision&quot;</span>: all_metrics[<span class="hljs-string">&quot;overall_precision&quot;</span>],
        <span class="hljs-string">&quot;recall&quot;</span>: all_metrics[<span class="hljs-string">&quot;overall_recall&quot;</span>],
        <span class="hljs-string">&quot;f1&quot;</span>: all_metrics[<span class="hljs-string">&quot;overall_f1&quot;</span>],
        <span class="hljs-string">&quot;accuracy&quot;</span>: all_metrics[<span class="hljs-string">&quot;overall_accuracy&quot;</span>],
    }<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» Ä‘iá»u nÃ y Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n, chÃºng ta gáº§n nhÆ° Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh <code>Trainer</code> cá»§a mÃ¬nh. ChÃºng ta chá»‰ cáº§n má»™t <code>model</code>  Ä‘á»ƒ tinh chá»‰nh!</p>
<h3 class="relative group"><a id="nh-ngha-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#nh-ngha-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Äá»‹nh nghÄ©a mÃ´ hÃ¬nh
	</span></h3>

<p>VÃ¬ chÃºng ta Ä‘ang giáº£i quyáº¿t váº¥n Ä‘á» phÃ¢n loáº¡i token, chÃºng ta sáº½ sá»­ dá»¥ng lá»›p <code>AutoModelForTokenClassification</code>. Äiá»u chÃ­nh cáº§n nhá»› khi xÃ¡c Ä‘á»‹nh mÃ´ hÃ¬nh nÃ y lÃ  truyá»n má»™t sá»‘ thÃ´ng tin vá» sá»‘ lÆ°á»£ng nhÃ£n mÃ  chÃºng ta cÃ³. CÃ¡ch dá»… nháº¥t Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y lÃ  truyá»n vÃ o tham sá»‘ <code>num_labels</code>, nhÆ°ng náº¿u chÃºng ta muá»‘n má»™t tiá»‡n Ã­ch luáº­n suy hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° tiá»‡n Ã­ch chÃºng ta Ä‘Ã£ tháº¥y á»Ÿ Ä‘áº§u pháº§n nÃ y, tá»‘t hÆ¡n nÃªn Ä‘áº·t cÃ¡c nhÃ£n tÆ°Æ¡ng á»©ng chÃ­nh xÃ¡c thay tháº¿.</p>
<p>ChÃºng pháº£i Ä‘Æ°á»£c Ä‘áº·t bá»Ÿi hai tá»« Ä‘iá»ƒn, <code>id2label</code> vÃ  <code>label2id</code>, chá»©a cÃ¡c Ã¡nh xáº¡ tá»« ID Ä‘áº¿n nhÃ£n vÃ  ngÆ°á»£c láº¡i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->id2label = {<span class="hljs-built_in">str</span>(i): label <span class="hljs-keyword">for</span> i, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(label_names)}
label2id = {v: k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> id2label.items()}<!-- HTML_TAG_END --></pre></div>
<p>Giá» ta cÃ³ thá»ƒ truyá»n chÃºng vÃ o phÆ°Æ¡ng thá»©c <code>AutoModelForTokenClassification.from_pretrained()</code>, vÃ  chÃºng sáº½ Ä‘Æ°á»£c thiáº¿t láº­p trong cáº¥u hÃ¬nh mÃ´ hÃ¬nh vÃ  sau Ä‘Ã³ Ä‘Æ°á»£c lÆ°u váº£ táº£i lÃªn Hub:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForTokenClassification

model = AutoModelForTokenClassification.from_pretrained(
    model_checkpoint,
    id2label=id2label,
    label2id=label2id,
)<!-- HTML_TAG_END --></pre></div>
<p>Giá»‘ng nhÆ° khi chÃºng tÃ´i Ä‘á»‹nh nghÄ©a <code>AutoModelForSequenceClassification</code> cá»§a mÃ¬nh trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>, viá»‡c táº¡o mÃ´ hÃ¬nh Ä‘Æ°a ra cáº£nh bÃ¡o ráº±ng má»™t sá»‘ trá»ng sá»‘ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng (nhá»¯ng trá»ng sá»‘ tá»« Ä‘áº§u huáº¥n luyá»‡n trÆ°á»›c) vÃ  má»™t sá»‘ trá»ng sá»‘ khÃ¡c Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn (nhá»¯ng trá»ng sá»‘ tá»« Ä‘áº§u phÃ¢n loáº¡i token má»›i) vÃ  mÃ´ hÃ¬nh nÃ y nÃªn Ä‘Æ°á»£c huáº¥n luyá»‡n. ChÃºng ta sáº½ lÃ m Ä‘iá»u Ä‘Ã³ sau má»™t phÃºt, nhÆ°ng trÆ°á»›c tiÃªn hÃ£y kiá»ƒm tra ká»¹ xem mÃ´ hÃ¬nh cá»§a chÃºng ta cÃ³ Ä‘Ãºng sá»‘ lÆ°á»£ng nhÃ£n hay khÃ´ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.config.num_labels<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">9</span><!-- HTML_TAG_END --></pre></div>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>âš ï¸ Náº¿u báº¡n cÃ³ mÃ´ hÃ¬nh vá»›i sá»‘ lÆ°á»£ng nhÃ£n sai, báº¡n sáº½ nháº­n má»™t lá»—i khÃ³ hiá»ƒu khi gá»i hÃ m <code>Trainer.train()</code> sau Ä‘Ã³ (giá»‘ng nhÆ° â€œCUDA error: device-side assert triggeredâ€). ÄÃ¢y lÃ  nguyÃªn nhÃ¢n sá»‘ má»™t gÃ¢y ra lá»—i do ngÆ°á»i dÃ¹ng bÃ¡o cÃ¡o vá» nhá»¯ng lá»—i nhÆ° váº­y, vÃ¬ váº­y hÃ£y Ä‘áº£m báº£o báº¡n thá»±c hiá»‡n kiá»ƒm tra nÃ y Ä‘á»ƒ xÃ¡c nháº­n ráº±ng báº¡n cÃ³ sá»‘ lÆ°á»£ng nhÃ£n dá»± kiáº¿n.</p></div>
<h3 class="relative group"><a id="tinh-chnh-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mÃ´ hÃ¬nh
	</span></h3>

<p>Giá» ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a mÃ¬nh! ChÃºng ta chá»‰ cáº§n lÃ m hai Ä‘iá»u trÆ°á»›c khi Ä‘á»‹nh nghÄ©a <code>Trainer</code>:  Ä‘Äƒng nháº­p vÃ o Hugging Face vÃ  Ä‘á»‹nh nghÄ©a cÃ¡c tham sá»‘ huáº¥n luyá»‡n. Náº¿u báº¡n Ä‘ang lÃ m viá»‡c vá»›i notebook, cÃ³ má»™t hÃ m thuáº­n tiá»‡n cÃ³ thá»ƒ giÃºp báº¡n: </p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>Thao tÃ¡c nÃ y sáº½ hiá»ƒn thá»‹ má»™t tiá»‡n Ã­ch mÃ  báº¡n cÃ³ thá»ƒ nháº­p thÃ´ng tin Ä‘Äƒng nháº­p Hugging Facecá»§a mÃ¬nh.</p>
<p>Náº¿u báº¡n khÃ´ng lÃ m viá»‡c trong sá»• ghi chÃ©p, chá»‰ cáº§n nháº­p dÃ²ng sau vÃ o thiáº¿t bá»‹ Ä‘áº§u cuá»‘i cá»§a báº¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-cli login<!-- HTML_TAG_END --></pre></div>
<p>Once this is done, we can define our <code>TrainingArguments</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

args = TrainingArguments(
    <span class="hljs-string">&quot;bert-finetuned-ner&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
    push_to_hub=<span class="hljs-literal">True</span>,
)<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n Ä‘Ã£ tá»«ng tháº¥y háº§u háº¿t nhá»¯ng Ä‘iá»u Ä‘Ã³ trÆ°á»›c Ä‘Ã¢y: chÃºng ta Ä‘áº·t má»™t sá»‘ siÃªu tham sá»‘ (nhÆ° tá»‘c Ä‘á»™ há»c, sá»‘ epoch cáº§n luyá»‡n táº­p vÃ  giáº£m trá»ng lÆ°á»£ng) vÃ  chÃºng ta chá»‰ Ä‘á»‹nh <code>push_to_hub=True</code> Ä‘á»ƒ chá»‰ ra ráº±ng chÃºng ta muá»‘n lÆ°u mÃ´ hÃ¬nh vÃ  Ä‘Ã¡nh giÃ¡ nÃ³ vÃ o cuá»‘i má»—i epoch vÃ  ráº±ng chÃºng ta muá»‘n táº£i káº¿t quáº£ cá»§a mÃ¬nh lÃªn Model Hub. LÆ°u Ã½ ráº±ng báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh tÃªn cá»§a kho lÆ°u trá»¯ mÃ  báº¡n muá»‘n Ä‘áº©y Ä‘áº¿n báº±ng tham sá»‘ <code>hub_model_id</code> (cá»¥ thá»ƒ lÃ  báº¡n sáº½ pháº£i sá»­ dá»¥ng tham sá»‘ nÃ y Ä‘á»ƒ Ä‘áº©y Ä‘áº¿n má»™t tá»• chá»©c). VÃ­ dá»¥: khi Ä‘áº©y mÃ´ hÃ¬nh vÃ o tá»• chá»©c <a href="https://huggingface.co/huggingface-course" rel="nofollow"><code>huggingface-course</code></a> chÃºng ta Ä‘Ã£ thÃªm <code>hub_model_id=&quot;huggingface-course/bert-finetuned-ner&quot;</code> vÃ o <code>TrainingArguments</code>. Theo máº·c Ä‘á»‹nh, kho lÆ°u trá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng sáº½ náº±m trong khÃ´ng gian tÃªn cá»§a báº¡n vÃ  Ä‘Æ°á»£c Ä‘áº·t tÃªn theo thÆ° má»¥c Ä‘áº§u ra mÃ  báº¡n Ä‘Ã£ Ä‘áº·t, vÃ¬ váº­y trong trÆ°á»ng há»£p cá»§a chÃºng tÃ´i, nÃ³ sáº½ lÃ  <code>&quot;sgugger/bert-finetuned-ner&quot;</code>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u thÆ° má»¥c Ä‘áº§u ra báº¡n Ä‘ang sá»­ dá»¥ng Ä‘Ã£ tá»“n táº¡i, nÃ³ cáº§n pháº£i lÃ  báº£n sao cá»¥c bá»™ cá»§a kho lÆ°u trá»¯ mÃ  báº¡n muá»‘n Ä‘áº©y Ä‘áº¿n. Náº¿u khÃ´ng, báº¡n sáº½ gáº·p lá»—i khi xÃ¡c Ä‘á»‹nh <code>Trainer</code> cá»§a mÃ¬nh vÃ  sáº½ cáº§n Ä‘áº·t má»™t tÃªn má»›i.</p></div>
<p>Cuá»‘i cÃ¹ng, chÃºng ta chá»‰ cáº§n truyá»n má»i thá»© cho  <code>Trainer</code> vÃ  báº¯t Ä‘áº§u huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model=model,
    args=args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    compute_metrics=compute_metrics,
    tokenizer=tokenizer,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng trong khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n diá»…n ra, má»—i khi mÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u (á»Ÿ Ä‘Ã¢y, má»—i epoch), nÃ³ sáº½ Ä‘Æ°á»£c táº£i lÃªn Hub á»Ÿ cháº¿ Ä‘á»™ ná»n. Báº±ng cÃ¡ch nÃ y, báº¡n sáº½ cÃ³ thá»ƒ tiáº¿p tá»¥c huáº¥n luyá»‡n cá»§a mÃ¬nh trÃªn má»™t mÃ¡y khÃ¡c náº¿u cáº§n.</p>
<p>Sau khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n hoÃ n táº¥t, chÃºng ta sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>push_to_hub()</code> Ä‘á»ƒ Ä‘áº£m báº£o chÃºng ta táº£i lÃªn phiÃªn báº£n má»›i nháº¥t cá»§a mÃ´ hÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub(commit_message=<span class="hljs-string">&quot;Training complete&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>CÃ¢u lá»‡nh nÃ y tráº£ vá» URL cá»§a cam kháº¿t nÃ³ vá»«a lÃ m, náº¿u báº¡n muá»‘n kiá»ƒm tra nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;https://huggingface.co/sgugger/bert-finetuned-ner/commit/26ab21e5b1568f9afeccdaed2d8715f571d786ed&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p><code>Trainer</code> cÅ©ng soáº¡n tháº£o má»™t tháº» mÃ´ hÃ¬nh vá»›i táº¥t cáº£ cÃ¡c káº¿t quáº£ Ä‘Ã¡nh giÃ¡ vÃ  táº£i nÃ³ lÃªn. á» giai Ä‘oáº¡n nÃ y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tiá»‡n Ã­ch luáº­n suy trÃªn Model Hub Ä‘á»ƒ kiá»ƒm tra mÃ´ hÃ¬nh cá»§a mÃ¬nh vÃ  chia sáº» vá»›i báº¡n bÃ¨. Báº¡n Ä‘Ã£ tinh chá»‰nh thÃ nh cÃ´ng má»™t mÃ´ hÃ¬nh trong tÃ¡c vá»¥ phÃ¢n loáº¡i token - xin chÃºc má»«ng!</p>
<p>Náº¿u báº¡n muá»‘n tÃ¬m hiá»ƒu sÃ¢u hÆ¡n má»™t chÃºt vá» vÃ²ng huáº¥n luyá»‡n, bÃ¢y giá» chÃºng tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch thá»±c hiá»‡n Ä‘iá»u tÆ°Æ¡ng tá»± báº±ng cÃ¡ch sá»­ dá»¥ng ğŸ¤— Accelerate.</p>
<h2 class="relative group"><a id="mt-vng-hun-luyn-tu-chnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#mt-vng-hun-luyn-tu-chnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Má»™t vÃ²ng huáº¥n luyá»‡n tuá»³ chá»‰nh
	</span></h2>

<p>BÃ¢y giá» chÃºng ta hÃ£y xem toÃ n bá»™ vÃ²ng láº·p huáº¥n luyá»‡n, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ dá»… dÃ ng tÃ¹y chá»‰nh cÃ¡c pháº§n báº¡n cáº§n. NÃ³ sáº½ trÃ´ng ráº¥t giá»‘ng nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ lÃ m trong <a href="/course/chapter3/4">ChÆ°Æ¡ng 3</a>, vá»›i má»™t vÃ i thay Ä‘á»•i cho pháº§n Ä‘Ã¡nh giÃ¡.</p>
<h3 class="relative group"><a id="chun-b-mi-th-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-mi-th-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº©n bá»‹ má»i thá»© Ä‘á»ƒ huáº¥n luyá»‡n
	</span></h3>

<p>Äáº§u tiÃªn, chÃºng ta cáº§n xÃ¢y dá»±ng cÃ¡c <code>DataLoader</code> tá»« cÃ¡c táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. ChÃºng ta sáº½ sá»­ dá»¥ng láº¡i <code>data_collator</code> cá»§a mÃ¬nh dÆ°á»›i dáº¡ng <code>collate_fn</code> vÃ  xÃ¡o trá»™n táº­p huáº¥n luyá»‡n, nhÆ°ng khÃ´ng pháº£i táº­p kiá»ƒm Ä‘á»‹nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader

train_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=data_collator,
    batch_size=<span class="hljs-number">8</span>,
)
eval_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>], collate_fn=data_collator, batch_size=<span class="hljs-number">8</span>
)<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, chÃºng ta khÃ´i phá»¥c mÃ´ hÃ¬nh cá»§a mÃ¬nh, Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng chÃºng ta khÃ´ng tiáº¿p tá»¥c tinh chá»‰nh tá»« trÆ°á»›c mÃ  báº¯t Ä‘áº§u láº¡i tá»« mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c BERT:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForTokenClassification.from_pretrained(
    model_checkpoint,
    id2label=id2label,
    label2id=label2id,
)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng tÃ´i sáº½ cáº§n má»™t trÃ¬nh tá»‘i Æ°u hÃ³a. ChÃºng ta sáº½ sá»­ dá»¥ng <code>AdamW</code> cá»• Ä‘iá»ƒn, giá»‘ng nhÆ° <code>Adam</code>, nhÆ°ng vá»›i má»™t báº£n sá»­a lá»—i trong cÃ¡ch Ã¡p dá»¥ng weight decay (phÃ¢n rÃ£ trá»ng sá»‘):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>Once we have all those objects, we can send them to the <code>accelerator.prepare()</code> method:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator()
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸš¨ Náº¿u báº¡n huáº¥n luyá»‡n trÃªn TPU, báº¡n sáº½ cáº§n chuyá»ƒn táº¥t cáº£ cÃ¡c Ä‘oáº¡n mÃ£ á»Ÿ trÃªn thÃ nh má»™t hÃ m huáº¥n luyá»‡n. Xem <a href="/course/chapter3">ChÆ°Æ¡ng 3</a> Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.</p></div>
<p>BÃ¢y giá», chÃºng ta Ä‘Ã£ gá»­i <code>train_dataloader</code> cá»§a mÃ¬nh tá»›i <code>speedrator.prepare()</code>, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»™ dÃ i cá»§a nÃ³ Ä‘á»ƒ tÃ­nh sá»‘ bÆ°á»›c huáº¥n luyá»‡n. HÃ£y nhá»› ráº±ng chÃºng ta pháº£i luÃ´n lÃ m Ä‘iá»u nÃ y sau khi chuáº©n bá»‹ dataloader, vÃ¬ phÆ°Æ¡ng thá»©c Ä‘Ã³ sáº½ thay Ä‘á»•i Ä‘á»™ dÃ i cá»§a nÃ³. ChÃºng ta sá»­ dá»¥ng má»™t lá»‹ch trÃ¬nh tuyáº¿n tÃ­nh cá»• Ä‘iá»ƒn tá»« tá»‘c Ä‘á»™ há»c Ä‘áº¿n 0:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">3</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>Cuá»‘i cÃ¹ng, Ä‘á»ƒ Ä‘áº©y mÃ´ hÃ¬nh cá»§a chÃºng ta lÃªn Hub, chÃºng ta sáº½ cáº§n táº¡o má»™t Ä‘á»‘i tÆ°á»£ng <code>Repository</code> trong má»™t thÆ° má»¥c Ä‘ang lÃ m viá»‡c. Äáº§u tiÃªn hÃ£y Ä‘Äƒng nháº­p vÃ o Hugging Face, náº¿u báº¡n chÆ°a Ä‘Äƒng nháº­p. ChÃºng ta sáº½ xÃ¡c Ä‘á»‹nh tÃªn kho lÆ°u trá»¯ tá»« ID mÃ´ hÃ¬nh mÃ  ta muá»‘n cung cáº¥p cho mÃ´ hÃ¬nh cá»§a mÃ¬nh (vui lÃ²ng thay tháº¿ <code>repo_name</code> báº±ng sá»± lá»±a chá»n cá»§a riÃªng báº¡n; nÃ³ chá»‰ cáº§n chá»©a tÃªn ngÆ°á»i dÃ¹ng cá»§a báº¡n, Ä‘Ã³ lÃ  nhá»¯ng gÃ¬ hÃ m <code>get_full_repo_name ()</code> thá»±c hiá»‡n):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository, get_full_repo_name

model_name = <span class="hljs-string">&quot;bert-finetuned-ner-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;sgugger/bert-finetuned-ner-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, ta cÃ³ thá»ƒ sao chÃ©p kho lÆ°u trá»¯ Ä‘Ã³ trong má»™t thÆ° má»¥c cá»¥c bá»™. Náº¿u nÃ³ Ä‘Ã£ tá»“n táº¡i, thÆ° má»¥c cá»¥c bá»™ nÃ y pháº£i lÃ  báº£n sao hiá»‡n cÃ³ cá»§a kho lÆ°u trá»¯ mÃ  chÃºng ta Ä‘ang lÃ m viá»‡c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->output_dir = <span class="hljs-string">&quot;bert-finetuned-ner-accelerate&quot;</span>
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>Giá» ta cÃ³ thá»ƒ táº£i má»i thá»© ta lÆ°u trong <code>output_dir</code> báº±ng cÃ¡ch gá»i phÆ°Æ¡ng thá»©c <code>repo.push_to_hub()</code>. Äiá»u nÃ y sáº½ giÃºp ta táº£i ngay láº­p tá»©c mÃ´ hÃ¬nh á»Ÿ cuá»‘i má»—i epoch.</p>
<h3 class="relative group"><a id="vng-lp-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#vng-lp-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>VÃ²ng láº·p huáº¥n luyá»‡n
	</span></h3>

<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ viáº¿t vÃ²ng láº·p  huáº¥n luyá»‡n Ä‘áº§y Ä‘á»§. Äá»ƒ Ä‘Æ¡n giáº£n hÃ³a pháº§n Ä‘Ã¡nh giÃ¡ cá»§a nÃ³, chÃºng ta Ä‘á»‹nh nghÄ©a hÃ m <code>postprocess()</code> láº¥y cÃ¡c dá»± Ä‘oÃ¡n vÃ  nhÃ£n vÃ  chuyá»ƒn Ä‘á»•i chÃºng thÃ nh danh sÃ¡ch cÃ¡c chuá»—i, giá»‘ng nhÆ° Ä‘á»‘i tÆ°á»£ng <code>metric</code> mong Ä‘á»£i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">postprocess</span>(<span class="hljs-params">predictions, labels</span>):
    predictions = predictions.detach().cpu().clone().numpy()
    labels = labels.detach().cpu().clone().numpy()

    <span class="hljs-comment"># Loáº¡i bá» cÃ¡c chá»‰ má»¥c bá»‹ ngÃ³ lÆ¡ (cÃ¡c token Ä‘áº·c biá»‡t) vÃ  chuyá»ƒn chÃºng thÃ nh nhÃ£n</span>
    true_labels = [[label_names[l] <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> label <span class="hljs-keyword">if</span> l != -<span class="hljs-number">100</span>] <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]
    true_predictions = [
        [label_names[p] <span class="hljs-keyword">for</span> (p, l) <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(prediction, label) <span class="hljs-keyword">if</span> l != -<span class="hljs-number">100</span>]
        <span class="hljs-keyword">for</span> prediction, label <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(predictions, labels)
    ]
    <span class="hljs-keyword">return</span> true_labels, true_predictions<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ viáº¿t vÃ²ng láº·p huáº¥n luyá»‡n. Sau khi xÃ¡c Ä‘á»‹nh má»™t thanh tiáº¿n trÃ¬nh Ä‘á»ƒ theo dÃµi quÃ¡ trÃ¬nh huáº¥n luyá»‡n diá»…n ra nhÆ° tháº¿ nÃ o, vÃ²ng láº·p cÃ³ ba pháº§n:</p>
<ul><li>Báº£n thÃ¢n quÃ¡ trÃ¬nh huáº¥n luyá»‡n, lÃ  vÃ²ng láº·p cá»• Ä‘iá»ƒn trÃªn <code>train_dataloader</code>, truyá»n tháº³ng qua mÃ´ hÃ¬nh, sau Ä‘Ã³ truyá»n ngÆ°á»£c vÃ  tá»‘i Æ°u hÃ³a.</li>
<li>ÄÃ¡nh giÃ¡, trong Ä‘Ã³ cÃ³ má»™t Ä‘iá»ƒm má»›i sau khi nháº­n Ä‘Æ°á»£c káº¿t quáº£ Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh trÃªn má»™t lÃ´: vÃ¬ hai quy trÃ¬nh cÃ³ thá»ƒ Ä‘Ã£ Ä‘á»™n cÃ¡c Ä‘áº§u vÃ o vÃ  nhÃ£n thÃ nh cÃ¡c hÃ¬nh dáº¡ng khÃ¡c nhau, chÃºng ta cáº§n sá»­ dá»¥ng <code>accelerator.pad_across_processes()</code>Ä‘á»ƒ Ä‘Æ°a ra dá»± Ä‘oÃ¡n vÃ  dÃ¡n nhÃ£n cho cÃ¹ng má»™t hÃ¬nh dáº¡ng trÆ°á»›c khi gá»i phÆ°Æ¡ng thá»©c <code>collect()</code>. Náº¿u khÃ´ng lÃ m Ä‘iá»u nÃ y, Ä‘Ã¡nh giÃ¡ sáº½ bá»‹ lá»—i hoáº·c bá»‹ treo vÄ©nh viá»…n. Sau Ä‘Ã³, chÃºng ta gá»­i káº¿t quáº£ Ä‘áº¿n <code>metric.add_batch()</code> vÃ  gá»i <code>metric.compute()</code> khi vÃ²ng láº·p Ä‘Ã¡nh giÃ¡ káº¿t thÃºc.</li>
<li>LÆ°u vÃ  táº£i lÃªn, nÆ¡i Ä‘áº§u tiÃªn chÃºng ta lÆ°u mÃ´ hÃ¬nh vÃ  trÃ¬nh tokenize, sau Ä‘Ã³ gá»i <code>repo.push_to_hub()</code>. LÆ°u Ã½ ráº±ng chÃºng ta sá»­ dá»¥ng Ä‘á»‘i sá»‘ <code>blocks=False</code> Ä‘á»ƒ yÃªu cáº§u thÆ° viá»‡n ğŸ¤— Hub Ä‘áº©y vÃ o má»™t quÃ¡ trÃ¬nh khÃ´ng Ä‘á»“ng bá»™. Báº±ng cÃ¡ch nÃ y, quÃ¡ trÃ¬nh huáº¥n luyá»‡n tiáº¿p tá»¥c diá»…n ra bÃ¬nh thÆ°á»ng vÃ  lá»‡nh (dÃ i) nÃ y Ä‘Æ°á»£c thá»±c thi á»Ÿ cháº¿ Ä‘á»™ ná»n.</li></ul>
<p>ÄÃ¢y lÃ  mÃ£ hoÃ n chá»‰nh cho vÃ²ng láº·p huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Huáº¥n luyá»‡n</span>
    model.train()
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> train_dataloader:
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># ÄÃ¡nh giÃ¡</span>
    model.<span class="hljs-built_in">eval</span>()
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> eval_dataloader:
        <span class="hljs-keyword">with</span> torch.no_grad():
            outputs = model(**batch)

        predictions = outputs.logits.argmax(dim=-<span class="hljs-number">1</span>)
        labels = batch[<span class="hljs-string">&quot;labels&quot;</span>]

        <span class="hljs-comment"># Cáº§n Ä‘á»‡m cÃ¡c dá»± Ä‘oÃ¡n vÃ  nhÃ£n Ä‘á»ƒ táº­p há»£p</span>
        predictions = accelerator.pad_across_processes(predictions, dim=<span class="hljs-number">1</span>, pad_index=-<span class="hljs-number">100</span>)
        labels = accelerator.pad_across_processes(labels, dim=<span class="hljs-number">1</span>, pad_index=-<span class="hljs-number">100</span>)

        predictions_gathered = accelerator.gather(predictions)
        labels_gathered = accelerator.gather(labels)

        true_predictions, true_labels = postprocess(predictions_gathered, labels_gathered)
        metric.add_batch(predictions=true_predictions, references=true_labels)

    results = metric.compute()
    <span class="hljs-built_in">print</span>(
        <span class="hljs-string">f&quot;epoch <span class="hljs-subst">{epoch}</span>:&quot;</span>,
        {
            key: results[<span class="hljs-string">f&quot;overall_<span class="hljs-subst">{key}</span>&quot;</span>]
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;precision&quot;</span>, <span class="hljs-string">&quot;recall&quot;</span>, <span class="hljs-string">&quot;f1&quot;</span>, <span class="hljs-string">&quot;accuracy&quot;</span>]
        },
    )

    <span class="hljs-comment"># LÆ°u vÃ  táº£i</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>
<p>Trong trÆ°á»ng há»£p Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn báº¡n tháº¥y má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u báº±ng ğŸ¤— Accelerate, hÃ£y dÃ nh má»™t chÃºt thá»i gian Ä‘á»ƒ kiá»ƒm tra ba dÃ²ng mÃ£ Ä‘i kÃ¨m vá»›i nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->accelerator.wait_for_everyone()
unwrapped_model = accelerator.unwrap_model(model)
unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)<!-- HTML_TAG_END --></pre></div>
<p>DÃ²ng Ä‘áº§u tiÃªn Ä‘Ã£ tá»± giáº£i thÃ­ch: nÃ³ cho táº¥t cáº£ cÃ¡c quÃ¡ trÃ¬nh chá» cho Ä‘áº¿n khi má»i ngÆ°á»i á»Ÿ giai Ä‘oáº¡n Ä‘Ã³ trÆ°á»›c khi tiáº¿p tá»¥c. Äiá»u nÃ y lÃ  Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng ta cÃ³ cÃ¹ng má»™t mÃ´ hÃ¬nh trong má»i quy trÃ¬nh trÆ°á»›c khi lÆ°u. Sau Ä‘Ã³, chÃºng ta láº¥y <code>unwrapped_model</code>, lÃ  mÃ´ hÃ¬nh cÆ¡ sá»Ÿ mÃ  ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh. PhÆ°Æ¡ng thá»©c <code>accelerator.prepare()</code> thay Ä‘á»•i mÃ´ hÃ¬nh Ä‘á»ƒ hoáº¡t Ä‘á»™ng trong huáº¥n luyá»‡n phÃ¢n tÃ¡n, vÃ¬ váº­y nÃ³ sáº½ khÃ´ng cÃ³ phÆ°Æ¡ng thá»©c <code>save_pretrained()</code> ná»¯a; phÆ°Æ¡ng thá»©c <code>accelerator.unwrap_model()</code> hoÃ n tÃ¡c bÆ°á»›c Ä‘Ã³. Cuá»‘i cÃ¹ng, chÃºng ta gá»i lÃ  <code>save_pretrained()</code> nhÆ°ng yÃªu cáº§u phÆ°Æ¡ng thá»©c Ä‘Ã³ sá»­ dá»¥ng <code>accelerator.save()</code> thay vÃ¬ <code>torch.save()</code>.</p>
<p>Khi Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n, báº¡n sáº½ cÃ³ má»™t mÃ´ hÃ¬nh táº¡o ra káº¿t quáº£ khÃ¡ giá»‘ng vá»›i mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i <code>Trainer</code>. Báº¡n cÃ³ thá»ƒ kiá»ƒm tra mÃ´ hÃ¬nh mÃ  chÃºng ta Ä‘Ã£ huáº¥n luyá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng Ä‘oáº¡n mÃ£ nÃ y táº¡i <a href="https://huggingface.co/huggingface-course/bert-finetuned-ner-accelerate" rel="nofollow"><em>huggingface-course/bert-finetuned-ner-accelerate</em></a>. VÃ  náº¿u báº¡n muá»‘n kiá»ƒm tra báº¥t ká»³ tinh chá»‰nh nÃ o Ä‘á»‘i vá»›i vÃ²ng láº·p huáº¥n luyá»‡n, báº¡n cÃ³ thá»ƒ trá»±c tiáº¿p thá»±c hiá»‡n chÃºng báº±ng cÃ¡ch chá»‰nh sá»­a Ä‘oáº¡n mÃ£ Ä‘Æ°á»£c hiá»ƒn thá»‹ á»Ÿ trÃªn!</p>
<h2 class="relative group"><a id="s-dng-m-hnh-c-tinh-chnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#s-dng-m-hnh-c-tinh-chnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tinh chá»‰nh
	</span></h2>

<p>ChÃºng tÃ´i Ä‘Ã£ chá»‰ cho báº¡n cÃ¡ch báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng mÃ´ hÃ¬nh mÃ  chÃºng ta Ä‘Ã£ tinh chá»‰nh trÃªn Model Hub báº±ng tiá»‡n Ã­ch luáº­n suy. Äá»ƒ sá»­ dá»¥ng nÃ³ cá»¥c bá»™ trong má»™t <code>pipeline</code>, báº¡n chá»‰ cáº§n chá»‰ Ä‘á»‹nh mÃ£ Ä‘á»‹nh danh mÃ´ hÃ¬nh thÃ­ch há»£p:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

<span class="hljs-comment"># Thay tháº¿ nÃ³ vá»›i checkpoint cá»§a ta</span>
model_checkpoint = <span class="hljs-string">&quot;huggingface-course/bert-finetuned-ner&quot;</span>
token_classifier = pipeline(
    <span class="hljs-string">&quot;token-classification&quot;</span>, model=model_checkpoint, aggregation_strategy=<span class="hljs-string">&quot;simple&quot;</span>
)
token_classifier(<span class="hljs-string">&quot;My name is Sylvain and I work at Hugging Face in Brooklyn.&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[{<span class="hljs-string">&#x27;entity_group&#x27;</span>: <span class="hljs-string">&#x27;PER&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.9988506</span>, <span class="hljs-string">&#x27;word&#x27;</span>: <span class="hljs-string">&#x27;Sylvain&#x27;</span>, <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">18</span>},
 {<span class="hljs-string">&#x27;entity_group&#x27;</span>: <span class="hljs-string">&#x27;ORG&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.9647625</span>, <span class="hljs-string">&#x27;word&#x27;</span>: <span class="hljs-string">&#x27;Hugging Face&#x27;</span>, <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">33</span>, <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">45</span>},
 {<span class="hljs-string">&#x27;entity_group&#x27;</span>: <span class="hljs-string">&#x27;LOC&#x27;</span>, <span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.9986118</span>, <span class="hljs-string">&#x27;word&#x27;</span>: <span class="hljs-string">&#x27;Brooklyn&#x27;</span>, <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">49</span>, <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">57</span>}]<!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t quÃ¡! MÃ´ hÃ¬nh cá»§a chÃºng ta Ä‘ang hoáº¡t Ä‘á»™ng tá»‘t nhÆ° mÃ´ hÃ¬nh máº·c Ä‘á»‹nh cho pipeline nÃ y!</p>


		<script type="module" data-hydrate="1dbr44w">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="1dbr44w"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter7/2.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
