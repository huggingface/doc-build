<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;hi-p&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-d-liu&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;b-d-liu-squad&quot;,&quot;title&quot;:&quot;Bá»™ dá»¯ liá»‡u SQuAD&quot;},{&quot;local&quot;:&quot;x-l-d-liu-hun-luyn&quot;,&quot;title&quot;:&quot;Xá»­ lÃ½ dá»¯ liá»‡u huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;x-l-d-liu-kim-nh&quot;,&quot;title&quot;:&quot;Xá»­ lÃ½ dá»¯ liá»‡u kiá»ƒm Ä‘á»‹nh&quot;}],&quot;title&quot;:&quot;Chuáº©n bá»‹ dá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hn-vi-api-trainer&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬n vá»›i API `Trainer`&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hn-vi-keras&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;hu-x-l&quot;,&quot;title&quot;:&quot;Háº­u xá»­ lÃ½&quot;},{&quot;local&quot;:&quot;tinh-chnh-m-hnh&quot;,&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬nh&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh mÃ´ hÃ¬n vá»›i Keras&quot;},{&quot;local&quot;:&quot;mt-vng-lp-hun-luyn-tu-chnh&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;chun-b-mi-th-cho-hun-luyn&quot;,&quot;title&quot;:&quot;Chuáº¥n bá»‹ má»i thá»© cho huáº¥n luyá»‡n&quot;}],&quot;title&quot;:&quot;Má»™t vÃ²ng láº·p huáº¥n luyá»‡n tuá»³ chá»‰nh&quot;},{&quot;local&quot;:&quot;vng-lp-hun-luyn&quot;,&quot;title&quot;:&quot;VÃ²ng láº·p huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;s-dng-m-hnh-tinh-chnh&quot;,&quot;title&quot;:&quot;Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh&quot;}],&quot;title&quot;:&quot;Há»i Ä‘Ã¡p&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter7/7.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="hi-p" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hi-p"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Há»i Ä‘Ã¡p
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/vi/chapter7/section7_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/vi/chapter7/section7_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>ÄÃ£ Ä‘áº¿n lÃºc xem pháº§n há»i Ä‘Ã¡p! TÃ¡c vá»¥ nÃ y cÃ³ nhiá»u loáº¡i, nhÆ°ng tÃ¡c vá»¥ mÃ  chÃºng ta sáº½ táº­p trung vÃ o trong pháº§n nÃ y Ä‘Æ°á»£c gá»i lÃ  tráº£ lá»i cÃ¢u há»i <em>khai thÃ¡c</em>. Äiá»u nÃ y liÃªn quan Ä‘áº¿n viá»‡c Ä‘áº·t ra cÃ¡c cÃ¢u há»i vá» má»™t tÃ i liá»‡u vÃ  xÃ¡c Ä‘á»‹nh cÃ¡c cÃ¢u tráº£ lá»i dÆ°á»›i dáº¡ng <em>cÃ¡c khoáº£ng cá»§a vÄƒn báº£n</em> trong chÃ­nh tÃ i liá»‡u Ä‘Ã³.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/ajPx5LwJD-I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>ChÃºng ta sáº½ tinh chá»‰nh mÃ´ hÃ¬nh BERT trÃªn <a href="https://rajpurkar.github.io/SQuAD-explorer/" rel="nofollow">bá»™ dá»¯ liá»‡u SQuAD</a>, bao gá»“m cÃ¡c cÃ¢u há»i do cá»™ng Ä‘á»“ng Ä‘áº·t ra trÃªn má»™t táº­p cÃ¡c bÃ i viáº¿t trÃªn Wikipedia. Äiá»u nÃ y sáº½ cung cáº¥p cho chÃºng ta má»™t mÃ´ hÃ¬nh cÃ³ thá»ƒ tÃ­nh toÃ¡n cÃ¡c dá»± Ä‘oÃ¡n nhÆ° tháº¿ nÃ y:</p>
<iframe src="https://hf.space/gradioiframe/course-demos/bert-finetuned-squad/+" frameborder="0" height="450" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<p>ÄÃ¢y thá»±c sá»± cÃ¡ch mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n vÃ  táº£i lÃªn Hub báº±ng cÃ¡ch sá»­ dá»¥ng mÃ£ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong pháº§n nÃ y. Báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y nÃ³ vÃ  kiá»ƒm tra cÃ¡c dá»± Ä‘oáº¡n <a href="https://huggingface.co/huggingface-course/bert-finetuned-squad?context=%F0%9F%A4%97+Transformers+is+backed+by+the+three+most+popular+deep+learning+libraries+%E2%80%94+Jax%2C+PyTorch+and+TensorFlow+%E2%80%94+with+a+seamless+integration+between+them.+It%27s+straightforward+to+train+your+models+with+one+before+loading+them+for+inference+with+the+other.&question=Which+deep+learning+libraries+back+%F0%9F%A4%97+Transformers%3F" rel="nofollow">táº¡i Ä‘Ã¢y</a>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ CÃ¡c mÃ´ hÃ¬nh mÃ£ hÃ³a nhÆ° BERT cÃ³ xu hÆ°á»›ng tuyá»‡t vá»i trong viá»‡c trÃ­ch xuáº¥t cÃ¢u tráº£ lá»i cho cÃ¡c cÃ¢u há»i dáº¡ng thá»±c táº¿ nhÆ° â€œAi Ä‘Ã£ phÃ¡t minh ra kiáº¿n trÃºc Transformer?â€ nhÆ°ng khÃ¡ kÃ©m khi tráº£ lá»i nhá»¯ng cÃ¢u há»i má»Ÿ nhÆ° â€œTáº¡i sao báº§u trá»i láº¡i cÃ³ mÃ u xanh?â€ Trong nhá»¯ng trÆ°á»ng há»£p khÃ³ khÄƒn hÆ¡n nÃ y, cÃ¡c mÃ´ hÃ¬nh mÃ£ hÃ³a-giáº£i mÃ£ nhÆ° T5 vÃ  BART thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»•ng há»£p thÃ´ng tin theo cÃ¡ch khÃ¡ giá»‘ng vá»›i <a href="/course/chapter7/5">tÃ³m táº¯t vÄƒn báº£n</a>. Náº¿u báº¡n quan tÃ¢m Ä‘áº¿n kiá»ƒu tráº£ lá»i cÃ¢u há»i <em>chung chung</em> nÃ y, chÃºng tÃ´i khuyÃªn báº¡n nÃªn xem <a href="https://yjernite.github.io/lfqa.html" rel="nofollow">demo</a> cá»§a chÃºng tÃ´i dá»±a trÃªn <a href="https://huggingface.co/datasets/eli5" rel="nofollow">bá»™ dá»¯ liá»‡u ELI5</a>.</p></div>
<h2 class="relative group"><a id="chun-b-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº©n bá»‹ dá»¯ liá»‡u
	</span></h2>

<p>Táº­p dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t lÃ m tiÃªu chuáº©n há»c thuáº­t Ä‘á»ƒ tráº£ lá»i cÃ¢u há»i khai thÃ¡c lÃ  <a href="https://rajpurkar.github.io/SQuAD-explorer/" rel="nofollow">SQuAD</a>, vÃ¬ váº­y Ä‘Ã³ lÃ  táº­p chÃºng ta sáº½ sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y. NgoÃ i ra cÃ²n cÃ³ má»™t Ä‘iá»ƒm chuáº©n khÃ³ hÆ¡n <a href="https://huggingface.co/datasets/squad_v2" rel="nofollow">SQuAD v2</a>, bao gá»“m cÃ¡c cÃ¢u há»i khÃ´ng cÃ³ cÃ¢u tráº£ lá»i. Miá»…n lÃ  táº­p dá»¯ liá»‡u cá»§a riÃªng báº¡n chá»©a má»™t cá»™t cho ngá»¯ cáº£nh, má»™t cá»™t cho cÃ¢u há»i vÃ  má»™t cá»™t cho cÃ¢u tráº£ lá»i, báº¡n sáº½ cÃ³ thá»ƒ Ä‘iá»u chá»‰nh cÃ¡c bÆ°á»›c bÃªn dÆ°á»›i.</p>
<h3 class="relative group"><a id="b-d-liu-squad" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#b-d-liu-squad"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Bá»™ dá»¯ liá»‡u SQuAD
	</span></h3>

<p>NhÆ° thÆ°á»ng lá»‡, chÃºng ta cÃ³ thá»ƒ táº£i xuá»‘ng vÃ  lÆ°u bá»™ dá»¯ liá»‡u vÃ o bá»™ nhá»› cache chá»‰ trong má»™t bÆ°á»›c nhá» vÃ o <code>load_dataset()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

raw_datasets = load_dataset(<span class="hljs-string">&quot;squad&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ xem xÃ©t Ä‘á»‘i tÆ°á»£ng nÃ y Ä‘á»ƒ tÃ¬m hiá»ƒu thÃªm vá» táº­p dá»¯ liá»‡u SQuAD:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
        num_rows: <span class="hljs-number">87599</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
        num_rows: <span class="hljs-number">10570</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>CÃ³ váº» nhÆ° chÃºng ta cÃ³ má»i thá»© ta cáº§n vá»›i cÃ¡c trÆ°á»ng <code>context</code>, <code>question</code>, vÃ  <code>answers</code>, vÃ¬ váº­y hÃ£y in chÃºng cho pháº§n tá»­ Ä‘áº§u tiÃªn cá»§a táº­p huáº¥n luyá»‡n cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Context: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;context&quot;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Question: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;question&quot;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Answer: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;answers&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Context: <span class="hljs-string">&#x27;Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot;Venite Ad Me Omnes&quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive (and in a direct line that connects through 3 statues and the Gold Dome), is a simple, modern stone statue of Mary.&#x27;</span>
Question: <span class="hljs-string">&#x27;To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France?&#x27;</span>
Answer: {<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Saint Bernadette Soubirous&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">515</span>]}<!-- HTML_TAG_END --></pre></div>
<p>CÃ¡c trÆ°á»ng <code>context</code> vÃ  <code>question</code> ráº¥t dá»… sá»­ dá»¥ng. TrÆ°á»ng <code>answers</code> phá»©c táº¡p hÆ¡n má»™t chÃºt vÃ¬ nÃ³ so sÃ¡nh má»™t tá»« Ä‘iá»ƒn vá»›i hai trÆ°á»ng Ä‘á»u lÃ  danh sÃ¡ch. ÄÃ¢y lÃ  Ä‘á»‹nh dáº¡ng sáº½ Ä‘Æ°á»£c mong Ä‘á»£i bá»Ÿi chá»‰ sá»‘ <code>squad</code> trong quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡; náº¿u báº¡n Ä‘ang sá»­ dá»¥ng dá»¯ liá»‡u cá»§a riÃªng mÃ¬nh, báº¡n khÃ´ng nháº¥t thiáº¿t pháº£i lo láº¯ng vá» viá»‡c Ä‘áº·t cÃ¡c cÃ¢u tráº£ lá»i á»Ÿ cÃ¹ng má»™t Ä‘á»‹nh dáº¡ng. TrÆ°á»ng <code>text</code> khÃ¡ rÃµ rÃ ng vÃ  trÆ°á»ng <code>answer_start</code> chá»©a chá»‰ má»¥c kÃ½ tá»± báº¯t Ä‘áº§u cá»§a má»—i cÃ¢u tráº£ lá»i trong ngá»¯ cáº£nh.</p>
<p>Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, chá»‰ cÃ³ má»™t cÃ¢u tráº£ lá»i kháº£ dÄ©. ChÃºng ta cÃ³ thá»ƒ kiá»ƒm tra ká»¹ Ä‘iá»u nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>Dataset.filter()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">len</span>(x[<span class="hljs-string">&quot;answers&quot;</span>][<span class="hljs-string">&quot;text&quot;</span>]) != <span class="hljs-number">1</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Dataset({
    features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
    num_rows: <span class="hljs-number">0</span>
})<!-- HTML_TAG_END --></pre></div>
<p>Tuy nhiÃªn, Ä‘á»ƒ Ä‘Ã¡nh giÃ¡, cÃ³ má»™t sá»‘ cÃ¢u tráº£ lá»i cÃ³ thá»ƒ cÃ³ cho má»—i máº«u, cÃ³ thá»ƒ giá»‘ng hoáº·c khÃ¡c nhau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;answers&quot;</span>])
<span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;answers&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">177</span>, <span class="hljs-number">177</span>, <span class="hljs-number">177</span>]}
{<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Santa Clara, California&#x27;</span>, <span class="hljs-string">&quot;Levi&#x27;s Stadium&quot;</span>, <span class="hljs-string">&quot;Levi&#x27;s Stadium in the San Francisco Bay Area at Santa Clara, California.&quot;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">403</span>, <span class="hljs-number">355</span>, <span class="hljs-number">355</span>]}<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta sáº½ khÃ´ng Ä‘i sÃ¢u vÃ o táº­p lá»‡nh Ä‘Ã¡nh giÃ¡ vÃ¬ táº¥t cáº£ sáº½ Ä‘Æ°á»£c bao bá»c bá»Ÿi chá»‰ sá»‘ ğŸ¤— Datasets, nhÆ°ng phiÃªn báº£n ngáº¯n lÃ  má»™t sá»‘ cÃ¢u há»i cÃ³ má»™t sá»‘ cÃ¢u tráº£ lá»i cÃ³ thá»ƒ cÃ³ vÃ  táº­p lá»‡nh nÃ y sáº½ so sÃ¡nh má»™t cÃ¢u tráº£ lá»i Ä‘Æ°á»£c dá»± Ä‘oÃ¡n cho táº¥t cáº£ cÃ¢u tráº£ lá»i cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c vÃ  dÃ nh Ä‘iá»ƒm cao nháº¥t. VÃ­ dá»¥: náº¿u chÃºng ta xem xÃ©t máº«u á»Ÿ chá»‰ má»¥c 2:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;context&quot;</span>])
<span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;question&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Super Bowl 50 was an American football game to determine the champion of the National Football League (NFL) for the 2015 season. The American Football Conference (AFC) champion Denver Broncos defeated the National Football Conference (NFC) champion Carolina Panthers 24â€“10 to earn their third Super Bowl title. The game was played on February 7, 2016, at Levi\&#x27;s Stadium in the San Francisco Bay Area at Santa Clara, California. As this was the 50th Super Bowl, the league emphasized the &quot;golden anniversary&quot; with various gold-themed initiatives, as well as temporarily suspending the tradition of naming each Super Bowl game with Roman numerals (under which the game would have been known as &quot;Super Bowl L&quot;), so that the logo could prominently feature the Arabic numerals 50.&#x27;</span>
<span class="hljs-string">&#x27;Where did Super Bowl 50 take place?&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ta cÃ³ thá»ƒ tháº¥y cÃ¢u tráº£ lá»i cÃ³ thá»ƒ thá»±c ra lÃ  má»™t trong sá»‘ ba kháº£ nÄƒng ta tháº¥y trÆ°á»›c Ä‘Ã³.</p>
<h3 class="relative group"><a id="x-l-d-liu-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#x-l-d-liu-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xá»­ lÃ½ dá»¯ liá»‡u huáº¥n luyá»‡n
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/qgaM0weJHpA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>HÃ£y báº¯t Ä‘áº§u vá»›i viá»‡c xá»­ lÃ½ trÆ°á»›c dá»¯ liá»‡u huáº¥n luyá»‡n. Pháº§n khÃ³ sáº½ lÃ  táº¡o nhÃ£n cho cÃ¢u tráº£ lá»i cá»§a cÃ¢u há»i, Ä‘Ã³ sáº½ lÃ  vá»‹ trÃ­ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a cÃ¡c tháº» tÆ°Æ¡ng á»©ng vá»›i cÃ¢u tráº£ lá»i bÃªn trong ngá»¯ cáº£nh.</p>
<p>NhÆ°ng chÃºng ta Ä‘á»«ng vÆ°á»£t lÃªn chÃ­nh mÃ¬nh. Äáº§u tiÃªn, chÃºng ta cáº§n chuyá»ƒn Ä‘á»•i vÄƒn báº£n trong Ä‘áº§u vÃ o thÃ nh cÃ¡c ID mÃ  mÃ´ hÃ¬nh cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c, sá»­ dá»¥ng tokenizer:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_checkpoint = <span class="hljs-string">&quot;bert-base-cased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, chÃºng ta sáº½ tinh chá»‰nh mÃ´ hÃ¬nh BERT, nhÆ°ng báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng báº¥t ká»³ loáº¡i mÃ´ hÃ¬nh nÃ o khÃ¡c miá»…n lÃ  nÃ³ cÃ³ triá»ƒn khai trÃ¬nh tokenize nhanh. Báº¡n cÃ³ thá»ƒ xem táº¥t cáº£ cÃ¡c kiáº¿n trÃºc Ä‘i kÃ¨m vá»›i phiÃªn báº£n nhanh trong <a href="https://huggingface.co/transformers/#supported-frameworks" rel="nofollow">báº£ng lá»›n nÃ y</a> vÃ  Ä‘á»ƒ kiá»ƒm tra xem Ä‘á»‘i tÆ°á»£ng <code>tokenizer</code> mÃ  báº¡n Ä‘ang sá»­ dá»¥ng cÃ³ thá»±c sá»± lÃ  Ä‘Æ°á»£c há»— trá»£ bá»Ÿi ğŸ¤— Tokenizers, báº¡n cÃ³ thá»ƒ xem thuá»™c tÃ­nh <code>is_fast</code> cá»§a nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.is_fast<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-literal">True</span><!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ truyá»n cÃ¢u há»i vÃ  ngá»¯ cáº£nh cho trÃ¬nh tokenizer cá»§a mÃ¬nh vÃ  nÃ³ sáº½ chÃ¨n Ä‘Ãºng cÃ¡c token Ä‘áº·c biá»‡t Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢u nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-selector-attr">[CLS]</span> question <span class="hljs-selector-attr">[SEP]</span> context <span class="hljs-selector-attr">[SEP]</span><!-- HTML_TAG_END --></pre></div>
<p>HÃ£y cÃ¹ng kiá»ƒm tra nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->context = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;context&quot;</span>]
question = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;question&quot;</span>]

inputs = tokenizer(question, context)
tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Architecturally, &#x27;</span>
<span class="hljs-string">&#x27;the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin &#x27;</span>
<span class="hljs-string">&#x27;Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms &#x27;</span>
<span class="hljs-string">&#x27;upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred &#x27;</span>
<span class="hljs-string">&#x27;Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a &#x27;</span>
<span class="hljs-string">&#x27;replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette &#x27;</span>
<span class="hljs-string">&#x27;Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 statues &#x27;</span>
<span class="hljs-string">&#x27;and the Gold Dome ), is a simple, modern stone statue of Mary. [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>CÃ¡c nhÃ£n sau Ä‘Ã³ sáº½ lÃ  chá»‰ má»¥c cá»§a cÃ¡c token báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cÃ¢u tráº£ lá»i vÃ  mÃ´ hÃ¬nh sáº½ cÃ³ nhiá»‡m vá»¥ dá»± Ä‘oÃ¡n má»™t logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cho má»—i token trong Ä‘áº§u vÃ o, vá»›i cÃ¡c nhÃ£n lÃ½ thuyáº¿t nhÆ° sau:</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/qa_labels.svg" alt="One-hot encoded labels for question answering.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/qa_labels-dark.svg" alt="One-hot encoded labels for question answering."></div>
<p>Trong trÆ°á»ng há»£p nÃ y, ngá»¯ cáº£nh khÃ´ng quÃ¡ dÃ i, nhÆ°ng má»™t sá»‘ máº«u trong táº­p dá»¯ liá»‡u cÃ³ ngá»¯ cáº£nh ráº¥t dÃ i sáº½ vÆ°á»£t quÃ¡ Ä‘á»™ dÃ i tá»‘i Ä‘a mÃ  chÃºng tÃ´i Ä‘áº·t (trong trÆ°á»ng há»£p nÃ y lÃ  384). NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter6/4">ChÆ°Æ¡ng 6</a> khi chÃºng ta khÃ¡m phÃ¡ pháº§n bÃªn trong cá»§a pipeline <code>question-answering</code>, chÃºng ta sáº½ Ä‘á»‘i phÃ³ vá»›i cÃ¡c ngá»¯ cáº£nh dÃ i báº±ng cÃ¡ch táº¡o má»™t sá»‘ Ä‘áº·c trÆ°ng huáº¥n luyá»‡n tá»« má»™t máº«u táº­p dá»¯ liá»‡u cá»§a mÃ¬nh, vá»›i cá»­a sá»• trÆ°á»£t giá»¯a chÃºng.</p>
<p>Äá»ƒ xem cÃ¡ch nÃ y hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o báº±ng cÃ¡ch sá»­ dá»¥ng vÃ­ dá»¥ hiá»‡n táº¡i, chÃºng ta cÃ³ thá»ƒ giá»›i háº¡n Ä‘á»™ dÃ i á»Ÿ 100 vÃ  sá»­ dá»¥ng cá»­a sá»• trÆ°á»£t gá»“m 50 token. Xin nháº¯c láº¡i, chÃºng ta sá»­ dá»¥ng:</p>
<ul><li><code>max_length</code> Ä‘á»ƒ Ä‘áº·t Ä‘á»™ dÃ i tá»‘i Ä‘a (á»Ÿ Ä‘Ã¢y lÃ  100)</li>
<li><code>truncation=&quot;only_second&quot;</code> Ä‘á»ƒ cáº¯t ngáº¯n ngá»¯ cáº£nh (á»Ÿ vá»‹ trÃ­ thá»© hai) khi cÃ¢u há»i cÃ³ ngá»¯ cáº£nh quÃ¡ dÃ i</li>
<li><code>stride</code> Ä‘á»ƒ Ä‘áº·t sá»‘ lÆ°á»£ng token chá»“ng chÃ©o giá»¯a hai pháº§n liÃªn tiáº¿p (á»Ÿ Ä‘Ã¢y lÃ  50)</li>
<li><code>return_overflowing_tokens=True</code> Ä‘á»ƒ cho trÃ¬nh tokenizer biáº¿t chÃºng ta muá»‘n cÃ¡c token trÃ n</li></ul>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    question,
    context,
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
)

<span class="hljs-keyword">for</span> ids <span class="hljs-keyword">in</span> inputs[<span class="hljs-string">&quot;input_ids&quot;</span>]:
    <span class="hljs-built_in">print</span>(tokenizer.decode(ids))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basi [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP]. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 statues and the Gold Dome ), is a simple, modern stone statue of Mary. [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, vÃ­ dá»¥ cá»§a chÃºng ta Ä‘Ã£ Ä‘Æ°á»£c chia thÃ nh bá»‘n Ä‘áº§u vÃ o, má»—i Ä‘áº§u vÃ o chá»©a cÃ¢u há»i vÃ  má»™t sá»‘ pháº§n cá»§a ngá»¯ cáº£nh. LÆ°u Ã½ ráº±ng cÃ¢u tráº£ lá»i cho cÃ¢u há»i (â€œBernadette Soubirousâ€) chá»‰ xuáº¥t hiá»‡n trong Ä‘áº§u vÃ o thá»© ba vÃ  cuá»‘i cÃ¹ng, vÃ¬ váº­y báº±ng cÃ¡ch xá»­ lÃ½ cÃ¡c ngá»¯ cáº£nh dÃ i theo cÃ¡ch nÃ y, chÃºng ta sáº½ táº¡o má»™t sá»‘ máº«u huáº¥n luyá»‡n trong Ä‘Ã³ cÃ¢u tráº£ lá»i khÃ´ng Ä‘Æ°á»£c Ä‘Æ°a vÃ o ngá»¯ cáº£nh. Äá»‘i vá»›i nhá»¯ng vÃ­ dá»¥ Ä‘Ã³, nhÃ£n sáº½ lÃ  <code>start_position = end_position = 0</code> (vÃ¬ váº­y chÃºng tÃ´i dá»± Ä‘oÃ¡n token <code>[CLS]</code>). ChÃºng ta cÅ©ng sáº½ Ä‘áº·t cÃ¡c nhÃ£n Ä‘Ã³ trong trÆ°á»ng há»£p khÃ´ng may khi cÃ¢u tráº£ lá»i Ä‘Ã£ bá»‹ cáº¯t bá»›t Ä‘á»ƒ chÃºng ta chá»‰ cÃ³ pháº§n Ä‘áº§u (hoáº·c pháº§n cuá»‘i) cá»§a cÃ¢u tráº£ lá»i. Äá»‘i vá»›i cÃ¡c vÃ­ dá»¥ trong Ä‘Ã³ cÃ¢u tráº£ lá»i náº±m Ä‘áº§y Ä‘á»§ trong ngá»¯ cáº£nh, cÃ¡c nhÃ£n sáº½ lÃ  chá»‰ má»¥c cá»§a token nÆ¡i cÃ¢u tráº£ lá»i báº¯t Ä‘áº§u vÃ  chá»‰ má»¥c cá»§a token nÆ¡i cÃ¢u tráº£ lá»i káº¿t thÃºc.</p>
<p>Táº­p dá»¯ liá»‡u cung cáº¥p cho chÃºng ta kÃ½ tá»± báº¯t Ä‘áº§u cá»§a cÃ¢u tráº£ lá»i trong ngá»¯ cáº£nh vÃ  báº±ng cÃ¡ch thÃªm Ä‘á»™ dÃ i cá»§a cÃ¢u tráº£ lá»i, chÃºng ta cÃ³ thá»ƒ tÃ¬m tháº¥y kÃ½ tá»± káº¿t thÃºc trong ngá»¯ cáº£nh. Äá»ƒ Ã¡nh xáº¡ chÃºng vá»›i cÃ¡c chá»‰ sá»‘ token, chÃºng ta sáº½ cáº§n sá»­ dá»¥ng Ã¡nh xáº¡ offset mÃ  chÃºng ta Ä‘Ã£ nghiÃªn cá»©u trong <a href="/course/chapter6/4">ChÆ°Æ¡ng 6</a>. ChÃºng ta cÃ³ thá»ƒ yÃªu cáº§u tokenizer tráº£ láº¡i nhá»¯ng thá»© nÃ y báº±ng cÃ¡ch truyá»n theo <code>return_offsets_mapping=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    question,
    context,
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
    return_offsets_mapping=<span class="hljs-literal">True</span>,
)
inputs.keys()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->dict_keys([<span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;offset_mapping&#x27;</span>, <span class="hljs-string">&#x27;overflow_to_sample_mapping&#x27;</span>])<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, chÃºng ta láº¥y láº¡i cÃ¡c ID Ä‘áº§u vÃ o thÃ´ng thÆ°á»ng, token ID vÃ  attention mask, cÅ©ng nhÆ° Ã¡nh xáº¡ offset mÃ  chÃºng ta yÃªu cáº§u vÃ  má»™t khÃ³a bá»• sung, <code>overflow_to_sample_mapping</code>. GiÃ¡ trá»‹ tÆ°Æ¡ng á»©ng sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng cho chÃºng ta khi tokenize nhiá»u vÄƒn báº£n cÃ¹ng má»™t lÃºc (chÃºng ta nÃªn lÃ m Ä‘á»ƒ hÆ°á»Ÿng lá»£i tá»« thá»±c táº¿ lÃ  trÃ¬nh tokenizer Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Rust). VÃ¬ má»™t máº«u cÃ³ thá»ƒ cung cáº¥p má»™t sá»‘ Ä‘á»‘i tÆ°á»£ng Ä‘á»‹a lÃ½, nÃªn nÃ³ Ã¡nh xáº¡ tá»«ng Ä‘á»‘i tÆ°á»£ng Ä‘á»‹a lÃ½ vá»›i vÃ­ dá»¥ mÃ  nÃ³ cÃ³ nguá»“n gá»‘c. Bá»Ÿi vÃ¬ á»Ÿ Ä‘Ã¢y chÃºng ta chá»‰ tokenize má»™t vÃ­ dá»¥, chÃºng ta nháº­n Ä‘Æ°á»£c danh sÃ¡ch cÃ¡c <code>0</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>
<p>NhÆ°ng náº¿u chÃºng ta mÃ£ hÃ³a nhiá»u máº«u hÆ¡n, Ä‘iá»u nÃ y sáº½ trá»Ÿ nÃªn há»¯u Ã­ch hÆ¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;question&quot;</span>],
    raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;context&quot;</span>],
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
    return_offsets_mapping=<span class="hljs-literal">True</span>,
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;The 4 examples gave <span class="hljs-subst">{<span class="hljs-built_in">len</span>(inputs[<span class="hljs-string">&#x27;input_ids&#x27;</span>])}</span> features.&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Here is where each comes from: <span class="hljs-subst">{inputs[<span class="hljs-string">&#x27;overflow_to_sample_mapping&#x27;</span>]}</span>.&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;The 4 examples gave 19 features.&#x27;</span>
<span class="hljs-string">&#x27;Here is where each comes from: [0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3].&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, ba máº«u Ä‘áº§u tiÃªn (táº¡i chá»‰ sá»‘ 2, 3 vÃ  4 trong táº­p huáº¥n luyá»‡n) má»—i máº«u Ä‘Æ°a ra bá»‘n Ä‘áº·c trÆ°ng vÃ  máº«u cuá»‘i cÃ¹ng (táº¡i chá»‰ má»¥c 5 trong táº­p huáº¥n luyá»‡n) Ä‘Æ°a ra 7 Ä‘áº·c trÆ°ng.</p>
<p>ThÃ´ng tin nÃ y sáº½ há»¯u Ã­ch Ä‘á»ƒ Ã¡nh xáº¡ tá»«ng Ä‘á»‘i tÆ°á»£ng mÃ  chÃºng ta nháº­n Ä‘Æ°á»£c vá»›i nhÃ£n tÆ°Æ¡ng á»©ng cá»§a nÃ³. NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, cÃ¡c nhÃ£n Ä‘Ã³ lÃ :</p>
<ul><li><code>(0, 0)</code> náº¿u cÃ¢u tráº£ lá»i khÃ´ng náº±m trong khoáº£ng tÆ°Æ¡ng á»©ng cá»§a ngá»¯ cáº£nh</li>
<li><code>(start_position, end_position)</code> náº¿u cÃ¢u tráº£ lá»i náº±m trong khoáº£ng tÆ°Æ¡ng á»©ng cá»§a ngá»¯ cáº£nh, vá»›i <code>start_position</code> lÃ  chá»‰ má»¥c cá»§a token (trong cÃ¡c ID Ä‘áº§u vÃ o) á»Ÿ Ä‘áº§u cÃ¢u tráº£ lá»i vÃ  <code>end_position</code> lÃ  chá»‰ má»¥c cá»§a token (trong cÃ¡c ID Ä‘áº§u vÃ o) nÆ¡i cÃ¢u tráº£ lá»i káº¿t thÃºc.</li></ul>
<p>Äá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Ã¢y lÃ  trÆ°á»ng há»£p nÃ o vÃ  náº¿u cÃ³ liÃªn quan, vá»‹ trÃ­ cá»§a cÃ¡c token, trÆ°á»›c tiÃªn chÃºng ta tÃ¬m cÃ¡c chá»‰ sá»‘ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc ngá»¯ cáº£nh trong cÃ¡c ID Ä‘áº§u vÃ o. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c token ID Ä‘á»ƒ thá»±c hiá»‡n viá»‡c nÃ y, nhÆ°ng vÃ¬ chÃºng khÃ´ng nháº¥t thiáº¿t pháº£i tá»“n táº¡i cho táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh (vÃ­ dá»¥: DistilBERT khÃ´ng yÃªu cáº§u chÃºng), thay vÃ o Ä‘Ã³, chÃºng ta sáº½ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>sequence_ids()</code> cá»§a <code>BatchEncoding</code> mÃ  tokenizer cá»§a ta tráº£ vá».</p>
<p>Khi ta cÃ³ cÃ¡c chá»‰ má»¥c token Ä‘Ã³, chÃºng ta xem xÃ©t cÃ¡c offset, lÃ  cÃ¡c bá»™ giÃ¡ trá»‹ cá»§a hai sá»‘ nguyÃªn Ä‘áº¡i diá»‡n cho khoáº£ng kÃ½ tá»± bÃªn trong ngá»¯ cáº£nh ban Ä‘áº§u. Do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ phÃ¡t hiá»‡n xem Ä‘oáº¡n ngá»¯ cáº£nh trong Ä‘áº·c trÆ°ng nÃ y báº¯t Ä‘áº§u sau cÃ¢u tráº£ lá»i hay káº¿t thÃºc trÆ°á»›c khi cÃ¢u tráº£ lá»i báº¯t Ä‘áº§u (trong trÆ°á»ng há»£p Ä‘Ã³ nhÃ£n lÃ  <code>(0, 0)</code>). Náº¿u khÃ´ng pháº£i nhÆ° váº­y, chÃºng ta láº·p láº¡i Ä‘á»ƒ tÃ¬m mÃ£ token Ä‘áº§u tiÃªn vÃ  cuá»‘i cÃ¹ng cá»§a cÃ¢u tráº£ lá»i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->answers = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;answers&quot;</span>]
start_positions = []
end_positions = []

<span class="hljs-keyword">for</span> i, offset <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>]):
    sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][i]
    answer = answers[sample_idx]
    start_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>]
    end_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>] + <span class="hljs-built_in">len</span>(answer[<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>])
    sequence_ids = inputs.sequence_ids(i)

    <span class="hljs-comment"># TÃ¬m Ä‘iá»ƒm báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a ngá»¯ cáº£nh</span>
    <span class="hljs-keyword">while</span> sequence_ids[idx] != <span class="hljs-number">1</span>:
        idx += <span class="hljs-number">1</span>
    context_start = idx
    <span class="hljs-keyword">while</span> sequence_ids[idx] == <span class="hljs-number">1</span>:
        idx += <span class="hljs-number">1</span>
    context_end = idx - <span class="hljs-number">1</span>

    <span class="hljs-comment"># Náº¿u cÃ¢u tráº£ lá»i khÃ´ng hoÃ n toÃ n náº±m trong ngá»¯ cáº£nh, nhÃ£n lÃ  (0, 0)</span>
    <span class="hljs-keyword">if</span> offset[context_start][<span class="hljs-number">0</span>] &gt; start_char <span class="hljs-keyword">or</span> offset[context_end][<span class="hljs-number">1</span>] &lt; end_char:
        start_positions.append(<span class="hljs-number">0</span>)
        end_positions.append(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># Náº¿u khÃ´ng nÃ³ sáº½ lÃ  vá»‹ trÃ­ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc</span>
        idx = context_start
        <span class="hljs-keyword">while</span> idx &lt;= context_end <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">0</span>] &lt;= start_char:
            idx += <span class="hljs-number">1</span>
        start_positions.append(idx - <span class="hljs-number">1</span>)

        idx = context_end
        <span class="hljs-keyword">while</span> idx &gt;= context_start <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">1</span>] &gt;= end_char:
            idx -= <span class="hljs-number">1</span>
        end_positions.append(idx + <span class="hljs-number">1</span>)

start_positions, end_positions<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->([<span class="hljs-number">83</span>, <span class="hljs-number">51</span>, <span class="hljs-number">19</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">27</span>, <span class="hljs-number">0</span>, <span class="hljs-number">34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">67</span>, <span class="hljs-number">34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
 [<span class="hljs-number">85</span>, <span class="hljs-number">53</span>, <span class="hljs-number">21</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">70</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">68</span>, <span class="hljs-number">35</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y cÃ¹ng xem má»™t vÃ i káº¿t quáº£ Ä‘á»ƒ xÃ¡c minh ráº±ng cÃ¡ch tiáº¿p cáº­n cá»§a chÃºng ta lÃ  Ä‘Ãºng. Äá»‘i vá»›i Ä‘áº·c trÆ°ng Ä‘áº§u tiÃªn chÃºng ta tÃ¬m tháº¥y <code>(83, 85)</code> dÆ°á»›i dáº¡ng nhÃ£n, hÃ£y so sÃ¡nh cÃ¢u tráº£ lá»i lÃ½ thuyáº¿t vá»›i khoáº£ng token Ä‘Æ°á»£c giáº£i mÃ£ tá»« 83 Ä‘áº¿n 85 (bao gá»“m):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->idx = <span class="hljs-number">0</span>
sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][idx]
answer = answers[sample_idx][<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>]

start = start_positions[idx]
end = end_positions[idx]
labeled_answer = tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][idx][start : end + <span class="hljs-number">1</span>])

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Theoretical answer: <span class="hljs-subst">{answer}</span>, labels give: <span class="hljs-subst">{labeled_answer}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Theoretical answer: the Main Building, labels give: the Main Building&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Káº¿t quáº£ khÃ¡ lÃ  khá»›p nhau! BÃ¢y giá» chÃºng ta hÃ£y kiá»ƒm tra chá»‰ má»¥c 4, nÆ¡i chÃºng ta Ä‘áº·t nhÃ£n thÃ nh <code>(0, 0)</code>, cÃ³ nghÄ©a lÃ  cÃ¢u tráº£ lá»i khÃ´ng náº±m trong pháº§n ngá»¯ cáº£nh cá»§a Ä‘áº·c trÆ°ng Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->idx = <span class="hljs-number">4</span>
sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][idx]
answer = answers[sample_idx][<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>]

decoded_example = tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][idx])
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Theoretical answer: <span class="hljs-subst">{answer}</span>, decoded example: <span class="hljs-subst">{decoded_example}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Theoretical answer: a Marian place of prayer and reflection, decoded example: [CLS] What is the Grotto at Notre Dame? [SEP] Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grot [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>&lt;/Tip&gt;</p>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ tháº¥y tá»«ng bÆ°á»›c cÃ¡ch tiá»n xá»­ lÃ½ dá»¯ liá»‡u huáº¥n luyá»‡n cá»§a mÃ¬nh, chÃºng ta cÃ³ thá»ƒ nhÃ³m nÃ³ trong má»™t hÃ m mÃ  ta sáº½ Ã¡p dá»¥ng trÃªn toÃ n bá»™ táº­p dá»¯ liá»‡u huáº¥n luyá»‡n. ChÃºng ta sáº½ Ä‘á»‡m má»i Ä‘áº·c trÆ°ng Ä‘áº¿n Ä‘á»™ dÃ i tá»‘i Ä‘a mÃ  ta Ä‘Ã£ Ä‘áº·t, vÃ¬ háº§u háº¿t cÃ¡c ngá»¯ cáº£nh sáº½ dÃ i (vÃ  cÃ¡c máº«u tÆ°Æ¡ng á»©ng sáº½ Ä‘Æ°á»£c chia thÃ nh nhiá»u Ä‘áº·c trÆ°ng), vÃ¬ váº­y khÃ´ng cÃ³ lá»£i Ã­ch thá»±c sá»± nÃ o khi Ã¡p dá»¥ng Ä‘á»‡m Ä‘á»™ng á»Ÿ Ä‘Ã¢y:</p>
<p>Tháº­t váº­y, chÃºng ta khÃ´ng tháº¥y cÃ¢u tráº£ lá»i bÃªn trong ngá»¯ cáº£nh.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> Khi sá»­ dá»¥ng kiáº¿n trÃºc XLNet, pháº§n Ä‘á»‡m Ä‘Æ°á»£c Ã¡p dá»¥ng á»Ÿ bÃªn trÃ¡i vÃ  cÃ¢u há»i vÃ  ngá»¯ cáº£nh Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i. Äiá»u chá»‰nh táº¥t cáº£ mÃ£ chÃºng ta vá»«a tháº¥y vá»›i kiáº¿n trÃºc XLNet (vÃ  thÃªm <code>padding=True</code>). LÆ°u Ã½ ráº±ng token <code>[CLS]</code> cÃ³ thá»ƒ khÃ´ng á»Ÿ vá»‹ trÃ­ 0 khi Ã¡p dá»¥ng pháº§n Ä‘á»‡m.</p></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ tháº¥y tá»«ng bÆ°á»›c cÃ¡ch tiá»n xá»­ lÃ½ dá»¯ liá»‡u huáº¥n luyá»‡n cá»§a mÃ¬nh, chÃºng ta cÃ³ thá»ƒ nhÃ³m nÃ³ trong má»™t hÃ m mÃ  chÃºng ta sáº½ Ã¡p dá»¥ng trÃªn toÃ n bá»™ táº­p dá»¯ liá»‡u huáº¥n luyá»‡n. ChÃºng ta sáº½ Ä‘á»‡m má»i Ä‘áº·c trÆ°ng Ä‘áº¿n Ä‘á»™ dÃ i tá»‘i Ä‘a mÃ  chÃºng ta Ä‘Ã£ Ä‘áº·t, vÃ¬ háº§u háº¿t cÃ¡c ngá»¯ cáº£nh sáº½ dÃ i (vÃ  cÃ¡c máº«u tÆ°Æ¡ng á»©ng sáº½ Ä‘Æ°á»£c chia thÃ nh nhiá»u Ä‘áº·c trÆ°ng), vÃ¬ váº­y khÃ´ng cÃ³ lá»£i Ã­ch thá»±c sá»± nÃ o khi Ã¡p dá»¥ng Ä‘á»‡m Ä‘á»™ng á»Ÿ Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->max_length = <span class="hljs-number">384</span>
stride = <span class="hljs-number">128</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_training_examples</span>(<span class="hljs-params">examples</span>):
    questions = [q.strip() <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> examples[<span class="hljs-string">&quot;question&quot;</span>]]
    inputs = tokenizer(
        questions,
        examples[<span class="hljs-string">&quot;context&quot;</span>],
        max_length=max_length,
        truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
        stride=stride,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
        return_offsets_mapping=<span class="hljs-literal">True</span>,
        padding=<span class="hljs-string">&quot;max_length&quot;</span>,
    )

    offset_mapping = inputs.pop(<span class="hljs-string">&quot;offset_mapping&quot;</span>)
    sample_map = inputs.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    answers = examples[<span class="hljs-string">&quot;answers&quot;</span>]
    start_positions = []
    end_positions = []

    <span class="hljs-keyword">for</span> i, offset <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(offset_mapping):
        sample_idx = sample_map[i]
        answer = answers[sample_idx]
        start_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>]
        end_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>] + <span class="hljs-built_in">len</span>(answer[<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>])
        sequence_ids = inputs.sequence_ids(i)

        <span class="hljs-comment"># TÃ¬m Ä‘iá»ƒm báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a ngá»¯ cáº£nh</span>
        idx = <span class="hljs-number">0</span>
        <span class="hljs-keyword">while</span> sequence_ids[idx] != <span class="hljs-number">1</span>:
            idx += <span class="hljs-number">1</span>
        context_start = idx
        <span class="hljs-keyword">while</span> sequence_ids[idx] == <span class="hljs-number">1</span>:
            idx += <span class="hljs-number">1</span>
        context_end = idx - <span class="hljs-number">1</span>

        <span class="hljs-comment"># Náº¿u cÃ¢u tráº£ lá»i khÃ´ng hoÃ n toÃ n náº±m trong ngá»¯ cáº£nh, nhÃ£n lÃ  (0, 0)</span>
        <span class="hljs-keyword">if</span> offset[context_start][<span class="hljs-number">0</span>] &gt; start_char <span class="hljs-keyword">or</span> offset[context_end][<span class="hljs-number">1</span>] &lt; end_char:
            start_positions.append(<span class="hljs-number">0</span>)
            end_positions.append(<span class="hljs-number">0</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Náº¿u khÃ´ng nÃ³ sáº½ lÃ  vá»‹ trÃ­ token báº¯t Ä‘áº§u vÃ  káº¿t thÃºc</span>
            idx = context_start
            <span class="hljs-keyword">while</span> idx &lt;= context_end <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">0</span>] &lt;= start_char:
                idx += <span class="hljs-number">1</span>
            start_positions.append(idx - <span class="hljs-number">1</span>)

            idx = context_end
            <span class="hljs-keyword">while</span> idx &gt;= context_start <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">1</span>] &gt;= end_char:
                idx -= <span class="hljs-number">1</span>
            end_positions.append(idx + <span class="hljs-number">1</span>)

    inputs[<span class="hljs-string">&quot;start_positions&quot;</span>] = start_positions
    inputs[<span class="hljs-string">&quot;end_positions&quot;</span>] = end_positions
    <span class="hljs-keyword">return</span> inputs<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh hai háº±ng sá»‘ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘á»™ dÃ i tá»‘i Ä‘a Ä‘Æ°á»£c sá»­ dá»¥ng cÅ©ng nhÆ° Ä‘á»™ dÃ i cá»§a cá»­a sá»• trÆ°á»£t vÃ  ta Ä‘Ã£ thÃªm má»™t chÃºt dá»n dáº¹p trÆ°á»›c khi tokenize: má»™t sá»‘ cÃ¢u há»i trong táº­p dá»¯ liá»‡u SQuAD cÃ³ thÃªm khoáº£ng tráº¯ng á»Ÿ Ä‘áº§u vÃ  káº¿t thÃºc mÃ  khÃ´ng thÃªm báº¥t ká»³ thá»© gÃ¬ (vÃ  chiáº¿m dung lÆ°á»£ng khi Ä‘Æ°á»£c tokenize náº¿u báº¡n sá»­ dá»¥ng mÃ´ hÃ¬nh nhÆ° RoBERTa), vÃ¬ váº­y ta Ä‘Ã£ xÃ³a nhá»¯ng khoáº£ng tráº¯ng thá»«a Ä‘Ã³.</p>
<p>Äá»ƒ Ã¡p dá»¥ng hÃ m nÃ y cho toÃ n bá»™ táº­p huáº¥n luyá»‡n, chÃºng ta sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>Dataset.map()</code> vá»›i <code>batched=True</code>. Äiá»u nÃ y cáº§n thiáº¿t á»Ÿ Ä‘Ã¢y vÃ¬ ta Ä‘ang thay Ä‘á»•i Ä‘á»™ dÃ i cá»§a táº­p dá»¯ liá»‡u (vÃ¬ má»™t máº«u cÃ³ thá»ƒ cung cáº¥p má»™t sá»‘ Ä‘áº·c trÆ°ng huáº¥n luyá»‡n):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->train_dataset = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].<span class="hljs-built_in">map</span>(
    preprocess_training_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].column_names,
)
<span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-built_in">len</span>(train_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">87599</span>, <span class="hljs-number">88729</span>)<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° ta cÃ³ thá»ƒ tháº¥y, quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ Ä‘Ã£ thÃªm khoáº£ng 1,000 Ä‘áº·c trÆ°ng. Bá»™ huáº¥n luyá»‡n hiá»‡n Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ sá»­ dá»¥ng - hÃ£y cÃ¹ng tÃ¬m hiá»ƒu vá» quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ cá»§a bá»™ kiá»ƒm Ä‘á»‹nh!</p>
<h3 class="relative group"><a id="x-l-d-liu-kim-nh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#x-l-d-liu-kim-nh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xá»­ lÃ½ dá»¯ liá»‡u kiá»ƒm Ä‘á»‹nh
	</span></h3>

<p>Viá»‡c xá»­ lÃ½ trÆ°á»›c dá»¯ liá»‡u kiá»ƒm Ä‘á»‹nh sáº½ dá»… dÃ ng hÆ¡n má»™t chÃºt vÃ¬ chÃºng ta khÃ´ng cáº§n táº¡o nhÃ£n (trá»« khi chÃºng ta muá»‘n tÃ­nh toÃ¡n máº¥t mÃ¡t kiá»ƒm Ä‘á»‹nh, nhÆ°ng con sá»‘ Ä‘Ã³ sáº½ khÃ´ng thá»±c sá»± giÃºp chÃºng ta hiá»ƒu mÃ´ hÃ¬nh tá»‘t nhÆ° tháº¿ nÃ o). Niá»m vui thá»±c sá»± sáº½ lÃ  diá»…n giáº£i cÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh thÃ nh cÃ¡c khoáº£ng cá»§a bá»‘i cáº£nh ban Ä‘áº§u. Äá»‘i vá»›i Ä‘iá»u nÃ y, chÃºng ta sáº½ chá»‰ cáº§n lÆ°u trá»¯ cáº£ Ã¡nh xáº¡ offset vÃ  má»™t sá»‘ cÃ¡ch Ä‘á»ƒ khá»›p tá»«ng Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ táº¡o vá»›i vÃ­ dá»¥ ban Ä‘áº§u mÃ  nÃ³ xuáº¥t phÃ¡t. VÃ¬ cÃ³ má»™t cá»™t ID trong táº­p dá»¯ liá»‡u gá»‘c, chÃºng ta sáº½ sá»­ dá»¥ng ID Ä‘Ã³.</p>
<p>Äiá»u duy nháº¥t chÃºng ta sáº½ thÃªm á»Ÿ Ä‘Ã¢y lÃ  má»™t chÃºt dá»n dáº¹p cÃ¡c Ã¡nh xáº¡ offset. ChÃºng sáº½ chá»©a cÃ¡c pháº§n bÃ¹ cho cÃ¢u há»i vÃ  ngá»¯ cáº£nh, nhÆ°ng khi chÃºng ta Ä‘ang á»Ÿ giai Ä‘oáº¡n háº­u xá»­ lÃ½, chÃºng ta sáº½ khÃ´ng cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ biáº¿t pháº§n nÃ o cá»§a ID Ä‘áº§u vÃ o tÆ°Æ¡ng á»©ng vá»›i ngá»¯ cáº£nh vÃ  pháº§n nÃ o lÃ  cÃ¢u há»i (phÆ°Æ¡ng thá»©c <code>sequence_ids()</code> ta Ä‘Ã£ sá»­ dá»¥ng chá»‰ cÃ³ sáºµn cho Ä‘áº§u ra cá»§a tokenizer). VÃ¬ váº­y, chÃºng ta sáº½ Ä‘áº·t cÃ¡c offset tÆ°Æ¡ng á»©ng vá»›i cÃ¢u há»i thÃ nh <code>None</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_validation_examples</span>(<span class="hljs-params">examples</span>):
    questions = [q.strip() <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> examples[<span class="hljs-string">&quot;question&quot;</span>]]
    inputs = tokenizer(
        questions,
        examples[<span class="hljs-string">&quot;context&quot;</span>],
        max_length=max_length,
        truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
        stride=stride,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
        return_offsets_mapping=<span class="hljs-literal">True</span>,
        padding=<span class="hljs-string">&quot;max_length&quot;</span>,
    )

    sample_map = inputs.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    example_ids = []

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])):
        sample_idx = sample_map[i]
        example_ids.append(examples[<span class="hljs-string">&quot;id&quot;</span>][sample_idx])

        sequence_ids = inputs.sequence_ids(i)
        offset = inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>][i]
        inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>][i] = [
            o <span class="hljs-keyword">if</span> sequence_ids[k] == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> k, o <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(offset)
        ]

    inputs[<span class="hljs-string">&quot;example_id&quot;</span>] = example_ids
    <span class="hljs-keyword">return</span> inputs<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng hÃ m nÃ y trÃªn toÃ n bá»™ táº­p dá»¯ liá»‡u kiá»ƒm Ä‘á»‹nh nhÆ° trÆ°á»›c Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->validation_dataset = raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].<span class="hljs-built_in">map</span>(
    preprocess_validation_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].column_names,
)
<span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>]), <span class="hljs-built_in">len</span>(validation_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">10570</span>, <span class="hljs-number">10822</span>)<!-- HTML_TAG_END --></pre></div>
<p>Trong trÆ°á»ng há»£p nÃ y, chÃºng ta chá»‰ thÃªm má»™t vÃ i trÄƒm máº«u, vÃ¬ váº­y cÃ³ váº» nhÆ° cÃ¡c ngá»¯ cáº£nh trong táº­p dá»¯ liá»‡u kiá»ƒm Ä‘á»‹nh ngáº¯n hÆ¡n má»™t chÃºt.</p>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ tiá»n xá»­ lÃ½ táº¥t cáº£ dá»¯ liá»‡u, chÃºng ta cÃ³ thá»ƒ tham gia khÃ³a huáº¥n luyá»‡n.</p>
<h2 class="relative group"><a id="tinh-chnh-m-hn-vi-api-trainer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-m-hn-vi-api-trainer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mÃ´ hÃ¬n vá»›i API <code>Trainer</code></span></h2>

<p>Äoáº¡n mÃ£ huáº¥n luyá»‡n cho máº«u nÃ y sáº½ trÃ´ng ráº¥t giá»‘ng trong cÃ¡c pháº§n trÆ°á»›c - Ä‘iá»u khÃ³ nháº¥t sáº½ lÃ  viáº¿t hÃ m <code>compute_metrics()</code>. VÃ¬ chÃºng ta Ä‘Ã£ Ä‘á»‡m táº¥t cáº£ cÃ¡c máº«u Ä‘áº¿n Ä‘á»™ dÃ i tá»‘i Ä‘a mÃ  ta Ä‘áº·t, khÃ´ng cÃ³ cÃ´ng cá»¥ Ä‘á»‘i chiáº¿u dá»¯ liá»‡u Ä‘á»ƒ xÃ¡c Ä‘á»‹nh, vÃ¬ váº­y viá»‡c tÃ­nh toÃ¡n sá»‘ liá»‡u nÃ y thá»±c sá»± lÃ  Ä‘iá»u duy nháº¥t chÃºng ta pháº£i lo láº¯ng. Pháº§n khÃ³ khÄƒn sáº½ lÃ  háº­u xá»­ lÃ½ cÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh thÃ nh cÃ¡c khoáº£ng vÄƒn báº£n trong cÃ¡c vÃ­ dá»¥ ban Ä‘áº§u; khi ta Ä‘Ã£ lÃ m Ä‘iá»u Ä‘Ã³, chá»‰ sá»‘ tá»« thÆ° viá»‡n ğŸ¤— Datasets sáº½ thá»±c hiá»‡n háº§u háº¿t cÃ´ng viá»‡c cho mÃ¬nh.</p>
<h3 class="relative group"><a id="hu-x-l" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hu-x-l"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Háº­u xá»­ lÃ½
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/BNy08iIWVJM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>MÃ´ hÃ¬nh sáº½ tráº£ vá» cÃ¡c logit Ä‘áº§u ra cho cÃ¡c vá»‹ trÃ­ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a cÃ¢u tráº£ lá»i trong ID Ä‘áº§u vÃ o, nhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong quÃ¡ trÃ¬nh khÃ¡m phÃ¡ pipeline <a href="/course/chapter6/3b"><code>question-answering</code></a>. BÆ°á»›c tiá»n xá»­ lÃ½ sáº½ tÆ°Æ¡ng tá»± nhÆ° nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ lÃ m á»Ÿ Ä‘Ã³, vÃ¬ váº­y Ä‘Ã¢y lÃ  lá»i nháº¯c nhanh vá» cÃ¡c bÆ°á»›c chÃºng ta Ä‘Ã£ thá»±c hiá»‡n:</p>
<ul><li>ChÃºng ta Ä‘Ã£ che cÃ¡c logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc tÆ°Æ¡ng á»©ng vá»›i cÃ¡c token bÃªn ngoÃ i ngá»¯ cáº£nh.</li>
<li>Sau Ä‘Ã³, chÃºng ta chuyá»ƒn Ä‘á»•i cÃ¡c logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc thÃ nh xÃ¡c suáº¥t báº±ng cÃ¡ch sá»­ dá»¥ng softmax.</li>
<li>ChÃºng ta quy Ä‘iá»ƒm cho tá»«ng cáº·p <code>(start_token, end_token)</code> cÃ¡ch láº¥y tÃ­ch cá»§a hai xÃ¡c suáº¥t tÆ°Æ¡ng á»©ng.</li>
<li>ChÃºng ta Ä‘Ã£ tÃ¬m kiáº¿m cáº·p cÃ³ Ä‘iá»ƒm tá»‘i Ä‘a mang láº¡i cÃ¢u tráº£ lá»i há»£p lá»‡ (vÃ­ dá»¥: <code>start_token</code> tháº¥p hÆ¡n <code>end_token</code>).</li></ul>
<p>á» Ä‘Ã¢y, chÃºng ta sáº½ thay Ä‘á»•i quy trÃ¬nh nÃ y má»™t chÃºt vÃ¬ chÃºng ta khÃ´ng cáº§n tÃ­nh Ä‘iá»ƒm thá»±c táº¿ (chá»‰ lÃ  cÃ¢u tráº£ lá»i dá»± Ä‘oÃ¡n). Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ thá»ƒ bá» qua bÆ°á»›c softmax. Äá»ƒ Ä‘i nhanh hÆ¡n, chÃºng ta cÅ©ng sáº½ khÃ´ng tÃ­nh Ä‘iá»ƒm táº¥t cáº£ cÃ¡c cáº·p <code>(start_token, end_token)</code> cÃ³ thá»ƒ, mÃ  chá»‰ nhá»¯ng cáº·p tÆ°Æ¡ng á»©ng vá»›i logit <code>n_best</code> cao nháº¥t (vá»›i <code>n_best = 20</code>). VÃ¬ chÃºng ta sáº½ bá» qua softmax, nhá»¯ng Ä‘iá»ƒm Ä‘Ã³ sáº½ lÃ  Ä‘iá»ƒm logit vÃ  sáº½ cÃ³ Ä‘Æ°á»£c báº±ng cÃ¡ch láº¥y tá»•ng cá»§a logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc (thay vÃ¬ nhÃ¢n, vÃ¬ quy táº¯c (\log(ab) = \log(a) + \log(b)\)).</p>
<p>Äá»ƒ chá»©ng minh táº¥t cáº£ nhá»¯ng Ä‘iá»u nÃ y, chÃºng ta sáº½ cáº§n má»™t sá»‘ loáº¡i dá»± Ä‘oÃ¡n. VÃ¬ chÃºng ta chÆ°a huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a mÃ¬nh, chÃºng ta sáº½ sá»­ dá»¥ng mÃ´ hÃ¬nh máº·c Ä‘á»‹nh cho pipeline QA Ä‘á»ƒ táº¡o ra má»™t sá»‘ dá»± Ä‘oÃ¡n trÃªn má»™t pháº§n nhá» cá»§a táº­p há»£p kiá»ƒm. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng xá»­ lÃ½ tÆ°Æ¡ng tá»± nhÆ° trÆ°á»›c Ä‘Ã¢y; bá»Ÿi vÃ¬ nÃ³ dá»±a vÃ o háº±ng sá»‘ toÃ n cá»¥c <code>tokenizer</code>, chÃºng ta chá»‰ cáº§n thay Ä‘á»•i Ä‘á»‘i tÆ°á»£ng Ä‘Ã³ thÃ nh tokenizer cá»§a mÃ´ hÃ¬nh mÃ  chÃºng ta muá»‘n sá»­ dá»¥ng táº¡m thá»i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->small_eval_set = raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].select(<span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>))
trained_checkpoint = <span class="hljs-string">&quot;distilbert-base-cased-distilled-squad&quot;</span>

tokenizer = AutoTokenizer.from_pretrained(trained_checkpoint)
eval_set = small_eval_set.<span class="hljs-built_in">map</span>(
    preprocess_validation_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].column_names,
)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá», quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ Ä‘Ã£ hoÃ n táº¥t, chÃºng ta thay Ä‘á»•i tokenizer trá»Ÿ láº¡i cÃ¡i mÃ  chÃºng ta Ä‘Ã£ chá»n ban Ä‘áº§u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta loáº¡i bá» cÃ¡c cá»™t cá»§a <code>eval_set</code> mÃ  mÃ´ hÃ¬nh khÃ´ng mong Ä‘á»£i, xÃ¢y dá»±ng má»™t lÃ´ vá»›i táº¥t cáº£ bá»™ kiá»ƒm Ä‘á»‹nh nhá» Ä‘Ã³ vÃ  chuyá»ƒn nÃ³ qua mÃ´ hÃ¬nh. Náº¿u cÃ³ sáºµn GPU, chÃºng ta sá»­ dá»¥ng nÃ³ Ä‘á»ƒ cháº¡y nhanh hÆ¡n:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForQuestionAnswering

eval_set_for_model = eval_set.remove_columns([<span class="hljs-string">&quot;example_id&quot;</span>, <span class="hljs-string">&quot;offset_mapping&quot;</span>])
eval_set_for_model.set_format(<span class="hljs-string">&quot;torch&quot;</span>)

device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span>) <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> torch.device(<span class="hljs-string">&quot;cpu&quot;</span>)
batch = {k: eval_set_for_model[k].to(device) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> eval_set_for_model.column_names}
trained_model = AutoModelForQuestionAnswering.from_pretrained(trained_checkpoint).to(
    device
)

<span class="hljs-keyword">with</span> torch.no_grad():
    outputs = trained_model(**batch)<!-- HTML_TAG_END --></pre></div>
<p>VÃ¬ <code>Trainer</code> sáº½ tráº£ cho ta cÃ¡c dá»± Ä‘oÃ¡n dÆ°á»›i dáº¡ng máº£ng NumPy, ta sáº½ láº¥y cÃ¡c logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc vÃ  chuyá»ƒn nÃ³ thÃ nh dáº¡ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->start_logits = outputs.start_logits.cpu().numpy()
end_logits = outputs.end_logits.cpu().numpy()<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá», chÃºng ta cáº§n tÃ¬m cÃ¢u tráº£ lá»i dá»± Ä‘oÃ¡n cho tá»«ng vÃ­ dá»¥ trong <code>small_eval_set</code> cá»§a chÃºng ta. Má»™t vÃ­ dá»¥ cÃ³ thá»ƒ Ä‘Ã£ Ä‘Æ°á»£c chia thÃ nh nhiá»u Ä‘áº·c trÆ°ng trong <code>eval_set</code>, vÃ¬ váº­y bÆ°á»›c Ä‘áº§u tiÃªn lÃ  Ã¡nh xáº¡ tá»«ng máº«u trong <code>small_eval_set</code> vá»›i cÃ¡c Ä‘áº·c trÆ°ng tÆ°Æ¡ng á»©ng trong <code>eval_set</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> collections

example_to_features = collections.defaultdict(<span class="hljs-built_in">list</span>)
<span class="hljs-keyword">for</span> idx, feature <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(eval_set):
    example_to_features[feature[<span class="hljs-string">&quot;example_id&quot;</span>]].append(idx)<!-- HTML_TAG_END --></pre></div>
<p>Vá»›i Ä‘iá»u nÃ y trong tay, chÃºng ta thá»±c sá»± cÃ³ thá»ƒ báº¯t Ä‘áº§u lÃ m viá»‡c báº±ng cÃ¡ch láº·p láº¡i táº¥t cáº£ cÃ¡c máº«u vÃ , Ä‘á»‘i vá»›i má»—i máº«u, thÃ´ng qua táº¥t cáº£ cÃ¡c Ä‘áº·c trÆ°ng liÃªn quan. NhÆ° chÃºng ta Ä‘Ã£ nÃ³i trÆ°á»›c Ä‘Ã¢y, chÃºng ta sáº½ xem xÃ©t Ä‘iá»ƒm logit cho cÃ¡c logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a <code>n_best</code>, ngoáº¡i trá»« cÃ¡c vá»‹ trÃ­ cung cáº¥p:</p>
<ul><li>Má»™t cÃ¢u tráº£ lá»i sáº½ khÃ´ng náº±m trong ngá»¯ cáº£nh</li>
<li>Má»™t cÃ¢u tráº£ lá»i cÃ³ Ä‘á»™ dÃ i Ã¢m</li>
<li>Má»™t cÃ¢u tráº£ lá»i quÃ¡ dÃ i (chÃºng ta giá»›i háº¡n kháº£ nÄƒng á»Ÿ má»©c <code>max_answer_length=30</code>)</li></ul>
<p>Khi chÃºng ta cÃ³ táº¥t cáº£ cÃ¡c cÃ¢u tráº£ lá»i cÃ³ thá»ƒ Ä‘Æ°á»£c ghi cho má»™t máº«u, ta chá»‰ cáº§n chá»n má»™t cÃ¢u cÃ³ Ä‘iá»ƒm logit tá»‘t nháº¥t:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

n_best = <span class="hljs-number">20</span>
max_answer_length = <span class="hljs-number">30</span>
predicted_answers = []

<span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> small_eval_set:
    example_id = example[<span class="hljs-string">&quot;id&quot;</span>]
    context = example[<span class="hljs-string">&quot;context&quot;</span>]
    answers = []

    <span class="hljs-keyword">for</span> feature_index <span class="hljs-keyword">in</span> example_to_features[example_id]:
        start_logit = start_logits[feature_index]
        end_logit = end_logits[feature_index]
        offsets = eval_set[<span class="hljs-string">&quot;offset_mapping&quot;</span>][feature_index]

        start_indexes = np.argsort(start_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
        end_indexes = np.argsort(end_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
        <span class="hljs-keyword">for</span> start_index <span class="hljs-keyword">in</span> start_indexes:
            <span class="hljs-keyword">for</span> end_index <span class="hljs-keyword">in</span> end_indexes:
                <span class="hljs-comment"># Bá» qua cÃ¡c cÃ¢u tráº£ lá»i khÃ´ng Ä‘áº§u Ä‘á»§ trong ngá»¯ cáº£nh</span>
                <span class="hljs-keyword">if</span> offsets[start_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> offsets[end_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                    <span class="hljs-keyword">continue</span>
                <span class="hljs-comment"># Bá» qua nhá»¯ng cÃ¢u tráº£ lá»i cÃ³ Ä‘á»™ dÃ i &lt; 0 hoáº·c &gt; max_answer_length.</span>
                <span class="hljs-keyword">if</span> (
                    end_index &lt; start_index
                    <span class="hljs-keyword">or</span> end_index - start_index + <span class="hljs-number">1</span> &gt; max_answer_length
                ):
                    <span class="hljs-keyword">continue</span>

                answers.append(
                    {
                        <span class="hljs-string">&quot;text&quot;</span>: context[offsets[start_index][<span class="hljs-number">0</span>] : offsets[end_index][<span class="hljs-number">1</span>]],
                        <span class="hljs-string">&quot;logit_score&quot;</span>: start_logit[start_index] + end_logit[end_index],
                    }
                )

    best_answer = <span class="hljs-built_in">max</span>(answers, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;logit_score&quot;</span>])
    predicted_answers.append({<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: best_answer[<span class="hljs-string">&quot;text&quot;</span>]})<!-- HTML_TAG_END --></pre></div>
<p>Äá»‹nh dáº¡ng cuá»‘i cÃ¹ng cá»§a cÃ¡c cÃ¢u tráº£ lá»i Ä‘Æ°á»£c dá»± Ä‘oÃ¡n lÃ  Ä‘á»‹nh dáº¡ng sáº½ Ä‘Æ°á»£c dá»± Ä‘oÃ¡n theo chá»‰ sá»‘ mÃ  chÃºng ta sáº½ sá»­ dá»¥ng. NhÆ° thÆ°á»ng lá»‡, chÃºng ta cÃ³ thá»ƒ táº£i nÃ³ vá»›i sá»± trá»£ giÃºp cá»§a thÆ° viá»‡n ğŸ¤— Evaluate:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

metric = evaluate.load(<span class="hljs-string">&quot;squad&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ThÆ°á»›c Ä‘o nÃ y mong Ä‘á»£i cÃ¡c cÃ¢u tráº£ lá»i Ä‘Æ°á»£c dá»± Ä‘oÃ¡n á»Ÿ Ä‘á»‹nh dáº¡ng mÃ  chÃºng ta Ä‘Ã£ tháº¥y á»Ÿ trÃªn (danh sÃ¡ch cÃ¡c tá»« Ä‘iá»ƒn cÃ³ má»™t khÃ³a cho ID cá»§a máº«u vÃ  má»™t khÃ³a cho vÄƒn báº£n Ä‘Æ°á»£c dá»± Ä‘oÃ¡n) vÃ  cÃ¡c cÃ¢u tráº£ lá»i lÃ½ thuyáº¿t á»Ÿ Ä‘á»‹nh dáº¡ng bÃªn dÆ°á»›i (danh sÃ¡ch cÃ¡c tá»« Ä‘iá»ƒn cÃ³ má»™t khÃ³a cho ID cá»§a máº«u vÃ  má»™t khÃ³a cho cÃ¡c cÃ¢u tráº£ lá»i cÃ³ thá»ƒ cÃ³):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->theoretical_answers = [
    {<span class="hljs-string">&quot;id&quot;</span>: ex[<span class="hljs-string">&quot;id&quot;</span>], <span class="hljs-string">&quot;answers&quot;</span>: ex[<span class="hljs-string">&quot;answers&quot;</span>]} <span class="hljs-keyword">for</span> ex <span class="hljs-keyword">in</span> small_eval_set
]<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ kiá»ƒm tra xem ta cÃ³ nháº­n Ä‘Æ°á»£c káº¿t quáº£ há»£p lÃ½ hay khÃ´ng báº±ng cÃ¡ch xem xÃ©t yáº¿u tá»‘ Ä‘áº§u tiÃªn cá»§a cáº£ hai danh sÃ¡ch:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(predicted_answers[<span class="hljs-number">0</span>])
<span class="hljs-built_in">print</span>(theoretical_answers[<span class="hljs-number">0</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;56be4db0acb8001400a502ec&#x27;</span>, <span class="hljs-string">&#x27;prediction_text&#x27;</span>: <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>}
{<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;56be4db0acb8001400a502ec&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>: {<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">177</span>, <span class="hljs-number">177</span>, <span class="hljs-number">177</span>]}}<!-- HTML_TAG_END --></pre></div>
<p>KhÃ´ng tá»‡ láº¯m! BÃ¢y giá» chÃºng ta hÃ£y xem xÃ©t Ä‘iá»ƒm sá»‘ mÃ  sá»‘ liá»‡u mang láº¡i cho chÃºng ta:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->metric.compute(predictions=predicted_answers, references=theoretical_answers)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">83.0</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.25</span>}<!-- HTML_TAG_END --></pre></div>
<p>Má»™t láº§n ná»¯a, Ä‘iá»u Ä‘Ã³ khÃ¡ tá»‘t theo <a href="https://arxiv.org/abs/1910.01108v2" rel="nofollow">bÃ i bÃ¡o cá»§a nÃ³</a>, DistilBERT Ä‘Æ°á»£c tinh chá»‰nh trÃªn SQuAD thu Ä‘Æ°á»£c 79.1 vÃ  86.9 trÃªn toÃ n bá»™ táº­p dá»¯ liá»‡u.</p>
<p>BÃ¢y giá» chÃºng ta hÃ£y Ä‘áº·t má»i thá»© ta vá»«a lÃ m trong má»™t hÃ m <code>compute_metrics()</code> mÃ  ta sáº½ sá»­ dá»¥ng trong <code>Trainer</code>. ThÃ´ng thÆ°á»ng, hÃ m <code>compute_metrics()</code> Ä‘Ã³ chá»‰ nháº­n Ä‘Æ°á»£c má»™t tuple <code>eval_preds</code> vá»›i cÃ¡c logit vÃ  nhÃ£n. á» Ä‘Ã¢y chÃºng ta sáº½ cáº§n nhiá»u hÆ¡n má»™t chÃºt, vÃ¬ chÃºng ta pháº£i tÃ¬m trong táº­p dá»¯ liá»‡u cÃ¡c Ä‘áº·c trÆ°ng cho pháº§n bÃ¹ vÃ  trong táº­p dá»¯ liá»‡u cÃ¡c vÃ­ dá»¥ cho cÃ¡c ngá»¯ cáº£nh ban Ä‘áº§u, vÃ¬ váº­y chÃºng ta sáº½ khÃ´ng thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng nÃ y Ä‘á»ƒ nháº­n káº¿t quáº£ Ä‘Ã¡nh giÃ¡ thÆ°á»ng xuyÃªn trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. ChÃºng ta sáº½ chá»‰ sá»­ dá»¥ng nÃ³ khi káº¿t thÃºc khÃ³a huáº¥nl luyá»‡n Ä‘á»ƒ kiá»ƒm tra káº¿t quáº£.</p>
<p>HÃ m <code>compute_metrics()</code> nhÃ³m cÃ¡c bÆ°á»›c giá»‘ng nhÆ° trÆ°á»›c; chÃºng ta chá»‰ thÃªm má»™t kiá»ƒm tra nhá» trong trÆ°á»ng há»£p ta khÃ´ng Ä‘Æ°a ra báº¥t ká»³ cÃ¢u tráº£ lá»i há»£p lá»‡ nÃ o (trong trÆ°á»ng há»£p Ä‘Ã³ ta dá»± Ä‘oÃ¡n má»™t chuá»—i trá»‘ng).</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">start_logits, end_logits, features, examples</span>):
    example_to_features = collections.defaultdict(<span class="hljs-built_in">list</span>)
    <span class="hljs-keyword">for</span> idx, feature <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(features):
        example_to_features[feature[<span class="hljs-string">&quot;example_id&quot;</span>]].append(idx)

    predicted_answers = []
    <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> tqdm(examples):
        example_id = example[<span class="hljs-string">&quot;id&quot;</span>]
        context = example[<span class="hljs-string">&quot;context&quot;</span>]
        answers = []

        <span class="hljs-comment"># Láº·p qua táº¥t cáº£ cÃ¡c Ä‘áº·c trÆ°ng liÃªn quan tá»›i máº«u Ä‘Ã³</span>
        <span class="hljs-keyword">for</span> feature_index <span class="hljs-keyword">in</span> example_to_features[example_id]:
            start_logit = start_logits[feature_index]
            end_logit = end_logits[feature_index]
            offsets = features[feature_index][<span class="hljs-string">&quot;offset_mapping&quot;</span>]

            start_indexes = np.argsort(start_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
            end_indexes = np.argsort(end_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
            <span class="hljs-keyword">for</span> start_index <span class="hljs-keyword">in</span> start_indexes:
                <span class="hljs-keyword">for</span> end_index <span class="hljs-keyword">in</span> end_indexes:
                    <span class="hljs-comment"># Bá» qua cÃ¢u tráº£ lá»i khÃ´ng xuáº¥t hiá»‡n hoÃ n toÃ n trong ngá»¯ cáº£nh</span>
                    <span class="hljs-keyword">if</span> offsets[start_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> offsets[end_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                        <span class="hljs-keyword">continue</span>
                    <span class="hljs-comment"># Bá» qua nhá»¯ng cÃ¢u tráº£ lá»i vá»›i Ä‘á»™ dÃ i &lt; 0 hoáº·c &gt; max_answer_length</span>
                    <span class="hljs-keyword">if</span> (
                        end_index &lt; start_index
                        <span class="hljs-keyword">or</span> end_index - start_index + <span class="hljs-number">1</span> &gt; max_answer_length
                    ):
                        <span class="hljs-keyword">continue</span>

                    answer = {
                        <span class="hljs-string">&quot;text&quot;</span>: context[offsets[start_index][<span class="hljs-number">0</span>] : offsets[end_index][<span class="hljs-number">1</span>]],
                        <span class="hljs-string">&quot;logit_score&quot;</span>: start_logit[start_index] + end_logit[end_index],
                    }
                    answers.append(answer)

        <span class="hljs-comment"># Chá»n cÃ¢u tráº£ lá»i cÃ³ Ä‘iá»ƒm cao nháº¥t</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(answers) &gt; <span class="hljs-number">0</span>:
            best_answer = <span class="hljs-built_in">max</span>(answers, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;logit_score&quot;</span>])
            predicted_answers.append(
                {<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: best_answer[<span class="hljs-string">&quot;text&quot;</span>]}
            )
        <span class="hljs-keyword">else</span>:
            predicted_answers.append({<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: <span class="hljs-string">&quot;&quot;</span>})

    theoretical_answers = [{<span class="hljs-string">&quot;id&quot;</span>: ex[<span class="hljs-string">&quot;id&quot;</span>], <span class="hljs-string">&quot;answers&quot;</span>: ex[<span class="hljs-string">&quot;answers&quot;</span>]} <span class="hljs-keyword">for</span> ex <span class="hljs-keyword">in</span> examples]
    <span class="hljs-keyword">return</span> metric.compute(predictions=predicted_answers, references=theoretical_answers)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ kiá»ƒm tra nÃ³ hoáº¡t Ä‘á»™ng dá»±a trÃªn dá»± Ä‘oÃ¡n cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->compute_metrics(start_logits, end_logits, eval_set, small_eval_set)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">83.0</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.25</span>}<!-- HTML_TAG_END --></pre></div>
<p>TrÃ´ng khÃ¡ á»•n! BÃ¢y giá» chÃºng ta hÃ£y sá»­ dá»¥ng Ä‘iá»u nÃ y Ä‘á»ƒ tinh chá»‰nh mÃ´ hÃ¬nh cá»§a mÃ¬nh.</p>
<h3 class="relative group"><a id="tinh-chnh-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh mÃ´ hÃ¬nh
	</span></h3>

<p>Giá» ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh cá»§a mÃ¬nh. HÃ£y cÅ©ng táº¡o ra nÃ³ sá»­ dá»¥ng lá»›p <code>AutoModelForQuestionAnswering</code> nhÆ° trÆ°á»›c Ä‘Ã³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForQuestionAnswering.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° thÆ°á»ng lá»‡, chÃºng ta nháº­n Ä‘Æ°á»£c cáº£nh bÃ¡o ráº±ng má»™t sá»‘ trá»ng sá»‘ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng (cÃ¡c trá»ng sá»‘ tá»« pháº§n Ä‘áº§u huáº¥n luyá»‡n trÆ°á»›c) vÃ  má»™t sá»‘ trá»ng sá»‘ khÃ¡c Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn (cÃ¡c trá»ng sá»‘ cho Ä‘áº§u tráº£ lá»i cÃ¢u há»i). BÃ¢y giá» báº¡n nÃªn quen vá»›i Ä‘iá»u nÃ y, nhÆ°ng Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  mÃ´ hÃ¬nh nÃ y chÆ°a sáºµn sÃ ng Ä‘á»ƒ sá»­ dá»¥ng vÃ  cáº§n Ä‘Æ°á»£c tinh chá»‰nh - Ä‘iá»u tá»‘t lÃ  chÃºng ta sáº¯p lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³!</p>
<p>Äá»ƒ cÃ³ thá»ƒ Ä‘áº©y mÃ´ hÃ¬nh cá»§a mÃ¬nh lÃªn Hub, chÃºng ta cáº§n Ä‘Äƒng nháº­p vÃ o Hugging Face. Náº¿u báº¡n Ä‘ang cháº¡y Ä‘oáº¡n mÃ£ nÃ y trong notebook, báº¡n cÃ³ thá»ƒ lÃ m nhÆ° váº­y vá»›i hÃ m tiá»‡n Ã­ch sau, hÃ m nÃ y sáº½ hiá»ƒn thá»‹ má»™t tiá»‡n Ã­ch mÃ  báº¡n cÃ³ thá»ƒ nháº­p thÃ´ng tin Ä‘Äƒng nháº­p cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>Náº¿u báº¡n khÃ´ng lÃ m viá»‡c trong notebook, chá»‰ cáº§n nháº­p dÃ²ng sau vÃ o thiáº¿t bá»‹ Ä‘áº§u cuá»‘i cá»§a báº¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-cli login<!-- HTML_TAG_END --></pre></div>
<p>Khi Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n, chÃºng ta cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh <code>TrainingArguments</code> cá»§a mÃ¬nh. NhÆ° ta Ä‘Ã£ nÃ³i khi xÃ¡c Ä‘á»‹nh chá»©c nÄƒng cá»§a mÃ¬nh Ä‘á»ƒ tÃ­nh toÃ¡n cÃ¡c chá»‰ sá»‘, chÃºng ta sáº½ khÃ´ng thá»ƒ cÃ³ vÃ²ng láº·p Ä‘Ã¡nh giÃ¡ thÆ°á»ng xuyÃªn vÃ¬ Ä‘áº·c trÆ°ng cá»§a hÃ m <code>compute_metrics()</code>. ChÃºng ta cÃ³ thá»ƒ viáº¿t lá»›p con cá»§a riÃªng mÃ¬nh vá» <code>Trainer</code> Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y (má»™t cÃ¡ch tiáº¿p cáº­n báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y trong <a href="https://github.com/huggingface/transformers/blob/master/examples/pytorch/question-answering/trainer_qa.py" rel="nofollow">bá»™ lá»‡nh máº«u cho há»i Ä‘Ã¡p</a>), nhÆ°ng hÆ¡i dÃ i cho pháº§n nÃ y. Thay vÃ o Ä‘Ã³, chÃºng ta sáº½ chá»‰ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh khi káº¿t thÃºc huáº¥n luyá»‡n táº¡i Ä‘Ã¢y vÃ  chá»‰ cho báº¡n cÃ¡ch thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡ thÆ°á»ng xuyÃªn trong â€œVÃ²ng huáº¥n luyá»‡n tÃ¹y chá»‰nhâ€ bÃªn dÆ°á»›i.</p>
<p>ÄÃ¢y thá»±c sá»± lÃ  nÆ¡i API <code>Trainer</code> thá»ƒ hiá»‡n cÃ¡c giá»›i háº¡n cá»§a nÃ³ vÃ  lÃ  lÃºc thÆ° viá»‡n ğŸ¤— Accelerate tá»a sÃ¡ng: viá»‡c tÃ¹y chá»‰nh lá»›p cho má»™t trÆ°á»ng há»£p sá»­ dá»¥ng cá»¥ thá»ƒ cÃ³ thá»ƒ gÃ¢y khÃ³ khÄƒn, nhÆ°ng viá»‡c Ä‘iá»u chá»‰nh má»™t vÃ²ng huáº¥n luyá»‡n Ä‘Æ°á»£c tiáº¿p xÃºc hoÃ n toÃ n ráº¥t dá»… dÃ ng.</p>
<p>ChÃºng ta hÃ£y xem xÃ©t cÃ¡c <code>TrainingArguments</code> cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

args = TrainingArguments(
    <span class="hljs-string">&quot;bert-finetuned-squad&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;no&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
    fp16=<span class="hljs-literal">True</span>,
    push_to_hub=<span class="hljs-literal">True</span>,
)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta Ä‘Ã£ tháº¥y háº§u háº¿t nhá»¯ng Ä‘iá»u nÃ y trÆ°á»›c Ä‘Ã¢y: chÃºng ta Ä‘áº·t má»™t sá»‘ siÃªu tham sá»‘ (nhÆ° tá»‘c Ä‘á»™ há»c, sá»‘ epoch ta dÃ¹ng Ä‘á»ƒ huáº¥n luyá»‡n vÃ  má»™t sá»‘ phÃ¢n rÃ£ trá»ng sá»‘) vÃ  cho biáº¿t ráº±ng chÃºng ta muá»‘n lÆ°u mÃ´ hÃ¬nh vÃ o cuá»‘i má»—i epoch, bá» qua Ä‘Ã¡nh giÃ¡ vÃ  táº£i káº¿t quáº£ cá»§a mÃ¬nh lÃªn Model Hub. ChÃºng ta cÅ©ng cho phÃ©p huáº¥n luyá»‡n chÃ­nh xÃ¡c há»—n há»£p vá»›i <code>fp16 = True</code>, vÃ¬ nÃ³ cÃ³ thá»ƒ tÄƒng tá»‘c huáº¥n luyá»‡n má»™t cÃ¡ch Ä‘á»™c Ä‘Ã¡o trÃªn GPU gáº§n Ä‘Ã¢y.</p>
<p>Máº·c Ä‘á»‹nh, kho lÆ°u trá»¯ Ä‘Æ°á»£c sá»­ dá»¥ng sáº½ náº±m trong khÃ´ng gian tÃªn cá»§a báº¡n vÃ  Ä‘Æ°á»£c Ä‘áº·t tÃªn theo thÆ° má»¥c Ä‘áº§u ra mÃ  báº¡n Ä‘Ã£ Ä‘áº·t, vÃ¬ váº­y trong trÆ°á»ng há»£p cá»§a mÃ¬nh, nÃ³ sáº½ náº±m trong <code>&quot;sgugger/bert-finetuned-squad&quot;</code>. ChÃºng ta cÃ³ thá»ƒ ghi Ä‘Ã¨ Ä‘iá»u nÃ y báº±ng cÃ¡ch chuyá»ƒn má»™t <code>hub_model_id</code>; vÃ­ dá»¥: Ä‘á»ƒ Ä‘áº©y mÃ´ hÃ¬nh vÃ o tá»• chá»©c <code>huggingface_course</code>, chÃºng ta Ä‘Ã£ sá»­ dá»¥ng <code>hub_model_id=&quot;huggingface_course/bert-finetuned-squad&quot;</code> (lÃ  mÃ´ hÃ¬nh mÃ  ta Ä‘Ã£ liÃªn káº¿t á»Ÿ Ä‘áº§u pháº§n nÃ y).</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u thÆ° má»¥c Ä‘áº§u ra báº¡n Ä‘ang sá»­ dá»¥ng tá»“n táº¡i, nÃ³ cáº§n pháº£i lÃ  báº£n sao cá»¥c bá»™ cá»§a kho lÆ°u trá»¯ mÃ  báº¡n muá»‘n Ä‘áº©y Ä‘áº¿n (vÃ¬ váº­y hÃ£y Ä‘áº·t tÃªn má»›i náº¿u báº¡n gáº·p lá»—i khi xÃ¡c Ä‘á»‹nh <code>Trainer</code> cá»§a mÃ¬nh).</p></div>
<p>Cuá»‘i cÃ¹ng, ta chá»‰ cáº§n truyá»n má»i thá»© vÃ o lá»›p <code>Trainer</code> vÃ  khá»Ÿi Ä‘á»™ng viá»‡c huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model=model,
    args=args,
    train_dataset=train_dataset,
    eval_dataset=validation_dataset,
    tokenizer=tokenizer,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>LÆ°u Ã½ ráº±ng trong khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n diá»…n ra, má»—i khi mÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u (á»Ÿ Ä‘Ã¢y, má»—i epoch), nÃ³ sáº½ Ä‘Æ°á»£c táº£i lÃªn Hub á»Ÿ cháº¿ Ä‘á»™ ná»n. Báº±ng cÃ¡ch nÃ y, báº¡n sáº½ cÃ³ thá»ƒ tiáº¿p tá»¥c huáº¥n luyá»‡n cá»§a mÃ¬nh trÃªn má»™t mÃ¡y khÃ¡c náº¿u cáº§n. ToÃ n bá»™ quÃ¡ trÃ¬nh huáº¥n luyá»‡n máº¥t má»™t khoáº£ng thá»i gian (hÆ¡n má»™t giá» trÃªn Titan RTX), vÃ¬ váº­y báº¡n cÃ³ thá»ƒ uá»‘ng má»™t ly cÃ  phÃª hoáº·c Ä‘á»c láº¡i má»™t sá»‘ pháº§n cá»§a khÃ³a há»c mÃ  báº¡n tháº¥y khÃ³ khÄƒn hÆ¡n trong khi tiáº¿p tá»¥c. CÅ©ng lÆ°u Ã½ ráº±ng ngay sau khi epoch Ä‘áº§u tiÃªn káº¿t thÃºc, báº¡n sáº½ tháº¥y má»™t sá»‘ trá»ng sá»‘ Ä‘Æ°á»£c táº£i lÃªn Hub vÃ  báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u chÆ¡i vá»›i mÃ´ hÃ¬nh cá»§a mÃ¬nh trÃªn trang cá»§a nÃ³.</p>
<p>Sau khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n hoÃ n táº¥t, cuá»‘i cÃ¹ng ta cÅ©ng cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh cá»§a mÃ¬nh (vÃ  cáº§u nguyá»‡n ráº±ng ta Ä‘Ã£ khÃ´ng dÃ nh táº¥t cáº£ thá»i gian tÃ­nh toÃ¡n vÃ o viá»‡c gÃ¬). PhÆ°Æ¡ng thá»©c <code>predict()</code> cá»§a <code>Trainer</code> sáº½ tráº£ vá» má»™t bá»™ giÃ¡ trá»‹ trong Ä‘Ã³ cÃ¡c pháº§n tá»­ Ä‘áº§u tiÃªn sáº½ lÃ  cÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh (á»Ÿ Ä‘Ã¢y lÃ  má»™t cáº·p vá»›i cÃ¡c logit báº¯t Ä‘áº§u vÃ  káº¿t thÃºc). ChÃºng ta gá»­i chÃºng Ä‘áº¿n hÃ m <code>compute_metrics())</code> cá»§a mÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions, _, _ = trainer.predict(validation_dataset)
start_logits, end_logits = predictions
compute_metrics(start_logits, end_logits, validation_dataset, raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">81.18259224219489</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.67381321905516</span>}<!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t quÃ¡! Äá»ƒ so sÃ¡nh, Ä‘iá»ƒm cÆ¡ báº£n Ä‘Æ°á»£c bÃ¡o cÃ¡o trong bÃ i bÃ¡o BERT cho mÃ´ hÃ¬nh nÃ y lÃ  80.8 vÃ  88.5, vÃ¬ váº­y chÃºng ta Ä‘ang á»Ÿ Ä‘Ãºng vá»‹ trÃ­ cá»§a mÃ¬nh.</p>
<p>Cuá»‘i cÃ¹ng, ta sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>push_to_hub()</code> Ä‘á»ƒ Ä‘áº£m báº£o ta sáº½ táº£i phiÃªn báº£n má»›i nháº¥t cá»§a mÃ´ hÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub(commit_message=<span class="hljs-string">&quot;Training complete&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u nÃ y tráº£ vá» URL cá»§a cam káº¿t mÃ  nÃ³ vá»«a thá»±c hiá»‡n, náº¿u báº¡n muá»‘n kiá»ƒm tra nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;https://huggingface.co/sgugger/bert-finetuned-squad/commit/9dcee1fbc25946a6ed4bb32efb1bd71d5fa90b68&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p><code>Trainer</code> cÅ©ng soáº¡n tháº£o má»™t tháº» mÃ´ hÃ¬nh vá»›i táº¥t cáº£ cÃ¡c káº¿t quáº£ Ä‘Ã¡nh giÃ¡ vÃ  táº£i nÃ³ lÃªn.</p>
<p>á» giai Ä‘oáº¡n nÃ y, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng tiá»‡n Ã­ch luáº­n suy trÃªn Model Hub Ä‘á»ƒ kiá»ƒm tra mÃ´ hÃ¬nh vÃ  chia sáº» mÃ´ hÃ¬nh Ä‘Ã³ vá»›i báº¡n bÃ¨, gia Ä‘Ã¬nh vÃ  váº­t nuÃ´i yÃªu thÃ­ch cá»§a báº¡n. Báº¡n Ä‘Ã£ tinh chá»‰nh thÃ nh cÃ´ng má»™t mÃ´ hÃ¬nh trong tÃ¡c vá»¥ há»i Ä‘Ã¡p - xin chÃºc má»«ng!</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Äáº¿n lÆ°á»£t báº¡n!</strong> HÃ£y thá»­ má»™t kiáº¿n trÃºc mÃ´ hÃ¬nh khÃ¡c Ä‘á»ƒ xem liá»‡u nÃ³ cÃ³ hoáº¡t Ä‘á»™ng tá»‘t hÆ¡n trong tÃ¡c vá»¥ nÃ y khÃ´ng!</p></div>
<p>Náº¿u báº¡n muá»‘n tÃ¬m hiá»ƒu sÃ¢u hÆ¡n má»™t chÃºt vá» vÃ²ng huáº¥n luyá»‡n, bÃ¢y giá» chÃºng tÃ´i sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch thá»±c hiá»‡n Ä‘iá»u tÆ°Æ¡ng tá»± báº±ng cÃ¡ch sá»­ dá»¥ng ğŸ¤— Accelerate.</p>
<h2 class="relative group"><a id="mt-vng-lp-hun-luyn-tu-chnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#mt-vng-lp-hun-luyn-tu-chnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Má»™t vÃ²ng láº·p huáº¥n luyá»‡n tuá»³ chá»‰nh
	</span></h2>

<p>BÃ¢y giá» chÃºng ta hÃ£y xem toÃ n bá»™ vÃ²ng láº·p huáº¥n luyá»‡n, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ dá»… dÃ ng tÃ¹y chá»‰nh cÃ¡c pháº§n báº¡n cáº§n. NÃ³ sáº½ trÃ´ng ráº¥t giá»‘ng vá»›i vÃ²ng láº·p huáº¥n luyá»‡n trong <a href="/course/chapter3/4">ChÆ°Æ¡ng 3</a>, ngoáº¡i trá»« vÃ²ng láº·p Ä‘Ã¡nh giÃ¡. ChÃºng ta sáº½ cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh thÆ°á»ng xuyÃªn vÃ¬ ta khÃ´ng bá»‹ háº¡n cháº¿ bá»Ÿi lá»›p <code>Trainer</code> ná»¯a.</p>
<h3 class="relative group"><a id="chun-b-mi-th-cho-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#chun-b-mi-th-cho-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Chuáº¥n bá»‹ má»i thá»© cho huáº¥n luyá»‡n
	</span></h3>

<p>Äáº§u tiÃªn, chÃºng ta cáº§n xÃ¢y dá»±ng cÃ¡c <code>DataLoader</code> tá»« cÃ¡c táº­p dá»¯ liá»‡u cá»§a mÃ¬nh. ChÃºng ta Ä‘áº·t Ä‘á»‹nh dáº¡ng cá»§a cÃ¡c táº­p dá»¯ liá»‡u Ä‘Ã³ thÃ nh <code>&quot;torch&quot;</code> vÃ  xÃ³a cÃ¡c cá»™t trong táº­p xÃ¡c thá»±c khÃ´ng Ä‘Æ°á»£c mÃ´ hÃ¬nh sá»­ dá»¥ng. Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng <code>default_data_collator</code> Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Transformers dÆ°á»›i dáº¡ng <code>collate_fn</code> vÃ  xÃ¡o trá»™n bá»™ huáº¥n luyá»‡n, nhÆ°ng khÃ´ng pháº£i bá»™ kiá»ƒm Ä‘á»‹nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> default_data_collator

train_dataset.set_format(<span class="hljs-string">&quot;torch&quot;</span>)
validation_set = validation_dataset.remove_columns([<span class="hljs-string">&quot;example_id&quot;</span>, <span class="hljs-string">&quot;offset_mapping&quot;</span>])
validation_set.set_format(<span class="hljs-string">&quot;torch&quot;</span>)

train_dataloader = DataLoader(
    train_dataset,
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=default_data_collator,
    batch_size=<span class="hljs-number">8</span>,
)
eval_dataloader = DataLoader(
    validation_set, collate_fn=default_data_collator, batch_size=<span class="hljs-number">8</span>
)<!-- HTML_TAG_END --></pre></div>
<p>Tiáº¿p theo, chÃºng ta khÃ´i phá»¥c mÃ´ hÃ¬nh cá»§a mÃ¬nh, Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng ta khÃ´ng tiáº¿p tá»¥c tinh chá»‰nh tá»« trÆ°á»›c mÃ  báº¯t Ä‘áº§u láº¡i tá»« mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c BERT:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForQuestionAnswering.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta sáº½ cáº§n má»™t trÃ¬nh tá»‘i Æ°u hÃ³a. NhÆ° thÆ°á»ng lá»‡, ta sá»­ dá»¥ng <code>AdamW</code> cá»• Ä‘iá»ƒn, giá»‘ng nhÆ° Adam, nhÆ°ng vá»›i má»™t báº£n sá»­a lá»—i trong cÃ¡ch phÃ¢n rÃ£ trá»ng sá»‘ Ä‘Æ°á»£c Ã¡p dá»¥ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>Khi chÃºng ta cÃ³ táº¥t cáº£ cÃ¡c Ä‘á»‘i tÆ°á»£ng Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ gá»­i chÃºng Ä‘áº¿n phÆ°Æ¡ng thá»©c <code>accelerator.prepare()</code>. HÃ£y nhá»› ráº±ng náº¿u báº¡n muá»‘n huáº¥n luyá»‡n vá» TPU trong notebook Colab, báº¡n sáº½ cáº§n chuyá»ƒn táº¥t cáº£ mÃ£ nÃ y vÃ o má»™t hÃ m huáº¥n luyá»‡n vÃ  Ä‘iá»u Ä‘Ã³ sáº½ khÃ´ng thá»±c thi báº¥t ká»³ Ã´ khá»Ÿi táº¡o má»™t <code>Accelerator</code> nÃ o. ChÃºng ta cÃ³ thá»ƒ buá»™c huáº¥n luyá»‡n Ä‘á»™ chÃ­nh xÃ¡c há»—n há»£p báº±ng cÃ¡ch chuyá»ƒn <code>fp16=True</code> vÃ o <code>Accelerator</code> (hoáº·c, náº¿u báº¡n Ä‘ang thá»±c thi mÃ£ dÆ°á»›i dáº¡ng táº­p lá»‡nh, chá»‰ cáº§n Ä‘áº£m báº£o Ä‘iá»n vÃ o ğŸ¤— Accelerate <code>config</code> má»™t cÃ¡ch thÃ­ch há»£p).</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator(fp16=<span class="hljs-literal">True</span>)
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>
<p>NhÆ° báº¡n Ä‘Ã£ biáº¿t tá»« cÃ¡c pháº§n trÆ°á»›c, chÃºng ta chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»™ dÃ i <code>train_dataloader</code> Ä‘á»ƒ tÃ­nh sá»‘ bÆ°á»›c huáº¥n luyá»‡n sau khi nÃ³ Ä‘Ã£ tráº£i qua phÆ°Æ¡ng thá»©c <code>accelerator.prepare()</code>. ChÃºng ta sá»­ dá»¥ng cÃ¹ng má»™t lá»‹ch trÃ¬nh tuyáº¿n tÃ­nh nhÆ° trong cÃ¡c pháº§n trÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">3</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ Ä‘áº©y mÃ´ hÃ¬nh cá»§a mÃ¬nh lÃªn Hub, chÃºng ta sáº½ cáº§n táº¡o má»™t Ä‘á»‘i tÆ°á»£ng <code>Repository</code> trong má»™t thÆ° má»¥c Ä‘ang lÃ m viá»‡c. Äáº§u tiÃªn hÃ£y Ä‘Äƒng nháº­p vÃ o Hugging Face Hub, náº¿u báº¡n chÆ°a Ä‘Äƒng nháº­p. ChÃºng ta sáº½ xÃ¡c Ä‘á»‹nh tÃªn kho lÆ°u trá»¯ tá»« ID mÃ´ hÃ¬nh mÃ  ta muá»‘n cung cáº¥p cho mÃ´ hÃ¬nh cá»§a mÃ¬nh (vui lÃ²ng thay tháº¿ <code>repo_name</code> báº±ng sá»± lá»±a chá»n cá»§a riÃªng báº¡n; nÃ³ chá»‰ cáº§n chá»©a tÃªn ngÆ°á»i dÃ¹ng cá»§a báº¡n, Ä‘Ã³ lÃ  nhá»¯ng gÃ¬ hÃ m <code>get_full_repo_name()</code> thá»±c hiá»‡n ):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository, get_full_repo_name

model_name = <span class="hljs-string">&quot;bert-finetuned-squad-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;sgugger/bert-finetuned-squad-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sao chÃ©p kho lÆ°u trá»¯ Ä‘Ã³ trong má»™t thÆ° má»¥c cá»¥c bá»™. Náº¿u nÃ³ Ä‘Ã£ tá»“n táº¡i, thÆ° má»¥c cá»¥c bá»™ nÃ y pháº£i lÃ  báº£n sao cá»§a kho lÆ°u trá»¯ mÃ  ta Ä‘ang lÃ m viá»‡c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->output_dir = <span class="hljs-string">&quot;bert-finetuned-squad-accelerate&quot;</span>
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>Giá» ta cÃ³ thá»ƒ táº£i má»i thá»­ ta lÆ°u trong <code>output_dir</code> báº±ng cÃ¡ch gá»i phÆ°Æ¡ng thá»©c <code>repo.push_to_hub()</code>. NÃ³ sáº½ giÃºp ta táº£i cÃ¡c mÃ´ hÃ¬nh tá»©c thÃ¬ á»Ÿ cuá»‘i má»—i epoch.</p>
<h2 class="relative group"><a id="vng-lp-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#vng-lp-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>VÃ²ng láº·p huáº¥n luyá»‡n
	</span></h2>

<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ viáº¿t vÃ²ng láº·p huáº¥n luyá»‡n Ä‘áº§y Ä‘á»§. Sau khi xÃ¡c Ä‘á»‹nh thanh tiáº¿n trÃ¬nh Ä‘á»ƒ theo dÃµi quÃ¡ trÃ¬nh huáº¥n luyá»‡n diá»…n ra nhÆ° tháº¿ nÃ o, vÃ²ng láº·p cÃ³ ba pháº§n:</p>
<ul><li>Báº£n thÃ¢n quÃ¡ trÃ¬nh huáº¥n luyá»‡n, lÃ  sá»± láº·p láº¡i cá»• Ä‘iá»ƒn trÃªn <code>train_dataloader</code>, truyá»n tháº³ng qua mÃ´ hÃ¬nh, sau Ä‘Ã³ truyá»n ngÆ°á»£c vÃ  tá»‘i Æ°u hÃ³a.</li>
<li>BÆ°á»›c Ä‘Ã¡nh giÃ¡, trong Ä‘Ã³ ta thu tháº­p táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cho <code>start_logits</code> vÃ  <code>end_logits</code> trÆ°á»›c khi chuyá»ƒn Ä‘á»•i chÃºng thÃ nh máº£ng NumPy. Khi vÃ²ng láº·p Ä‘Ã¡nh giÃ¡ káº¿t thÃºc, chÃºng ta ná»‘i táº¥t cáº£ cÃ¡c káº¿t quáº£. LÆ°u Ã½ ráº±ng chÃºng ta cáº§n cáº¯t bá»›t vÃ¬ <code>Accelerator</code> cÃ³ thá»ƒ Ä‘Ã£ thÃªm má»™t vÃ i máº«u vÃ o cuá»‘i Ä‘á»ƒ Ä‘áº£m báº£o chÃºng ta cÃ³ cÃ¹ng sá»‘ lÆ°á»£ng máº«u trong má»—i quy trÃ¬nh.</li>
<li>LÆ°u vÃ  táº£i lÃªn, nÆ¡i trÆ°á»›c tiÃªn chÃºng ta lÆ°u mÃ´ hÃ¬nh vÃ  trÃ¬nh mÃ£ hÃ³a, sau Ä‘Ã³ gá»i <code>repo.push_to_hub()</code>. NhÆ° chÃºng ta Ä‘Ã£ lÃ m trÆ°á»›c Ä‘Ã¢y, chÃºng ta sá»­ dá»¥ng Ä‘á»‘i sá»‘ <code>blocking=False</code> Ä‘á»ƒ yÃªu cáº§u thÆ° viá»‡n ğŸ¤— Hub Ä‘áº©y vÃ o má»™t quÃ¡ trÃ¬nh khÃ´ng Ä‘á»“ng bá»™. Báº±ng cÃ¡ch nÃ y, quÃ¡ trÃ¬nh huáº¥n luyá»‡n tiáº¿p tá»¥c diá»…n ra bÃ¬nh thÆ°á»ng vÃ  lá»‡nh (dÃ i) nÃ y Ä‘Æ°á»£c thá»±c thi á»Ÿ cháº¿ Ä‘á»™ ná»n.</li></ul>
<p>ÄÃ¢y lÃ  mÃ£ hoÃ n chá»‰nh cho vÃ²ng láº·p huáº¥n luyá»‡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Huáº¥n luyá»‡n</span>
    model.train()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_dataloader):
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># ÄÃ¡nh giÃ¡</span>
    model.<span class="hljs-built_in">eval</span>()
    start_logits = []
    end_logits = []
    accelerator.<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Evaluation!&quot;</span>)
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> tqdm(eval_dataloader):
        <span class="hljs-keyword">with</span> torch.no_grad():
            outputs = model(**batch)

        start_logits.append(accelerator.gather(outputs.start_logits).cpu().numpy())
        end_logits.append(accelerator.gather(outputs.end_logits).cpu().numpy())

    start_logits = np.concatenate(start_logits)
    end_logits = np.concatenate(end_logits)
    start_logits = start_logits[: <span class="hljs-built_in">len</span>(validation_dataset)]
    end_logits = end_logits[: <span class="hljs-built_in">len</span>(validation_dataset)]

    metrics = compute_metrics(
        start_logits, end_logits, validation_dataset, raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>]
    )
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;epoch <span class="hljs-subst">{epoch}</span>:&quot;</span>, metrics)

    <span class="hljs-comment"># LÆ°u vÃ  táº£i</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>
<p>Trong trÆ°á»ng há»£p Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn báº¡n tháº¥y má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c lÆ°u báº±ng ğŸ¤— Accelerate, hÃ£y dÃ nh má»™t chÃºt thá»i gian Ä‘á»ƒ kiá»ƒm tra ba dÃ²ng mÃ£ Ä‘i kÃ¨m vá»›i nÃ³:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->accelerator.wait_for_everyone()
unwrapped_model = accelerator.unwrap_model(model)
unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)<!-- HTML_TAG_END --></pre></div>
<p>DÃ²ng Ä‘áº§u tiÃªn Ä‘Ã£ tá»± giáº£i thÃ­ch: nÃ³ cho táº¥t cáº£ cÃ¡c quÃ¡ trÃ¬nh chá» cho Ä‘áº¿n khi má»i ngÆ°á»i á»Ÿ giai Ä‘oáº¡n Ä‘Ã³ trÆ°á»›c khi tiáº¿p tá»¥c. Äiá»u nÃ y lÃ  Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng chÃºng ta cÃ³ cÃ¹ng má»™t mÃ´ hÃ¬nh trong má»i quy trÃ¬nh trÆ°á»›c khi lÆ°u. Sau Ä‘Ã³, ta láº¥y <code>unwrapped_model</code>, lÃ  mÃ´ hÃ¬nh cÆ¡ sá»Ÿ mÃ  ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh. PhÆ°Æ¡ng thá»©c <code>accelerator.prepare()</code> thay Ä‘á»•i mÃ´ hÃ¬nh Ä‘á»ƒ hoáº¡t Ä‘á»™ng trong huáº¥n luyá»‡n phÃ¢n tÃ¡n, vÃ¬ váº­y nÃ³ sáº½ khÃ´ng cÃ³ phÆ°Æ¡ng thá»©c <code>save_pretrained()</code> ná»¯a; phÆ°Æ¡ng thá»©c <code>accelerator.unwrap_model()</code> hoÃ n tÃ¡c bÆ°á»›c Ä‘Ã³. Cuá»‘i cÃ¹ng, chÃºng ta gá»i <code>save_pretrained()</code> nhÆ°ng yÃªu cáº§u phÆ°Æ¡ng thá»©c Ä‘Ã³ sá»­ dá»¥ng <code>accelerator.save()</code> thay vÃ¬ <code>torch.save()</code>.</p>
<p>Khi Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n, báº¡n sáº½ cÃ³ má»™t mÃ´ hÃ¬nh táº¡o ra káº¿t quáº£ khÃ¡ giá»‘ng vá»›i mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i <code>Trainer</code>. Báº¡n cÃ³ thá»ƒ kiá»ƒm tra mÃ´ hÃ¬nh mÃ  ta Ä‘Ã£ huáº¥n luyá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng mÃ£ nÃ y táº¡i <a href="https://huggingface.co/huggingface-course/bert-finetuned-squad-accelerate" rel="nofollow"><em>huggingface-course/bert-finetuned-squad-accelerate</em></a>. VÃ  náº¿u báº¡n muá»‘n kiá»ƒm tra báº¥t ká»³ tinh chá»‰nh nÃ o Ä‘á»‘i vá»›i vÃ²ng láº·p huáº¥n luyá»‡n, báº¡n cÃ³ thá»ƒ trá»±c tiáº¿p thá»±c hiá»‡n chÃºng báº±ng cÃ¡ch chá»‰nh sá»­a Ä‘oáº¡n mÃ£ Ä‘Æ°á»£c hiá»ƒn thá»‹ á»Ÿ trÃªn!</p>
<h2 class="relative group"><a id="s-dng-m-hnh-tinh-chnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#s-dng-m-hnh-tinh-chnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Sá»­ dá»¥ng mÃ´ hÃ¬nh tinh chá»‰nh
	</span></h2>

<p>ChÃºng tÃ´i Ä‘Ã£ chá»‰ cho báº¡n cÃ¡ch báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng mÃ´ hÃ¬nh mÃ  chÃºng ta Ä‘Ã£ tinh chá»‰nh trÃªn Model Hub báº±ng tiá»‡n Ã­ch luáº­n suy. Äá»ƒ sá»­ dá»¥ng nÃ³ cá»¥c bá»™ trong má»™t <code>pipeline</code>, báº¡n chá»‰ cáº§n chá»‰ Ä‘á»‹nh mÃ£ Ä‘á»‹nh danh mÃ´ hÃ¬nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

<span class="hljs-comment"># Thay tháº¿ nÃ³ vá»›i checkpoint cá»§a báº¡n</span>
model_checkpoint = <span class="hljs-string">&quot;huggingface-course/bert-finetuned-squad&quot;</span>
question_answerer = pipeline(<span class="hljs-string">&quot;question-answering&quot;</span>, model=model_checkpoint)

context = <span class="hljs-string">&quot;&quot;&quot;
ğŸ¤— Transformers is backed by the three most popular deep learning libraries â€” Jax, PyTorch and TensorFlow â€” with a seamless integration
between them. It&#x27;s straightforward to train your models with one before loading them for inference with the other.
&quot;&quot;&quot;</span>
question = <span class="hljs-string">&quot;Which deep learning libraries back ğŸ¤— Transformers?&quot;</span>
question_answerer(question=question, context=context)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.9979003071784973</span>,
 <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">78</span>,
 <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">105</span>,
 <span class="hljs-string">&#x27;answer&#x27;</span>: <span class="hljs-string">&#x27;Jax, PyTorch and TensorFlow&#x27;</span>}<!-- HTML_TAG_END --></pre></div>
<p>Tuyá»‡t quÃ¡! MÃ´ hÃ¬nh cá»§a chÃºng ta Ä‘ang hoáº¡t Ä‘á»™ng tá»‘t nhÆ° mÃ´ hÃ¬nh máº·c Ä‘á»‹nh cho pipeline nÃ y!</p>


		<script type="module" data-hydrate="s0w5w0">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="s0w5w0"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter7/7.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
