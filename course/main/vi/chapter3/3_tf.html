<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;tinh-chnh-mt-m-hnh-vi-keras&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;hun-luyn&quot;,&quot;title&quot;:&quot;Huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;ci-thin-hiu-sut-hun-luyn&quot;,&quot;title&quot;:&quot;Cáº£i thiá»‡n hiá»‡u suáº¥t huáº¥n luyá»‡n&quot;},{&quot;local&quot;:&quot;cc-d-on-ca-m-hnh&quot;,&quot;title&quot;:&quot;CÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh&quot;}],&quot;title&quot;:&quot;Tinh chá»‰nh má»™t mÃ´ hÃ¬nh vá»›i Keras&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter3/3_tf.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CourseFloatingBanner-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="tinh-chnh-mt-m-hnh-vi-keras" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-mt-m-hnh-vi-keras"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh chá»‰nh má»™t mÃ´ hÃ¬nh vá»›i Keras
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://discuss.huggingface.co/t/chapter-3-questions" target="_blank"><img alt="Ask a Question" class="!m-0" src="https://img.shields.io/badge/Ask%20a%20question-ffcb4c.svg?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgLTEgMTA0IDEwNiI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMyMzFmMjA7fS5jbHMtMntmaWxsOiNmZmY5YWU7fS5jbHMtM3tmaWxsOiMwMGFlZWY7fS5jbHMtNHtmaWxsOiMwMGE5NGY7fS5jbHMtNXtmaWxsOiNmMTVkMjI7fS5jbHMtNntmaWxsOiNlMzFiMjM7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5EaXNjb3Vyc2VfbG9nbzwvdGl0bGU+PGcgaWQ9IkxheWVyXzIiPjxnIGlkPSJMYXllcl8zIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik01MS44NywwQzIzLjcxLDAsMCwyMi44MywwLDUxYzAsLjkxLDAsNTIuODEsMCw1Mi44MWw1MS44Ni0uMDVjMjguMTYsMCw1MS0yMy43MSw1MS01MS44N1M4MCwwLDUxLjg3LDBaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNTIuMzcsMTkuNzRBMzEuNjIsMzEuNjIsMCwwLDAsMjQuNTgsNjYuNDFsLTUuNzIsMTguNEwzOS40LDgwLjE3YTMxLjYxLDMxLjYxLDAsMSwwLDEzLTYwLjQzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMyIgZD0iTTc3LjQ1LDMyLjEyYTMxLjYsMzEuNiwwLDAsMS0zOC4wNSw0OEwxOC44Niw4NC44MmwyMC45MS0yLjQ3QTMxLjYsMzEuNiwwLDAsMCw3Ny40NSwzMi4xMloiLz48cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Ik03MS42MywyNi4yOUEzMS42LDMxLjYsMCwwLDEsMzguOCw3OEwxOC44Niw4NC44MiwzOS40LDgwLjE3QTMxLjYsMzEuNiwwLDAsMCw3MS42MywyNi4yOVoiLz48cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Ik0yNi40Nyw2Ny4xMWEzMS42MSwzMS42MSwwLDAsMSw1MS0zNUEzMS42MSwzMS42MSwwLDAsMCwyNC41OCw2Ni40MWwtNS43MiwxOC40WiIvPjxwYXRoIGNsYXNzPSJjbHMtNiIgZD0iTTI0LjU4LDY2LjQxQTMxLjYxLDMxLjYxLDAsMCwxLDcxLjYzLDI2LjI5YTMxLjYxLDMxLjYxLDAsMCwwLTQ5LDM5LjYzbC0zLjc2LDE4LjlaIi8+PC9nPjwvZz48L3N2Zz4="></a>
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3_tf.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter3/section3_tf.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Khi báº¡n Ä‘Ã£ hoÃ n thÃ nh táº¥t cáº£ cÃ´ng viá»‡c tiá»n xá»­ lÃ½ dá»¯ liá»‡u trong pháº§n trÆ°á»›c, báº¡n chá»‰ cÃ²n má»™t vÃ i bÆ°á»›c ná»¯a Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh. Tuy nhiÃªn, lÆ°u Ã½ ráº±ng lá»‡nh <code>model.fit()</code> sáº½ cháº¡y ráº¥t cháº­m trÃªn CPU. Náº¿u báº¡n chÆ°a thiáº¿t láº­p GPU, báº¡n cÃ³ thá»ƒ cÃ³ quyá»n truy cáº­p vÃ o GPU hoáº·c TPU miá»…n phÃ­ trÃªn <a href="https://colab.research.google.com/" rel="nofollow">Google Colab</a>.</p>
<p>CÃ¡c Ä‘oáº¡n mÃ£ vÃ­ dá»¥ bÃªn dÆ°á»›i giáº£ sá»­ báº¡n Ä‘Ã£ thá»±c thi cÃ¡c vÃ­ dá»¥ trong pháº§n trÆ°á»›c. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t báº£n tÃ³m táº¯t ngáº¯n gá»n tÃ³m táº¯t láº¡i nhá»¯ng gÃ¬ báº¡n cáº§n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, DataCollatorWithPadding
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
checkpoint = <span class="hljs-string">&quot;bert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> tokenizer(example[<span class="hljs-string">&quot;sentence1&quot;</span>], example[<span class="hljs-string">&quot;sentence2&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)

data_collator = DataCollatorWithPadding(tokenizer=tokenizer, return_tensors=<span class="hljs-string">&quot;tf&quot;</span>)

tf_train_dataset = tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;attention_mask&quot;</span>, <span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;token_type_ids&quot;</span>],
    label_cols=[<span class="hljs-string">&quot;labels&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=data_collator,
    batch_size=<span class="hljs-number">8</span>,
)

tf_validation_dataset = tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;attention_mask&quot;</span>, <span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;token_type_ids&quot;</span>],
    label_cols=[<span class="hljs-string">&quot;labels&quot;</span>],
    shuffle=<span class="hljs-literal">False</span>,
    collate_fn=data_collator,
    batch_size=<span class="hljs-number">8</span>,
)<!-- HTML_TAG_END --></pre></div>
<h3 class="relative group"><a id="hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Huáº¥n luyá»‡n
	</span></h3>

<p>CÃ¡c mÃ´ hÃ¬nh TensorFlow nháº­p tá»« ğŸ¤— Transformers vá»‘n lÃ  cÃ¡c mÃ´ hÃ¬nh Keras. ÄÃ¢y lÃ  pháº§n giá»›i thiá»‡u ngáº¯n vá» Keras.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/rnTGBy2ax1c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  má»™t khi chÃºng tÃ´i cÃ³ dá»¯ liá»‡u riÃªng mÃ¬nh, chÃºng ta chá»‰ cáº§n thao tÃ¡c Ã­t bÆ°á»›c ná»¯a thÃ´i Ä‘á»ƒ báº¯t Ä‘áº§u huáº¥n luyá»‡n.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/AUozVp78dhk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>NhÆ° trong <a href="/course/chapter2">chÆ°Æ¡ng trÆ°á»›c</a>, chÃºng ta sáº½ sá»­ dá»¥ng lá»›p <code>TFAutoModelForSequenceClassification</code>, vá»›i hai nhÃ£n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TFAutoModelForSequenceClassification

model = TFAutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div>
<p>Báº¡n sáº½ nháº­n tháº¥y ráº±ng khÃ´ng nhÆ° trong <a href="/course/chapter2">ChÆ°Æ¡ng 2</a>, báº¡n nháº­n Ä‘Æ°á»£c má»™t cáº£nh bÃ¡o sau khi khá»Ÿi táº¡o mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c nÃ y. ÄÃ¢y lÃ  do BERT chÆ°a Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá» phÃ¢n loáº¡i cÃ¡c cáº·p cÃ¢u, vÃ¬ váº­y pháº§n Ä‘áº§u cá»§a mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c Ä‘Ã£ bá»‹ loáº¡i bá» vÃ  pháº§n Ä‘áº§u má»›i phÃ¹ há»£p Ä‘á»ƒ phÃ¢n loáº¡i chuá»—i Ä‘Ã£ Ä‘Æ°á»£c chÃ¨n vÃ o thay tháº¿. CÃ¡c cáº£nh bÃ¡o chá»‰ ra ráº±ng má»™t sá»‘ trá»ng sá»‘ Ä‘Ã£ khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng (nhá»¯ng trá»ng sá»‘ tÆ°Æ¡ng á»©ng vá»›i Ä‘áº§u huáº¥n luyá»‡n trÆ°á»›c bá»‹ rá»¥ng) vÃ  má»™t sá»‘ trá»ng sá»‘ khÃ¡c khÃ¡c Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn (nhá»¯ng trá»ng sá»‘ dÃ nh cho Ä‘áº§u má»›i). NÃ³ káº¿t thÃºc báº±ng cÃ¡ch khuyáº¿n khÃ­ch báº¡n huáº¥n luyá»‡n mÃ´ hÃ¬nh, Ä‘Ã³ chÃ­nh xÃ¡c lÃ  nhá»¯ng gÃ¬ chÃºng ta sáº½ lÃ m bÃ¢y giá».</p>
<p>Äá»ƒ tinh chá»‰nh mÃ´ hÃ¬nh trÃªn táº­p dá»¯ liá»‡u cá»§a mÃ¬nh, chÃºng ta chá»‰ cáº§n <code>compile()</code> mÃ´ hÃ¬nh vÃ  sau Ä‘Ã³ chuyá»ƒn dá»¯ liá»‡u cá»§a ta Ä‘áº¿n phÆ°Æ¡ng thá»©c <code>fit()</code>. Thao tÃ¡c nÃ y sáº½ báº¯t Ä‘áº§u quÃ¡ trÃ¬nh tinh chá»‰nh (sáº½ máº¥t vÃ i phÃºt trÃªn GPU) vÃ  bÃ¡o cÃ¡o sá»± máº¥t mÃ¡t á»Ÿ táº­p huáº¥n luyá»‡n khi nÃ³ diá»…n ra, cá»™ng vá»›i máº¥t mÃ¡t á»Ÿ táº­p kiá»ƒm Ä‘á»‹nh á»Ÿ cuá»‘i má»—i epoch.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>LÆ°u Ã½ ráº±ng ğŸ¤— cÃ¡c mÃ´ hÃ¬nh Transformers cÃ³ má»™t kháº£ nÄƒng Ä‘áº·c biá»‡t mÃ  háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh Keras khÃ´ng cÃ³ - chÃºng cÃ³ thá»ƒ tá»± Ä‘á»™ng sá»­ dá»¥ng má»™t lÆ°á»£ng máº¥t mÃ¡t thÃ­ch há»£p mÃ  chÃºng tÃ­nh toÃ¡n bÃªn trong. ChÃºng sáº½ sá»­ dá»¥ng sá»± máº¥t mÃ¡t nÃ y theo máº·c Ä‘á»‹nh náº¿u báº¡n khÃ´ng Ä‘áº·t tham sá»‘ máº¥t mÃ¡t bÃªn trong <code>compile()</code>. LÆ°u Ã½ ráº±ng Ä‘á»ƒ sá»­ dá»¥ng hÃ m máº¥t mÃ¡t trong ná»™i bá»™, báº¡n sáº½ cáº§n truyá»n cÃ¡c nhÃ£n cá»§a mÃ¬nh nhÆ° má»™t pháº§n cá»§a Ä‘áº§u vÃ o, khÃ´ng pháº£i dÆ°á»›i dáº¡ng nhÃ£n riÃªng biá»‡t, Ä‘Ã¢y lÃ  cÃ¡ch thÃ´ng thÆ°á»ng Ä‘á»ƒ sá»­ dá»¥ng nhÃ£n vá»›i cÃ¡c mÃ´ hÃ¬nh Keras. Báº¡n sáº½ tháº¥y cÃ¡c vÃ­ dá»¥ vá» Ä‘iá»u nÃ y trong Pháº§n 2 cá»§a khÃ³a há»c, trong Ä‘Ã³ viá»‡c xÃ¡c Ä‘á»‹nh hÃ m máº¥t mÃ¡t chÃ­nh xÃ¡c cÃ³ thá»ƒ khÃ³ khÄƒn. Tuy nhiÃªn, Ä‘á»‘i vá»›i phÃ¢n loáº¡i chuá»—i, má»™t hÃ m máº¥t mÃ¡t Keras tiÃªu chuáº©n hoáº¡t Ä‘á»™ng khÃ¡ tá»‘t, vÃ¬ váº­y Ä‘Ã³ lÃ  nhá»¯ng gÃ¬ chÃºng ta sáº½ sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y.</p></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tensorflow.keras.losses <span class="hljs-keyword">import</span> SparseCategoricalCrossentropy

model.<span class="hljs-built_in">compile</span>(
    optimizer=<span class="hljs-string">&quot;adam&quot;</span>,
    loss=SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>),
    metrics=[<span class="hljs-string">&quot;accuracy&quot;</span>],
)
model.fit(
    tf_train_dataset,
    validation_data=tf_validation_dataset,
)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>LÆ°u Ã½ má»™t lá»—i ráº¥t phá»• biáº¿n á»Ÿ Ä‘Ã¢y - báº¡n <em>cÃ³ thá»ƒ</em> chá»‰ cáº§n truyá»n tÃªn cá»§a hÃ m máº¥t mÃ¡t dÆ°á»›i dáº¡ng chuá»—i cho Keras, nhÆ°ng theo máº·c Ä‘á»‹nh, Keras sáº½ cho ráº±ng báº¡n Ä‘Ã£ Ã¡p dá»¥ng softmax cho Ä‘áº§u ra cá»§a mÃ¬nh. Tuy nhiÃªn, nhiá»u mÃ´ hÃ¬nh xuáº¥t ra cÃ¡c giÃ¡ trá»‹ ngay trÆ°á»›c khi Ã¡p dá»¥ng softmax, cÃ²n Ä‘Æ°á»£c gá»i lÃ  <em>logit</em>. ChÃºng ta cáº§n nÃ³i vá»›i hÃ m máº¥t mÃ¡t ráº±ng Ä‘Ã³ lÃ  nhá»¯ng gÃ¬ mÃ´ hÃ¬nh cá»§a chÃºng ta lÃ m vÃ  cÃ¡ch duy nháº¥t Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³ lÃ  gá»i nÃ³ trá»±c tiáº¿p, thay vÃ¬ Ä‘áº·t tÃªn báº±ng má»™t chuá»—i.</p></div>
<h3 class="relative group"><a id="ci-thin-hiu-sut-hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#ci-thin-hiu-sut-hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Cáº£i thiá»‡n hiá»‡u suáº¥t huáº¥n luyá»‡n
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/cpzq6ESSM5c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Náº¿u báº¡n thá»­ Ä‘oáº¡n mÃ£ trÃªn, nÃ³ cháº¯c cháº¯n cháº¡y, nhÆ°ng báº¡n sáº½ tháº¥y ráº±ng hÃ m máº¥t mÃ¡t chá»‰ giáº£m tá»« tá»« hoáº·c khÃ´ng thÆ°á»ng xuyÃªn. NguyÃªn nhÃ¢n chÃ­nh lÃ  do <em>learning rate</em> hay <em>tá»‘c Ä‘á»™ há»c</em>. Vá»›i hÃ m máº¥t mÃ¡t, khi ta truyá»n cho Keras tÃªn cá»§a trÃ¬nh tá»‘i Æ°u hÃ³a dÆ°á»›i dáº¡ng má»™t chuá»—i, Keras sáº½ khá»Ÿi táº¡o trÃ¬nh tá»‘i Æ°u hÃ³a Ä‘Ã³ vá»›i cÃ¡c giÃ¡ trá»‹ máº·c Ä‘á»‹nh cho táº¥t cáº£ cÃ¡c tham sá»‘, bao gá»“m cáº£ tá»‘c Ä‘á»™ há»c. Tuy nhiÃªn, tá»« kinh nghiá»‡m lÃ¢u nÄƒm, chÃºng tÃ´i biáº¿t
ráº±ng cÃ¡c mÃ´ hÃ¬nh Transformer Ä‘Æ°á»£c hÆ°á»Ÿng lá»£i tá»« tá»‘c Ä‘á»™ há»c tháº¥p hÆ¡n nhiá»u so vá»›i tá»· lá»‡ máº·c Ä‘á»‹nh cho Adam, lÃ  1e-3, cÅ©ng Ä‘Æ°á»£c viáº¿t báº±ng 10 lÅ©y thá»«a cá»§a -3, hoáº·c 0,001. 5e-5 (0,00005), tháº¥p hÆ¡n khoáº£ng hai mÆ°Æ¡i láº§n, lÃ  má»™t Ä‘iá»ƒm khá»Ÿi Ä‘áº§u tá»‘t hÆ¡n nhiá»u.</p>
<p>NgoÃ i viá»‡c giáº£m tá»‘c Ä‘á»™ há»c, chÃºng tÃ´i cÃ³ má»™t máº¹o thá»© hai: Ta cÃ³ thá»ƒ tá»« tá»« giáº£m tá»‘c Ä‘á»™ há»c trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Trong tÃ i liá»‡u, Ä‘Ã´i khi báº¡n sáº½ tháº¥y Ä‘iá»u nÃ y Ä‘Æ°á»£c gá»i lÃ  <em>phÃ¢n rÃ£</em> hoáº·c <em>á»§</em> tá»‘c Ä‘á»™ há»c. á» Keras, cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y lÃ  sá»­ dá»¥ng <em>learning rate scheduler</em> hay <em>cÃ´ng cá»¥ láº­p lá»‹ch trÃ¬nh tá»‘c Ä‘á»™ há»c</em>. Má»™t cÃ¡i hay Ä‘á»ƒ sá»­ dá»¥ng lÃ  <code>PolynomialDecay</code> - vá»›i cÃ i Ä‘áº·t máº·c Ä‘á»‹nh, nÃ³ chá»‰ Ä‘Æ¡n giáº£n lÃ  giáº£m Ä‘á»™ tuyáº¿n tÃ­nh tá»‘c Ä‘á»™ há»c tá»« giÃ¡ trá»‹ ban Ä‘áº§u Ä‘áº¿n giÃ¡ trá»‹ cuá»‘i cÃ¹ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, Ä‘Ã³ chÃ­nh xÃ¡c lÃ  nhá»¯ng gÃ¬ ta muá»‘n. Tuy nhiÃªn, Ä‘á»ƒ sá»­ dá»¥ng bá»™ láº­p lá»‹ch má»™t cÃ¡ch chÃ­nh xÃ¡c, chÃºng ta cáº§n cho nÃ³ biáº¿t thá»i gian huáº¥n luyá»‡n sáº½ kÃ©o dÃ i. ChÃºng ta tÃ­nh giÃ¡ trá»‹ Ä‘Ã³ dÆ°á»›i dáº¡ng <code>num_train_steps</code> nhÆ° sau.</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tensorflow.keras.optimizers.schedules <span class="hljs-keyword">import</span> PolynomialDecay

batch_size = <span class="hljs-number">8</span>
num_epochs = <span class="hljs-number">3</span>
<span class="hljs-comment"># Sá»‘ bÆ°á»›c huáº¥n luyá»‡n lÃ  sá»‘ lÆ°á»£ng máº«u trong táº­p dá»¯ liá»‡u, chia cho kÃ­ch thÆ°á»›c lÃ´ sau Ä‘Ã³ nhÃ¢n</span>
<span class="hljs-comment"># vá»›i tá»•ng sá»‘ epoch. LÆ°u Ã½ ráº±ng tf_train_dataset á»Ÿ Ä‘Ã¢y lÃ  tf.data.Dataset theo lÃ´,</span>
<span class="hljs-comment"># khÃ´ng pháº£i lÃ  Hugging Face Dataset, vÃ¬ váº­y len() cá»§a nÃ³ Ä‘Ã£ lÃ  num_samples // batch_size.</span>
num_train_steps = <span class="hljs-built_in">len</span>(tf_train_dataset) * num_epochs
lr_scheduler = PolynomialDecay(
    initial_learning_rate=<span class="hljs-number">5e-5</span>, end_learning_rate=<span class="hljs-number">0.0</span>, decay_steps=num_train_steps
)
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam

opt = Adam(learning_rate=lr_scheduler)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ThÆ° viá»‡n ğŸ¤— Transformers cÅ©ng cÃ³ má»™t hÃ m <code>create_optimizer()</code> sáº½ táº¡o ra má»™t trÃ¬nh tá»‘i Æ°u hÃ³a <code>AdamW</code> vá»›i sá»± giáº£m tá»‘c Ä‘á»™ há»c. ÄÃ¢y lÃ  má»™t phÃ­m táº¯t thuáº­n tiá»‡n mÃ  báº¡n sáº½ tháº¥y chi tiáº¿t trong cÃ¡c pháº§n sau cá»§a khÃ³a há»c.</p></div>
<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ trÃ¬nh tá»‘i Æ°u hÃ³a hoÃ n toÃ n má»›i vÃ  ta cÃ³ thá»ƒ thá»­ huáº¥n luyá»‡n vá»›i nÃ³. Äáº§u tiÃªn, hÃ£y táº£i láº¡i mÃ´ hÃ¬nh, Ä‘á»ƒ Ä‘áº·t láº¡i cÃ¡c thay Ä‘á»•i Ä‘á»‘i vá»›i trá»ng sá»‘ tá»« láº§n cháº¡y huáº¥n luyá»‡n mÃ  chÃºng ta vá»«a thá»±c hiá»‡n vÃ  sau Ä‘Ã³ ta cÃ³ thá»ƒ biÃªn dá»‹ch nÃ³ báº±ng trÃ¬nh tá»‘i Æ°u hÃ³a má»›i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf

model = TFAutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)
loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>)
model.<span class="hljs-built_in">compile</span>(optimizer=opt, loss=loss, metrics=[<span class="hljs-string">&quot;accuracy&quot;</span>])<!-- HTML_TAG_END --></pre></div>
<p>Giá» ta sáº½ fit láº¡i 1 láº§n ná»¯a:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.fit(tf_train_dataset, validation_data=tf_validation_dataset, epochs=<span class="hljs-number">3</span>)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ Náº¿u báº¡n muá»‘n tá»± Ä‘á»™ng táº£i mÃ´ hÃ¬nh cá»§a mÃ¬nh lÃªn Hub trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, báº¡n cÃ³ thá»ƒ truyá»n <code>PushToHubCallback</code> vÃ o trong phÆ°Æ¡ng thá»©c <code>model.fit()</code>. ChÃºng ta sáº½ tÃ¬m hiá»ƒu thÃªm vá» Ä‘iá»u nÃ y trong <a href="/course/chapter4/3">ChÆ°Æ¡ng 4</a></p></div>
<h3 class="relative group"><a id="cc-d-on-ca-m-hnh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#cc-d-on-ca-m-hnh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>CÃ¡c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh
	</span></h3>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/nx10eh4CoOs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Viá»‡c huáº¥n luyá»‡n vÃ  theo dÃµi sá»± máº¥t mÃ¡t giáº£m xuá»‘ng Ä‘á»u ráº¥t tá»‘t, nhÆ°ng náº¿u chÃºng ta muá»‘n thá»±c sá»± cÃ³ Ä‘Æ°á»£c káº¿t quáº£ Ä‘áº§u ra tá»« mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n, Ä‘á»ƒ tÃ­nh toÃ¡n má»™t sá»‘ chá»‰ sá»‘ hoáº·c sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Ã³ trong sáº£n xuáº¥t thÃ¬ sao? Äá»ƒ lÃ m Ä‘iá»u Ä‘Ã³, chÃºng ta chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>predict()</code>. Äiá»u nÃ y sáº½ tráº£ vá» <em>logit</em> tá»« Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh, má»™t cho má»—i lá»›p.</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->preds = model.predict(tf_validation_dataset)[<span class="hljs-string">&quot;logits&quot;</span>]<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i cÃ¡c logit nÃ y thÃ nh cÃ¡c dá»± Ä‘oÃ¡n lá»›p cá»§a mÃ´ hÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng <code>argmax</code> Ä‘á»ƒ tÃ¬m logit cao nháº¥t, tÆ°Æ¡ng á»©ng vá»›i lá»›p cÃ³ nhiá»u kháº£ nÄƒng nháº¥t:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->class_preds = np.argmax(preds, axis=<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(preds.shape, class_preds.shape)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">408</span>, <span class="hljs-number">2</span>) (<span class="hljs-number">408</span>,)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá», hÃ£y sá»­ dá»¥ng cÃ¡c <code>preds</code> Ä‘Ã³ Ä‘á»ƒ tÃ­nh toÃ¡n má»™t sá»‘ chá»‰ sá»‘! ChÃºng ta cÃ³ thá»ƒ táº£i cÃ¡c chá»‰ sá»‘ Ä‘Æ°á»£c liÃªn káº¿t vá»›i táº­p dá»¯ liá»‡u MRPC dá»… dÃ ng nhÆ° khi ta táº£i táº­p dá»¯ liá»‡u, láº§n nÃ y lÃ  vá»›i hÃ m <code>eval.load())</code>. Äá»‘i tÆ°á»£ng Ä‘Æ°á»£c tráº£ vá» cÃ³ phÆ°Æ¡ng thá»©c <code>compute()</code> mÃ  chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n phÃ©p tÃ­nh sá»‘ liá»‡u:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
metric.compute(predictions=class_preds, references=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-string">&quot;label&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8578431372549019</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8996539792387542</span>}<!-- HTML_TAG_END --></pre></div>
<p>Káº¿t quáº£ chÃ­nh xÃ¡c báº¡n nháº­n Ä‘Æ°á»£c cÃ³ thá»ƒ khÃ¡c nhau, vÃ¬ viá»‡c khá»Ÿi táº¡o ngáº«u nhiÃªn pháº§n Ä‘áº§u mÃ´ hÃ¬nh cÃ³ thá»ƒ thay Ä‘á»•i cÃ¡c chá»‰ sá»‘ mÃ  nÃ³ Ä‘áº¡t Ä‘Æ°á»£c. á» Ä‘Ã¢y, chÃºng ta cÃ³ thá»ƒ tháº¥y mÃ´ hÃ¬nh cÃ³ Ä‘á»™ chÃ­nh xÃ¡c 85.78% trÃªn táº­p kiá»ƒm Ä‘á»‹nh vÃ  Ä‘iá»ƒm F1 lÃ  89.97. ÄÃ³ lÃ  hai chá»‰ sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ káº¿t quáº£ trÃªn táº­p dá»¯ liá»‡u MRPC theo Ä‘iá»ƒm chuáº©n GLUE. Báº£ng trong <a href="https://arxiv.org/pdf/1810.04805.pdf" rel="nofollow">bÃ i bÃ¡o BERT</a> bÃ¡o cÃ¡o Ä‘iá»ƒm F1 lÃ  88.9 cho mÃ´ hÃ¬nh cÆ¡ sá»Ÿ. ÄÃ³ lÃ  mÃ´ hÃ¬nh <code>khÃ´ng phÃ¢n biá»‡t</code> viáº¿t hoa viáº¿t thÆ°á»ng trong khi chÃºng ta hiá»‡n Ä‘ang sá»­ dá»¥ng mÃ´ hÃ¬nh <code>cÃ³ phÃ¢n biá»‡t</code>, Ä‘iá»u nÃ y giáº£i thÃ­ch káº¿t quáº£ tá»‘t hÆ¡n.</p>
<p>Pháº§n nÃ y káº¿t thÃºc pháº§n giá»›i thiá»‡u vá» cÃ¡ch tinh chá»‰nh báº±ng Keras API. Má»™t vÃ­ dá»¥ vá» cÃ¡ch lÃ m nÃ y Ä‘á»‘i vá»›i háº§u háº¿t cÃ¡c tÃ¡c vá»¥ NLP phá»• biáº¿n sáº½ Ä‘Æ°á»£c Ä‘Æ°a ra trong <a href="/course/chapter7">ChÆ°Æ¡ng 7</a>. Náº¿u báº¡n muá»‘n trau dá»“i ká»¹ nÄƒng cá»§a mÃ¬nh trÃªn API Keras, hÃ£y cá»‘ gáº¯ng tinh chá»‰nh má»™t mÃ´ hÃ¬nh trÃªn táº­p dá»¯ liá»‡u GLUE SST-2, báº±ng cÃ¡ch sá»­ dá»¥ng xá»­ lÃ½ dá»¯ liá»‡u báº¡n Ä‘Ã£ thá»±c hiá»‡n trong pháº§n 2.</p>


		<script type="module" data-hydrate="yrsydu">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="yrsydu"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter3/3_tf.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
