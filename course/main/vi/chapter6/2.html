<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;hun-luyn-mt-tokenizer-mi-t-ci-c&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;tp-hp-mt-kho-ng-liu&quot;,&quot;title&quot;:&quot;Táº­p há»£p má»™t kho ngá»¯ liá»‡u&quot;},{&quot;local&quot;:&quot;hun-luyn-mt-tokenizer-mi&quot;,&quot;title&quot;:&quot;Huáº¥n luyá»‡n má»™t tokenizer má»›i&quot;},{&quot;local&quot;:&quot;lu-tokenizer&quot;,&quot;title&quot;:&quot;LÆ°u tokenizer&quot;}],&quot;title&quot;:&quot;Huáº¥n luyá»‡n má»™t tokenizer má»›i tá»« cÃ¡i cÅ©&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter6/2.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js"> 





<h1 class="relative group"><a id="hun-luyn-mt-tokenizer-mi-t-ci-c" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hun-luyn-mt-tokenizer-mi-t-ci-c"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Huáº¥n luyá»‡n má»™t tokenizer má»›i tá»« cÃ¡i cÅ©
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter6/section2.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter6/section2.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>Náº¿u mÃ´ hÃ¬nh ngÃ´n ngá»¯ khÃ´ng cÃ³ sáºµn ngÃ´n ngá»¯ báº¡n quan tÃ¢m hoáº·c náº¿u kho tÃ i liá»‡u cá»§a báº¡n ráº¥t khÃ¡c vá»›i kho mÃ  mÃ´ hÃ¬nh ngÃ´n ngá»¯ cá»§a báº¡n Ä‘Ã£ huáº¥n luyá»‡n, báº¡n ráº¥t cÃ³ thá»ƒ sáº½ muá»‘n huáº¥n luyá»‡n láº¡i mÃ´ hÃ¬nh tá»« Ä‘áº§u báº±ng cÃ¡ch sá»­ dá»¥ng trÃ¬nh tokenize phÃ¹ há»£p vá»›i dá»¯ liá»‡u cá»§a báº¡n. Äiá»u Ä‘Ã³ sáº½ yÃªu cáº§u huáº¥n luyá»‡n má»™t trÃ¬nh tokenize má»›i trÃªn táº­p dá»¯ liá»‡u cá»§a báº¡n. NhÆ°ng chÃ­nh xÃ¡c thÃ¬ Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  gÃ¬? Khi chÃºng ta láº§n Ä‘áº§u xem xÃ©t cÃ¡c tokenizer trong <a href="/course/chapter2">ChÆ°Æ¡ng 2</a>, chÃºng ta tháº¥y ráº±ng háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh Transformer sá»­ dá»¥ng thuáº­t toÃ¡n tokenize <em>tá»« phá»¥</em>. Äá»ƒ xÃ¡c Ä‘á»‹nh nhá»¯ng tá»« phá»¥ nÃ o Ä‘Æ°á»£c quan tÃ¢m vÃ  xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn nháº¥t trong kho ngá»¯ liá»‡u hiá»‡n cÃ³, trÃ¬nh tokenize cáº§n pháº£i xem xÃ©t ká»¹ táº¥t cáº£ cÃ¡c vÄƒn báº£n trong kho ngá»¯ liá»‡u - má»™t quÃ¡ trÃ¬nh mÃ  chÃºng ta gá»i lÃ  <em>huáº¥n luyá»‡n</em>. CÃ¡c quy táº¯c chi phá»‘i viá»‡c huáº¥n luyá»‡n nÃ y phá»¥ thuá»™c vÃ o loáº¡i tokenizer Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  chÃºng ta sáº½ xem xÃ©t ba thuáº­t toÃ¡n chÃ­nh á»Ÿ pháº§n sau cá»§a chÆ°Æ¡ng nÃ y.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/DJimQynXZsQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>âš ï¸ Huáº¥n luyá»‡n má»™t tokenizer khÃ´ng giá»‘ng nhÆ° huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh! Huáº¥n luyá»‡n mÃ´ hÃ¬nh sá»­ dá»¥ng giáº£m Ä‘á»™ dá»‘c ngáº«u nhiÃªn Ä‘á»ƒ lÃ m cho tá»•n tháº¥t nhá» hÆ¡n má»™t chÃºt cho má»—i Ä‘á»£t. NÃ³ Ä‘Æ°á»£c ngáº«u nhiÃªn hÃ³a bá»Ÿi tá»± nhiÃªn (cÃ³ nghÄ©a lÃ  báº¡n pháº£i Ä‘áº·t má»™t giÃ¡ trá»‹ seed Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»± khi thá»±c hiá»‡n cÃ¹ng thá»±c hiá»‡n huáº¥n luyá»‡n hai láº§n). Huáº¥n luyá»‡n má»™t trÃ¬nh tokenize lÃ  má»™t quy trÃ¬nh thá»‘ng kÃª cá»‘ gáº¯ng xÃ¡c Ä‘á»‹nh nhá»¯ng tá»« phá»¥ nÃ o tá»‘t nháº¥t Ä‘á»ƒ chá»n cho má»™t kho dá»¯ liá»‡u nháº¥t Ä‘á»‹nh, vÃ  cÃ¡c quy táº¯c Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»n chÃºng dá»±a trÃªn thuáº­t toÃ¡n tokenize. NÃ³ mang tÃ­nh cá»‘ Ä‘á»‹nh, nghÄ©a lÃ  báº¡n luÃ´n nháº­n Ä‘Æ°á»£c cÃ¹ng má»™t káº¿t quáº£ khi huáº¥n luyá»‡n vá»›i cÃ¹ng má»™t thuáº­t toÃ¡n trÃªn cÃ¹ng má»™t kho tÃ i liá»‡u.</p></div>
<h2 class="relative group"><a id="tp-hp-mt-kho-ng-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tp-hp-mt-kho-ng-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Táº­p há»£p má»™t kho ngá»¯ liá»‡u
	</span></h2>

<p>CÃ³ má»™t API ráº¥t Ä‘Æ¡n giáº£n trong ğŸ¤— Transformers mÃ  báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n má»™t tokenizer má»›i cÃ³ cÃ¹ng Ä‘áº·c Ä‘iá»ƒm vá»›i cÃ¡i hiá»‡n cÃ³: <code>AutoTokenizer.train_new_from_iterator()</code>. Äá»ƒ tháº¥y Ä‘iá»u nÃ y trong thá»±c táº¿, giáº£ sá»­ chÃºng ta muá»‘n huáº¥n luyá»‡n GPT-2 tá»« Ä‘áº§u, nhÆ°ng báº±ng má»™t ngÃ´n ngá»¯ khÃ¡c ngoÃ i tiáº¿ng Anh. Nhiá»‡m vá»¥ Ä‘áº§u tiÃªn cá»§a chÃºng ta sáº½ lÃ  thu tháº­p nhiá»u dá»¯ liá»‡u báº±ng ngÃ´n ngá»¯ Ä‘Ã³ trong má»™t kho dá»¯ liá»‡u huáº¥n luyá»‡n. Äá»ƒ cung cáº¥p cÃ¡c máº«u mÃ  má»i ngÆ°á»i cÃ³ hiá»ƒu Ä‘Æ°á»£c, chÃºng ta sáº½ khÃ´ng sá»­ dá»¥ng ngÃ´n ngá»¯ nhÆ° tiáº¿ng Nga hoáº·c tiáº¿ng Trung á»Ÿ Ä‘Ã¢y, mÃ  lÃ  ngÃ´n ngá»¯ tiáº¿ng Anh chuyÃªn dá»¥ng: Ä‘oáº¡n mÃ£ Python.</p>
<p>ThÆ° viá»‡n <a href="https://github.com/huggingface/datasets" rel="nofollow">ğŸ¤— Datasets</a> cÃ³ thá»ƒ giÃºp chÃºng ta táº­p há»£p má»™t kho dá»¯ liá»‡u mÃ£ nguá»“n Python. ChÃºng ta sáº½ sá»­ dá»¥ng hÃ m <code>load_dataset()</code> thÃ´ng thÆ°á»ng Ä‘á»ƒ táº£i xuá»‘ng vÃ  lÆ°u vÃ o bá»™ nhá»› cache cá»§a táº­p dá»¯ liá»‡u <a href="https://huggingface.co/datasets/code_search_net" rel="nofollow">CodeSearchNet</a>. Táº­p dá»¯ liá»‡u nÃ y Ä‘Æ°á»£c táº¡o cho <a href="https://wandb.ai/github/CodeSearchNet/benchmark" rel="nofollow">thá»­ thÃ¡ch CodeSearchNet</a> vÃ  chá»©a hÃ ng triá»‡u hÃ m tá»« cÃ¡c thÆ° viá»‡n mÃ£ nguá»“n má»Ÿ trÃªn GitHub báº±ng má»™t sá»‘ ngÃ´n ngá»¯ láº­p trÃ¬nh. á» Ä‘Ã¢y, chÃºng ta sáº½ táº£i pháº§n Python cá»§a táº­p dá»¯ liá»‡u nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

<span class="hljs-comment"># QuÃ¡ trÃ¬nh nÃ y cÃ³ thá»ƒ máº¥t má»™t vÃ i phÃºt Ä‘á»ƒ táº£i, vÃ¬ váº­y hÃ£y láº¥y cÃ  phÃª hoáº·c trÃ  trong khi chá» Ä‘á»£i!</span>
raw_datasets = load_dataset(<span class="hljs-string">&quot;code_search_net&quot;</span>, <span class="hljs-string">&quot;python&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ xem xÃ©t pháº§n tÃ¡ch huáº¥n luyá»‡n Ä‘á»ƒ xem ta cÃ³ quyá»n truy cáº­p vÃ o nhá»¯ng cá»™t nÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Dataset({
    features: [<span class="hljs-string">&#x27;repository_name&#x27;</span>, <span class="hljs-string">&#x27;func_path_in_repository&#x27;</span>, <span class="hljs-string">&#x27;func_name&#x27;</span>, <span class="hljs-string">&#x27;whole_func_string&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, 
      <span class="hljs-string">&#x27;func_code_string&#x27;</span>, <span class="hljs-string">&#x27;func_code_tokens&#x27;</span>, <span class="hljs-string">&#x27;func_documentation_string&#x27;</span>, <span class="hljs-string">&#x27;func_documentation_tokens&#x27;</span>, <span class="hljs-string">&#x27;split_name&#x27;</span>, 
      <span class="hljs-string">&#x27;func_code_url&#x27;</span>
    ],
    num_rows: <span class="hljs-number">412178</span>
})<!-- HTML_TAG_END --></pre></div>
<p>ChÃºng ta cÃ³ thá»ƒ tháº¥y táº­p dá»¯ liá»‡u tÃ¡ch chuá»—i tÃ i liá»‡u mÃ´ táº£ khá»i Ä‘oáº¡n mÃ£ vÃ  Ä‘á» xuáº¥t tokenize cáº£ hai. á» Ä‘Ã¢y, chÃºng ta sáº½ chá»‰ sá»­ dá»¥ng cá»™t <code>whole_func_string</code> Ä‘á»ƒ huáº¥n luyá»‡n trÃ¬nh tokenize. ChÃºng ta cÃ³ thá»ƒ xem xÃ©t máº«u má»™t trong nhá»¯ng hÃ m nÃ y báº±ng cÃ¡ch láº­p chá»‰ má»¥c vÃ o pháº§n <code>train</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">123456</span>][<span class="hljs-string">&quot;whole_func_string&quot;</span>])<!-- HTML_TAG_END --></pre></div>
<p>nÃ³ nÃªn tráº£ vá» káº¿t quáº£ nhÆ° dÆ°á»›i Ä‘Ã¢y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_simple_responses</span>(<span class="hljs-params">
      self, timeout_ms=<span class="hljs-literal">None</span>, info_cb=DEFAULT_MESSAGE_CALLBACK</span>):
    <span class="hljs-string">&quot;&quot;&quot;Accepts normal responses from the device.

    Args:
      timeout_ms: Timeout in milliseconds to wait for each response.
      info_cb: Optional callback for text sent from the bootloader.

    Returns:
      OKAY packet&#x27;s message.
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> self._accept_responses(<span class="hljs-string">&#x27;OKAY&#x27;</span>, info_cb, timeout_ms=timeout_ms)<!-- HTML_TAG_END --></pre></div>
<p>Äiá»u Ä‘áº§u tiÃªn chÃºng ta cáº§n lÃ m lÃ  chuyá»ƒn Ä‘á»•i táº­p dá»¯ liá»‡u thÃ nh má»™t <em>iterator</em> danh sÃ¡ch cÃ¡c vÄƒn báº£n - vÃ­ dá»¥, má»™t danh sÃ¡ch cÃ¡c vÄƒn báº£n. Viá»‡c sá»­ dá»¥ng danh sÃ¡ch vÄƒn báº£n sáº½ cho phÃ©p tokenizer hoáº¡t Ä‘á»™ng nhanh hÆ¡n (huáº¥n luyá»‡n hÃ ng loáº¡t vÄƒn báº£n thay vÃ¬ xá»­ lÃ½ tá»«ng vÄƒn báº£n riÃªng láº») vÃ  nÃ³ pháº£i lÃ  má»™t trÃ¬nh láº·p náº¿u chÃºng ta muá»‘n trÃ¡nh cÃ³ má»i thá»© trong bá»™ nhá»› cÃ¹ng má»™t lÃºc. Náº¿u kho dá»¯ liá»‡u cá»§a báº¡n lá»›n, báº¡n sáº½ muá»‘n táº­n dá»¥ng lá»£i tháº¿ thá»±c tiá»…n lÃ  ğŸ¤— Datasets khÃ´ng táº£i má»i thá»© vÃ o RAM mÃ  lÆ°u trá»¯ cÃ¡c pháº§n tá»­ cá»§a táº­p dá»¯ liá»‡u trÃªn Ä‘Ä©a.</p>
<p>LÃ m nhÆ° sau sáº½ táº¡o má»™t danh sÃ¡ch cÃ¡c danh sÃ¡ch vá»›i má»—i danh sÃ¡ch gá»“m 1,000 vÄƒn báº£n, nhÆ°ng sáº½ táº£i má»i thá»© vÃ o bá»™ nhá»›:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-comment"># Äá»«ng bá» ghi chÃº dÃ²ng bÃªn dÆ°á»›i trá»« khi táº­p dá»¯ liá»‡u cá»§a báº¡n nhá»!</span>
<span class="hljs-comment"># training_corpus = [raw_datasets[&quot;train&quot;][i: i + 1000][&quot;whole_func_string&quot;] for i in range(0, len(raw_datasets[&quot;train&quot;]), 1000)]</span><!-- HTML_TAG_END --></pre></div>
<p>Sá»­ dá»¥ng trÃ¬nh táº¡o Python, chÃºng ta cÃ³ thá»ƒ trÃ¡nh viá»‡c Python táº£i báº¥t ká»³ thá»© gÃ¬ vÃ o bá»™ nhá»› cho Ä‘áº¿n khi nÃ³ thá»±c sá»± cáº§n thiáº¿t. Äá»ƒ táº¡o má»™t trÃ¬nh táº¡o nhÆ° váº­y, báº¡n chá»‰ cáº§n thay dáº¥u ngoáº·c vuÃ´ng báº±ng dáº¥u ngoáº·c Ä‘Æ¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->training_corpus = (
    raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][i : i + <span class="hljs-number">1000</span>][<span class="hljs-string">&quot;whole_func_string&quot;</span>]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-number">1000</span>)
)<!-- HTML_TAG_END --></pre></div>
<p>DÃ²ng mÃ£ nÃ y khÃ´ng tÃ¬m náº¡p báº¥t ká»³ pháº§n tá»­ nÃ o cá»§a táº­p dá»¯ liá»‡u; nÃ³ chá»‰ táº¡o má»™t Ä‘á»‘i tÆ°á»£ng mÃ  báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng trong vÃ²ng láº·p Python <code>for</code>. CÃ¡c vÄƒn báº£n sáº½ chá»‰ Ä‘Æ°á»£c táº£i khi báº¡n cáº§n (nghÄ©a lÃ  khi báº¡n Ä‘ang á»Ÿ bÆ°á»›c cá»§a vÃ²ng láº·p <code>for</code> mÃ  yÃªu cáº§u chÃºng) vÃ  chá»‰ 1,000 vÄƒn báº£n sáº½ Ä‘Æ°á»£c táº£i má»—i láº§n. Báº±ng cÃ¡ch nÃ y, báº¡n sáº½ khÃ´ng sá»­ dá»¥ng háº¿t bá»™ nhá»› cá»§a mÃ¬nh ngay cáº£ khi báº¡n Ä‘ang xá»­ lÃ½ má»™t táº­p dá»¯ liá»‡u lá»›n.</p>
<p>Váº¥n Ä‘á» vá»›i má»™t Ä‘á»‘i tÆ°á»£ng táº¡o lÃ  nÃ³ chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng má»™t láº§n. VÃ¬ váº­y, thay vÃ¬ Ä‘iá»u nÃ y cho ta danh sÃ¡ch 10 chá»¯ sá»‘ Ä‘áº§u tiÃªn hai láº§n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->gen = (i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(gen))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">list</span>(gen))<!-- HTML_TAG_END --></pre></div>
<p>chÃºng ta cÃ³ thá»ƒ láº¥y chÃºng trong má»™t láº§n vÃ  sau Ä‘Ã³ danh sÃ¡ng sáº½ trá»‘ng:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]
[]<!-- HTML_TAG_END --></pre></div>
<p>ÄÃ³ lÃ  lÃ­ do chÃºng ta Ä‘á»‹nh nghÄ©a má»™t hÃ m thay vÃ o Ä‘Ã³ tráº£ vá» má»™t trÃ¬nh táº¡o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_training_corpus</span>():
    <span class="hljs-keyword">return</span> (
        raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][i : i + <span class="hljs-number">1000</span>][<span class="hljs-string">&quot;whole_func_string&quot;</span>]
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-number">1000</span>)
    )


training_corpus = get_training_corpus()<!-- HTML_TAG_END --></pre></div>
<p>Ta cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a trÃ¬nh táº¡o bÃªn trong vÃ²ng láº·p <code>for</code> sá»­ dá»¥ng <code>yield</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_training_corpus</span>():
    dataset = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]
    <span class="hljs-keyword">for</span> start_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(dataset), <span class="hljs-number">1000</span>):
        samples = dataset[start_idx : start_idx + <span class="hljs-number">1000</span>]
        <span class="hljs-keyword">yield</span> samples[<span class="hljs-string">&quot;whole_func_string&quot;</span>]<!-- HTML_TAG_END --></pre></div>
<p>sáº½ táº¡o ra trÃ¬nh táº¡o hoÃ n toÃ n giá»‘ng nhÆ° trÆ°á»›c Ä‘Ã¢y, nhÆ°ng cho phÃ©p báº¡n sá»­ dá»¥ng logic phá»©c táº¡p hÆ¡n báº¡n cÃ³ thá»ƒ trong má»™t bao hÃ m.</p>
<h2 class="relative group"><a id="hun-luyn-mt-tokenizer-mi" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hun-luyn-mt-tokenizer-mi"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Huáº¥n luyá»‡n má»™t tokenizer má»›i
	</span></h2>

<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ kho vÄƒn báº£n cá»§a mÃ¬nh dÆ°á»›i dáº¡ng má»™t trÃ¬nh láº·p cÃ¡c loáº¡t vÄƒn báº£n, chÃºng ta Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n má»™t trÃ¬nh tokenize má»›i. Äá»ƒ thá»±c hiá»‡n viá»‡c nÃ y, trÆ°á»›c tiÃªn chÃºng ta cáº§n táº£i tokenizer mÃ  chÃºng ta muá»‘n ghÃ©p ná»‘i vá»›i mÃ´ hÃ¬nh cá»§a mÃ¬nh (á»Ÿ Ä‘Ã¢y, GPT-2):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

old_tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;gpt2&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Máº·c dÃ¹ chÃºng ta sáº½ huáº¥n luyá»‡n má»™t tokenizer, nhÆ°ng báº¡n nÃªn lÃ m Ä‘iá»u nÃ y Ä‘á»ƒ trÃ¡nh báº¯t Ä‘áº§u hoÃ n toÃ n tá»« Ä‘áº§u. Báº±ng cÃ¡ch nÃ y, chÃºng ta sáº½ khÃ´ng pháº£i chá»‰ Ä‘á»‹nh báº¥t ká»³ Ä‘iá»u gÃ¬ vá» thuáº­t toÃ¡n tokenize hoáº·c cÃ¡c token Ä‘áº·c biá»‡t mÃ  ta muá»‘n sá»­ dá»¥ng; tokenizer má»›i sáº½ giá»‘ng há»‡t nhÆ° GPT-2 vÃ  Ä‘iá»u duy nháº¥t sáº½ thay Ä‘á»•i lÃ  tá»« vá»±ng, sáº½ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi quÃ¡ trÃ¬nh huáº¥n luyá»‡n trÃªn kho ngá»¯ liá»‡u cá»§a chÃºng tÃ´i.</p>
<p>Äáº§u tiÃªn, chÃºng ta hÃ£y xem cÃ¡ch mÃ  tokenizer nÃ y sáº½ xá»­ lÃ½ má»™t hÃ m máº«u tháº¿ nÃ o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->example = <span class="hljs-string">&#x27;&#x27;&#x27;def add_numbers(a, b):
    &quot;&quot;&quot;Add the two numbers `a` and `b`.&quot;&quot;&quot;
    return a + b&#x27;&#x27;&#x27;</span>

tokens = old_tokenizer.tokenize(example)
tokens<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;def&#x27;</span>, <span class="hljs-string">&#x27;Ä add&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;umbers&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;Ä b&#x27;</span>, <span class="hljs-string">&#x27;):&#x27;</span>, <span class="hljs-string">&#x27;ÄŠ&#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &quot;&quot;&quot;&#x27;</span>, <span class="hljs-string">&#x27;Add&#x27;</span>, <span class="hljs-string">&#x27;Ä the&#x27;</span>, <span class="hljs-string">&#x27;Ä two&#x27;</span>,
 <span class="hljs-string">&#x27;Ä numbers&#x27;</span>, <span class="hljs-string">&#x27;Ä `&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;Ä and&#x27;</span>, <span class="hljs-string">&#x27;Ä `&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;.&quot;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&quot;&#x27;</span>, <span class="hljs-string">&#x27;ÄŠ&#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä return&#x27;</span>, <span class="hljs-string">&#x27;Ä a&#x27;</span>, <span class="hljs-string">&#x27;Ä +&#x27;</span>, <span class="hljs-string">&#x27;Ä b&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>Tokenizer nÃ y cÃ³ má»™t sá»‘ kÃ½ hiá»‡u Ä‘áº·c biá»‡t, nhÆ° <code>Ä </code> vÃ  <code>ÄŠ</code>, tÆ°Æ¡ng á»©ng biá»ƒu thá»‹ dáº¥u cÃ¡ch vÃ  dÃ²ng má»›i. NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, Ä‘iá»u nÃ y khÃ´ng quÃ¡ hiá»‡u quáº£: tokenizer tráº£ vá» cÃ¡c mÃ£ thÃ´ng bÃ¡o riÃªng láº» cho tá»«ng khoáº£ng tráº¯ng, khi nÃ³ cÃ³ thá»ƒ nhÃ³m cÃ¡c má»©c thá»¥t lá» láº¡i vá»›i nhau (vÃ¬ cÃ³ bá»™ bá»‘n hoáº·c tÃ¡m dáº¥u cÃ¡ch sáº½ ráº¥t phá»• biáº¿n trong mÃ£). NÃ³ cÅ©ng tÃ¡ch tÃªn hÃ m hÆ¡i ká»³ láº¡, nhÃ¬n khÃ´ng quen cÃ¡c tá»« cÃ³ kÃ½ tá»± <code>_</code>.</p>
<p>HÃ£y huáº¥n luyá»‡n má»™t tokenizer má»›i vÃ  xem liá»‡u nÃ³ cÃ³ giáº£i quyáº¿t Ä‘Æ°á»£c nhá»¯ng váº¥n Ä‘á» Ä‘Ã³ khÃ´ng. Äá»‘i vá»›i Ä‘iá»u nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng phÆ°Æ¡ng thá»©c <code>train_new_from_iterator()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer = old_tokenizer.train_new_from_iterator(training_corpus, <span class="hljs-number">52000</span>)<!-- HTML_TAG_END --></pre></div>
<p>Lá»‡nh nÃ y cÃ³ thá»ƒ máº¥t má»™t chÃºt thá»i gian náº¿u kho dá»¯ liá»‡u cá»§a báº¡n ráº¥t lá»›n, nhÆ°ng Ä‘á»‘i vá»›i táº­p dá»¯ liá»‡u 1.6GB vÄƒn báº£n nÃ y, nÃ³ ráº¥t nhanh (1 phÃºt 16 giÃ¢y trÃªn CPU AMD Ryzen 9 3900X vá»›i 12 lÃµi).</p>
<p>LÆ°u Ã½ ráº±ng <code>AutoTokenizer.train_new_from_iterator()</code> chá»‰ hoáº¡t Ä‘á»™ng náº¿u tokenizer báº¡n Ä‘ang sá»­ dá»¥ng lÃ  tokenizer â€œnhanhâ€. NhÆ° báº¡n sáº½ tháº¥y trong pháº§n tiáº¿p theo, thÆ° viá»‡n ğŸ¤— Transformers chá»©a hai loáº¡i tokenizers: má»™t sá»‘ Ä‘Æ°á»£c viáº¿t hoÃ n toÃ n báº±ng Python vÃ  nhá»¯ng loáº¡i khÃ¡c (loáº¡i nhanh) Ä‘Æ°á»£c há»— trá»£ bá»Ÿi thÆ° viá»‡n ğŸ¤— Tokenizers, Ä‘Æ°á»£c viáº¿t báº±ng ngÃ´n ngá»¯ láº­p trÃ¬nh <a href="https://www.rust-lang.org" rel="nofollow">Rust</a>. Python lÃ  ngÃ´n ngá»¯ thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng nháº¥t cho cÃ¡c á»©ng dá»¥ng khoa há»c dá»¯ liá»‡u vÃ  há»c sÃ¢u, nhÆ°ng khi báº¥t ká»³ thá»© gÃ¬ cáº§n Ä‘Æ°á»£c song song hÃ³a cho nhanh, nÃ³ pháº£i Ä‘Æ°á»£c viáº¿t báº±ng má»™t ngÃ´n ngá»¯ khÃ¡c. VÃ­ dá»¥, cÃ¡c phÃ©p nhÃ¢n ma tráº­n lÃ  cá»‘t lÃµi cá»§a tÃ­nh toÃ¡n mÃ´ hÃ¬nh Ä‘Æ°á»£c viáº¿t báº±ng CUDA, má»™t thÆ° viá»‡n C Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a cho GPU.</p>
<p>Viá»‡c huáº¥n luyá»‡n má»™t tokenizer hoÃ n toÃ n má»›i báº±ng Python thuáº§n tÃºy sáº½ ráº¥t cháº­m, Ä‘Ã³ lÃ  lÃ½ do táº¡i sao chÃºng tÃ´i Ä‘Ã£ phÃ¡t triá»ƒn thÆ° viá»‡n ğŸ¤— Tokenizer. LÆ°u Ã½ ráº±ng cÅ©ng giá»‘ng nhÆ° báº¡n khÃ´ng pháº£i há»c ngÃ´n ngá»¯ CUDA Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi mÃ´ hÃ¬nh cá»§a mÃ¬nh trÃªn má»™t loáº¡t Ä‘áº§u vÃ o trÃªn GPU, báº¡n sáº½ khÃ´ng cáº§n pháº£i há»c Rust Ä‘á»ƒ sá»­ dá»¥ng trÃ¬nh tokenizer nhanh. ThÆ° viá»‡n ğŸ¤— Tokenizers cung cáº¥p cÃ¡c liÃªn káº¿t Python cho nhiá»u phÆ°Æ¡ng thá»©c gá»i ná»™i bá»™ má»™t sá»‘ Ä‘oáº¡n mÃ£ trong Rust; vÃ­ dá»¥: Ä‘á»ƒ song song huáº¥n luyá»‡n trÃ¬nh tokenize má»›i cá»§a báº¡n hoáº·c, nhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong <a href="/course/chapter3">ChÆ°Æ¡ng 3</a>, tokenize má»™t loáº¡t Ä‘áº§u vÃ o.</p>
<p>Háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh Transformer Ä‘á»u cÃ³ sáºµn cÃ´ng cá»¥ tokenize nhanh (cÃ³ má»™t sá»‘ ngoáº¡i lá»‡ mÃ  báº¡n cÃ³ thá»ƒ kiá»ƒm tra <a href="https://huggingface.co/transformers/#supported-frameworks" rel="nofollow">táº¡i Ä‘Ã¢y</a>) vÃ  API <code>AutoTokenizer</code> luÃ´n chá»n tá»‘c tokenizer nhanh cho báº¡n náº¿u nÃ³ cÃ³ sáºµn. Trong pháº§n tiáº¿p theo, chÃºng ta sáº½ xem xÃ©t má»™t sá»‘ tÃ­nh nÄƒng Ä‘áº·c biá»‡t khÃ¡c mÃ  cÃ¡c tokenize nhanh cÃ³ mÃ  thá»±c sá»± há»¯u Ã­ch cho cÃ¡c tÃ¡c vá»¥ nhÆ° phÃ¢n loáº¡i token vÃ  há»i Ä‘Ã¡p. Tuy nhiÃªn, trÆ°á»›c khi Ä‘i sÃ¢u vÃ o váº¥n Ä‘á» Ä‘Ã³, chÃºng ta hÃ£y thá»­ tokenizer hoÃ n toÃ n má»›i cá»§a chÃºng ta trÃªn máº«u trÆ°á»›c:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokens = tokenizer.tokenize(example)
tokens<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;def&#x27;</span>, <span class="hljs-string">&#x27;Ä add&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;numbers&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;Ä b&#x27;</span>, <span class="hljs-string">&#x27;):&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä &quot;&quot;&quot;&#x27;</span>, <span class="hljs-string">&#x27;Add&#x27;</span>, <span class="hljs-string">&#x27;Ä the&#x27;</span>, <span class="hljs-string">&#x27;Ä two&#x27;</span>, <span class="hljs-string">&#x27;Ä numbers&#x27;</span>, <span class="hljs-string">&#x27;Ä `&#x27;</span>,
 <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;Ä and&#x27;</span>, <span class="hljs-string">&#x27;Ä `&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;`.&quot;&quot;&quot;&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä return&#x27;</span>, <span class="hljs-string">&#x27;Ä a&#x27;</span>, <span class="hljs-string">&#x27;Ä +&#x27;</span>, <span class="hljs-string">&#x27;Ä b&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>á» Ä‘Ã¢y chÃºng ta láº¡i tháº¥y cÃ¡c kÃ½ hiá»‡u Ä‘áº·c biá»‡t <code>Ä </code> vÃ  <code>ÄŠ</code> biá»ƒu thá»‹ dáº¥u cÃ¡ch vÃ  dÃ²ng má»›i, nhÆ°ng chÃºng ta cÅ©ng cÃ³ thá»ƒ tháº¥y ráº±ng trÃ¬nh tokenize Ä‘Ã£ há»c Ä‘Æ°á»£c má»™t sá»‘ token ráº¥t cá»¥ thá»ƒ cho má»™t kho cÃ¡c hÃ m Python: vÃ­ dá»¥: cÃ³ má»™t token <code>ÄŠÄ Ä Ä </code> Ä‘áº¡i diá»‡n cho má»™t thá»¥t lá» vÃ  token <code>Ä &quot;&quot;&quot;</code> Ä‘áº¡i diá»‡n cho ba dáº¥u ngoáº·c kÃ©p báº¯t Ä‘áº§u má»™t chuá»—i tÃ i liá»‡u. Tokenizer cÅ©ng phÃ¢n chia chÃ­nh xÃ¡c tÃªn hÃ m trÃªn <code>_</code>. ÄÃ¢y lÃ  má»™t biá»…u diá»…n khÃ¡ nhá» gá»n; tÆ°Æ¡ng Ä‘á»‘i, sá»­ dá»¥ng tokenizer Ä‘Æ¡n giáº£n báº±ng tiáº¿ng Anh trÃªn cÃ¹ng má»™t máº«u sáº½ cho ta má»™t cÃ¢u dÃ i hÆ¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(tokens))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(old_tokenizer.tokenize(example)))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">27</span>
<span class="hljs-number">36</span><!-- HTML_TAG_END --></pre></div>
<p>HÃ£y cÃ¹ng nhÃ¬n vÃ o vÃ­ dá»¥ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->example = <span class="hljs-string">&quot;&quot;&quot;class LinearLayer():
    def __init__(self, input_size, output_size):
        self.weight = torch.randn(input_size, output_size)
        self.bias = torch.zeros(output_size)

    def __call__(self, x):
        return x @ self.weights + self.bias
    &quot;&quot;&quot;</span>
tokenizer.tokenize(example)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;class&#x27;</span>, <span class="hljs-string">&#x27;Ä Linear&#x27;</span>, <span class="hljs-string">&#x27;Layer&#x27;</span>, <span class="hljs-string">&#x27;():&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä def&#x27;</span>, <span class="hljs-string">&#x27;Ä __&#x27;</span>, <span class="hljs-string">&#x27;init&#x27;</span>, <span class="hljs-string">&#x27;__(&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;Ä input&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;size&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>,
 <span class="hljs-string">&#x27;Ä output&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;size&#x27;</span>, <span class="hljs-string">&#x27;):&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä Ä Ä Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä self&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;weight&#x27;</span>, <span class="hljs-string">&#x27;Ä =&#x27;</span>, <span class="hljs-string">&#x27;Ä torch&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;randn&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>,
 <span class="hljs-string">&#x27;size&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;Ä output&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;size&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä Ä Ä Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä self&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;bias&#x27;</span>, <span class="hljs-string">&#x27;Ä =&#x27;</span>, <span class="hljs-string">&#x27;Ä torch&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;zeros&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>,
 <span class="hljs-string">&#x27;output&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;size&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄŠÄ Ä Ä &#x27;</span>, <span class="hljs-string">&#x27;Ä def&#x27;</span>, <span class="hljs-string">&#x27;Ä __&#x27;</span>, <span class="hljs-string">&#x27;call&#x27;</span>, <span class="hljs-string">&#x27;__(&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;Ä x&#x27;</span>, <span class="hljs-string">&#x27;):&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä Ä Ä Ä Ä &#x27;</span>,
 <span class="hljs-string">&#x27;Ä return&#x27;</span>, <span class="hljs-string">&#x27;Ä x&#x27;</span>, <span class="hljs-string">&#x27;Ä @&#x27;</span>, <span class="hljs-string">&#x27;Ä self&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;weights&#x27;</span>, <span class="hljs-string">&#x27;Ä +&#x27;</span>, <span class="hljs-string">&#x27;Ä self&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;bias&#x27;</span>, <span class="hljs-string">&#x27;ÄŠÄ Ä Ä Ä &#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>NgoÃ i token tÆ°Æ¡ng á»©ng vá»›i thá»¥t lá», á»Ÿ Ä‘Ã¢y chÃºng ta cÅ©ng cÃ³ thá»ƒ tháº¥y token cho thá»¥t lá» kÃ©p:<code>ÄŠÄ Ä Ä Ä Ä Ä Ä </code>. CÃ¡c tá»« Ä‘áº·c biá»‡t trong Python nhÆ° <code>class</code>, <code>init</code>, <code>call</code>, <code>self</code>, vÃ  <code>return</code>, má»—i tá»« Ä‘Æ°á»£c tokenize thÃ nh má»™t token vÃ  chÃºng ta cÃ³ thá»ƒ tháº¥y cÅ©ng nhÆ° tÃ¡ch <code>_</code>  vÃ  <code>.</code>,  tokenizer phÃ¢n chia chÃ­nh xÃ¡c cÃ¡c tÃªn: <code>LinearLayer</code> Ä‘Æ°á»£c tokenize lÃ  <code>[&quot;Ä Linear&quot;, &quot;Layer&quot;]</code>.</p>
<h2 class="relative group"><a id="lu-tokenizer" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#lu-tokenizer"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>LÆ°u tokenizer
	</span></h2>

<p>Äá»ƒ Ä‘áº£m báº£o ráº±ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ sau nÃ y, chÃºng ta cáº§n pháº£i lÆ°u tokenizer má»›i cá»§a mÃ¬nh. Giá»‘ng nhÆ° Ä‘á»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh, Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i phÆ°Æ¡ng thá»©c <code>save_pretrained()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.save_pretrained(<span class="hljs-string">&quot;code-search-net-tokenizer&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Thao tÃ¡c nÃ y sáº½ táº¡o má»™t thÆ° má»¥c má»›i cÃ³ tÃªn <em>code-search-net-tokenizer</em>, sáº½ chá»©a táº¥t cáº£ cÃ¡c tá»‡p mÃ  tokenizer cáº§n Ä‘Æ°á»£c táº£i láº¡i. Náº¿u báº¡n muá»‘n chia sáº» tokenizer nÃ y vá»›i Ä‘á»“ng nghiá»‡p vÃ  báº¡n bÃ¨ cá»§a mÃ¬nh, báº¡n cÃ³ thá»ƒ táº£i nÃ³ lÃªn Hub báº±ng cÃ¡ch Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n cá»§a mÃ¬nh. Náº¿u báº¡n Ä‘ang lÃ m viá»‡c trÃªn notebook, cÃ³ má»™t hÃ m tiá»‡n Ã­ch giÃºp báº¡n lÃ m Ä‘iá»u nÃ y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>Thao tÃ¡c nÃ y sáº½ hiá»ƒn thá»‹ má»™t tiá»‡n Ã­ch mÃ  báº¡n cÃ³ thá»ƒ nháº­p thÃ´ng tin Ä‘Äƒng nháº­p Hugging Face cá»§a mÃ¬nh. Náº¿u báº¡n khÃ´ng lÃ m viá»‡c trong notebook, chá»‰ cáº§n nháº­p dÃ²ng sau vÃ o thiáº¿t bá»‹ Ä‘áº§u cuá»‘i cá»§a báº¡n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-cli login<!-- HTML_TAG_END --></pre></div>
<p>Khi báº¡n Ä‘Ã£ Ä‘Äƒng nháº­p, báº¡n cÃ³ thá»ƒ Ä‘áº©y tokenizer cá»§a mÃ¬nh báº±ng cÃ¡ch thá»±c hiá»‡n lá»‡nh sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.push_to_hub(<span class="hljs-string">&quot;code-search-net-tokenizer&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Thao tÃ¡c nÃ y sáº½ táº¡o má»™t kho lÆ°u trá»¯ má»›i trong khÃ´ng gian tÃªn cá»§a báº¡n vá»›i tÃªn <code>code-search-net-tokenizer</code>, chá»©a tá»‡p tokenizer. Sau Ä‘Ã³ báº¡n cÃ³ thá»ƒ táº£i tokenizer tá»« báº¥t kÃ¬ Ä‘Ã¢u vá»›i phÆ°Æ¡ng thá»©c <code>from_pretrained()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-comment"># Thay &quot;huggingface-course&quot; dÆ°á»›i Ä‘áº¥y vá»›i tÃªn khÃ´ng gian thá»±c sá»± sá»­ dá»¥ng tokenizer riÃªng cá»§a báº¡n</span>
tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;huggingface-course/code-search-net-tokenizer&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Giá» báº¡n Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»« Ä‘áº§u vÃ  viá»‡c tinh chá»‰nh nÃ³ trong táº§m tay cá»§a báº¡n! ChÃºng ta sáº½ tÃ¬m hiá»ƒu Ä‘iá»u Ä‘Ã³ trong <a href="/course/chap7">ChÆ°Æ¡ng 7</a>, nhÆ°ng trÆ°á»›c tiÃªn, trong pháº§n cÃ²n láº¡i cá»§a chÆ°Æ¡ng nÃ y, chÃºng ta sáº½ xem xÃ©t ká»¹ hÆ¡n vá» cÃ¡c trÃ¬nh tokenize nhanh vÃ  khÃ¡m phÃ¡ chi tiáº¿t nhá»¯ng gÃ¬ thá»±c sá»± xáº£y ra khi chÃºng ta gá»i phÆ°Æ¡ng thá»©c <code>train_new_from_iterator()</code>.</p>


		<script type="module" data-hydrate="e0rvh7">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="e0rvh7"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter6/2.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
