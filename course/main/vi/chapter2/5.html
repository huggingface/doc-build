<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;x-l-a-chui&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;m-hnh-k-vng-mt-l-cc-u-vo&quot;,&quot;title&quot;:&quot;MÃ´ hÃ¬nh kÃ¬ vá»ng má»™t lÃ´ cÃ¡c Ä‘áº§u vÃ o&quot;},{&quot;local&quot;:&quot;m-thm-vo-u-vo&quot;,&quot;title&quot;:&quot;ÄÃªm thÃªm vÃ o Ä‘áº§u vÃ o&quot;},{&quot;local&quot;:&quot;attention-masks&quot;,&quot;title&quot;:&quot;Attention masks&quot;},{&quot;local&quot;:&quot;nhng-chui-di-hn&quot;,&quot;title&quot;:&quot;Nhá»¯ng chuá»—i dÃ i hÆ¡n&quot;}],&quot;title&quot;:&quot;Xá»­ lÃ½ Ä‘a chuá»—i&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/pages/chapter2/5.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="x-l-a-chui" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#x-l-a-chui"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Xá»­ lÃ½ Ä‘a chuá»—i
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter2/section5_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter2/section5_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/M6adb1j2jPI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Trong pháº§n trÆ°á»›c, chÃºng ta Ä‘Ã£ khÃ¡m phÃ¡ cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng Ä‘Æ¡n giáº£n nháº¥t: thá»±c hiá»‡n luáº­n suy trÃªn má»™t dÃ£y Ä‘Æ¡n cÃ³ Ä‘á»™ dÃ i nhá». Tuy nhiÃªn, má»™t sá»‘ cÃ¢u há»i Ä‘Æ°á»£c Ä‘á» cáº­p nhÆ°:</p>
<ul><li>LÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta xá»­ lÃ½ nhiá»u chuá»—i?</li>
<li>LÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta xá»­ lÃ½ nhiá»u chuá»—i <em>cÃ³ Ä‘á»™ dÃ i khÃ¡c nhau</em>?</li>
<li>CÃ¡c chá»‰ sá»‘ tá»« vá»±ng cÃ³ pháº£i lÃ  Ä‘áº§u vÃ o duy nháº¥t cho phÃ©p má»™t mÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng tá»‘t khÃ´ng?</li>
<li>Náº¿u nhÆ° má»™t chuá»—i quÃ¡ dÃ i thÃ¬ sao?</li></ul>
<p>HÃ£y xem nhá»¯ng cÃ¢u há»i nÃ y Ä‘áº·t ra nhá»¯ng loáº¡i váº¥n Ä‘á» nÃ o vÃ  cÃ¡ch chÃºng tÃ´i cÃ³ thá»ƒ giáº£i quyáº¿t chÃºng báº±ng cÃ¡ch sá»­ dá»¥ng API ğŸ¤— Transformers.</p>
<h2 class="relative group"><a id="m-hnh-k-vng-mt-l-cc-u-vo" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#m-hnh-k-vng-mt-l-cc-u-vo"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>MÃ´ hÃ¬nh kÃ¬ vá»ng má»™t lÃ´ cÃ¡c Ä‘áº§u vÃ o
	</span></h2>

<p>Trong bÃ i táº­p trÆ°á»›c, báº¡n Ä‘Ã£ tháº¥y cÃ¡ch cÃ¡c chuá»—i Ä‘Æ°á»£c chuyá»ƒn thÃ nh danh sÃ¡ch cÃ¡c sá»‘. HÃ£y chuyá»ƒn Ä‘á»•i danh sÃ¡ch cÃ¡c sá»‘ nÃ y thÃ nh má»™t tensor vÃ  gá»­i nÃ³ Ä‘áº¿n mÃ´ hÃ¬nh:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, AutoModelForSequenceClassification

checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased-finetuned-sst-2-english&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence = <span class="hljs-string">&quot;I&#x27;ve been waiting for a HuggingFace course my whole life.&quot;</span>

tokens = tokenizer.tokenize(sequence)
ids = tokenizer.convert_tokens_to_ids(tokens)
input_ids = torch.tensor(ids)
<span class="hljs-comment"># This line will fail.</span>
model(input_ids)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->IndexError: Dimension out of <span class="hljs-built_in">range</span> (expected to be <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> of [-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], but got <span class="hljs-number">1</span>)<!-- HTML_TAG_END --></pre></div>
<p>Ã”i khÃ´ng! Táº¡i sao Ä‘oáº¡n mÃ£ láº¡i khÃ´ng thÃ nh cÃ´ng? ChÃºng ta Ä‘Ã£ lÃ m theo cÃ¡c bÆ°á»›c tá»« pipeline trong pháº§n 2.</p>
<p>Váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y Ä‘Ã³ lÃ  chÃºng ta Ä‘Ã£ gá»­i má»™t chuá»—i Ä‘Æ¡n cho mÃ´ hÃ¬nh, trong khi mÃ´ hÃ¬nh ğŸ¤— Transformers mong Ä‘á»£i nhiá»u cÃ¢u theo máº·c Ä‘á»‹nh. á» Ä‘Ã¢y, chÃºng ta Ä‘Ã£ cá»‘ gáº¯ng thá»±c hiá»‡n má»i thá»© mÃ  tokenizer Ä‘Ã£ lÃ m á»Ÿ phÃ­a sau khi Ã¡p dá»¥ng nÃ³ vÃ o má»™t <code>chuá»—i</code>, nhÆ°ng náº¿u báº¡n nhÃ¬n ká»¹, báº¡n sáº½ tháº¥y ráº±ng nÃ³ khÃ´ng chá»‰ chuyá»ƒn Ä‘á»•i danh sÃ¡ch ID Ä‘áº§u vÃ o thÃ nh má»™t tensor, nÃ³  cÃ²n thÃªm má»™t chiá»u lÃªn trÃªn:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_inputs = tokenizer(sequence, return_tensors=<span class="hljs-string">&quot;pt&quot;</span>)
<span class="hljs-built_in">print</span>(tokenized_inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tensor([[  <span class="hljs-number">101</span>,  <span class="hljs-number">1045</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">2310</span>,  <span class="hljs-number">2042</span>,  <span class="hljs-number">3403</span>,  <span class="hljs-number">2005</span>,  <span class="hljs-number">1037</span>, <span class="hljs-number">17662</span>, <span class="hljs-number">12172</span>,
          <span class="hljs-number">2607</span>,  <span class="hljs-number">2026</span>,  <span class="hljs-number">2878</span>,  <span class="hljs-number">2166</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>]])<!-- HTML_TAG_END --></pre></div>
<p>HÃ£y cÅ©ng thá»­ láº¡i vÃ  thÃªm má»™t chiá»u má»›i:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, AutoModelForSequenceClassification

checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased-finetuned-sst-2-english&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence = <span class="hljs-string">&quot;I&#x27;ve been waiting for a HuggingFace course my whole life.&quot;</span>

tokens = tokenizer.tokenize(sequence)
ids = tokenizer.convert_tokens_to_ids(tokens)

input_ids = torch.tensor([ids])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Input IDs:&quot;</span>, input_ids)

output = model(input_ids)
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Logits:&quot;</span>, output.logits)<!-- HTML_TAG_END --></pre></div>
<p>Ta in ra cÃ¡c ID Ä‘áº§u vÃ o cÅ©ng nhÆ° káº¿t quáº£ logit nhÆ° sau:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Input IDs: [[ <span class="hljs-number">1045</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">2310</span>,  <span class="hljs-number">2042</span>,  <span class="hljs-number">3403</span>,  <span class="hljs-number">2005</span>,  <span class="hljs-number">1037</span>, <span class="hljs-number">17662</span>, <span class="hljs-number">12172</span>,  <span class="hljs-number">2607</span>, <span class="hljs-number">2026</span>,  <span class="hljs-number">2878</span>,  <span class="hljs-number">2166</span>,  <span class="hljs-number">1012</span>]]
Logits: [[-<span class="hljs-number">2.7276</span>,  <span class="hljs-number">2.8789</span>]]<!-- HTML_TAG_END --></pre></div>
<p><em>Batching</em> hay <em>LÃ´</em> lÃ  hÃ nh Ä‘á»™ng gá»­i nhiá»u cÃ¢u qua mÃ´ hÃ¬nh, táº¥t cáº£ cÃ¹ng má»™t lÃºc. Náº¿u báº¡n chá»‰ cÃ³ má»™t cÃ¢u, báº¡n chá»‰ cÃ³ thá»ƒ xÃ¢y dá»±ng má»™t lÃ´ vá»›i má»™t chuá»—i duy nháº¥t:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-attr">batched_ids</span> = [ids, ids]<!-- HTML_TAG_END --></pre></div>
<p>ÄÃ¢y lÃ  má»™t lÃ´ chá»©a hai chuá»—i giá»‘ng nhau!</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Chuyá»ƒn Ä‘á»•i danh sÃ¡ch <code>batch_ids</code> nÃ y thÃ nh má»™t tensor vÃ  chuyá»ƒn nÃ³ qua mÃ´ hÃ¬nh cá»§a báº¡n. Kiá»ƒm tra Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng báº¡n cÃ³ Ä‘Æ°á»£c logit giá»‘ng nhÆ° trÆ°á»›c Ä‘Ã¢y (nhÆ°ng hai láº§n)!</p></div>
<p>Viá»‡c phÃ¢n phá»‘i lÃ´ cho phÃ©p mÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng khi báº¡n Ä‘Æ°a vÃ o nhiá»u cÃ¢u. Viá»‡c sá»­ dá»¥ng nhiá»u chuá»—i cÅ©ng Ä‘Æ¡n giáº£n nhÆ° xÃ¢y dá»±ng má»™t lÃ´ vá»›i má»™t chuá»—i duy nháº¥t. Tuy nhiÃªn, cÃ³ má»™t váº¥n Ä‘á» thá»© hai. Khi báº¡n cá»‘ gáº¯ng ghÃ©p hai (hoáº·c nhiá»u) cÃ¢u láº¡i vá»›i nhau, chÃºng cÃ³ thá»ƒ cÃ³ Ä‘á»™ dÃ i khÃ¡c nhau. Náº¿u báº¡n Ä‘Ã£ tá»«ng lÃ m viá»‡c vá»›i tensor trÆ°á»›c Ä‘Ã¢y, báº¡n biáº¿t ráº±ng chÃºng cáº§n cÃ³ dáº¡ng hÃ¬nh chá»¯ nháº­t, vÃ¬ váº­y báº¡n sáº½ khÃ´ng thá»ƒ chuyá»ƒn Ä‘á»•i trá»±c tiáº¿p danh sÃ¡ch ID Ä‘áº§u vÃ o thÃ nh tensor. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i thÆ°á»ng <em>Ä‘á»‡m</em> cÃ¡c Ä‘áº§u vÃ o.</p>
<h2 class="relative group"><a id="m-thm-vo-u-vo" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#m-thm-vo-u-vo"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ÄÃªm thÃªm vÃ o Ä‘áº§u vÃ o
	</span></h2>

<p>Danh sÃ¡ch cÃ¡c danh sÃ¡ch dÆ°á»›i Ä‘Ã¢y khÃ´ng thá»ƒ chuyá»ƒn Ä‘á»•i thÃ nh má»™t tensor:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->batched_ids = [
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>],
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>]
]<!-- HTML_TAG_END --></pre></div>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng ta sáº½ sá»­ dá»¥ng <em>Ä‘á»‡m</em> Ä‘á»ƒ lÃ m cho cÃ¡c tensor cá»§a chÃºng ta cÃ³ hÃ¬nh chá»¯ nháº­t. Äá»‡m Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c cÃ¢u cá»§a chÃºng ta cÃ³ cÃ¹ng Ä‘á»™ dÃ i báº±ng cÃ¡ch thÃªm má»™t tá»« Ä‘áº·c biá»‡t Ä‘Æ°á»£c gá»i lÃ  <em>padding token</em> hay <em>token Ä‘Æ°á»£c Ä‘á»‡m thÃªm</em> vÃ o cÃ¡c cÃ¢u cÃ³ Ã­t giÃ¡ trá»‹ hÆ¡n. VÃ­ dá»¥: náº¿u báº¡n cÃ³ 10 cÃ¢u 10 tá»« vÃ  1 cÃ¢u 20 tá»«, pháº§n Ä‘á»‡m sáº½ Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c cÃ¢u cÃ³ 20 tá»«. Trong vÃ­ dá»¥ cá»§a chÃºng tÃ´i, tensor káº¿t quáº£ trÃ´ng giá»‘ng nhÆ° sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->padding_id = <span class="hljs-number">100</span>

batched_ids = [
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>],
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, padding_id],
]<!-- HTML_TAG_END --></pre></div>
<p>ID cá»§a token Ä‘á»‡m cÃ³ thá»ƒ tÃ¬m tháº¥y á»Ÿ <code>tokenizer.pad_token_id</code>. HÃ£y sá»­ dá»¥ng nÃ³ vÃ  gá»­i hai cÃ¢u cá»§a chÃºng ta thÃ´ng qua mÃ´ hÃ¬nh riÃªng láº» vÃ  theo lÃ´ vá»›i nhau:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence1_ids = [[<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>]]
sequence2_ids = [[<span class="hljs-number">200</span>, <span class="hljs-number">200</span>]]
batched_ids = [
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>],
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, tokenizer.pad_token_id],
]

<span class="hljs-built_in">print</span>(model(torch.tensor(sequence1_ids)).logits)
<span class="hljs-built_in">print</span>(model(torch.tensor(sequence2_ids)).logits)
<span class="hljs-built_in">print</span>(model(torch.tensor(batched_ids)).logits)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tensor([[ <span class="hljs-number">1.5694</span>, -<span class="hljs-number">1.3895</span>]], grad_fn=&lt;AddmmBackward&gt;)
tensor([[ <span class="hljs-number">0.5803</span>, -<span class="hljs-number">0.4125</span>]], grad_fn=&lt;AddmmBackward&gt;)
tensor([[ <span class="hljs-number">1.5694</span>, -<span class="hljs-number">1.3895</span>],
        [ <span class="hljs-number">1.3373</span>, -<span class="hljs-number">1.2163</span>]], grad_fn=&lt;AddmmBackward&gt;)<!-- HTML_TAG_END --></pre></div>
<p>CÃ³ Ä‘iá»u gÃ¬ Ä‘Ã³ khÃ´ng á»•n vá»›i cÃ¡c logit trong cÃ¡c dá»± Ä‘oÃ¡n theo lÃ´ cá»§a chÃºng ta: hÃ ng thá»© hai pháº£i giá»‘ng vá»›i logit cho cÃ¢u thá»© hai, nhÆ°ng chÃºng ta cÃ³ cÃ¡c giÃ¡ trá»‹ hoÃ n toÃ n khÃ¡c nhau!</p>
<p>Äiá»u nÃ y lÃ  do tÃ­nh nÄƒng chÃ­nh cá»§a cÃ¡c mÃ´ hÃ¬nh Transformer lÃ  cÃ¡c lá»›p attention Ä‘Ã£ <em>ngá»¯ cáº£nh hÃ³a</em> má»—i token. ChÃºng sáº½ tÃ­nh Ä‘áº¿n cÃ¡c padding token vÃ¬ chÃºng tham gia vÃ o táº¥t cáº£ cÃ¡c token cá»§a má»™t chuá»—i. Äá»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»± khi chuyá»ƒn cÃ¡c cÃ¢u riÃªng láº» cÃ³ Ä‘á»™ dÃ i khÃ¡c nhau qua mÃ´ hÃ¬nh hoáº·c khi chuyá»ƒn má»™t lÃ´ vá»›i cÃ¡c cÃ¢u vÃ  pháº§n Ä‘á»‡m giá»‘ng nhau Ä‘Æ°á»£c Ã¡p dá»¥ng, chÃºng ta cáº§n yÃªu cáº§u cÃ¡c lá»›p attention Ä‘Ã³ bá» qua cÃ¡c tháº» Ä‘á»‡m. Äiá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng attention mask.</p>
<h2 class="relative group"><a id="attention-masks" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#attention-masks"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Attention masks
	</span></h2>

<p><em>Attention masks</em> lÃ  cÃ¡c tensor cÃ³ hÃ¬nh dáº¡ng chÃ­nh xÃ¡c nhÆ° tensor ID Ä‘áº§u vÃ o, Ä‘Æ°á»£c láº¥p Ä‘áº§y bá»Ÿi 0 vÃ  1: 1 cho biáº¿t cÃ¡c tokenn tÆ°Æ¡ng á»©ng nÃªn Ä‘Æ°á»£c tham gia vÃ  cÃ¡c sá»‘ 0 cho biáº¿t cÃ¡c token tÆ°Æ¡ng á»©ng khÃ´ng Ä‘Æ°á»£c tham gia (tá»©c lÃ  chÃºng pháº£i bá»‹ bá» qua bá»Ÿi cÃ¡c lá»›p attention cá»§a mÃ´ hÃ¬nh).</p>
<p>HÃ£y hoÃ n thÃ nh vÃ­ dá»¥ trÆ°á»›c vá»›i má»™t attention mask:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->batched_ids = [
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>],
    [<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, tokenizer.pad_token_id],
]

attention_mask = [
    [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],
    [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],
]

outputs = model(torch.tensor(batched_ids), attention_mask=torch.tensor(attention_mask))
<span class="hljs-built_in">print</span>(outputs.logits)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tensor([[ <span class="hljs-number">1.5694</span>, -<span class="hljs-number">1.3895</span>],
        [ <span class="hljs-number">0.5803</span>, -<span class="hljs-number">0.4125</span>]], grad_fn=&lt;AddmmBackward&gt;)<!-- HTML_TAG_END --></pre></div>
<p>BÃ¢y giá» chÃºng ta nháº­n Ä‘Æ°á»£c cÃ¡c logit tÆ°Æ¡ng tá»± cho cÃ¢u thá»© hai trong lÃ´.</p>
<p>LÆ°u Ã½ cÃ¡ch giÃ¡ trá»‹ cuá»‘i cÃ¹ng cá»§a chuá»—i thá»© hai lÃ  ID Ä‘á»‡m, lÃ  giÃ¡ trá»‹ 0 trong attention mask.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>Thá»­ nghiá»‡m thÃ´i!</strong> Ãp dá»¥ng thá»§ cÃ´ng tokenize cho hai cÃ¢u Ä‘Æ°á»£c sá»­ dá»¥ng trong pháº§n 2 (â€œIâ€™ve been waiting for a HuggingFace course my whole life.â€ vÃ  â€œI hate this so much!â€). ÄÆ°a chÃºng vÃ o mÃ´ hÃ¬nh vÃ  kiá»ƒm tra xem báº¡n cÃ³ nháº­n Ä‘Æ°á»£c cÃ¡c logit giá»‘ng nhÆ° trong pháº§n 2 khÃ´ng. BÃ¢y giá», gá»™p chÃºng láº¡i vá»›i nhau báº±ng cÃ¡ch sá»­ dá»¥ng token Ä‘á»‡m, sau Ä‘Ã³ táº¡o attention mask thÃ­ch há»£p. Kiá»ƒm tra xem báº¡n cÃ³ Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ tÆ°Æ¡ng tá»± khi Ä‘Æ°a qua mÃ´ hÃ¬nh khÃ´ng!</p></div>
<h2 class="relative group"><a id="nhng-chui-di-hn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#nhng-chui-di-hn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Nhá»¯ng chuá»—i dÃ i hÆ¡n
	</span></h2>

<p>Vá»›i cÃ¡c mÃ´ hÃ¬nh Transformer, cÃ³ má»™t giá»›i háº¡n vá» Ä‘á»™ dÃ i cá»§a cÃ¡c chuá»—i mÃ  chÃºng tÃ´i cÃ³ thá»ƒ vÆ°á»£t qua cÃ¡c mÃ´ hÃ¬nh. Háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh xá»­ lÃ½ chuá»—i lÃªn Ä‘áº¿n 512 hoáº·c 1024 token vÃ  sáº½ bá»‹ lá»—i khi Ä‘Æ°á»£c yÃªu cáº§u xá»­ lÃ½ chuá»—i dÃ i hÆ¡n. CÃ³ hai giáº£i phÃ¡p cho váº¥n Ä‘á» nÃ y:</p>
<ul><li>Sá»­ dá»¥ng mÃ´ hÃ¬nh cÃ³ Ä‘á»™ dÃ i chuá»—i Ä‘Æ°á»£c há»— trá»£ dÃ i hÆ¡n.</li>
<li>Cáº¯t ngáº¯n chuá»—i cá»§a báº¡n.</li></ul>
<p>CÃ¡c mÃ´ hÃ¬nh cÃ³ Ä‘á»™ dÃ i chuá»—i Ä‘Æ°á»£c há»— trá»£ khÃ¡c nhau vÃ  má»™t sá»‘ mÃ´ hÃ¬nh chuyÃªn xá»­ lÃ½ cÃ¡c trÃ¬nh tá»± ráº¥t dÃ i. <a href="https://huggingface.co/transformers/model_doc/longformer.html" rel="nofollow">Longformer</a> lÃ  má»™t vÃ­ dá»¥ vÃ  má»™t vÃ­ dá»¥ khÃ¡c lÃ  <a href="https://huggingface.co/transformers/model_doc/led.html" rel="nofollow">LED</a>. Náº¿u báº¡n Ä‘ang thá»±c hiá»‡n má»™t cÃ´ng viá»‡c Ä‘Ã²i há»i trÃ¬nh tá»± ráº¥t dÃ i, chÃºng tÃ´i khuyÃªn báº¡n nÃªn xem cÃ¡c mÃ´ hÃ¬nh Ä‘Ã³.</p>
<p>Náº¿u khÃ´ng, chÃºng tÃ´i khuyÃªn báº¡n nÃªn cáº¯t bá»›t cÃ¡c chuá»—i cá»§a mÃ¬nh báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh tham sá»‘ <code>max_sequence_length</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->sequence = sequence[:max_sequence_length]<!-- HTML_TAG_END --></pre></div>


		<script type="module" data-hydrate="koxc2c">
		import { start } from "/docs/course/main/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="koxc2c"]').parentNode,
			paths: {"base":"/docs/course/main/vi","assets":"/docs/course/main/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/vi/_app/pages/chapter2/5.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
