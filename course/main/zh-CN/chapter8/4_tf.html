<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;debugging-the-training-pipeline&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;debugging-the-training-pipeline&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ£€æŸ¥æ‚¨çš„æ•°æ®&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ£€æŸ¥ä½ çš„æ¨¡å‹&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ£€æŸ¥ä½ çš„è¶…å‚æ•°&quot;}],&quot;title&quot;:&quot;Debugging the training pipeline&quot;},{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¤„ç†å†…å­˜ä¸è¶³é”™è¯¯&quot;},{&quot;local&quot;:&quot;tensorflow&quot;,&quot;title&quot;:&quot;TensorFlow ğŸ¦›é¥¿é¥¿&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ£€æŸ¥æ‚¨çš„æ•°æ®ï¼ˆå†æ¬¡ï¼ï¼‰&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;åœ¨ä¸€æ‰¹ä¸Šè¿‡åº¦æ‹Ÿåˆä½ çš„æ¨¡å‹&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;åœ¨ä½ æœ‰ç¬¬ä¸€ä¸ªåŸºçº¿ä¹‹å‰ä¸è¦è°ƒæ•´ä»»ä½•ä¸œè¥¿&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;è¯·æ±‚å¸®å¿™&quot;}],&quot;title&quot;:&quot;å…¶ä»–æ½œåœ¨é—®é¢˜&quot;}],&quot;title&quot;:&quot;Debugging the training pipeline&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/chapter8/4_tf.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="debugging-the-training-pipeline" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#debugging-the-training-pipeline"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Debugging the training pipeline
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter8/section4_tf.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter8/section4_tf.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>ä½ å·²ç»ç¼–å†™äº†ä¸€ä¸ªæ¼‚äº®çš„è„šæœ¬æ¥è®­ç»ƒæˆ–å¾®è°ƒç»™å®šä»»åŠ¡çš„æ¨¡å‹ï¼Œå°½èŒå°½è´£åœ°éµå¾ª <a href="/course/chapter7">ç¬¬ä¸ƒç« </a> ä¸­çš„å»ºè®®ã€‚ ä½†æ˜¯å½“ä½ å¯åŠ¨å‘½ä»¤ <code>model.fit()</code> æ—¶ï¼Œå¯æ€•çš„äº‹æƒ…å‘ç”Ÿäº†ï¼šä½ å¾—åˆ°ä¸€ä¸ªé”™è¯¯ğŸ˜±ï¼ æˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯ï¼Œä¸€åˆ‡ä¼¼ä¹éƒ½å¾ˆå¥½ï¼Œè®­ç»ƒè¿è¡Œæ²¡æœ‰é”™è¯¯ï¼Œä½†ç”Ÿæˆçš„æ¨¡å‹å¾ˆç³Ÿç³•ã€‚ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•è°ƒè¯•æ­¤ç±»é—®é¢˜ã€‚</p>
<h2 class="relative group"><a id="debugging-the-training-pipeline" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#debugging-the-training-pipeline"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Debugging the training pipeline
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/N9kO52itd0Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>The problem when you encounter an error in <code>model.fit()</code> is that it could come from multiple sources, as training usually brings together a lot of things that youâ€™ve been working on up until that point. The problem could be something wrong in your dataset, or some issue when trying to batch elements of the datasets together. Or it could be something wrong in the model code, or your loss function or optimizer. And even if everything goes well for training, something could still go wrong during the evaluation if there is a problem with your metric.</p>
<p>The best way to debug an error that arises in <code>model.fit()</code> is to manually go through this whole pipeline to see where things went awry. The error is then often very easy to solve.</p>
<p>To demonstrate this, we will use the following script that (tries to) fine-tune a DistilBERT model on the <a href="https://huggingface.co/datasets/glue" rel="nofollow">MNLI dataset</a>:</p>
<p>å½“æ‚¨åœ¨ <code>model.fit()</code> ä¸­é‡åˆ°é”™è¯¯æ—¶ï¼Œé—®é¢˜åœ¨äºå®ƒå¯èƒ½æ¥è‡ªå¤šä¸ªæ¥æºï¼Œå› ä¸ºè®­ç»ƒé€šå¸¸ä¼šæ±‡é›†å¾ˆå¤šæ‚¨åœ¨æ­¤ä¹‹å‰ä¸€ç›´åœ¨åšçš„äº‹æƒ…ã€‚ é—®é¢˜å¯èƒ½æ˜¯æ‚¨çš„æ•°æ®é›†ä¸­æœ‰é—®é¢˜ï¼Œæˆ–è€…æ˜¯åœ¨å°è¯•å°†æ•°æ®é›†çš„å…ƒç´ æ‰¹å¤„ç†åœ¨ä¸€èµ·æ—¶å‡ºç°é—®é¢˜ã€‚ æˆ–è€…æ¨¡å‹ä»£ç ã€æŸå¤±å‡½æ•°æˆ–ä¼˜åŒ–å™¨ä¸­å¯èƒ½æœ‰é—®é¢˜ã€‚ å³ä½¿è®­ç»ƒä¸€åˆ‡é¡ºåˆ©ï¼Œå¦‚æœæ‚¨çš„æŒ‡æ ‡æœ‰é—®é¢˜ï¼Œè¯„ä¼°æœŸé—´ä»ç„¶å¯èƒ½å‡ºç°é—®é¢˜ã€‚</p>
<p>è°ƒè¯• <code>model.fit()</code> ä¸­å‡ºç°çš„é”™è¯¯çš„æœ€ä½³æ–¹æ³•æ˜¯æ‰‹åŠ¨æ£€æŸ¥æ•´ä¸ªç®¡é“ï¼Œçœ‹çœ‹å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚ é”™è¯¯é€šå¸¸å¾ˆå®¹æ˜“è§£å†³ã€‚</p>
<p>ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼ˆå°è¯•ï¼‰åœ¨ <a href="https://huggingface.co/datasets/glue" rel="nofollow">MNLI æ•°æ®é›†</a>ä¸Šå¾®è°ƒ DistilBERT æ¨¡å‹ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset, load_metric
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> (
    AutoTokenizer,
    TFAutoModelForSequenceClassification,
)

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mnli&quot;</span>)

model_checkpoint = <span class="hljs-string">&quot;distilbert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;premise&quot;</span>], examples[<span class="hljs-string">&quot;hypothesis&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)

train_dataset = tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;labels&quot;</span>], batch_size=<span class="hljs-number">16</span>, shuffle=<span class="hljs-literal">True</span>
)

validation_dataset = tokenized_datasets[<span class="hljs-string">&quot;validation_matched&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;labels&quot;</span>], batch_size=<span class="hljs-number">16</span>, shuffle=<span class="hljs-literal">True</span>
)

model = TFAutoModelForSequenceClassification.from_pretrained(model_checkpoint)

model.<span class="hljs-built_in">compile</span>(loss=<span class="hljs-string">&quot;sparse_categorical_crossentropy&quot;</span>, optimizer=<span class="hljs-string">&quot;adam&quot;</span>)

model.fit(train_dataset)<!-- HTML_TAG_END --></pre></div>
<p>å¦‚æœæ‚¨å°è¯•æ‰§è¡Œå®ƒï¼Œåœ¨è¿›è¡Œæ•°æ®é›†è½¬æ¢æ—¶å¯èƒ½ä¼šæ”¶åˆ°ä¸€äº›â€œVisibleDeprecationWarningâ€â€”â€”è¿™æ˜¯æˆ‘ä»¬å·²çŸ¥çš„ UX é—®é¢˜ï¼Œå› æ­¤è¯·å¿½ç•¥å®ƒã€‚ å¦‚æœä½ åœ¨ 2021 å¹´ 11 æœˆä¹‹åé˜…è¯»è¿™é—¨è¯¾ç¨‹å¹¶ä¸”å®ƒä»åœ¨ç»§ç»­ï¼Œé‚£ä¹ˆè¯·åœ¨æ¨ç‰¹ä¸Š @carrigmat ä¸Šå‘é€æ„¤æ€’çš„æ¨æ–‡ï¼Œç›´åˆ°ä»–ä¿®å¤å®ƒã€‚</p>
<p>ç„¶è€Œï¼Œæ›´ä¸¥é‡çš„é—®é¢˜æ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå½»åº•çš„é”™è¯¯ã€‚ å®ƒçœŸçš„éå¸¸é•¿ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->ValueError: No gradients provided <span class="hljs-keyword">for</span> <span class="hljs-built_in">any</span> variable: [<span class="hljs-string">&#x27;tf_distil_bert_for_sequence_classification/distilbert/embeddings/word_embeddings/weight:0&#x27;</span>, <span class="hljs-string">&#x27;...&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬è¯•å›¾è®­ç»ƒæˆ‘ä»¬çš„æ•°æ®ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰æ¢¯åº¦ï¼Ÿ è¿™å¾ˆä»¤äººå›°æƒ‘ã€‚ æˆ‘ä»¬ç”šè‡³ä¸çŸ¥é“è¯¥å¦‚ä½•å¼€å§‹è°ƒè¯•ç±»ä¼¼çš„ä¸œè¥¿ï¼Ÿ å½“ä½ å¾—åˆ°çš„é”™è¯¯å¹¶ä¸èƒ½ç«‹å³è¡¨æ˜é—®é¢˜å‡ºåœ¨å“ªé‡Œæ—¶ï¼Œæœ€å¥½çš„è§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯æŒ‰é¡ºåºæ£€æŸ¥æ‰€æœ‰å†…å®¹ï¼Œç¡®ä¿åœ¨æ¯ä¸ªé˜¶æ®µä¸€åˆ‡çœ‹èµ·æ¥éƒ½æ˜¯æ­£ç¡®çš„ã€‚ å½“ç„¶ï¼Œå¼€å§‹çš„åœ°æ–¹æ€»æ˜¯â€¦</p>
<h3 id="">æ£€æŸ¥æ‚¨çš„æ•°æ®</h3>
<p>è¿™æ˜¯ä¸è¨€è€Œå–»çš„ï¼Œä½†å¦‚æœæ‚¨çš„æ•°æ®å·²æŸåï¼ŒKeras å°†æ— æ³•ä¸ºæ‚¨ä¿®å¤å®ƒã€‚ æ‰€ä»¥é¦–å…ˆï¼Œä½ éœ€è¦çœ‹çœ‹ä½ çš„è®­ç»ƒé›†ä¸­æœ‰ä»€ä¹ˆã€‚</p>
<p>å°½ç®¡æŸ¥çœ‹ <code>raw_datasets</code> å’Œ <code>tokenized_datasets</code> å¾ˆè¯±äººï¼Œä½†æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨åœ¨æ•°æ®å°†è¦è¿›å…¥æ¨¡å‹çš„åœ°æ–¹ç›´æ¥æŸ¥çœ‹æ•°æ®ã€‚ è¿™æ„å‘³ç€åº”è¯¥ä»æ‚¨ä½¿ç”¨ <code>to_tf_dataset()</code> å‡½æ•°åˆ›å»ºçš„ <code>tf.data.Dataset</code> è¯»å–è¾“å‡ºï¼ é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ <code>tf.data.Dataset</code> å¯¹è±¡ä¸€æ¬¡ç»™æˆ‘ä»¬æ•´ä¸ªæ‰¹æ¬¡å¹¶ä¸”ä¸æ”¯æŒç´¢å¼•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åªè¯·æ±‚ <code>train_dataset[0]</code>ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¤¼è²Œåœ°å‘å®ƒè¦ä¸€æ‰¹ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> train_dataset:
    <span class="hljs-keyword">break</span><!-- HTML_TAG_END --></pre></div>
<p><code>break</code> åœ¨ä¸€æ¬¡è¿­ä»£åç»“æŸå¾ªç¯ï¼Œå› æ­¤è¿™ä¼šæŠ“å–æ¥è‡ª<code>train_dataset</code> çš„ç¬¬ä¸€æ‰¹å¹¶å°†å…¶ä¿å­˜ä¸º<code>batch</code>ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é‡Œé¢æœ‰ä»€ä¹ˆï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;attention_mask&#x27;</span>: &lt;tf.Tensor: shape=(<span class="hljs-number">16</span>, <span class="hljs-number">76</span>), dtype=int64, numpy=
 array([[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        ...,
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, ..., <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]])&gt;,
 <span class="hljs-string">&#x27;label&#x27;</span>: &lt;tf.Tensor: shape=(<span class="hljs-number">16</span>,), dtype=int64, numpy=array([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>])&gt;,
 <span class="hljs-string">&#x27;input_ids&#x27;</span>: &lt;tf.Tensor: shape=(<span class="hljs-number">16</span>, <span class="hljs-number">76</span>), dtype=int64, numpy=
 array([[ <span class="hljs-number">101</span>, <span class="hljs-number">2174</span>, <span class="hljs-number">1010</span>, ...,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>],
        [ <span class="hljs-number">101</span>, <span class="hljs-number">3174</span>, <span class="hljs-number">2420</span>, ...,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>],
        [ <span class="hljs-number">101</span>, <span class="hljs-number">2044</span>, <span class="hljs-number">2048</span>, ...,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>],
        ...,
        [ <span class="hljs-number">101</span>, <span class="hljs-number">3398</span>, <span class="hljs-number">3398</span>, ..., <span class="hljs-number">2051</span>, <span class="hljs-number">2894</span>,  <span class="hljs-number">102</span>],
        [ <span class="hljs-number">101</span>, <span class="hljs-number">1996</span>, <span class="hljs-number">4124</span>, ...,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>],
        [ <span class="hljs-number">101</span>, <span class="hljs-number">1999</span>, <span class="hljs-number">2070</span>, ...,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>,    <span class="hljs-number">0</span>]])&gt;}<!-- HTML_TAG_END --></pre></div>
<p>è¿™çœ‹èµ·æ¥ä¸é”™ï¼Œä¸æ˜¯å—ï¼Ÿæˆ‘ä»¬å°† <code>labels</code> ã€<code>attention_mask</code> å’Œ <code>input_ids</code> ä¼ é€’ç»™æ¨¡å‹ï¼Œè¿™åº”è¯¥æ˜¯è®¡ç®—è¾“å‡ºå’Œè®¡ç®—æŸå¤±æ‰€éœ€çš„ä¸€åˆ‡ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰æ¢¯åº¦å‘¢ï¼Ÿä»”ç»†çœ‹ï¼šæˆ‘ä»¬å°†å•ä¸ªå­—å…¸ä½œä¸ºè¾“å…¥ä¼ é€’ï¼Œä½†è®­ç»ƒæ‰¹æ¬¡é€šå¸¸æ˜¯è¾“å…¥å¼ é‡æˆ–å­—å…¸ï¼ŒåŠ ä¸Šæ ‡ç­¾å¼ é‡ã€‚æˆ‘ä»¬çš„æ ‡ç­¾åªæ˜¯æˆ‘ä»¬è¾“å…¥å­—å…¸ä¸­çš„ä¸€ä¸ªé”®ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªé—®é¢˜å—ï¼Ÿå®é™…ä¸Šï¼Œå¹¶éæ€»æ˜¯å¦‚æ­¤ï¼ä½†è¿™æ˜¯æ‚¨åœ¨ä½¿ç”¨ TensorFlow è®­ç»ƒ Transformer æ¨¡å‹æ—¶ä¼šé‡åˆ°çš„æœ€å¸¸è§é—®é¢˜ä¹‹ä¸€ã€‚æˆ‘ä»¬çš„æ¨¡å‹éƒ½å¯ä»¥åœ¨å†…éƒ¨è®¡ç®—æŸå¤±ï¼Œä½†è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œéœ€è¦åœ¨è¾“å…¥å­—å…¸ä¸­ä¼ é€’æ ‡ç­¾ã€‚è¿™æ˜¯å½“æˆ‘ä»¬æ²¡æœ‰ä¸º <code>compile()</code> æŒ‡å®šæŸå¤±å€¼æ—¶ä½¿ç”¨çš„æŸå¤±ã€‚å¦ä¸€æ–¹é¢ï¼ŒKeras é€šå¸¸å¸Œæœ›æ ‡ç­¾ä¸è¾“å…¥å­—å…¸åˆ†å¼€ä¼ é€’ï¼Œå¦‚æœä½ ä¸è¿™æ ·åšï¼ŒæŸå¤±è®¡ç®—é€šå¸¸ä¼šå¤±è´¥ã€‚</p>
<p>é—®é¢˜ç°åœ¨å˜å¾—æ›´æ¸…æ¥šäº†ï¼šæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªâ€œæŸå¤±â€å‚æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è¦æ±‚ Keras ä¸ºæˆ‘ä»¬è®¡ç®—æŸå¤±ï¼Œä½†æˆ‘ä»¬å°†æ ‡ç­¾ä½œä¸ºæ¨¡å‹çš„è¾“å…¥ä¼ é€’ï¼Œè€Œä¸æ˜¯æ”¾åœ¨ Keras æœŸæœ›çš„åœ°æ–¹çš„ï¼æˆ‘ä»¬éœ€è¦äºŒé€‰ä¸€ï¼šè¦ä¹ˆä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨æŸå¤±å¹¶å°†æ ‡ç­¾ä¿ç•™åœ¨åŸå¤„ï¼Œè¦ä¹ˆç»§ç»­ä½¿ç”¨ Keras æŸå¤±ï¼Œä½†å°†æ ‡ç­¾ç§»åŠ¨åˆ° Keras æœŸæœ›çš„ä½ç½®ã€‚ä¸ºç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ã€‚å°†å¯¹ <code>compile()</code> çš„è°ƒç”¨æ›´æ”¹ä¸ºï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">&quot;adam&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨æŸå¤±ï¼Œè¿™ä¸ªé—®é¢˜åº”è¯¥è§£å†³äº†ï¼</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>è½®åˆ°ä½ äº†ï¼</strong> ä½œä¸ºæˆ‘ä»¬è§£å†³å…¶ä»–é—®é¢˜åçš„å¯é€‰æŒ‘æˆ˜ï¼Œä½ å¯ä»¥å°è¯•å›åˆ°è¿™ä¸€æ­¥ï¼Œè®©æ¨¡å‹ä½¿ç”¨åŸå§‹ Keras è®¡ç®—çš„æŸå¤±è€Œä¸æ˜¯å†…éƒ¨æŸå¤±ã€‚ æ‚¨éœ€è¦å°† <code>&quot;labels&quot;</code> æ·»åŠ åˆ° <code>to_tf_dataset()</code> çš„ <code>label_cols</code> å‚æ•°ï¼Œä»¥ç¡®ä¿æ­£ç¡®è¾“å‡ºæ ‡ç­¾ï¼Œè¿™å°†ä¸ºæ‚¨æä¾›æ¢¯åº¦â€”â€”ä½†æˆ‘ä»¬æŒ‡å®šçš„æŸå¤±è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ . è®­ç»ƒä»ç„¶ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå­¦ä¹ ä¼šéå¸¸ç¼“æ…¢ï¼Œå¹¶ä¸”ä¼šåœ¨å¤šæ¬¡è®­ç»ƒæŸå¤±æ—¶è¾¾åˆ°ç¨³å®šçŠ¶æ€ã€‚ ä½ èƒ½å¼„æ¸…æ¥šå®ƒæ˜¯ä»€ä¹ˆå—ï¼Ÿ</p>
<p>ä¸€ä¸ª ROT13 ç¼–ç çš„æç¤ºï¼Œå¦‚æœä½ å¡ä½äº†ï¼šVs lbh ybbx ng gur bhgchgf bs FrdhraprPynffvsvpngvba zbqryf va Genafsbezref, gurve svefg bhgchg vf <code>ybtvgf</code>ã€‚ è£æ ¼çº³ ybtvgf?</p>
<p>ç¬¬äºŒä¸ªæç¤ºï¼šJura lbh fcrpvsl bcgvzvmref, npgvingvbaf æ˜¯ ybffrf jvgu fgevatf, Xrenf frgf nyy gur nethzrag inyhrf gb gurve qrsnhygfã€‚ Jung nethzragf qbrf FcnefrPngrtbevpnyPebffragebcl unir, naq jung ner gurve qrsnhygf?</p></div>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•è®­ç»ƒã€‚ æˆ‘ä»¬ç°åœ¨åº”è¯¥å¾—åˆ°æ¢¯åº¦ï¼Œæ‰€ä»¥å¸Œæœ›ï¼ˆè¿™é‡Œæ’­æ”¾ä¸ç¥¥çš„éŸ³ä¹ï¼‰æˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>model.fit()</code> ä¸€åˆ‡éƒ½ä¼šæ­£å¸¸å·¥ä½œï¼</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->  <span class="hljs-number">246</span>/<span class="hljs-number">24543</span> [..............................] - ETA: <span class="hljs-number">15</span>:<span class="hljs-number">52</span> - loss: nan<!-- HTML_TAG_END --></pre></div>
<p>Oh no. </p>
<p><code>nan</code> ä¸æ˜¯ä¸€ä¸ªéå¸¸ä»¤äººå¼€å¿ƒçš„æŸå¤±å€¼ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ£€æŸ¥äº†æˆ‘ä»¬çš„æ•°æ®ï¼Œå®ƒçœ‹èµ·æ¥è¿˜ä¸é”™ã€‚ å¦‚æœè¿™ä¸æ˜¯é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥è¯¥å»å“ªé‡Œï¼Ÿ æ˜¾è€Œæ˜“è§çš„ä¸‹ä¸€æ­¥æ˜¯â€¦</p>
<h3 id="">æ£€æŸ¥ä½ çš„æ¨¡å‹</h3>
<p><code>model.fit()</code> æ˜¯ Keras ä¸­ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å‡½æ•°ï¼Œä½†å®ƒä¸ºæ‚¨åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œè¿™ä½¿å¾—å‡†ç¡®æ‰¾åˆ°é—®é¢˜å‘ç”Ÿçš„ä½ç½®å˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚ å¦‚æœæ‚¨æ­£åœ¨è°ƒè¯•æ‚¨çš„æ¨¡å‹ï¼Œä¸€ä¸ªçœŸæ­£æœ‰ç”¨çš„ç­–ç•¥æ˜¯åªå°†ä¸€ä¸ªæ‰¹æ¬¡ä¼ é€’ç»™æ¨¡å‹ï¼Œå¹¶è¯¦ç»†æŸ¥çœ‹è¯¥æ‰¹æ¬¡çš„è¾“å‡ºã€‚ å¦‚æœæ¨¡å‹æŠ›å‡ºé”™è¯¯ï¼Œå¦ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æç¤ºæ˜¯ä½¿ç”¨ <code>run_eagerly=True</code> <code>compile()</code> æ¨¡å‹ã€‚ è¿™ä¼šä½¿å®ƒå˜æ…¢å¾ˆå¤šï¼Œä½†å®ƒä¼šä½¿é”™è¯¯æ¶ˆæ¯æ›´å®¹æ˜“ç†è§£ï¼Œå› ä¸ºå®ƒä»¬ä¼šå‡†ç¡®åœ°æŒ‡å‡ºé—®é¢˜å‘ç”Ÿåœ¨æ¨¡å‹ä»£ç çš„å“ªä¸ªä½ç½®ã€‚</p>
<p>ä¸è¿‡ï¼Œç›®å‰æˆ‘ä»¬è¿˜ä¸éœ€è¦ <code>run_eagerly</code>ã€‚ è®©æˆ‘ä»¬é€šè¿‡æ¨¡å‹è¿è¡Œæˆ‘ä»¬ä¹‹å‰å¾—åˆ°çš„â€œæ‰¹å¤„ç†â€ï¼Œçœ‹çœ‹è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model(batch)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->TFSequenceClassifierOutput(loss=&lt;tf.Tensor: shape=(<span class="hljs-number">16</span>,), dtype=float32, numpy=
array([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
       nan, nan, nan], dtype=float32)&gt;, logits=&lt;tf.Tensor: shape=(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>), dtype=float32, numpy=
array([[nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan],
       [nan, nan]], dtype=float32)&gt;, hidden_states=<span class="hljs-literal">None</span>, attentions=<span class="hljs-literal">None</span>)<!-- HTML_TAG_END --></pre></div>
<p>å—¯ï¼Œè¿™å¾ˆæ£˜æ‰‹ã€‚ä¸€åˆ‡éƒ½æ˜¯<code>nan</code>ï¼ä½†è¿™å¾ˆå¥‡æ€ªï¼Œä¸æ˜¯å—ï¼Ÿæˆ‘ä»¬æ‰€æœ‰çš„ logits æ€ä¹ˆä¼šå˜æˆâ€œnanâ€ï¼Ÿ <code>nan</code> çš„æ„æ€æ˜¯â€œä¸æ˜¯æ•°å­—â€ã€‚ <code>nan</code> å€¼ç»å¸¸å‡ºç°åœ¨æ‚¨æ‰§è¡Œç¦æ­¢æ“ä½œæ—¶ï¼Œä¾‹å¦‚é™¤ä»¥é›¶ã€‚ä½†æ˜¯ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­äº†è§£ <code>nan</code> éå¸¸é‡è¦çš„ä¸€ä»¶äº‹æ˜¯ï¼Œè¯¥å€¼å€¾å‘äº<em>ä¼ æ’­</em>ã€‚å¦‚æœå°†ä¸€ä¸ªæ•°å­—ä¹˜ä»¥ <code>nan</code>ï¼Œåˆ™è¾“å‡ºä¹Ÿæ˜¯ <code>nan</code>ã€‚å¦‚æœä½ åœ¨è¾“å‡ºã€æŸå¤±æˆ–æ¢¯åº¦çš„ä»»ä½•åœ°æ–¹å¾—åˆ°ä¸€ä¸ªâ€œnanâ€ï¼Œé‚£ä¹ˆå®ƒä¼šè¿…é€Ÿä¼ æ’­åˆ°ä½ çš„æ•´ä¸ªæ¨¡å‹ä¸­â€”â€”å› ä¸ºå½“é‚£ä¸ªâ€œnanâ€å€¼é€šè¿‡ä½ çš„ç½‘ç»œä¼ æ’­å›æ¥æ—¶ï¼Œä½ ä¼šå¾—åˆ°nan æ¢¯åº¦ï¼Œå½“ä½¿ç”¨è¿™äº›æ¢¯åº¦è®¡ç®—æƒé‡æ›´æ–°æ—¶ï¼Œæ‚¨å°†è·å¾— nan æƒé‡ï¼Œè¿™äº›æƒé‡å°†è®¡ç®—æ›´å¤šçš„ nan è¾“å‡ºï¼å¾ˆå¿«ï¼Œæ•´ä¸ªç½‘ç»œå°†åªæ˜¯â€œnanâ€çš„ä¸€å¤§å—ã€‚ä¸€æ—¦å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œå°±å¾ˆéš¾çœ‹å‡ºé—®é¢˜æ˜¯ä»å“ªé‡Œå¼€å§‹çš„ã€‚æˆ‘ä»¬å¦‚ä½•éš”ç¦»â€œnanâ€ç¬¬ä¸€æ¬¡å‡ºç°çš„åœ°æ–¹ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å°è¯•<em>é‡æ–°åˆå§‹åŒ–</em>æˆ‘ä»¬çš„æ¨¡å‹ã€‚ä¸€æ—¦æˆ‘ä»¬å¼€å§‹è®­ç»ƒï¼Œæˆ‘ä»¬å°±ä¼šåœ¨æŸä¸ªåœ°æ–¹å¾—åˆ°ä¸€ä¸ªâ€œnanâ€ï¼Œå®ƒå¾ˆå¿«å°±ä¼šä¼ æ’­åˆ°æ•´ä¸ªæ¨¡å‹ä¸­ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ä»æ£€æŸ¥ç‚¹åŠ è½½æ¨¡å‹è€Œä¸åšä»»ä½•æƒé‡æ›´æ–°ï¼Œçœ‹çœ‹æˆ‘ä»¬ä»å“ªé‡Œå¾—åˆ°ä¸€ä¸ª <code>nan</code> å€¼ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = TFAutoModelForSequenceClassification.from_pretrained(model_checkpoint)
model(batch)<!-- HTML_TAG_END --></pre></div>
<p>å½“æˆ‘ä»¬è¿è¡Œå®ƒæ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->TFSequenceClassifierOutput(loss=&lt;tf.Tensor: shape=(<span class="hljs-number">16</span>,), dtype=float32, numpy=
array([<span class="hljs-number">0.6844486</span> ,        nan,        nan, <span class="hljs-number">0.67127866</span>, <span class="hljs-number">0.7068601</span> ,
              nan, <span class="hljs-number">0.69309855</span>,        nan, <span class="hljs-number">0.65531296</span>,        nan,
              nan,        nan, <span class="hljs-number">0.675402</span>  ,        nan,        nan,
       <span class="hljs-number">0.69831556</span>], dtype=float32)&gt;, logits=&lt;tf.Tensor: shape=(<span class="hljs-number">16</span>, <span class="hljs-number">2</span>), dtype=float32, numpy=
array([[-<span class="hljs-number">0.04761693</span>, -<span class="hljs-number">0.06509043</span>],
       [-<span class="hljs-number">0.0481936</span> , -<span class="hljs-number">0.04556257</span>],
       [-<span class="hljs-number">0.0040929</span> , -<span class="hljs-number">0.05848458</span>],
       [-<span class="hljs-number">0.02417453</span>, -<span class="hljs-number">0.0684005</span> ],
       [-<span class="hljs-number">0.02517801</span>, -<span class="hljs-number">0.05241832</span>],
       [-<span class="hljs-number">0.04514256</span>, -<span class="hljs-number">0.0757378</span> ],
       [-<span class="hljs-number">0.02656011</span>, -<span class="hljs-number">0.02646275</span>],
       [ <span class="hljs-number">0.00766164</span>, -<span class="hljs-number">0.04350497</span>],
       [ <span class="hljs-number">0.02060014</span>, -<span class="hljs-number">0.05655622</span>],
       [-<span class="hljs-number">0.02615328</span>, -<span class="hljs-number">0.0447021</span> ],
       [-<span class="hljs-number">0.05119278</span>, -<span class="hljs-number">0.06928903</span>],
       [-<span class="hljs-number">0.02859691</span>, -<span class="hljs-number">0.04879177</span>],
       [-<span class="hljs-number">0.02210129</span>, -<span class="hljs-number">0.05791225</span>],
       [-<span class="hljs-number">0.02363213</span>, -<span class="hljs-number">0.05962167</span>],
       [-<span class="hljs-number">0.05352269</span>, -<span class="hljs-number">0.0481673</span> ],
       [-<span class="hljs-number">0.08141848</span>, -<span class="hljs-number">0.07110836</span>]], dtype=float32)&gt;, hidden_states=<span class="hljs-literal">None</span>, attentions=<span class="hljs-literal">None</span>)<!-- HTML_TAG_END --></pre></div>
<p><em>ç°åœ¨</em>æˆ‘ä»¬åˆ°äº†æŸä¸ªåœ°æ–¹ï¼ æˆ‘ä»¬çš„ logits ä¸­æ²¡æœ‰ <code>nan</code> å€¼ï¼Œè¿™ä»¤äººæ”¾å¿ƒã€‚ ä½†æ˜¯æˆ‘ä»¬ç¡®å®åœ¨æŸå¤±ä¸­çœ‹åˆ°äº†ä¸€äº›â€œnanâ€å€¼ï¼ è¿™äº›æ ·æœ¬æœ‰ä»€ä¹ˆç‰¹åˆ«å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„å—ï¼Ÿ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬æ˜¯å“ªäº›ï¼ˆè¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨è‡ªå·±è¿è¡Œæ­¤ä»£ç ï¼Œæ‚¨å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç´¢å¼•ï¼Œå› ä¸ºæ•°æ®é›†å·²è¢«éšæœºæ‰“ä¹±ï¼‰ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

loss = model(batch).loss.numpy()
indices = np.flatnonzero(np.isnan(loss))
indices<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->array([ <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>])<!-- HTML_TAG_END --></pre></div>
<p>è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›æ¥è‡ªæ ·æœ¬çš„è¾“å…¥idï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->input_ids = batch[<span class="hljs-string">&quot;input_ids&quot;</span>].numpy()
input_ids[indices]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->array([[  <span class="hljs-number">101</span>,  <span class="hljs-number">2007</span>,  <span class="hljs-number">2032</span>,  <span class="hljs-number">2001</span>,  <span class="hljs-number">1037</span>, <span class="hljs-number">16480</span>,  <span class="hljs-number">3917</span>,  <span class="hljs-number">2594</span>,  <span class="hljs-number">4135</span>,
        <span class="hljs-number">23212</span>,  <span class="hljs-number">3070</span>,  <span class="hljs-number">2214</span>, <span class="hljs-number">10170</span>,  <span class="hljs-number">1010</span>,  <span class="hljs-number">2012</span>,  <span class="hljs-number">4356</span>,  <span class="hljs-number">1997</span>,  <span class="hljs-number">3183</span>,
         <span class="hljs-number">6838</span>, <span class="hljs-number">12953</span>,  <span class="hljs-number">2039</span>,  <span class="hljs-number">2000</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">6147</span>,  <span class="hljs-number">1997</span>,  <span class="hljs-number">2010</span>,  <span class="hljs-number">2606</span>,
         <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">6838</span>,  <span class="hljs-number">2001</span>,  <span class="hljs-number">3294</span>,  <span class="hljs-number">6625</span>,  <span class="hljs-number">3773</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">2214</span>,
         <span class="hljs-number">2158</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">1998</span>,  <span class="hljs-number">6814</span>,  <span class="hljs-number">2016</span>,  <span class="hljs-number">2234</span>,  <span class="hljs-number">2461</span>,  <span class="hljs-number">2153</span>,  <span class="hljs-number">1998</span>, <span class="hljs-number">13322</span>,
         <span class="hljs-number">2009</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2045</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">1055</span>,  <span class="hljs-number">2053</span>,  <span class="hljs-number">3382</span>,  <span class="hljs-number">2008</span>,
         <span class="hljs-number">2016</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">2222</span>,  <span class="hljs-number">3046</span>,  <span class="hljs-number">8103</span>,  <span class="hljs-number">2075</span>,  <span class="hljs-number">2009</span>,  <span class="hljs-number">2153</span>,  <span class="hljs-number">1012</span>,
          <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">1998</span>,  <span class="hljs-number">2007</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">3712</span>,  <span class="hljs-number">4634</span>,  <span class="hljs-number">1010</span>,  <span class="hljs-number">2057</span>,  <span class="hljs-number">8108</span>,
         <span class="hljs-number">2025</span>,  <span class="hljs-number">3404</span>,  <span class="hljs-number">2028</span>,  <span class="hljs-number">1012</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">2616</span>, <span class="hljs-number">18449</span>,  <span class="hljs-number">2125</span>,  <span class="hljs-number">1999</span>,
         <span class="hljs-number">1037</span>,  <span class="hljs-number">9666</span>,  <span class="hljs-number">1997</span>,  <span class="hljs-number">4100</span>,  <span class="hljs-number">8663</span>, <span class="hljs-number">11020</span>,  <span class="hljs-number">6313</span>,  <span class="hljs-number">2791</span>,  <span class="hljs-number">1998</span>,
         <span class="hljs-number">2431</span>,  <span class="hljs-number">1011</span>,  <span class="hljs-number">4301</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2028</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">1055</span>,  <span class="hljs-number">5177</span>,
         <span class="hljs-number">2110</span>,  <span class="hljs-number">1998</span>,  <span class="hljs-number">3977</span>,  <span class="hljs-number">2000</span>,  <span class="hljs-number">2832</span>,  <span class="hljs-number">2106</span>,  <span class="hljs-number">2025</span>,  <span class="hljs-number">2689</span>,  <span class="hljs-number">2104</span>,
         <span class="hljs-number">2122</span>,  <span class="hljs-number">6214</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">1045</span>,  <span class="hljs-number">2001</span>,  <span class="hljs-number">1999</span>,  <span class="hljs-number">1037</span>, <span class="hljs-number">13090</span>,  <span class="hljs-number">5948</span>,  <span class="hljs-number">2007</span>,  <span class="hljs-number">2048</span>,
         <span class="hljs-number">2308</span>,  <span class="hljs-number">2006</span>,  <span class="hljs-number">2026</span>,  <span class="hljs-number">5001</span>,  <span class="hljs-number">2043</span>,  <span class="hljs-number">2026</span>,  <span class="hljs-number">2171</span>,  <span class="hljs-number">2001</span>,  <span class="hljs-number">2170</span>,
         <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">1045</span>,  <span class="hljs-number">2001</span>,  <span class="hljs-number">3564</span>,  <span class="hljs-number">1999</span>,  <span class="hljs-number">2277</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">2195</span>,  <span class="hljs-number">4279</span>,  <span class="hljs-number">2191</span>,  <span class="hljs-number">2039</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">2181</span>,  <span class="hljs-number">2124</span>,  <span class="hljs-number">2004</span>,
         <span class="hljs-number">1996</span>,  <span class="hljs-number">2225</span>,  <span class="hljs-number">7363</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2045</span>,  <span class="hljs-number">2003</span>,  <span class="hljs-number">2069</span>,  <span class="hljs-number">2028</span>,
         <span class="hljs-number">2451</span>,  <span class="hljs-number">1999</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">2225</span>,  <span class="hljs-number">7363</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">2061</span>,  <span class="hljs-number">2008</span>,  <span class="hljs-number">1045</span>,  <span class="hljs-number">2123</span>,  <span class="hljs-number">1005</span>,  <span class="hljs-number">1056</span>,  <span class="hljs-number">2113</span>,  <span class="hljs-number">2065</span>,
         <span class="hljs-number">2009</span>,  <span class="hljs-number">2428</span>, <span class="hljs-number">10654</span>,  <span class="hljs-number">7347</span>,  <span class="hljs-number">2030</span>,  <span class="hljs-number">2009</span>,  <span class="hljs-number">7126</span>,  <span class="hljs-number">2256</span>,  <span class="hljs-number">2495</span>,
         <span class="hljs-number">2291</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2009</span>,  <span class="hljs-number">2003</span>,  <span class="hljs-number">5094</span>,  <span class="hljs-number">2256</span>,  <span class="hljs-number">2495</span>,  <span class="hljs-number">2291</span>,  <span class="hljs-number">2035</span>,
         <span class="hljs-number">2105</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">2051</span>,  <span class="hljs-number">1010</span>,  <span class="hljs-number">2029</span>,  <span class="hljs-number">3216</span>,  <span class="hljs-number">2019</span>,  <span class="hljs-number">2503</span>,  <span class="hljs-number">3444</span>,  <span class="hljs-number">1010</span>,
         <span class="hljs-number">6732</span>,  <span class="hljs-number">1996</span>,  <span class="hljs-number">2265</span>,  <span class="hljs-number">2038</span>, <span class="hljs-number">19840</span>,  <span class="hljs-number">2098</span>,  <span class="hljs-number">2125</span>,  <span class="hljs-number">9906</span>,  <span class="hljs-number">1998</span>,
         <span class="hljs-number">2003</span>,  <span class="hljs-number">2770</span>,  <span class="hljs-number">2041</span>,  <span class="hljs-number">1997</span>,  <span class="hljs-number">4784</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2051</span>,  <span class="hljs-number">6732</span>,
         <span class="hljs-number">1996</span>,  <span class="hljs-number">2265</span>,  <span class="hljs-number">2003</span>,  <span class="hljs-number">9525</span>,  <span class="hljs-number">1998</span>,  <span class="hljs-number">4569</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>,  <span class="hljs-number">1996</span>, <span class="hljs-number">10556</span>,  <span class="hljs-number">2140</span>, <span class="hljs-number">11515</span>,  <span class="hljs-number">2058</span>,  <span class="hljs-number">1010</span>,  <span class="hljs-number">2010</span>,  <span class="hljs-number">2162</span>,
         <span class="hljs-number">2252</span>,  <span class="hljs-number">5689</span>,  <span class="hljs-number">2013</span>,  <span class="hljs-number">2010</span>,  <span class="hljs-number">7223</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2043</span>,  <span class="hljs-number">1996</span>,
        <span class="hljs-number">10556</span>,  <span class="hljs-number">2140</span>, <span class="hljs-number">11515</span>,  <span class="hljs-number">2058</span>,  <span class="hljs-number">1010</span>,  <span class="hljs-number">2010</span>,  <span class="hljs-number">2252</span>,  <span class="hljs-number">3062</span>,  <span class="hljs-number">2000</span>,
         <span class="hljs-number">1996</span>,  <span class="hljs-number">2598</span>,  <span class="hljs-number">1012</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>],
       [  <span class="hljs-number">101</span>, <span class="hljs-number">13543</span>,  <span class="hljs-number">1999</span>,  <span class="hljs-number">2049</span>,  <span class="hljs-number">6143</span>,  <span class="hljs-number">2933</span>,  <span class="hljs-number">2443</span>,   <span class="hljs-number">102</span>,  <span class="hljs-number">2025</span>,
        <span class="hljs-number">13543</span>,  <span class="hljs-number">1999</span>,  <span class="hljs-number">6143</span>,  <span class="hljs-number">2933</span>,  <span class="hljs-number">2003</span>,  <span class="hljs-number">2443</span>,   <span class="hljs-number">102</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,
            <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>,     <span class="hljs-number">0</span>]])<!-- HTML_TAG_END --></pre></div>
<p>å—¯ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆä¸å¯»å¸¸çš„ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æ ‡ç­¾ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->labels = batch[<span class="hljs-string">&#x27;labels&#x27;</span>].numpy()
labels[indices]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->array([<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>])<!-- HTML_TAG_END --></pre></div>
<p>å•Š! <code>nan</code> æ ·æœ¬éƒ½å…·æœ‰ç›¸åŒçš„æ ‡ç­¾ï¼Œå³æ ‡ç­¾ 2ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„æç¤ºã€‚ å½“æˆ‘ä»¬çš„æ ‡ç­¾ä¸º 2 æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°lossä¸º <code>nan</code>ï¼Œè¿™è¡¨æ˜è¿™æ˜¯æ£€æŸ¥æ¨¡å‹ä¸­æ ‡ç­¾æ•°é‡çš„å¥½æ—¶æœºï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.config.num_labels<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">2</span><!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†é—®é¢˜ï¼šæ¨¡å‹è®¤ä¸ºåªæœ‰ä¸¤ä¸ªç±»ï¼Œä½†æ ‡ç­¾ä¸Šå‡åˆ° 2ï¼Œè¿™æ„å‘³ç€å®é™…ä¸Šæœ‰ä¸‰ä¸ªç±»ï¼ˆå› ä¸º 0 ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼‰ã€‚ è¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°â€œnanâ€çš„æ–¹å¼â€”â€”é€šè¿‡å°è¯•è®¡ç®—ä¸å­˜åœ¨çš„ç±»çš„æŸå¤±ï¼ è®©æˆ‘ä»¬å°è¯•æ”¹å˜å®ƒå¹¶å†æ¬¡æ‹Ÿåˆæ¨¡å‹ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = TFAutoModelForSequenceClassification.from_pretrained(model_checkpoint, <span class="hljs-attribute">num_labels</span>=3)
model.compile(<span class="hljs-attribute">optimizer</span>=<span class="hljs-string">&#x27;adam&#x27;</span>)
model.fit(train_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->  <span class="hljs-number">869</span>/<span class="hljs-number">24543</span> [&gt;.............................] - ETA: <span class="hljs-number">15</span>:<span class="hljs-number">29</span> - loss: <span class="hljs-number">1.1032</span><!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬åœ¨è®­ç»ƒï¼ æ²¡æœ‰æ›´å¤šçš„â€™nanâ€™sï¼Œæˆ‘ä»¬çš„æŸå¤±æ­£åœ¨å‡å°‘â€¦æœ‰ç‚¹ã€‚ å¦‚æœä½ è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œä½ å¯èƒ½ä¼šå¼€å§‹æœ‰ç‚¹ä¸è€çƒ¦ï¼Œå› ä¸ºæŸå¤±å€¼ä¸€ç›´å±…é«˜ä¸ä¸‹ã€‚ è®©æˆ‘ä»¬åœ¨è¿™é‡Œåœæ­¢è®­ç»ƒå¹¶å°è¯•è€ƒè™‘å¯èƒ½å¯¼è‡´æ­¤é—®é¢˜çš„åŸå› ã€‚ åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬å¾ˆç¡®å®šæ•°æ®å’Œæ¨¡å‹éƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ¨¡å‹å¹¶æ²¡æœ‰å¾ˆå¥½åœ°å­¦ä¹ ã€‚ è¿˜å‰©ä¸‹ä»€ä¹ˆï¼Ÿ æ˜¯æ—¶å€™â€¦</p>
<h3 id="">æ£€æŸ¥ä½ çš„è¶…å‚æ•°</h3>
<p>å¦‚æœä½ å›å¤´çœ‹ä¸Šé¢çš„ä»£ç ï¼Œä½ å¯èƒ½æ ¹æœ¬çœ‹ä¸åˆ°ä»»ä½•è¶…å‚æ•°ï¼Œé™¤äº† <code>batch_size</code>ï¼Œè¿™ä¼¼ä¹ä¸æ˜¯ç½ªé­ç¥¸é¦–ã€‚ä¸è¿‡ï¼Œä¸è¦è¢«è¿·æƒ‘ï¼›æ€»æ˜¯æœ‰è¶…å‚æ•°ï¼Œå¦‚æœä½ çœ‹ä¸åˆ°å®ƒä»¬ï¼Œé‚£åªæ˜¯æ„å‘³ç€ä½ ä¸çŸ¥é“å®ƒä»¬çš„è®¾ç½®æ˜¯ä»€ä¹ˆã€‚ç‰¹åˆ«è¦è®°ä½å…³äº Keras çš„ä¸€ä¸ªå…³é”®ç‚¹ï¼šå¦‚æœæ‚¨ä½¿ç”¨å­—ç¬¦ä¸²è®¾ç½®æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨æˆ–æ¿€æ´»å‡½æ•°ï¼Œ<em>å®ƒçš„æ‰€æœ‰å‚æ•°éƒ½å°†è®¾ç½®ä¸ºå®ƒä»¬çš„é»˜è®¤å€¼</em>ã€‚è¿™æ„å‘³ç€å³ä½¿ä¸ºæ­¤ä½¿ç”¨å­—ç¬¦ä¸²éå¸¸æ–¹ä¾¿ï¼Œä½†åœ¨è¿™æ ·åšæ—¶æ‚¨åº”è¯¥éå¸¸å°å¿ƒï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å¯¹æ‚¨éšè—å…³é”®çš„äº‹æƒ…ã€‚ ï¼ˆä»»ä½•å°è¯•ä¸Šè¿°æ–¹å¼çš„äººéƒ½åº”è¯¥ä»”ç»†æ³¨æ„è¿™ä¸€äº‹å®ã€‚ï¼‰</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å“ªé‡Œè®¾ç½®äº†å¸¦æœ‰å­—ç¬¦ä¸²çš„å‚æ•°ï¼Ÿæˆ‘ä»¬æœ€åˆä½¿ç”¨å­—ç¬¦ä¸²è®¾ç½®æŸå¤±ï¼Œä½†æˆ‘ä»¬ä¸å†è¿™æ ·åšäº†ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨å­—ç¬¦ä¸²è®¾ç½®ä¼˜åŒ–å™¨ã€‚éš¾é“è¿™å¯¹æˆ‘ä»¬éšç’äº†ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹<a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam" rel="nofollow">å…³äºå®ƒçš„ä¸€äº›è®¨è®º</a>ã€‚</p>
<p>è¿™é‡Œæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„å—ï¼Ÿæ²¡é”™â€”â€”å­¦ä¹ ç‡ï¼å½“æˆ‘ä»¬åªä½¿ç”¨å­—ç¬¦ä¸²â€œadamâ€æ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—é»˜è®¤çš„å­¦ä¹ ç‡ï¼Œå³ 0.001ï¼Œå³ 1e-3ã€‚è¿™å¯¹äºtransormeræ¨¡å‹æ¥è¯´å¤ªé«˜äº†ï¼ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨çš„æ¨¡å‹å°è¯• 1e-5 å’Œ 1e-4 ä¹‹é—´çš„å­¦ä¹ ç‡ï¼›è¿™æ¯”æˆ‘ä»¬åœ¨è¿™é‡Œå®é™…ä½¿ç”¨çš„å€¼å° 10X åˆ° 100X ä¹‹é—´ã€‚å¬èµ·æ¥è¿™å¯èƒ½æ˜¯ä¸€ä¸ªä¸»è¦é—®é¢˜ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å°è¯•å‡å°‘å®ƒã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥å®é™…çš„â€œä¼˜åŒ–å™¨â€å¯¹è±¡ã€‚å½“æˆ‘ä»¬è¿™æ ·åšçš„æ—¶å€™ï¼Œè®©æˆ‘ä»¬ä»æ£€æŸ¥ç‚¹é‡æ–°åˆå§‹åŒ–æ¨¡å‹ï¼Œä»¥é˜²é«˜å­¦ä¹ ç‡çš„è®­ç»ƒæŸåäº†å®ƒçš„æƒé‡ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam

model = TFAutoModelForSequenceClassification.from_pretrained(model_checkpoint)
model.<span class="hljs-built_in">compile</span>(optimizer=Adam(<span class="hljs-number">5e-5</span>))<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡æ‚¨è¿˜å¯ä»¥ä»ğŸ¤— Transformers ä¸­å¯¼å…¥ <code>create_optimizer()</code> å‡½æ•°ï¼Œè¿™å°†ä¸ºæ‚¨æä¾›å…·æœ‰æ­£ç¡®æƒé‡è¡°å‡ä»¥åŠå­¦ä¹ ç‡é¢„çƒ­å’Œå­¦ä¹ ç‡è¡°å‡çš„ AdamW ä¼˜åŒ–å™¨ã€‚ æ­¤ä¼˜åŒ–å™¨é€šå¸¸ä¼šäº§ç”Ÿæ¯”ä½¿ç”¨é»˜è®¤ Adam ä¼˜åŒ–å™¨è·å¾—çš„ç»“æœç¨å¥½ä¸€äº›çš„ç»“æœã€‚</p></div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨æ–°çš„ã€æ”¹è¿›åçš„å­¦ä¹ ç‡æ¥æ‹Ÿåˆæ¨¡å‹ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.fit(train_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">319</span>/<span class="hljs-number">24543</span> [..............................] - ETA: <span class="hljs-number">16</span>:07 - loss: <span class="hljs-number">0.9718</span><!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨æˆ‘ä»¬çš„æŸå¤±çœŸçš„åœ¨æŸä¸ªåœ°æ–¹ï¼ è®­ç»ƒç»ˆäºçœ‹èµ·æ¥å¥æ•ˆäº†ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªæ•™è®­ï¼šå½“ä½ çš„æ¨¡å‹æ­£åœ¨è¿è¡Œä½†æŸå¤±æ²¡æœ‰ä¸‹é™ï¼Œå¹¶ä¸”ä½ ç¡®å®šä½ çš„æ•°æ®æ²¡é—®é¢˜æ—¶ï¼Œæ£€æŸ¥å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç­‰è¶…å‚æ•°æ˜¯ä¸ªå¥½ä¸»æ„ã€‚ å°†å…¶ä¸­ä»»ä½•ä¸€ä¸ªè®¾ç½®å¾—å¤ªé«˜å¾ˆå¯èƒ½å¯¼è‡´è®­ç»ƒåœ¨é«˜æŸå¤±å€¼ä¸‹â€œåœæ»â€ã€‚</p>
<h2 id="">å…¶ä»–æ½œåœ¨é—®é¢˜</h2>
<p>æˆ‘ä»¬å·²ç»æ¶µç›–äº†ä¸Šé¢è„šæœ¬ä¸­çš„é—®é¢˜ï¼Œä½†æ‚¨å¯èƒ½ä¼šé‡åˆ°å…¶ä»–å‡ ä¸ªå¸¸è§é”™è¯¯ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªï¼ˆéå¸¸ä¸å®Œæ•´çš„ï¼‰åˆ—è¡¨ã€‚</p>
<h3 id="">å¤„ç†å†…å­˜ä¸è¶³é”™è¯¯</h3>
<p>å†…å­˜ä¸è¶³çš„è¿¹è±¡æ˜¯â€œåˆ†é…å¼ é‡æ—¶å‡ºç° OOMâ€ä¹‹ç±»çš„é”™è¯¯â€”â€”OOM æ˜¯â€œå†…å­˜ä¸è¶³â€çš„ç¼©å†™ã€‚ åœ¨å¤„ç†å¤§å‹è¯­è¨€æ¨¡å‹æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„å±é™©ã€‚ å¦‚æœé‡åˆ°è¿™ç§æƒ…å†µï¼Œä¸€ä¸ªå¥½çš„ç­–ç•¥æ˜¯å°†æ‰¹é‡å¤§å°å‡åŠå¹¶é‡è¯•ã€‚ ä½†è¯·è®°ä½ï¼Œæœ‰äº›å‹å·<em>éå¸¸</em>å¤§ã€‚ ä¾‹å¦‚ï¼Œå…¨å°ºå¯¸ GPT-2 çš„å‚æ•°ä¸º 1.5Bï¼Œè¿™æ„å‘³ç€æ‚¨å°†éœ€è¦ 6 GB çš„å†…å­˜æ¥å­˜å‚¨æ¨¡å‹ï¼Œå¦å¤–éœ€è¦ 6 GB çš„å†…å­˜ç”¨äºæ¢¯åº¦ä¸‹é™ï¼ æ— è®ºæ‚¨ä½¿ç”¨ä»€ä¹ˆæ‰¹é‡å¤§å°ï¼Œè®­ç»ƒå®Œæ•´çš„ GPT-2 æ¨¡å‹é€šå¸¸éœ€è¦è¶…è¿‡ 20 GB çš„ VRAMï¼Œè€Œåªæœ‰å°‘æ•° GPU æ‹¥æœ‰ã€‚ åƒâ€œdistilbert-base-casedâ€è¿™æ ·æ›´è½»é‡çº§çš„æ¨¡å‹æ›´å®¹æ˜“è¿è¡Œï¼Œè®­ç»ƒä¹Ÿæ›´å¿«ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>åœ¨è¯¾ç¨‹çš„ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ›´å…ˆè¿›çš„æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯å¯ä»¥å¸®åŠ©æ‚¨å‡å°‘å†…å­˜å ç”¨å¹¶è®©æ‚¨å¾®è°ƒæœ€å¤§çš„æ¨¡å‹ã€‚</p></div>
<h3 class="relative group"><a id="tensorflow" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tensorflow"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>TensorFlow ğŸ¦›é¥¿é¥¿
	</span></h3>

<p>æ‚¨åº”è¯¥æ³¨æ„çš„ TensorFlow çš„ä¸€ä¸ªç‰¹æ®Šæ€ªç™–æ˜¯ï¼Œå®ƒä¼šåœ¨æ‚¨åŠ è½½æ¨¡å‹æˆ–è¿›è¡Œä»»ä½•è®­ç»ƒåç«‹å³ä¸ºè‡ªå·±åˆ†é… <em>æ‰€æœ‰ </em> GPU å†…å­˜ï¼Œç„¶åæ ¹æ®éœ€è¦åˆ†é…è¯¥å†…å­˜ã€‚è¿™ä¸å…¶ä»–æ¡†æ¶çš„è¡Œä¸ºä¸åŒï¼Œä¾‹å¦‚ PyTorchï¼Œåè€…æ ¹æ® CUDA çš„éœ€è¦åˆ†é…å†…å­˜ï¼Œè€Œä¸æ˜¯åœ¨å†…éƒ¨è¿›è¡Œã€‚ TensorFlow æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå½“æ‚¨è€—å°½å†…å­˜æ—¶ï¼Œå®ƒé€šå¸¸ä¼šç»™å‡ºæœ‰ç”¨çš„é”™è¯¯ï¼Œå¹¶ä¸”å®ƒå¯ä»¥ä»è¯¥çŠ¶æ€æ¢å¤è€Œä¸ä¼šå¯¼è‡´æ•´ä¸ª CUDA å†…æ ¸å´©æºƒã€‚ä½†ä¹Ÿæœ‰ä¸€ä¸ªé‡è¦çš„ç¼ºç‚¹ï¼šå¦‚æœä½ åŒæ—¶è¿è¡Œä¸¤ä¸ª TensorFlow è¿›ç¨‹ï¼Œé‚£ä¹ˆ<strong>ä½ å°†åº¦è¿‡ä¸€æ®µç³Ÿç³•çš„æ—¶å…‰</strong>ã€‚</p>
<p>å¦‚æœæ‚¨åœ¨ Colab ä¸Šè¿è¡Œï¼Œåˆ™æ— éœ€æ‹…å¿ƒè¿™ä¸€ç‚¹ï¼Œä½†å¦‚æœæ‚¨åœ¨æœ¬åœ°è¿è¡Œï¼Œè¿™ç»å¯¹æ˜¯æ‚¨åº”è¯¥å°å¿ƒçš„äº‹æƒ…ã€‚ç‰¹åˆ«è¦æ³¨æ„ï¼Œå…³é—­ç¬”è®°æœ¬é€‰é¡¹å¡å¹¶ä¸ä¸€å®šä¼šå…³é—­è¯¥ç¬”è®°æœ¬ï¼æ‚¨å¯èƒ½éœ€è¦é€‰æ‹©æ­£åœ¨è¿è¡Œçš„ç¬”è®°æœ¬ï¼ˆå¸¦æœ‰ç»¿è‰²å›¾æ ‡çš„ç¬”è®°æœ¬ï¼‰å¹¶åœ¨ç›®å½•åˆ—è¡¨ä¸­æ‰‹åŠ¨å…³é—­å®ƒä»¬ã€‚ä»»ä½•ä½¿ç”¨ TensorFlow çš„æ­£åœ¨è¿è¡Œçš„ç¬”è®°æœ¬ä»å¯èƒ½å ç”¨å¤§é‡ GPU å†…å­˜ï¼Œè¿™æ„å‘³ç€æ‚¨å¯åŠ¨çš„ä»»ä½•æ–°ç¬”è®°æœ¬éƒ½å¯èƒ½ä¼šé‡åˆ°ä¸€äº›éå¸¸å¥‡æ€ªçš„é—®é¢˜ã€‚</p>
<p>å¦‚æœæ‚¨å¼€å§‹è¿è¡Œä¹‹å‰æ­£ç¡®çš„ä»£ç å´æ”¶åˆ°æœ‰å…³ CUDAã€BLAS æˆ– cuBLAS çš„é”™è¯¯ï¼Œè¿™é€šå¸¸æ˜¯ç½ªé­ç¥¸é¦–ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼ <code>nvidia-smi</code> çš„å‘½ä»¤æ¥æ£€æŸ¥ - å½“æ‚¨å…³é—­æˆ–é‡æ–°å¯åŠ¨å½“å‰ç¬”è®°æœ¬æ—¶ï¼Œæ‚¨çš„å¤§éƒ¨åˆ†å†…å­˜æ˜¯å¦ç©ºé—²ï¼Œæˆ–è€…æ˜¯å¦ä»åœ¨ä½¿ç”¨ä¸­ï¼Ÿå¦‚æœå®ƒä»åœ¨ä½¿ç”¨ä¸­ï¼Œåˆ™æœ‰å…¶ä»–ä¸œè¥¿åœ¨å ç”¨å®ƒï¼</p>
<h3 id="">æ£€æŸ¥æ‚¨çš„æ•°æ®ï¼ˆå†æ¬¡ï¼ï¼‰</h3>
<p>åªæœ‰åœ¨ç†è®ºä¸Šå¯ä»¥ä»æ‚¨çš„æ•°æ®ä¸­å­¦åˆ°ä»»ä½•ä¸œè¥¿æ—¶ï¼Œæ‚¨çš„æ¨¡å‹æ‰ä¼šå­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚ å¦‚æœå­˜åœ¨æŸåæ•°æ®çš„é”™è¯¯æˆ–æ ‡ç­¾æ˜¯éšæœºå±æ€§çš„ï¼Œé‚£ä¹ˆæ‚¨å¾ˆå¯èƒ½ä¸ä¼šåœ¨æ•°æ®é›†ä¸Šè·å¾—ä»»ä½•çŸ¥è¯†ã€‚è¿™é‡Œä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·æ˜¯<code>tokenizer.decode()</code>ã€‚ è¿™ä¼šå°† <code>input_ids</code> è½¬æ¢å›å­—ç¬¦ä¸²ï¼Œå› æ­¤æ‚¨å¯ä»¥æŸ¥çœ‹æ•°æ®å¹¶æŸ¥çœ‹æ‚¨çš„è®­ç»ƒæ•°æ®æ˜¯å¦æ­£åœ¨æ•™æˆæ‚¨å¸Œæœ›å®ƒæ•™æˆçš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼Œåƒæˆ‘ä»¬ä¸Šé¢æ‰€åšçš„é‚£æ ·ä» <code>tf.data.Dataset</code> ä¸­è·å– <code>batch</code> åï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·è§£ç ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->input_ids = batch[<span class="hljs-string">&quot;input_ids&quot;</span>].numpy()
tokenizer.decode(input_ids[<span class="hljs-number">0</span>])<!-- HTML_TAG_END --></pre></div>
<p>Then you can compare it with the first label, like so:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->labels = batch[<span class="hljs-string">&quot;labels&quot;</span>].numpy()
label = labels[<span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>
<p>ä¸€æ—¦æ‚¨å¯ä»¥åƒè¿™æ ·æŸ¥çœ‹æ‚¨çš„æ•°æ®ï¼Œæ‚¨å¯ä»¥é—®è‡ªå·±ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul><li>è§£ç åçš„æ•°æ®æ˜¯å¦å¯ä»¥ç†è§£ï¼Ÿ</li>
<li>ä½ è®¤åŒè¿™äº›æ ‡ç­¾å—ï¼Ÿ</li>
<li>æœ‰æ²¡æœ‰ä¸€ä¸ªæ ‡ç­¾æ¯”å…¶ä»–æ ‡ç­¾æ›´å¸¸è§ï¼Ÿ</li>
<li>å¦‚æœæ¨¡å‹é¢„æµ‹éšæœºçš„ç­”æ¡ˆ/æ€»æ˜¯ç›¸åŒçš„ç­”æ¡ˆï¼Œé‚£ä¹ˆloss/è¯„ä¼°æŒ‡æ ‡åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ</li></ul>
<p>æŸ¥çœ‹æ‚¨çš„æ•°æ®åï¼ŒæŸ¥çœ‹æ¨¡å‹çš„ä¸€äº›é¢„æµ‹å¹¶å¯¹å…¶è¿›è¡Œè§£ç ã€‚ å¦‚æœæ¨¡å‹æ€»æ˜¯é¢„æµ‹åŒæ ·çš„äº‹æƒ…ï¼Œé‚£å¯èƒ½æ˜¯å› ä¸ºä½ çš„æ•°æ®é›†åå‘ä¸€ä¸ªç±»åˆ«ï¼ˆé’ˆå¯¹åˆ†ç±»é—®é¢˜ï¼‰ï¼› è¿‡é‡‡æ ·ç¨€æœ‰ç±»ç­‰æŠ€æœ¯å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>å¦‚æœæ‚¨åœ¨åˆå§‹æ¨¡å‹ä¸Šè·å¾—çš„loss/è¯„ä¼°æŒ‡æ ‡ä¸æ‚¨æœŸæœ›çš„éšæœºé¢„æµ‹çš„loss/è¯„ä¼°æŒ‡æ ‡éå¸¸ä¸åŒï¼Œè¯·ä»”ç»†æ£€æŸ¥æ‚¨çš„lossæˆ–è¯„ä¼°æŒ‡æ ‡çš„è®¡ç®—æ–¹å¼ï¼Œå› ä¸ºé‚£é‡Œå¯èƒ½å­˜åœ¨é”™è¯¯ã€‚ å¦‚æœæ‚¨ä½¿ç”¨æœ€åæ·»åŠ çš„å¤šä¸ªlossï¼Œè¯·ç¡®ä¿å®ƒä»¬å…·æœ‰ç›¸åŒçš„è§„æ¨¡ã€‚</p>
<p>å½“æ‚¨ç¡®å®šæ‚¨çš„æ•°æ®æ˜¯å®Œç¾çš„æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æµ‹è¯•æ¥æŸ¥çœ‹æ¨¡å‹æ˜¯å¦èƒ½å¤Ÿå¯¹å…¶è¿›è¡Œè®­ç»ƒã€‚</p>
<h3 id="">åœ¨ä¸€æ‰¹ä¸Šè¿‡åº¦æ‹Ÿåˆä½ çš„æ¨¡å‹</h3>
<p>è¿‡åº¦æ‹Ÿåˆé€šå¸¸æ˜¯æˆ‘ä»¬åœ¨è®­ç»ƒæ—¶å°½é‡é¿å…çš„äº‹æƒ…ï¼Œå› ä¸ºè¿™æ„å‘³ç€æ¨¡å‹æ²¡æœ‰å­¦ä¹ è¯†åˆ«æˆ‘ä»¬æƒ³è¦çš„ä¸€èˆ¬ç‰¹å¾ï¼Œè€Œåªæ˜¯è®°ä½äº†è®­ç»ƒæ ·æœ¬ã€‚ ä½†æ˜¯ï¼Œä¸€éåˆä¸€éåœ°å°è¯•åœ¨ä¸€ä¸ªæ‰¹æ¬¡ä¸Šè®­ç»ƒæ‚¨çš„æ¨¡å‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµ‹è¯•ï¼Œå¯ä»¥æ£€æŸ¥æ‚¨æ„å»ºçš„é—®é¢˜æ˜¯å¦å¯ä»¥é€šè¿‡æ‚¨å°è¯•è®­ç»ƒçš„æ¨¡å‹æ¥è§£å†³ã€‚ å®ƒè¿˜å°†å¸®åŠ©æ‚¨æŸ¥çœ‹æ‚¨çš„åˆå§‹å­¦ä¹ ç‡æ˜¯å¦å¤ªé«˜ã€‚</p>
<p>ä¸€æ—¦ä½ å®šä¹‰äº†ä½ çš„â€œæ¨¡å‹â€ï¼Œè¿™æ ·åšçœŸçš„å¾ˆå®¹æ˜“ï¼› åªéœ€è·å–ä¸€æ‰¹è®­ç»ƒæ•°æ®ï¼Œç„¶åå°†è¯¥â€œæ‰¹æ¬¡â€è§†ä¸ºæ‚¨çš„æ•´ä¸ªæ•°æ®é›†ï¼Œå¹¶åœ¨å…¶ä¸Šfitå¤§é‡epochï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> train_dataset:
    <span class="hljs-keyword">break</span>

<span class="hljs-comment"># Make sure you have run model.compile() and set your optimizer,</span>
<span class="hljs-comment"># and your loss/metrics if you&#x27;re using them</span>

model.fit(batch, epochs=<span class="hljs-number">20</span>)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ å¦‚æœæ‚¨çš„è®­ç»ƒæ•°æ®ä¸å¹³è¡¡ï¼Œè¯·ç¡®ä¿æ„å»ºä¸€æ‰¹åŒ…å«æ‰€æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®ã€‚</p></div>
<p>ç”Ÿæˆçš„æ¨¡å‹åœ¨â€œæ‰¹æ¬¡â€ä¸Šåº”è¯¥æœ‰æ¥è¿‘å®Œç¾çš„ç»“æœï¼ŒæŸå¤±è¿…é€Ÿä¸‹é™åˆ° 0ï¼ˆæˆ–æ‚¨æ­£åœ¨ä½¿ç”¨çš„æŸå¤±çš„æœ€å°å€¼ï¼‰ã€‚</p>
<p>å¦‚æœä½ æ²¡æœ‰è®¾æ³•è®©ä½ çš„æ¨¡å‹è·å¾—è¿™æ ·çš„å®Œç¾ç»“æœï¼Œè¿™æ„å‘³ç€ä½ æ„å»ºé—®é¢˜æˆ–æ•°æ®çš„æ–¹å¼æœ‰é—®é¢˜ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä¿®å¤å®ƒã€‚ åªæœ‰å½“ä½ è®¾æ³•é€šè¿‡è¿‡æ‹Ÿåˆæµ‹è¯•æ—¶ï¼Œä½ æ‰èƒ½ç¡®å®šä½ çš„æ¨¡å‹å®é™…ä¸Šå¯ä»¥å­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚</p>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>âš ï¸ åœ¨æ­¤æµ‹è¯•ä¹‹åï¼Œæ‚¨å°†ä¸å¾—ä¸é‡æ–°åˆ›å»ºæ‚¨çš„æ¨¡å‹å’Œâ€œTrainerâ€ï¼Œå› ä¸ºè·å¾—çš„æ¨¡å‹å¯èƒ½æ— æ³•åœ¨æ‚¨çš„å®Œæ•´æ•°æ®é›†ä¸Šæ¢å¤å’Œå­¦ä¹ æœ‰ç”¨çš„ä¸œè¥¿ã€‚</p></div>
<h3 id="">åœ¨ä½ æœ‰ç¬¬ä¸€ä¸ªåŸºçº¿ä¹‹å‰ä¸è¦è°ƒæ•´ä»»ä½•ä¸œè¥¿</h3>
<p>è¶…å‚æ•°è°ƒæ•´æ€»æ˜¯è¢«å¼ºè°ƒä¸ºæœºå™¨å­¦ä¹ ä¸­æœ€éš¾çš„éƒ¨åˆ†ï¼Œä½†è¿™åªæ˜¯å¸®åŠ©æ‚¨åœ¨æŒ‡æ ‡ä¸Šè·å¾—ä¸€ç‚¹ç‚¹æå‡çš„æœ€åä¸€æ­¥ã€‚ ä¾‹å¦‚å°†é»˜è®¤çš„ Adam å­¦ä¹ ç‡ 1e-3 ä¸ Transformer æ¨¡å‹ä¸€èµ·ä½¿ç”¨ï¼Œå½“ç„¶ä¼šä½¿å­¦ä¹ è¿›è¡Œå¾—éå¸¸ç¼“æ…¢æˆ–å®Œå…¨åœæ­¢ï¼Œä½†å¤§å¤šæ•°æ—¶å€™â€œåˆç†â€çš„è¶…å‚æ•°ï¼Œä¾‹å¦‚ä» 1e-5 åˆ° 5e-5 çš„å­¦ä¹ ç‡ï¼Œä¼šå¾ˆå¥½åœ°ç»™ä½ å¸¦æ¥å¥½çš„ç»“æœã€‚å› æ­¤ï¼Œåœ¨æ‚¨è·å¾—è¶…å‡ºæ•°æ®é›†åŸºçº¿çš„ä¸œè¥¿ä¹‹å‰ï¼Œä¸è¦å¼€å§‹è¿›è¡Œè€—æ—¶ä¸”æ˜‚è´µçš„è¶…å‚æ•°æœç´¢ã€‚</p>
<p>ä¸€æ—¦ä½ æœ‰ä¸€ä¸ªè¶³å¤Ÿå¥½çš„æ¨¡å‹ï¼Œä½ å°±å¯ä»¥å¼€å§‹ç¨å¾®è°ƒæ•´ä¸€ä¸‹ã€‚ ä¸è¦å°è¯•ä½¿ç”¨ä¸åŒçš„è¶…å‚æ•°å¯åŠ¨ä¸€åƒæ¬¡è¿è¡Œï¼Œè€Œæ˜¯æ¯”è¾ƒä¸€ä¸ªè¶…å‚æ•°çš„ä¸åŒå€¼çš„å‡ æ¬¡è¿è¡Œï¼Œä»¥äº†è§£å“ªä¸ªå½±å“æœ€å¤§ã€‚</p>
<p>å¦‚æœæ‚¨æ­£åœ¨è°ƒæ•´æ¨¡å‹æœ¬èº«ï¼Œä¸è¦å°è¯•ä»»ä½•æ‚¨æ— æ³•åˆç†è¯æ˜çš„äº‹æƒ…ã€‚ å§‹ç»ˆç¡®ä¿æ‚¨è¿”å›è¿‡æ‹Ÿåˆæµ‹è¯•ä»¥éªŒè¯æ‚¨çš„æ›´æ”¹æ²¡æœ‰äº§ç”Ÿä»»ä½•æ„å¤–åæœã€‚</p>
<h3 id="">è¯·æ±‚å¸®å¿™</h3>
<p>å¸Œæœ›æ‚¨ä¼šåœ¨æœ¬èŠ‚ä¸­æ‰¾åˆ°ä¸€äº›å¯ä»¥å¸®åŠ©æ‚¨è§£å†³é—®é¢˜çš„å»ºè®®ï¼Œä½†å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œè¯·è®°ä½æ‚¨å¯ä»¥éšæ—¶åœ¨ <a href="https://discuss.huggingface.co/" rel="nofollow">è®ºå›</a> ä¸Šå‘ç¤¾åŒºæé—®ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½æœ‰ç”¨çš„é¢å¤–èµ„æºï¼š</p>
<ul><li><a href="https://docs.google.com/presentation/d/1yHLPvPhUs2KGI5ZWo0sU-PKU3GimAk3iTsI38Z-B5Gw/edit#slide=id.p" rel="nofollow">â€œä½œä¸ºå·¥ç¨‹æœ€ä½³å®è·µå·¥å…·çš„å†ç°æ€§â€</a>ï¼Œä½œè€…ï¼šJoel Grus</li>
<li><a href="https://towardsdatascience.com/checklist-for-debugging-neural-networks-d8b2a9434f21" rel="nofollow">â€œç¥ç»ç½‘ç»œè°ƒè¯•æ¸…å•â€</a> ä½œè€…ï¼šCecelia Shao</li>
<li><a href="https://medium.com/@keeper6928/how-to-unit-test-machine-learning-code-57cf6fd81765" rel="nofollow">â€œå¦‚ä½•å¯¹æœºå™¨å­¦ä¹ ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯•â€</a> by Chase Roberts</li>
<li><a href="http://karpathy.github.io/2019/04/25/recipe/" rel="nofollow">â€œè®­ç»ƒç¥ç»ç½‘ç»œçš„ç§˜è¯€â€</a>ä½œè€…ï¼šAndrej Karpathy</li></ul>
<p>å½“ç„¶ï¼Œå¹¶ä¸æ˜¯ä½ åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶é‡åˆ°çš„æ¯ä¸€ä¸ªé—®é¢˜éƒ½æ˜¯ä½ è‡ªå·±çš„é”™ï¼ å¦‚æœæ‚¨åœ¨ ğŸ¤— Transformers æˆ– ğŸ¤— Datasets åº“ä¸­é‡åˆ°çœ‹èµ·æ¥ä¸æ­£ç¡®çš„å†…å®¹ï¼Œæ‚¨å¯èƒ½é‡åˆ°äº†é”™è¯¯ã€‚ ä½ åº”è¯¥å‘Šè¯‰æˆ‘ä»¬è¿™ä¸€åˆ‡ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å‡†ç¡®è§£é‡Šå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>


		<script type="module" data-hydrate="1aarn68">
		import { start } from "/docs/course/main/zh-CN/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="1aarn68"]').parentNode,
			paths: {"base":"/docs/course/main/zh-CN","assets":"/docs/course/main/zh-CN"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/zh-CN/_app/pages/chapter8/4_tf.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
