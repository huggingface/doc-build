<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;squad&quot;,&quot;title&quot;:&quot;SQuAD æ•°æ®é›†&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¤„ç†è®­ç»ƒæ•°æ®&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¤„ç†éªŒè¯æ•°æ®&quot;}],&quot;title&quot;:&quot;å‡†å¤‡æ•°æ®&quot;},{&quot;local&quot;:&quot;trainer-api&quot;,&quot;title&quot;:&quot;ä½¿ç”¨ `Trainer` API å¾®è°ƒæ¨¡å‹&quot;},{&quot;local&quot;:&quot;keras&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;åå¤„ç†&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¾®è°ƒæ¨¡å‹&quot;}],&quot;title&quot;:&quot;ä½¿ç”¨ Keras å¾®è°ƒæ¨¡å‹&quot;},{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ä¸ºè®­ç»ƒåšå‡†å¤‡&quot;}],&quot;title&quot;:&quot;è‡ªå®šä¹‰è®­ç»ƒå¾ªç¯&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;è®­ç»ƒå¾ªç¯&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ä½¿ç”¨å¾®è°ƒæ¨¡å‹&quot;}],&quot;title&quot;:&quot;é—®ç­”&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/chapter7/7.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 id="">é—®ç­”</h1>


<div class="flex space-x-1 absolute z-10 right-0 top-0">
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter7/section7_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter7/section7_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>æ˜¯æ—¶å€™çœ‹é—®ç­”äº†! è¿™é¡¹ä»»åŠ¡æœ‰å¤šç§å½¢å¼, ä½†æˆ‘ä»¬å°†åœ¨æœ¬èŠ‚ä¸­å…³æ³¨çš„ä¸€é¡¹ç§°ä¸º<em>æå–</em>çš„é—®ç­”ã€‚é—®é¢˜çš„ç­”æ¡ˆå°±åœ¨ <em>ç»™å®šçš„æ–‡æ¡£</em> ä¹‹ä¸­ã€‚</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/ajPx5LwJD-I" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ <a href="https://rajpurkar.github.io/SQuAD-explorer/" rel="nofollow">SQuAD æ•°æ®é›†</a> å¾®è°ƒä¸€ä¸ªBERTæ¨¡å‹, å…¶ä¸­åŒ…æ‹¬ç¾¤ä¼—å·¥ä½œè€…å¯¹ä¸€ç»„ç»´åŸºç™¾ç§‘æ–‡ç« æå‡ºçš„é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°çš„æµ‹è¯•æ ·ä¾‹:</p>
<iframe src="https://hf.space/gradioiframe/course-demos/bert-finetuned-squad/+" frameborder="0" height="450" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<iframe src="https://hf.space/gradioiframe/course-demos/bert-finetuned-squad-darkmode/+" frameborder="0" height="450" title="Gradio app" class="hidden dark:block container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<p>æœ¬èŠ‚ä½¿ç”¨çš„ä»£ç å·²ç»ä¸Šä¼ åˆ°äº†Hubã€‚ä½ å¯ä»¥åœ¨ <a href="https://huggingface.co/huggingface-course/bert-finetuned-squad?context=%F0%9F%A4%97+Transformers+is+backed+by+the+three+most+popular+deep+learning+libraries+%E2%80%94+Jax%2C+PyTorch+and+TensorFlow+%E2%80%94+with+a+seamless+integration+between+them.+It%27s+straightforward+to+train+your+models+with+one+before+loading+them+for+inference+with+the+other.&question=Which+deep+learning+libraries+back+%F0%9F%A4%97+Transformers%3F" rel="nofollow">è¿™é‡Œ</a> æ‰¾åˆ°å®ƒå¹¶å°è¯•ç”¨å®ƒè¿›è¡Œé¢„æµ‹ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ åƒ BERT è¿™æ ·çš„çº¯ç¼–ç å™¨æ¨¡å‹å¾€å¾€å¾ˆæ“…é•¿æå–è¯¸å¦‚ â€œè°å‘æ˜äº† Transformer æ¶æ„?â€ä¹‹ç±»çš„äº‹å®æ€§é—®é¢˜çš„ç­”æ¡ˆã€‚ä½†åœ¨ç»™å‡ºè¯¸å¦‚ â€œä¸ºä»€ä¹ˆå¤©ç©ºæ˜¯è“è‰²çš„?â€ ä¹‹ç±»çš„å¼€æ”¾å¼é—®é¢˜æ—¶è¡¨ç°ä¸ä½³ã€‚åœ¨è¿™äº›æ›´å…·æŒ‘æˆ˜æ€§çš„æƒ…å†µä¸‹, T5 å’Œ BART ç­‰ç¼–ç å™¨-è§£ç å™¨æ¨¡å‹é€šå¸¸ä½¿ç”¨ä»¥ä¸ <a href="/course/chapter7/5">æ–‡æœ¬æ‘˜è¦</a> éå¸¸ç›¸ä¼¼çš„æ–¹å¼åˆæˆä¿¡æ¯ã€‚å¦‚æœä½ å¯¹è¿™ç§ç±»å‹çš„<em>ç”Ÿæˆå¼</em>é—®ç­”æ„Ÿå…´è¶£, æˆ‘ä»¬å»ºè®®æ‚¨æŸ¥çœ‹æˆ‘ä»¬åŸºäº <a href="https://huggingface.co/datasets/eli5" rel="nofollow">ELI5 æ•°æ®é›†</a> çš„ <a href="https://yjernite.github.io/lfqa.html" rel="nofollow">æ¼”ç¤º</a>ã€‚</p></div>
<h2 id="">å‡†å¤‡æ•°æ®</h2>
<p>æœ€å¸¸ç”¨ä½œæŠ½å–å¼é—®ç­”çš„å­¦æœ¯åŸºå‡†çš„æ•°æ®é›†æ˜¯ <a href="https://rajpurkar.github.io/SQuAD-explorer/" rel="nofollow">SQuAD</a>, æ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬å°†åœ¨è¿™é‡Œä½¿ç”¨çš„ã€‚è¿˜æœ‰ä¸€ä¸ªæ›´éš¾çš„ <a href="https://huggingface.co/datasets/squad_v2" rel="nofollow">SQuAD v2</a> åŸºå‡†, å…¶ä¸­åŒ…æ‹¬æ²¡æœ‰ç­”æ¡ˆçš„é—®é¢˜ã€‚åªè¦ä½ è‡ªå·±çš„æ•°æ®é›†åŒ…å«ä¸Šä¸‹æ–‡åˆ—ã€é—®é¢˜åˆ—å’Œç­”æ¡ˆåˆ—, ä½ å°±åº”è¯¥èƒ½å¤Ÿè°ƒæ•´ä»¥ä¸‹æ­¥éª¤ã€‚</p>
<h3 class="relative group"><a id="squad" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#squad"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>SQuAD æ•°æ®é›†
	</span></h3>

<p>åƒå¾€å¸¸ä¸€æ ·, æˆ‘ä»¬åªéœ€ä¸€æ­¥å°±å¯ä»¥ä¸‹è½½å’Œç¼“å­˜æ•°æ®é›†, è¿™è¦å½’åŠŸäº <code>load_dataset()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

raw_datasets = load_dataset(<span class="hljs-string">&quot;squad&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¿™ä¸ªå¯¹è±¡ä»¥, äº†è§£æœ‰å…³ SQuAD æ•°æ®é›†çš„æ›´å¤šä¿¡æ¯:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
        num_rows: <span class="hljs-number">87599</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
        num_rows: <span class="hljs-number">10570</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>çœ‹èµ·æ¥æˆ‘ä»¬æ‹¥æœ‰æ‰€éœ€çš„ <code>context</code> ã€<code>question</code> å’Œ <code>answers</code> å­—æ®µ, æ‰€ä»¥è®©æˆ‘ä»¬æ‰“å°è®­ç»ƒé›†çš„ç¬¬ä¸€ä¸ªå…ƒç´ :</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Context: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;context&quot;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Question: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;question&quot;</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Answer: &quot;</span>, raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;answers&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Context: <span class="hljs-string">&#x27;Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot;Venite Ad Me Omnes&quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive (and in a direct line that connects through 3 statues and the Gold Dome), is a simple, modern stone statue of Mary.&#x27;</span>
Question: <span class="hljs-string">&#x27;To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France?&#x27;</span>
Answer: {<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Saint Bernadette Soubirous&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">515</span>]}<!-- HTML_TAG_END --></pre></div>
<p><code>context</code> å’Œ <code>question</code> å­—æ®µä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ã€‚ä½†æ˜¯ <code>answers</code> å­—æ®µæœ‰ç‚¹æ£˜æ‰‹, å› ä¸ºå®ƒå°†å­—å…¸ä¸ä¸¤ä¸ªéƒ½æ˜¯åˆ—è¡¨çš„å­—æ®µç»„æˆã€‚è¿™æ˜¯åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­ <code>squad</code> æŒ‡æ ‡æ‰€æœŸæœ›çš„æ ¼å¼; å¦‚æœä½ ä½¿ç”¨çš„æ˜¯è‡ªå·±çš„æ•°æ®, åˆ™ä¸å¿…æ‹…å¿ƒå°†ç­”æ¡ˆé‡‡ç”¨ç›¸åŒçš„æ ¼å¼ã€‚<code>text</code> å­—æ®µæ¯”è¾ƒæ˜æ˜¾, è€Œ <code>answer_start</code> å­—æ®µåŒ…å«ä¸Šä¸‹æ–‡ä¸­æ¯ä¸ªç­”æ¡ˆçš„èµ·å§‹å­—ç¬¦ç´¢å¼•ã€‚</p>
<p>åœ¨è®­ç»ƒæœŸé—´, åªæœ‰ä¸€ç§å¯èƒ½çš„ç­”æ¡ˆã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Dataset.filter()</code> æ–¹æ³•:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">len</span>(x[<span class="hljs-string">&quot;answers&quot;</span>][<span class="hljs-string">&quot;text&quot;</span>]) != <span class="hljs-number">1</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Dataset({
    features: [<span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;context&#x27;</span>, <span class="hljs-string">&#x27;question&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>],
    num_rows: <span class="hljs-number">0</span>
})<!-- HTML_TAG_END --></pre></div>
<p>ç„¶è€Œ, å¯¹äºè¯„ä¼°, æ¯ä¸ªæ ·æœ¬éƒ½æœ‰å‡ ä¸ªå¯èƒ½çš„ç­”æ¡ˆ, å®ƒä»¬å¯èƒ½ç›¸åŒæˆ–ä¸åŒ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;answers&quot;</span>])
<span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;answers&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">177</span>, <span class="hljs-number">177</span>, <span class="hljs-number">177</span>]}
{<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Santa Clara, California&#x27;</span>, <span class="hljs-string">&quot;Levi&#x27;s Stadium&quot;</span>, <span class="hljs-string">&quot;Levi&#x27;s Stadium in the San Francisco Bay Area at Santa Clara, California.&quot;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">403</span>, <span class="hljs-number">355</span>, <span class="hljs-number">355</span>]}<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬ä¸ä¼šæ·±å…¥ç ”ç©¶è¯„ä¼°è„šæœ¬, å› ä¸ºå®ƒéƒ½ä¼šè¢«ä¸€ä¸ª ğŸ¤— Datasets æŒ‡æ ‡åŒ…è£¹èµ·æ¥, ä½†ç®€çŸ­çš„ç‰ˆæœ¬æ˜¯ä¸€äº›é—®é¢˜æœ‰å‡ ä¸ªå¯èƒ½çš„ç­”æ¡ˆ, è¿™ä¸ªè„šæœ¬ä¼šå°†é¢„æµ‹çš„ç­”æ¡ˆä¸æ‰€æœ‰â€‹â€‹çš„å¯æ¥å—çš„ç­”æ¡ˆå¹¶è·å¾—æœ€é«˜åˆ†ã€‚ä¾‹å¦‚, æˆ‘ä»¬çœ‹ä¸€ä¸‹ç´¢å¼• 2 å¤„çš„æ ·æœ¬e:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;context&quot;</span>])
<span class="hljs-built_in">print</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&quot;question&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Super Bowl 50 was an American football game to determine the champion of the National Football League (NFL) for the 2015 season. The American Football Conference (AFC) champion Denver Broncos defeated the National Football Conference (NFC) champion Carolina Panthers 24â€“10 to earn their third Super Bowl title. The game was played on February 7, 2016, at Levi\&#x27;s Stadium in the San Francisco Bay Area at Santa Clara, California. As this was the 50th Super Bowl, the league emphasized the &quot;golden anniversary&quot; with various gold-themed initiatives, as well as temporarily suspending the tradition of naming each Super Bowl game with Roman numerals (under which the game would have been known as &quot;Super Bowl L&quot;), so that the logo could prominently feature the Arabic numerals 50.&#x27;</span>
<span class="hljs-string">&#x27;Where did Super Bowl 50 take place?&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, ç­”æ¡ˆç¡®å®å¯ä»¥æ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ä¸‰ç§å¯èƒ½æ€§ä¹‹ä¸€ã€‚</p>
<h3 id="">å¤„ç†è®­ç»ƒæ•°æ®</h3>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/qgaM0weJHpA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>è®©æˆ‘ä»¬ä»é¢„å¤„ç†è®­ç»ƒæ•°æ®å¼€å§‹ã€‚å›°éš¾çš„éƒ¨åˆ†å°†æ˜¯ä¸ºé—®é¢˜çš„ç­”æ¡ˆç”Ÿæˆæ ‡ç­¾, è¿™å°†æ˜¯ä¸ä¸Šä¸‹æ–‡ä¸­çš„ç­”æ¡ˆç›¸å¯¹åº”çš„æ ‡è®°çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚</p>
<p>ä½†æ˜¯, æˆ‘ä»¬ä¸è¦è¶…è¶Šè‡ªå·±ã€‚é¦–å…ˆ, æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ†è¯å™¨å°†è¾“å…¥ä¸­çš„æ–‡æœ¬è½¬æ¢ä¸ºæ¨¡å‹å¯ä»¥ç†è§£çš„ ID:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_checkpoint = <span class="hljs-string">&quot;bert-base-cased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>å¦‚å‰æ‰€è¿°, æˆ‘ä»¬å°†å¯¹ BERT æ¨¡å‹è¿›è¡Œå¾®è°ƒ, ä½†ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å…¶ä»–æ¨¡å‹ç±»å‹, åªè¦å®ƒå®ç°äº†å¿«é€Ÿæ ‡è®°å™¨å³å¯ã€‚ä½ å¯ä»¥åœ¨ <a href="https://huggingface.co/transformers/#supported-frameworks" rel="nofollow">this big table</a> ä¸­çœ‹åˆ°æ‰€æœ‰å¿«é€Ÿç‰ˆæœ¬çš„æ¶æ„, å¹¶æ£€æŸ¥ä½ æ­£åœ¨ä½¿ç”¨çš„ <code>tokenizer</code> å¯¹è±¡ç¡®å®ç”± ğŸ¤— Tokenizers æ”¯æŒ, ä½ å¯ä»¥æŸ¥çœ‹å®ƒçš„ <code>is_fast</code> å±æ€§:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.is_fast<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-literal">True</span><!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬å¯ä»¥å°†é—®é¢˜å’Œä¸Šä¸‹æ–‡ä¸€èµ·ä¼ é€’ç»™æˆ‘ä»¬çš„æ ‡è®°å™¨, å®ƒä¼šæ­£ç¡®æ’å…¥ç‰¹æ®Šæ ‡è®°ä»¥å½¢æˆå¦‚ä¸‹å¥å­:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-selector-attr">[CLS]</span> question <span class="hljs-selector-attr">[SEP]</span> context <span class="hljs-selector-attr">[SEP]</span><!-- HTML_TAG_END --></pre></div>
<p>è®©æˆ‘ä»¬ä»”ç»†æ£€æŸ¥ä¸€ä¸‹:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->context = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;context&quot;</span>]
question = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&quot;question&quot;</span>]

inputs = tokenizer(question, context)
tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Architecturally, &#x27;</span>
<span class="hljs-string">&#x27;the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin &#x27;</span>
<span class="hljs-string">&#x27;Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms &#x27;</span>
<span class="hljs-string">&#x27;upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred &#x27;</span>
<span class="hljs-string">&#x27;Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a &#x27;</span>
<span class="hljs-string">&#x27;replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette &#x27;</span>
<span class="hljs-string">&#x27;Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 statues &#x27;</span>
<span class="hljs-string">&#x27;and the Gold Dome ), is a simple, modern stone statue of Mary. [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ç„¶åæ ‡ç­¾å°†æˆä¸ºå¼€å§‹å’Œç»“æŸç­”æ¡ˆçš„æ ‡è®°çš„ç´¢å¼•, å¹¶ä¸”æ¨¡å‹çš„ä»»åŠ¡æ˜¯é¢„æµ‹è¾“å…¥ä¸­æ¯ä¸ªæ ‡è®°çš„å¼€å§‹å’Œç»“æŸ logit, ç†è®ºæ ‡ç­¾å¦‚ä¸‹:</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/qa_labels.svg" alt="One-hot encoded labels for question answering.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/qa_labels-dark.svg" alt="One-hot encoded labels for question answering."></div>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹, ä¸Šä¸‹æ–‡ä¸ä¼šå¤ªé•¿, ä½†æ˜¯æ•°æ®é›†ä¸­çš„ä¸€äº›ç¤ºä¾‹çš„ä¸Šä¸‹æ–‡å¾ˆé•¿, ä¼šè¶…è¿‡æˆ‘ä»¬è®¾ç½®çš„æœ€å¤§é•¿åº¦(åœ¨è¿™ç§æƒ…å†µä¸‹ä¸º 384)ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ <a href="/course/chapter6/4">ç¬¬å…­ç« </a> ä¸­æ‰€çœ‹åˆ°çš„, å½“æˆ‘ä»¬æ¢ç´¢ <code>question-answering</code> ç®¡é“çš„å†…éƒ¨ç»“æ„æ—¶, æˆ‘ä»¬å°†é€šè¿‡ä»æˆ‘ä»¬çš„æ•°æ®é›†çš„ä¸€ä¸ªæ ·æœ¬ä¸­åˆ›å»ºå‡ ä¸ªè®­ç»ƒç‰¹å¾æ¥å¤„ç†é•¿ä¸Šä¸‹æ–‡, å®ƒä»¬ä¹‹é—´æœ‰ä¸€ä¸ªæ»‘åŠ¨çª—å£ã€‚</p>
<p>è¦ä½¿ç”¨å½“å‰ç¤ºä¾‹æŸ¥çœ‹å…¶å·¥ä½œåŸç†, æˆ‘ä»¬å¯ä»¥å°†é•¿åº¦é™åˆ¶ä¸º 100, å¹¶ä½¿ç”¨ 50 ä¸ªæ ‡è®°çš„æ»‘åŠ¨çª—å£ã€‚æé†’ä¸€ä¸‹, æˆ‘ä»¬ä½¿ç”¨:</p>
<ul><li><code>max_length</code> è®¾ç½®æœ€å¤§é•¿åº¦ (æ­¤å¤„ä¸º 100)</li>
<li><code>truncation=&quot;only_second&quot;</code> ç”¨äºå½“å¸¦æœ‰ä¸Šä¸‹æ–‡çš„é—®é¢˜å¤ªé•¿æ—¶, æˆªæ–­ä¸Šä¸‹æ–‡t (ä½äºç¬¬äºŒä¸ªä½ç½®) </li>
<li><code>stride</code> è®¾ç½®ä¸¤ä¸ªè¿ç»­å—ä¹‹é—´çš„é‡å æ ‡è®°æ•° (è¿™é‡Œä¸º 50)</li>
<li><code>return_overflowing_tokens=True</code> è®©æ ‡è®°å™¨çŸ¥é“æˆ‘ä»¬æƒ³è¦æº¢å‡ºçš„æ ‡è®°</li></ul>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    question,
    context,
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
)

<span class="hljs-keyword">for</span> ids <span class="hljs-keyword">in</span> inputs[<span class="hljs-string">&quot;input_ids&quot;</span>]:
    <span class="hljs-built_in">print</span>(tokenizer.decode(ids))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basi [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP] Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 [SEP]&#x27;</span>
<span class="hljs-string">&#x27;[CLS] To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France? [SEP]. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive ( and in a direct line that connects through 3 statues and the Gold Dome ), is a simple, modern stone statue of Mary. [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>å¦‚æˆ‘ä»¬æ‰€è§, æˆ‘ä»¬çš„ç¤ºä¾‹è¢«åˆ†æˆå››ä¸ªè¾“å…¥, æ¯ä¸ªè¾“å…¥éƒ½åŒ…å«é—®é¢˜å’Œä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†ã€‚ è¯·æ³¨æ„, é—®é¢˜çš„ç­”æ¡ˆ (â€œBernadette Soubirousâ€) ä»…å‡ºç°åœ¨ç¬¬ä¸‰ä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªè¾“å…¥ä¸­, å› æ­¤é€šè¿‡ä»¥è¿™ç§æ–¹å¼å¤„ç†é•¿ä¸Šä¸‹æ–‡, æˆ‘ä»¬å°†åˆ›å»ºä¸€äº›ç­”æ¡ˆä¸åŒ…å«åœ¨ä¸Šä¸‹æ–‡ä¸­çš„è®­ç»ƒç¤ºä¾‹ã€‚å¯¹äºè¿™äº›ç¤ºä¾‹, æ ‡ç­¾å°†æ˜¯ <code>start_position = end_position = 0</code> (æ‰€ä»¥æˆ‘ä»¬é¢„æµ‹ <code>[CLS]</code> æ ‡è®°)ã€‚æˆ‘ä»¬è¿˜å°†åœ¨ç­”æ¡ˆè¢«æˆªæ–­çš„ä¸å¹¸æƒ…å†µä¸‹è®¾ç½®è¿™äº›æ ‡ç­¾, ä»¥ä¾¿æˆ‘ä»¬åªæœ‰å®ƒçš„å¼€å§‹(æˆ–ç»“æŸ)ã€‚å¯¹äºç­”æ¡ˆå®Œå…¨åœ¨ä¸Šä¸‹æ–‡ä¸­çš„ç¤ºä¾‹, æ ‡ç­¾å°†æ˜¯ç­”æ¡ˆå¼€å§‹çš„æ ‡è®°çš„ç´¢å¼•å’Œç­”æ¡ˆç»“æŸçš„æ ‡è®°çš„ç´¢å¼•ã€‚</p>
<p>æ•°æ®é›†ä¸ºæˆ‘ä»¬æä¾›äº†ä¸Šä¸‹æ–‡ä¸­ç­”æ¡ˆçš„å¼€å§‹å­—ç¬¦, é€šè¿‡æ·»åŠ ç­”æ¡ˆçš„é•¿åº¦, æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸Šä¸‹æ–‡ä¸­çš„ç»“æŸå­—ç¬¦ã€‚è¦å°†å®ƒä»¬æ˜ å°„åˆ°ä»¤ç‰Œç´¢å¼•, æˆ‘ä»¬å°†éœ€è¦ä½¿ç”¨æˆ‘ä»¬åœ¨ <a href="/course/chapter6/4">ç¬¬å…­ç« </a> ä¸­ç ”ç©¶çš„åç§»æ˜ å°„ã€‚æˆ‘ä»¬å¯ä»¥è®©æ ‡è®°å™¨é€šè¿‡ä¼ é€’ <code>return_offsets_mapping=True</code> æ¥è¿”å›è¿™äº›å€¼:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    question,
    context,
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
    return_offsets_mapping=<span class="hljs-literal">True</span>,
)
inputs.keys()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->dict_keys([<span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;offset_mapping&#x27;</span>, <span class="hljs-string">&#x27;overflow_to_sample_mapping&#x27;</span>])<!-- HTML_TAG_END --></pre></div>
<p>å¦‚æˆ‘ä»¬æ‰€è§, æˆ‘ä»¬å–å›äº†é€šå¸¸çš„è¾“å…¥ IDã€ä»¤ç‰Œç±»å‹ ID å’Œæ³¨æ„æ©ç , ä»¥åŠæˆ‘ä»¬éœ€è¦çš„åç§»æ˜ å°„å’Œä¸€ä¸ªé¢å¤–çš„é”®, <code>overflow_to_sample_mapping</code>ã€‚å½“æˆ‘ä»¬åŒæ—¶æ ‡è®°å¤šä¸ªæ–‡æœ¬æ—¶, ç›¸åº”çš„å€¼å°†å¯¹æˆ‘ä»¬æœ‰ç”¨(æˆ‘ä»¬åº”è¯¥è¿™æ ·åšä»¥å—ç›Šäºæˆ‘ä»¬çš„æ ‡è®°å™¨ç”± Rust æ”¯æŒçš„äº‹å®)ã€‚ç”±äºä¸€ä¸ªæ ·æœ¬å¯ä»¥æä¾›å¤šä¸ªç‰¹å¾, å› æ­¤å®ƒå°†æ¯ä¸ªç‰¹å¾æ˜ å°„åˆ°å…¶æ¥æºçš„ç¤ºä¾‹ã€‚å› ä¸ºè¿™é‡Œæˆ‘ä»¬åªæ ‡è®°äº†ä¸€ä¸ªä¾‹å­, æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ª <code>0</code> çš„åˆ—è¡¨:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>
<p>ä½†æ˜¯, å¦‚æœæˆ‘ä»¬æ ‡è®°æ›´å¤šç¤ºä¾‹, è¿™å°†å˜å¾—æ›´åŠ æœ‰ç”¨:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(
    raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;question&quot;</span>],
    raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;context&quot;</span>],
    max_length=<span class="hljs-number">100</span>,
    truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
    stride=<span class="hljs-number">50</span>,
    return_overflowing_tokens=<span class="hljs-literal">True</span>,
    return_offsets_mapping=<span class="hljs-literal">True</span>,
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;The 4 examples gave <span class="hljs-subst">{<span class="hljs-built_in">len</span>(inputs[<span class="hljs-string">&#x27;input_ids&#x27;</span>])}</span> features.&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Here is where each comes from: <span class="hljs-subst">{inputs[<span class="hljs-string">&#x27;overflow_to_sample_mapping&#x27;</span>]}</span>.&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;The 4 examples gave 19 features.&#x27;</span>
<span class="hljs-string">&#x27;Here is where each comes from: [0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3].&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„, å‰ä¸‰ä¸ªç¤ºä¾‹ (åœ¨è®­ç»ƒé›†ä¸­çš„ç´¢å¼• 2ã€3 å’Œ 4 å¤„) æ¯ä¸ªéƒ½ç»™å‡ºäº†å››ä¸ªç‰¹å¾, æœ€åä¸€ä¸ªç¤ºä¾‹(åœ¨è®­ç»ƒé›†ä¸­çš„ç´¢å¼• 5 å¤„) ç»™å‡ºäº† 7 ä¸ªç‰¹å¾ã€‚</p>
<p>æ­¤ä¿¡æ¯å°†æœ‰åŠ©äºå°†æˆ‘ä»¬è·å¾—çš„æ¯ä¸ªç‰¹å¾æ˜ å°„åˆ°å…¶ç›¸åº”çš„æ ‡ç­¾ã€‚å¦‚å‰æ‰€è¿°, è¿™äº›æ ‡ç­¾æ˜¯:</p>
<ul><li><code>(0, 0)</code> å¦‚æœç­”æ¡ˆä¸åœ¨ä¸Šä¸‹æ–‡çš„ç›¸åº”èŒƒå›´å†…</li>
<li><code>(start_position, end_position)</code> å¦‚æœç­”æ¡ˆåœ¨ä¸Šä¸‹æ–‡çš„ç›¸åº”èŒƒå›´å†…, åˆ™ <code>start_position</code> æ˜¯ç­”æ¡ˆå¼€å¤´çš„æ ‡è®°ç´¢å¼• (åœ¨è¾“å…¥ ID ä¸­), å¹¶ä¸” <code>end_position</code> æ˜¯ç­”æ¡ˆç»“æŸçš„æ ‡è®°çš„ç´¢å¼• (åœ¨è¾“å…¥ ID ä¸­)ã€‚</li></ul>
<p>ä¸ºäº†ç¡®å®šæ˜¯å“ªç§æƒ…å†µä»¥åŠæ ‡è®°çš„ä½ç½®, ä»¥åŠ(å¦‚æœç›¸å…³çš„è¯)æ ‡è®°çš„ä½ç½®, æˆ‘ä»¬é¦–å…ˆåœ¨è¾“å…¥ ID ä¸­æ‰¾åˆ°å¼€å§‹å’Œç»“æŸä¸Šä¸‹æ–‡çš„ç´¢å¼•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡è®°ç±»å‹ ID æ¥æ‰§è¡Œæ­¤æ“ä½œ, ä½†ç”±äºè¿™äº› ID ä¸ä¸€å®šå­˜åœ¨äºæ‰€æœ‰æ¨¡å‹ä¸­ (ä¾‹å¦‚, DistilBERT ä¸éœ€è¦å®ƒä»¬), æˆ‘ä»¬å°†æ”¹ä¸ºä½¿ç”¨æˆ‘ä»¬çš„æ ‡è®°å™¨è¿”å›çš„ <code>BatchEncoding</code> çš„ <code>sequence_ids()</code> æ–¹æ³•ã€‚</p>
<p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¿™äº›æ ‡è®°ç´¢å¼•, æˆ‘ä»¬å°±ä¼šæŸ¥çœ‹ç›¸åº”çš„åç§»é‡, å®ƒä»¬æ˜¯ä¸¤ä¸ªæ•´æ•°çš„å…ƒç»„, è¡¨ç¤ºåŸå§‹ä¸Šä¸‹æ–‡ä¸­çš„å­—ç¬¦èŒƒå›´ã€‚å› æ­¤, æˆ‘ä»¬å¯ä»¥æ£€æµ‹æ­¤ç‰¹å¾ä¸­çš„ä¸Šä¸‹æ–‡å—æ˜¯åœ¨ç­”æ¡ˆä¹‹åå¼€å§‹è¿˜æ˜¯åœ¨ç­”æ¡ˆå¼€å§‹ä¹‹å‰ç»“æŸ(åœ¨è¿™ç§æƒ…å†µä¸‹, æ ‡ç­¾æ˜¯ <code>(0, 0)</code>)ã€‚å¦‚æœä¸æ˜¯è¿™æ ·, æˆ‘ä»¬å¾ªç¯æŸ¥æ‰¾ç­”æ¡ˆçš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæ ‡è®°:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->answers = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">2</span>:<span class="hljs-number">6</span>][<span class="hljs-string">&quot;answers&quot;</span>]
start_positions = []
end_positions = []

<span class="hljs-keyword">for</span> i, offset <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>]):
    sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][i]
    answer = answers[sample_idx]
    start_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>]
    end_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>] + <span class="hljs-built_in">len</span>(answer[<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>])
    sequence_ids = inputs.sequence_ids(i)

    <span class="hljs-comment"># Find the start and end of the context</span>
    idx = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> sequence_ids[idx] != <span class="hljs-number">1</span>:
        idx += <span class="hljs-number">1</span>
    context_start = idx
    <span class="hljs-keyword">while</span> sequence_ids[idx] == <span class="hljs-number">1</span>:
        idx += <span class="hljs-number">1</span>
    context_end = idx - <span class="hljs-number">1</span>

    <span class="hljs-comment"># If the answer is not fully inside the context, label is (0, 0)</span>
    <span class="hljs-keyword">if</span> offset[context_start][<span class="hljs-number">0</span>] &gt; start_char <span class="hljs-keyword">or</span> offset[context_end][<span class="hljs-number">1</span>] &lt; end_char:
        start_positions.append(<span class="hljs-number">0</span>)
        end_positions.append(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># Otherwise it&#x27;s the start and end token positions</span>
        idx = context_start
        <span class="hljs-keyword">while</span> idx &lt;= context_end <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">0</span>] &lt;= start_char:
            idx += <span class="hljs-number">1</span>
        start_positions.append(idx - <span class="hljs-number">1</span>)

        idx = context_end
        <span class="hljs-keyword">while</span> idx &gt;= context_start <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">1</span>] &gt;= end_char:
            idx -= <span class="hljs-number">1</span>
        end_positions.append(idx + <span class="hljs-number">1</span>)

start_positions, end_positions<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->([<span class="hljs-number">83</span>, <span class="hljs-number">51</span>, <span class="hljs-number">19</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">27</span>, <span class="hljs-number">0</span>, <span class="hljs-number">34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">67</span>, <span class="hljs-number">34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
 [<span class="hljs-number">85</span>, <span class="hljs-number">53</span>, <span class="hljs-number">21</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">70</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">68</span>, <span class="hljs-number">35</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<!-- HTML_TAG_END --></pre></div>
<p>è®©æˆ‘ä»¬çœ‹ä¸€äº›ç»“æœæ¥éªŒè¯æˆ‘ä»¬çš„æ–¹æ³•æ˜¯å¦æ­£ç¡®ã€‚å¯¹äºæˆ‘ä»¬å‘ç°çš„ç¬¬ä¸€ä¸ªç‰¹å¾, æˆ‘ä»¬å°† <code>(83, 85)</code> ä½œä¸ºæ ‡ç­¾, è®©æˆ‘ä»¬å°†ç†è®ºç­”æ¡ˆä¸ä» 83 åˆ° 85 (åŒ…æ‹¬)çš„æ ‡è®°è§£ç èŒƒå›´è¿›è¡Œæ¯”è¾ƒ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->idx = <span class="hljs-number">0</span>
sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][idx]
answer = answers[sample_idx][<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>]

start = start_positions[idx]
end = end_positions[idx]
labeled_answer = tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][idx][start : end + <span class="hljs-number">1</span>])

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Theoretical answer: <span class="hljs-subst">{answer}</span>, labels give: <span class="hljs-subst">{labeled_answer}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Theoretical answer: the Main Building, labels give: the Main Building&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>æ‰€ä»¥è¿™æ˜¯ä¸€åœºæ¯”èµ›! ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥ç´¢å¼• 4, æˆ‘ä»¬å°†æ ‡ç­¾è®¾ç½®ä¸º <code>(0, 0)</code>, è¿™æ„å‘³ç€ç­”æ¡ˆä¸åœ¨è¯¥åŠŸèƒ½çš„ä¸Šä¸‹æ–‡å—ä¸­</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->idx = <span class="hljs-number">4</span>
sample_idx = inputs[<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>][idx]
answer = answers[sample_idx][<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>]

decoded_example = tokenizer.decode(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>][idx])
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Theoretical answer: <span class="hljs-subst">{answer}</span>, decoded example: <span class="hljs-subst">{decoded_example}</span>&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;Theoretical answer: a Marian place of prayer and reflection, decoded example: [CLS] What is the Grotto at Notre Dame? [SEP] Architecturally, the school has a Catholic character. Atop the Main Building\&#x27;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot; Venite Ad Me Omnes &quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grot [SEP]&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>äº‹å®ä¸Š, æˆ‘ä»¬åœ¨ä¸Šä¸‹æ–‡ä¸­çœ‹ä¸åˆ°ç­”æ¡ˆã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>è½®åˆ°ä½ äº†!</strong> ä½¿ç”¨ XLNet æ¶æ„æ—¶, åœ¨å·¦ä¾§åº”ç”¨å¡«å……, å¹¶åˆ‡æ¢é—®é¢˜å’Œä¸Šä¸‹æ–‡ã€‚å°†æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„æ‰€æœ‰ä»£ç æ”¹ç¼–ä¸º XLNet æ¶æ„ (å¹¶æ·»åŠ  <code>padding=True</code>)ã€‚è¯·æ³¨æ„, <code>[CLS]</code> æ ‡è®°å¯èƒ½ä¸åœ¨åº”ç”¨å¡«å……çš„ 0 ä½ç½®ã€‚</p></div>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»é€æ­¥äº†è§£äº†å¦‚ä½•é¢„å¤„ç†æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®, æˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†ç»„åˆ°ä¸€ä¸ªå‡½æ•°ä¸­, æˆ‘ä»¬å°†åº”ç”¨äºæ•´ä¸ªè®­ç»ƒæ•°æ®é›†ã€‚æˆ‘ä»¬ä¼šå°†æ¯ä¸ªç‰¹å¾å¡«å……åˆ°æˆ‘ä»¬è®¾ç½®çš„æœ€å¤§é•¿åº¦, å› ä¸ºå¤§å¤šæ•°ä¸Šä¸‹æ–‡ä¼šå¾ˆé•¿ (å¹¶ä¸”ç›¸åº”çš„æ ·æœ¬å°†è¢«åˆ†æˆå‡ ä¸ªç‰¹å¾), æ‰€ä»¥åœ¨è¿™é‡Œåº”ç”¨åŠ¨æ€å¡«å……æ²¡æœ‰çœŸæ­£çš„å¥½å¤„:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->max_length = <span class="hljs-number">384</span>
stride = <span class="hljs-number">128</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_training_examples</span>(<span class="hljs-params">examples</span>):
    questions = [q.strip() <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> examples[<span class="hljs-string">&quot;question&quot;</span>]]
    inputs = tokenizer(
        questions,
        examples[<span class="hljs-string">&quot;context&quot;</span>],
        max_length=max_length,
        truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
        stride=stride,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
        return_offsets_mapping=<span class="hljs-literal">True</span>,
        padding=<span class="hljs-string">&quot;max_length&quot;</span>,
    )

    offset_mapping = inputs.pop(<span class="hljs-string">&quot;offset_mapping&quot;</span>)
    sample_map = inputs.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    answers = examples[<span class="hljs-string">&quot;answers&quot;</span>]
    start_positions = []
    end_positions = []

    <span class="hljs-keyword">for</span> i, offset <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(offset_mapping):
        sample_idx = sample_map[i]
        answer = answers[sample_idx]
        start_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>]
        end_char = answer[<span class="hljs-string">&quot;answer_start&quot;</span>][<span class="hljs-number">0</span>] + <span class="hljs-built_in">len</span>(answer[<span class="hljs-string">&quot;text&quot;</span>][<span class="hljs-number">0</span>])
        sequence_ids = inputs.sequence_ids(i)

        <span class="hljs-comment"># Find the start and end of the context</span>
        idx = <span class="hljs-number">0</span>
        <span class="hljs-keyword">while</span> sequence_ids[idx] != <span class="hljs-number">1</span>:
            idx += <span class="hljs-number">1</span>
        context_start = idx
        <span class="hljs-keyword">while</span> sequence_ids[idx] == <span class="hljs-number">1</span>:
            idx += <span class="hljs-number">1</span>
        context_end = idx - <span class="hljs-number">1</span>

        <span class="hljs-comment"># If the answer is not fully inside the context, label is (0, 0)</span>
        <span class="hljs-keyword">if</span> offset[context_start][<span class="hljs-number">0</span>] &gt; start_char <span class="hljs-keyword">or</span> offset[context_end][<span class="hljs-number">1</span>] &lt; end_char:
            start_positions.append(<span class="hljs-number">0</span>)
            end_positions.append(<span class="hljs-number">0</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Otherwise it&#x27;s the start and end token positions</span>
            idx = context_start
            <span class="hljs-keyword">while</span> idx &lt;= context_end <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">0</span>] &lt;= start_char:
                idx += <span class="hljs-number">1</span>
            start_positions.append(idx - <span class="hljs-number">1</span>)

            idx = context_end
            <span class="hljs-keyword">while</span> idx &gt;= context_start <span class="hljs-keyword">and</span> offset[idx][<span class="hljs-number">1</span>] &gt;= end_char:
                idx -= <span class="hljs-number">1</span>
            end_positions.append(idx + <span class="hljs-number">1</span>)

    inputs[<span class="hljs-string">&quot;start_positions&quot;</span>] = start_positions
    inputs[<span class="hljs-string">&quot;end_positions&quot;</span>] = end_positions
    <span class="hljs-keyword">return</span> inputs<!-- HTML_TAG_END --></pre></div>
<p>è¯·æ³¨æ„, æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå¸¸æ•°æ¥ç¡®å®šä½¿ç”¨çš„æœ€å¤§é•¿åº¦ä»¥åŠæ»‘åŠ¨çª—å£çš„é•¿åº¦, å¹¶ä¸”æˆ‘ä»¬åœ¨æ ‡è®°åŒ–ä¹‹å‰æ·»åŠ äº†ä¸€ç‚¹æ¸…ç†: SQuAD æ•°æ®é›†ä¸­çš„ä¸€äº›é—®é¢˜åœ¨å¼€å¤´æœ‰é¢å¤–çš„ç©ºæ ¼, å¹¶ä¸”ä¸æ·»åŠ ä»»ä½•å†…å®¹çš„ç»“å°¾ (å¦‚æœä½ ä½¿ç”¨åƒ RoBERTa è¿™æ ·çš„æ¨¡å‹, åˆ™åœ¨æ ‡è®°åŒ–æ—¶ä¼šå ç”¨ç©ºé—´), å› æ­¤æˆ‘ä»¬åˆ é™¤äº†é‚£äº›é¢å¤–çš„ç©ºæ ¼ã€‚</p>
<p>ä¸ºäº†å°†æ­¤å‡½æ•°åº”ç”¨äºæ•´ä¸ªè®­ç»ƒé›†, æˆ‘ä»¬ä½¿ç”¨ <code>Dataset.map()</code> æ–¹æ³•ä¸ <code>batched=True</code> æ ‡å¿—ã€‚è¿™æ˜¯å¿…è¦çš„, å› ä¸ºæˆ‘ä»¬æ­£åœ¨æ›´æ”¹æ•°æ®é›†çš„é•¿åº¦(å› ä¸ºä¸€ä¸ªç¤ºä¾‹å¯ä»¥æä¾›å¤šä¸ªè®­ç»ƒç‰¹å¾):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->train_dataset = raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].<span class="hljs-built_in">map</span>(
    preprocess_training_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;train&quot;</span>].column_names,
)
<span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-built_in">len</span>(train_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">87599</span>, <span class="hljs-number">88729</span>)<!-- HTML_TAG_END --></pre></div>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€è§, é¢„å¤„ç†å¢åŠ äº†å¤§çº¦ 1,000 ä¸ªç‰¹å¾ã€‚æˆ‘ä»¬çš„è®­ç»ƒé›†ç°åœ¨å¯ä»¥ä½¿ç”¨äº†â€” è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶éªŒè¯é›†çš„é¢„å¤„ç†!</p>
<h3 id="">å¤„ç†éªŒè¯æ•°æ®</h3>
<p>é¢„å¤„ç†éªŒè¯æ•°æ®ä¼šç¨å¾®å®¹æ˜“ä¸€äº›, å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦ç”Ÿæˆæ ‡ç­¾(é™¤éæˆ‘ä»¬æƒ³è®¡ç®—éªŒè¯æŸå¤±, ä½†è¿™ä¸ªæ•°å­—å¹¶ä¸èƒ½çœŸæ­£å¸®åŠ©æˆ‘ä»¬ç†è§£æ¨¡å‹æœ‰å¤šå¥½)ã€‚çœŸæ­£çš„ä¹è¶£æ˜¯å°†æ¨¡å‹çš„é¢„æµ‹è§£é‡Šä¸ºåŸå§‹ä¸Šä¸‹æ–‡çš„è·¨åº¦ã€‚ä¸ºæ­¤, æˆ‘ä»¬åªéœ€è¦å­˜å‚¨åç§»æ˜ å°„å’ŒæŸç§æ–¹å¼æ¥å°†æ¯ä¸ªåˆ›å»ºçš„ç‰¹å¾ä¸å®ƒæ¥è‡ªçš„åŸå§‹ç¤ºä¾‹ç›¸åŒ¹é…ã€‚ç”±äºåŸå§‹æ•°æ®é›†ä¸­æœ‰ä¸€ä¸ª ID åˆ—, æˆ‘ä»¬å°†ä½¿ç”¨è¯¥ IDã€‚</p>
<p>æˆ‘ä»¬å°†åœ¨è¿™é‡Œæ·»åŠ çš„å”¯ä¸€å†…å®¹æ˜¯å¯¹åç§»æ˜ å°„çš„ä¸€ç‚¹ç‚¹æ¸…ç†ã€‚å®ƒä»¬å°†åŒ…å«é—®é¢˜å’Œä¸Šä¸‹æ–‡çš„åç§»é‡, ä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬è¿›å…¥åå¤„ç†é˜¶æ®µ, æˆ‘ä»¬å°†æ— æ³•çŸ¥é“è¾“å…¥ ID çš„å“ªä¸€éƒ¨åˆ†å¯¹åº”äºä¸Šä¸‹æ–‡ä»¥åŠå“ªä¸€éƒ¨åˆ†æ˜¯é—®é¢˜(æˆ‘ä»¬ä½¿ç”¨çš„ <code>sequence_ids()</code> æ–¹æ³•ä»…å¯ç”¨äºæ ‡è®°å™¨çš„è¾“å‡º)ã€‚å› æ­¤, æˆ‘ä»¬å°†ä¸é—®é¢˜å¯¹åº”çš„åç§»é‡è®¾ç½®ä¸º <code>None</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_validation_examples</span>(<span class="hljs-params">examples</span>):
    questions = [q.strip() <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> examples[<span class="hljs-string">&quot;question&quot;</span>]]
    inputs = tokenizer(
        questions,
        examples[<span class="hljs-string">&quot;context&quot;</span>],
        max_length=max_length,
        truncation=<span class="hljs-string">&quot;only_second&quot;</span>,
        stride=stride,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
        return_offsets_mapping=<span class="hljs-literal">True</span>,
        padding=<span class="hljs-string">&quot;max_length&quot;</span>,
    )

    sample_map = inputs.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    example_ids = []

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inputs[<span class="hljs-string">&quot;input_ids&quot;</span>])):
        sample_idx = sample_map[i]
        example_ids.append(examples[<span class="hljs-string">&quot;id&quot;</span>][sample_idx])

        sequence_ids = inputs.sequence_ids(i)
        offset = inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>][i]
        inputs[<span class="hljs-string">&quot;offset_mapping&quot;</span>][i] = [
            o <span class="hljs-keyword">if</span> sequence_ids[k] == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> k, o <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(offset)
        ]

    inputs[<span class="hljs-string">&quot;example_id&quot;</span>] = example_ids
    <span class="hljs-keyword">return</span> inputs<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬å¯ä»¥åƒä»¥å‰ä¸€æ ·å°†æ­¤å‡½æ•°åº”ç”¨äºæ•´ä¸ªéªŒè¯æ•°æ®é›†:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->validation_dataset = raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].<span class="hljs-built_in">map</span>(
    preprocess_validation_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].column_names,
)
<span class="hljs-built_in">len</span>(raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>]), <span class="hljs-built_in">len</span>(validation_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">10570</span>, <span class="hljs-number">10822</span>)<!-- HTML_TAG_END --></pre></div>
<p>Iåœ¨è¿™ç§æƒ…å†µä¸‹, æˆ‘ä»¬åªæ·»åŠ äº†å‡ ç™¾ä¸ªæ ·æœ¬, å› æ­¤éªŒè¯æ•°æ®é›†ä¸­çš„ä¸Šä¸‹æ–‡ä¼¼ä¹æœ‰ç‚¹çŸ­ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†, æˆ‘ä»¬å¯ä»¥å¼€å§‹è®­ç»ƒäº†ã€‚</p>
<h2 class="relative group"><a id="trainer-api" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#trainer-api"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ä½¿ç”¨ <code>Trainer</code> API å¾®è°ƒæ¨¡å‹
	</span></h2>

<p>è¿™ä¸ªä¾‹å­çš„è®­ç»ƒä»£ç çœ‹èµ·æ¥å¾ˆåƒå‰é¢å‡ èŠ‚ä¸­çš„ä»£ç  â€” æœ€éš¾çš„æ˜¯ç¼–å†™ <code>compute_metrics()</code> å‡½æ•°ã€‚ç”±äºæˆ‘ä»¬å°†æ‰€æœ‰æ ·æœ¬å¡«å……åˆ°æˆ‘ä»¬è®¾ç½®çš„æœ€å¤§é•¿åº¦, å› æ­¤æ²¡æœ‰æ•°æ®æ•´ç†å™¨è¦å®šä¹‰, æ‰€ä»¥è¿™ä¸ªåº¦é‡è®¡ç®—çœŸçš„æ˜¯æˆ‘ä»¬å”¯ä¸€éœ€è¦æ‹…å¿ƒçš„äº‹æƒ…ã€‚å›°éš¾çš„éƒ¨åˆ†æ˜¯å°†æ¨¡å‹é¢„æµ‹åå¤„ç†ä¸ºåŸå§‹ç¤ºä¾‹ä¸­çš„æ–‡æœ¬èŒƒå›´; ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†, ğŸ¤— Datasets åº“ä¸­çš„æŒ‡æ ‡å°†ä¸ºæˆ‘ä»¬å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œã€‚</p>
<h3 id="">åå¤„ç†</h3>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/BNy08iIWVJM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>è¯¥æ¨¡å‹å°†åœ¨è¾“å…¥IDä¸­ä¸ºç­”æ¡ˆçš„å¼€å§‹å’Œç»“æŸä½ç½®è¾“å‡ºLogit, æ­£å¦‚æˆ‘ä»¬åœ¨æ¢ç´¢ <a href="/course/chapter6/4"><code>question-answering</code> pipeline</a> æ—¶çœ‹åˆ°çš„é‚£æ ·ã€‚åå¤„ç†æ­¥éª¤å°†ç±»ä¼¼äºæˆ‘ä»¬åœ¨é‚£é‡Œæ‰€åšçš„, æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬é‡‡å–çš„è¡ŒåŠ¨çš„å¿«é€Ÿæé†’:</p>
<ul><li>æˆ‘ä»¬å±è”½äº†ä¸ä¸Šä¸‹æ–‡ä¹‹å¤–çš„æ ‡è®°ç›¸å¯¹åº”çš„å¼€å§‹å’Œç»“æŸ logitsã€‚</li>
<li>ç„¶å, æˆ‘ä»¬ä½¿ç”¨ softmax å°†å¼€å§‹å’Œç»“æŸ logits è½¬æ¢ä¸ºæ¦‚ç‡ã€‚</li>
<li>æˆ‘ä»¬é€šè¿‡å–å¯¹åº”çš„ä¸¤ä¸ªæ¦‚ç‡çš„ä¹˜ç§¯æ¥ç»™æ¯ä¸ª <code>(start_token, end_token)</code> ç»„åˆèµ‹å€¼ã€‚</li>
<li>æˆ‘ä»¬å¯»æ‰¾äº§ç”Ÿæœ‰æ•ˆç­”æ¡ˆçš„æœ€é«˜åˆ†æ•°çš„é…å¯¹ (ä¾‹å¦‚, <code>start_token</code> ä½äº <code>end_token</code>)ã€‚</li></ul>
<p>åœ¨è¿™é‡Œ, æˆ‘ä»¬å°†ç¨å¾®æ”¹å˜è¿™ä¸ªè¿‡ç¨‹, å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦è®¡ç®—å®é™…åˆ†æ•° (åªæ˜¯é¢„æµ‹çš„ç­”æ¡ˆ)ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è·³è¿‡ softmax æ­¥éª¤ã€‚ä¸ºäº†æ›´å¿«, æˆ‘ä»¬ä¹Ÿä¸ä¼šå¯¹æ‰€æœ‰å¯èƒ½çš„ <code>(start_token, end_token)</code> å¯¹è¿›è¡Œè¯„åˆ†, è€Œåªä¼šå¯¹å¯¹åº”äºæœ€é«˜ <code>n_best</code> çš„é‚£äº›å¯¹è¿›è¡Œè¯„åˆ† (ä½¿ç”¨ <code>n_best=20</code>)ã€‚ç”±äºæˆ‘ä»¬å°†è·³è¿‡ softmax, å› æ­¤è¿™äº›åˆ†æ•°å°†æ˜¯ logit åˆ†æ•°, å¹¶ä¸”å°†é€šè¿‡å– start å’Œ end logits çš„æ€»å’Œæ¥è·å¾— (è€Œä¸æ˜¯ä¹˜ç§¯, å› ä¸ºè§„åˆ™ <!-- HTML_TAG_START --><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>a</mi><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(ab) = \log(a) + \log(b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">ab</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><!-- HTML_TAG_END -->)ã€‚</p>
<p>ä¸ºäº†è¯æ˜è¿™ä¸€åˆ‡, æˆ‘ä»¬éœ€è¦ä¸€äº›é¢„æµ‹ã€‚ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹, æˆ‘ä»¬å°†ä½¿ç”¨ QA ç®¡é“çš„é»˜è®¤æ¨¡å‹å¯¹ä¸€å°éƒ¨åˆ†éªŒè¯é›†ç”Ÿæˆä¸€äº›é¢„æµ‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å’Œä¹‹å‰ä¸€æ ·çš„å¤„ç†å‡½æ•°; å› ä¸ºå®ƒä¾èµ–äºå…¨å±€å¸¸é‡ <code>tokenizer</code>, æˆ‘ä»¬åªéœ€å°†è¯¥å¯¹è±¡æ›´æ”¹ä¸ºæˆ‘ä»¬è¦ä¸´æ—¶ä½¿ç”¨çš„æ¨¡å‹çš„æ ‡è®°å™¨:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->small_eval_set = raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].select(<span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>))
trained_checkpoint = <span class="hljs-string">&quot;distilbert-base-cased-distilled-squad&quot;</span>

tokenizer = AutoTokenizer.from_pretrained(trained_checkpoint)
eval_set = small_eval_set.<span class="hljs-built_in">map</span>(
    preprocess_validation_examples,
    batched=<span class="hljs-literal">True</span>,
    remove_columns=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>].column_names,
)<!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨é¢„å¤„ç†å·²ç»å®Œæˆ, æˆ‘ä»¬å°†åˆ†è¯å™¨æ”¹å›æˆ‘ä»¬æœ€åˆé€‰æ‹©çš„é‚£ä¸ª:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>ç„¶å, æˆ‘ä»¬åˆ é™¤ <code>eval_set</code> ä¸­æ¨¡å‹ä¸æœŸå¾…çš„åˆ—, ç”¨æ‰€æœ‰çš„å°éªŒè¯é›†æ„å»ºä¸€ä¸ªæ‰¹æ¬¡, ç„¶åé€šè¿‡æ¨¡å‹ã€‚å¦‚æœ GPU å¯ç”¨, æˆ‘ä»¬ä¼šä½¿ç”¨å®ƒæ¥åŠ å¿«é€Ÿåº¦:</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForQuestionAnswering

eval_set_for_model = eval_set.remove_columns([<span class="hljs-string">&quot;example_id&quot;</span>, <span class="hljs-string">&quot;offset_mapping&quot;</span>])
eval_set_for_model.set_format(<span class="hljs-string">&quot;torch&quot;</span>)

device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span>) <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> torch.device(<span class="hljs-string">&quot;cpu&quot;</span>)
batch = {k: eval_set_for_model[k].to(device) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> eval_set_for_model.column_names}
trained_model = AutoModelForQuestionAnswering.from_pretrained(trained_checkpoint).to(
    device
)

<span class="hljs-keyword">with</span> torch.no_grad():
    outputs = trained_model(**batch)<!-- HTML_TAG_END --></pre></div>
<p>ç”±äº <code>Trainer</code> å°†ä¸ºæˆ‘ä»¬æä¾› NumPy æ•°ç»„çš„é¢„æµ‹, æˆ‘ä»¬è·å–å¼€å§‹å’Œç»“æŸ logits å¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºè¯¥æ ¼å¼</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->start_logits = outputs.start_logits.cpu().numpy()
end_logits = outputs.end_logits.cpu().numpy()<!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨, æˆ‘ä»¬éœ€è¦åœ¨ <code>small_eval_set</code> ä¸­æ‰¾åˆ°æ¯ä¸ªç¤ºä¾‹çš„é¢„æµ‹ç­”æ¡ˆã€‚ä¸€ä¸ªç¤ºä¾‹å¯èƒ½å·²ç»åœ¨  <code>eval_set</code> ä¸­æ‹†åˆ†ä¸ºå¤šä¸ªç‰¹å¾, å› æ­¤ç¬¬ä¸€æ­¥æ˜¯å°† <code>small_eval_set</code> ä¸­çš„æ¯ä¸ªç¤ºä¾‹æ˜ å°„åˆ° <code>eval_set</code> ä¸­ç›¸åº”çš„ç‰¹å¾:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> collections

example_to_features = collections.defaultdict(<span class="hljs-built_in">list</span>)
<span class="hljs-keyword">for</span> idx, feature <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(eval_set):
    example_to_features[feature[<span class="hljs-string">&quot;example_id&quot;</span>]].append(idx)<!-- HTML_TAG_END --></pre></div>
<p>æœ‰äº†è¿™ä¸ª, æˆ‘ä»¬å°±å¯ä»¥çœŸæ­£å¼€å§‹å·¥ä½œ, å¾ªç¯éå†æ‰€æœ‰ç¤ºä¾‹, å¹¶ä¸ºæ¯ä¸ªç¤ºä¾‹éå†æ‰€æœ‰ç›¸å…³åŠŸèƒ½ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´, æˆ‘ä»¬å°†æŸ¥çœ‹ <code>n_best</code> å¼€å§‹ logits å’Œç»“æŸ logits çš„ logit åˆ†æ•°, ä¸åŒ…æ‹¬ä»¥ä¸‹çš„ä½ç½®:</p>
<ul><li>ä¸€ä¸ªä¸åœ¨ä¸Šä¸‹æ–‡ä¸­çš„ç­”æ¡ˆ</li>
<li>é•¿åº¦ä¸ºè´Ÿçš„ç­”æ¡ˆ</li>
<li>ç­”æ¡ˆå¤ªé•¿ (æˆ‘ä»¬å°†å¯èƒ½æ€§é™åˆ¶åœ¨ <code>max_answer_length=30</code>)</li></ul>
<p>ä¸€æ—¦æˆ‘ä»¬ä¸ºä¸€ä¸ªç¤ºä¾‹è·å¾—äº†æ‰€æœ‰å¯èƒ½çš„ç­”æ¡ˆ, æˆ‘ä»¬åªéœ€é€‰æ‹©ä¸€ä¸ªå…·æœ‰æœ€ä½³ logit åˆ†æ•°çš„ç­”æ¡ˆ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

n_best = <span class="hljs-number">20</span>
max_answer_length = <span class="hljs-number">30</span>
predicted_answers = []

<span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> small_eval_set:
    example_id = example[<span class="hljs-string">&quot;id&quot;</span>]
    context = example[<span class="hljs-string">&quot;context&quot;</span>]
    answers = []

    <span class="hljs-keyword">for</span> feature_index <span class="hljs-keyword">in</span> example_to_features[example_id]:
        start_logit = start_logits[feature_index]
        end_logit = end_logits[feature_index]
        offsets = eval_set[<span class="hljs-string">&quot;offset_mapping&quot;</span>][feature_index]

        start_indexes = np.argsort(start_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
        end_indexes = np.argsort(end_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
        <span class="hljs-keyword">for</span> start_index <span class="hljs-keyword">in</span> start_indexes:
            <span class="hljs-keyword">for</span> end_index <span class="hljs-keyword">in</span> end_indexes:
                <span class="hljs-comment"># Skip answers that are not fully in the context</span>
                <span class="hljs-keyword">if</span> offsets[start_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> offsets[end_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                    <span class="hljs-keyword">continue</span>
                <span class="hljs-comment"># Skip answers with a length that is either &lt; 0 or &gt; max_answer_length.</span>
                <span class="hljs-keyword">if</span> (
                    end_index &lt; start_index
                    <span class="hljs-keyword">or</span> end_index - start_index + <span class="hljs-number">1</span> &gt; max_answer_length
                ):
                    <span class="hljs-keyword">continue</span>

                answers.append(
                    {
                        <span class="hljs-string">&quot;text&quot;</span>: context[offsets[start_index][<span class="hljs-number">0</span>] : offsets[end_index][<span class="hljs-number">1</span>]],
                        <span class="hljs-string">&quot;logit_score&quot;</span>: start_logit[start_index] + end_logit[end_index],
                    }
                )

    best_answer = <span class="hljs-built_in">max</span>(answers, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;logit_score&quot;</span>])
    predicted_answers.append({<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: best_answer[<span class="hljs-string">&quot;text&quot;</span>]})<!-- HTML_TAG_END --></pre></div>
<p>é¢„æµ‹ç­”æ¡ˆçš„æœ€ç»ˆæ ¼å¼æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨çš„åº¦é‡æ ‡å‡†æ‰€æœŸæœ›çš„æ ¼å¼ã€‚åƒå¾€å¸¸ä¸€æ ·, æˆ‘ä»¬å¯ä»¥åœ¨ ğŸ¤— Datasets åº“çš„å¸®åŠ©ä¸‹åŠ è½½å®ƒ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_metric

metric = load_metric(<span class="hljs-string">&quot;squad&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>è¯¥æŒ‡æ ‡æœŸæœ›æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ ¼å¼çš„é¢„æµ‹ç­”æ¡ˆ (ä¸€ä¸ªå­—å…¸åˆ—è¡¨, å…¶ä¸­ä¸€ä¸ªé”®ç”¨äºç¤ºä¾‹ ID, ä¸€ä¸ªé”®ç”¨äºé¢„æµ‹æ–‡æœ¬) å’Œä»¥ä¸‹æ ¼å¼çš„ç†è®ºç­”æ¡ˆ (ä¸€ä¸ªå­—å…¸åˆ—è¡¨, ä¸€ä¸ªé”®ç¤ºä¾‹çš„ ID å’Œå¯èƒ½ç­”æ¡ˆçš„ä¸€é”®):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->theoretical_answers = [
    {<span class="hljs-string">&quot;id&quot;</span>: ex[<span class="hljs-string">&quot;id&quot;</span>], <span class="hljs-string">&quot;answers&quot;</span>: ex[<span class="hljs-string">&quot;answers&quot;</span>]} <span class="hljs-keyword">for</span> ex <span class="hljs-keyword">in</span> small_eval_set
]<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡æŸ¥çœ‹ä¸¤ä¸ªåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ¥æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦å¾—åˆ°äº†åˆç†çš„ç»“æœ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">print</span>(predicted_answers[<span class="hljs-number">0</span>])
<span class="hljs-built_in">print</span>(theoretical_answers[<span class="hljs-number">0</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;56be4db0acb8001400a502ec&#x27;</span>, <span class="hljs-string">&#x27;prediction_text&#x27;</span>: <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>}
{<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;56be4db0acb8001400a502ec&#x27;</span>, <span class="hljs-string">&#x27;answers&#x27;</span>: {<span class="hljs-string">&#x27;text&#x27;</span>: [<span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>, <span class="hljs-string">&#x27;Denver Broncos&#x27;</span>], <span class="hljs-string">&#x27;answer_start&#x27;</span>: [<span class="hljs-number">177</span>, <span class="hljs-number">177</span>, <span class="hljs-number">177</span>]}}<!-- HTML_TAG_END --></pre></div>
<p>è¿˜ä¸é”™! ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæŒ‡æ ‡ç»™æˆ‘ä»¬çš„åˆ†æ•°:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->metric.compute(predictions=predicted_answers, references=theoretical_answers)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">83.0</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.25</span>}<!-- HTML_TAG_END --></pre></div>
<p>åŒæ ·, è€ƒè™‘åˆ°æ ¹æ® <a href="https://arxiv.org/abs/1910.01108v2" rel="nofollow">its paper</a>, åœ¨ SQuAD ä¸Šå¾®è°ƒçš„ DistilBERT åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šçš„å¾—åˆ†åˆ†åˆ«ä¸º 79.1 å’Œ 86.9, è¿™æ˜¯ç›¸å½“ä¸é”™çš„ã€‚</p>
<p>ç°åœ¨, è®©æˆ‘ä»¬æŠŠåˆšæ‰æ‰€åšçš„ä¸€åˆ‡æ”¾åœ¨ <code>compute_metrics()</code> å‡½æ•°ä¸­, æˆ‘ä»¬å°†åœ¨ <code>Trainer</code> ä¸­ä½¿ç”¨å®ƒã€‚é€šå¸¸, <code>compute_metrics()</code> å‡½æ•°åªæ¥æ”¶ä¸€ä¸ªåŒ…å« logits å’Œ labels çš„å…ƒç»„ <code>eval_preds</code>ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦æ›´å¤š, å› ä¸ºæˆ‘ä»¬å¿…é¡»åœ¨ç‰¹å¾æ•°æ®é›†ä¸­æŸ¥æ‰¾åç§»é‡, åœ¨åŸå§‹ä¸Šä¸‹æ–‡çš„ç¤ºä¾‹æ•°æ®é›†ä¸­æŸ¥æ‰¾, å› æ­¤æˆ‘ä»¬å°†æ— æ³•åœ¨è®­ç»ƒæœŸé—´ä½¿ç”¨æ­¤å‡½æ•°è·å¾—å¸¸è§„è¯„ä¼°ç»“æœã€‚æˆ‘ä»¬åªä¼šåœ¨è®­ç»ƒç»“æŸæ—¶ä½¿ç”¨å®ƒæ¥æ£€æŸ¥ç»“æœã€‚</p>
<p><code>compute_metrics()</code> å‡½æ•°å°†ä¸å‰é¢ç›¸åŒçš„æ­¥éª¤åˆ†ç»„; æˆ‘ä»¬åªæ˜¯æ·»åŠ ä¸€ä¸ªå°æ£€æŸ¥, ä»¥é˜²æˆ‘ä»¬æ²¡æœ‰æå‡ºä»»ä½•æœ‰æ•ˆçš„ç­”æ¡ˆ (åœ¨è¿™ç§æƒ…å†µä¸‹, æˆ‘ä»¬é¢„æµ‹ä¸€ä¸ªç©ºå­—ç¬¦ä¸²)ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">start_logits, end_logits, features, examples</span>):
    example_to_features = collections.defaultdict(<span class="hljs-built_in">list</span>)
    <span class="hljs-keyword">for</span> idx, feature <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(features):
        example_to_features[feature[<span class="hljs-string">&quot;example_id&quot;</span>]].append(idx)

    predicted_answers = []
    <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> tqdm(examples):
        example_id = example[<span class="hljs-string">&quot;id&quot;</span>]
        context = example[<span class="hljs-string">&quot;context&quot;</span>]
        answers = []

        <span class="hljs-comment"># Loop through all features associated with that example</span>
        <span class="hljs-keyword">for</span> feature_index <span class="hljs-keyword">in</span> example_to_features[example_id]:
            start_logit = start_logits[feature_index]
            end_logit = end_logits[feature_index]
            offsets = features[feature_index][<span class="hljs-string">&quot;offset_mapping&quot;</span>]

            start_indexes = np.argsort(start_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
            end_indexes = np.argsort(end_logit)[-<span class="hljs-number">1</span> : -n_best - <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>].tolist()
            <span class="hljs-keyword">for</span> start_index <span class="hljs-keyword">in</span> start_indexes:
                <span class="hljs-keyword">for</span> end_index <span class="hljs-keyword">in</span> end_indexes:
                    <span class="hljs-comment"># Skip answers that are not fully in the context</span>
                    <span class="hljs-keyword">if</span> offsets[start_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> offsets[end_index] <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                        <span class="hljs-keyword">continue</span>
                    <span class="hljs-comment"># Skip answers with a length that is either &lt; 0 or &gt; max_answer_length</span>
                    <span class="hljs-keyword">if</span> (
                        end_index &lt; start_index
                        <span class="hljs-keyword">or</span> end_index - start_index + <span class="hljs-number">1</span> &gt; max_answer_length
                    ):
                        <span class="hljs-keyword">continue</span>

                    answer = {
                        <span class="hljs-string">&quot;text&quot;</span>: context[offsets[start_index][<span class="hljs-number">0</span>] : offsets[end_index][<span class="hljs-number">1</span>]],
                        <span class="hljs-string">&quot;logit_score&quot;</span>: start_logit[start_index] + end_logit[end_index],
                    }
                    answers.append(answer)

        <span class="hljs-comment"># Select the answer with the best score</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(answers) &gt; <span class="hljs-number">0</span>:
            best_answer = <span class="hljs-built_in">max</span>(answers, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;logit_score&quot;</span>])
            predicted_answers.append(
                {<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: best_answer[<span class="hljs-string">&quot;text&quot;</span>]}
            )
        <span class="hljs-keyword">else</span>:
            predicted_answers.append({<span class="hljs-string">&quot;id&quot;</span>: example_id, <span class="hljs-string">&quot;prediction_text&quot;</span>: <span class="hljs-string">&quot;&quot;</span>})

    theoretical_answers = [{<span class="hljs-string">&quot;id&quot;</span>: ex[<span class="hljs-string">&quot;id&quot;</span>], <span class="hljs-string">&quot;answers&quot;</span>: ex[<span class="hljs-string">&quot;answers&quot;</span>]} <span class="hljs-keyword">for</span> ex <span class="hljs-keyword">in</span> examples]
    <span class="hljs-keyword">return</span> metric.compute(predictions=predicted_answers, references=theoretical_answers)<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬å¯ä»¥æ£€æŸ¥å®ƒæ˜¯å¦é€‚ç”¨äºæˆ‘ä»¬çš„é¢„æµ‹:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->compute_metrics(start_logits, end_logits, eval_set, small_eval_set)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">83.0</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.25</span>}<!-- HTML_TAG_END --></pre></div>
<p>çœ‹èµ·æ¥ä¸é”™! ç°åœ¨è®©æˆ‘ä»¬ç”¨å®ƒæ¥å¾®è°ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚</p>
<h3 id="">å¾®è°ƒæ¨¡å‹</h3>
<p>æˆ‘ä»¬ç°åœ¨å‡†å¤‡å¥½è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹äº†ã€‚è®©æˆ‘ä»¬é¦–å…ˆåˆ›å»ºå®ƒ, åƒä»¥å‰ä¸€æ ·ä½¿ç”¨ <code>AutoModelForQuestionAnswering</code> ç±»:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForQuestionAnswering.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>åƒå¾€å¸¸ä¸€æ ·, æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªè­¦å‘Š, æœ‰äº›æƒé‡æ²¡æœ‰ä½¿ç”¨(æ¥è‡ªé¢„è®­ç»ƒå¤´çš„), è€Œå¦ä¸€äº›æ˜¯éšæœºåˆå§‹åŒ–çš„ (ç”¨äºé—®ç­”å¤´çš„)ã€‚ä½ ç°åœ¨åº”è¯¥å·²ç»ä¹ æƒ¯äº†, ä½†è¿™æ„å‘³ç€è¿™ä¸ªæ¨¡å‹è¿˜æ²¡æœ‰å‡†å¤‡å¥½ä½¿ç”¨, éœ€è¦å¾®è°ƒ â€” æˆ‘ä»¬å³å°†è¿™æ ·åš!</p>
<p>ä¸ºäº†èƒ½å¤Ÿå°†æˆ‘ä»¬çš„æ¨¡å‹æ¨é€åˆ° Hub, æˆ‘ä»¬éœ€è¦ç™»å½• Hugging Faceã€‚ å¦‚æœä½ åœ¨ç¬”è®°æœ¬ä¸­è¿è¡Œæ­¤ä»£ç , åˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å®ç”¨ç¨‹åºå‡½æ•°æ‰§è¡Œæ­¤æ“ä½œ, è¯¥å‡½æ•°ä¼šæ˜¾ç¤ºä¸€ä¸ªå°éƒ¨ä»¶, ä½ å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥ç™»å½•å‡­æ®:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>å¦‚æœä½ ä¸åœ¨ç¬”è®°æœ¬ä¸­å·¥ä½œ, åªéœ€åœ¨ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹è¡Œ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-cli login<!-- HTML_TAG_END --></pre></div>
<p>å®Œæˆå, æˆ‘ä»¬å°±å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ <code>TrainingArguments</code>ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨å®šä¹‰å‡½æ•°æ¥è®¡ç®—åº¦é‡æ—¶æ‰€è¯´çš„é‚£æ ·, ç”±äº <code>compute_metrics()</code> å‡½æ•°çš„ç­¾å, æˆ‘ä»¬å°†ä¸èƒ½æœ‰å¸¸è§„çš„æ±‚å€¼å¾ªç¯ã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™ <code>Trainer</code> çš„å­ç±»æ¥å®Œæˆè¿™ä¸€ä»»åŠ¡(ä½ å¯ä»¥åœ¨ <a href="https://github.com/huggingface/transformers/blob/master/examples/pytorch/question-answering/trainer_qa.py" rel="nofollow">question answering example script</a>ä¸­æ‰¾åˆ°ä¸€ç§æ–¹æ³•), ä½†è¿™å¯¹äºæœ¬èŠ‚æ¥è¯´æœ‰ç‚¹å¤ªé•¿äº†ã€‚ç›¸å, æˆ‘ä»¬åªä¼šåœ¨è®­ç»ƒç»“æŸæ—¶è¯„ä¼°æ¨¡å‹, å¹¶åœ¨ä¸‹é¢çš„â€è‡ªå®šä¹‰è®­ç»ƒå¾ªç¯â€å‘ä½ å±•ç¤ºå¦‚ä½•è¿›è¡Œå¸¸è§„è¯„ä¼°ã€‚</p>
<p>Tè¿™ç¡®å®æ—¶ <code>Trainer</code> API æ˜¾ç¤ºå…¶å±€é™æ€§å’Œ ğŸ¤— Accelerate åº“çš„äº®ç‚¹æ‰€åœ¨: æ ¹æ®ç‰¹å®šç”¨ä¾‹è‡ªå®šä¹‰ç±»å¯èƒ½å¾ˆç—›è‹¦, ä½†è°ƒæ•´å®Œå…¨å…¬å¼€çš„è®­ç»ƒå¾ªç¯å¾ˆå®¹æ˜“ã€‚</p>
<p>æ¥çœ‹çœ‹æˆ‘ä»¬çš„ <code>TrainingArguments</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

args = TrainingArguments(
    <span class="hljs-string">&quot;bert-finetuned-squad&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;no&quot;</span>,
    save_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">2e-5</span>,
    num_train_epochs=<span class="hljs-number">3</span>,
    weight_decay=<span class="hljs-number">0.01</span>,
    fp16=<span class="hljs-literal">True</span>,
    push_to_hub=<span class="hljs-literal">True</span>,
)<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬ä¹‹å‰å·²ç»çœ‹åˆ°äº†å…¶ä¸­çš„å¤§éƒ¨åˆ†: æˆ‘ä»¬è®¾ç½®äº†ä¸€äº›è¶…å‚æ•° (æ¯”å¦‚å­¦ä¹ ç‡ã€è®­ç»ƒçš„ epoch æ•°å’Œä¸€äº›æƒé‡è¡°å‡), å¹¶è¡¨æ˜æˆ‘ä»¬å¸Œæœ›åœ¨æ¯ä¸ª epoch ç»“æŸæ—¶ä¿å­˜æ¨¡å‹, è·³è¿‡è¯„ä¼°, å¹¶å°†æˆ‘ä»¬çš„ç»“æœä¸Šä¼ åˆ°æ¨¡å‹ä¸­å¿ƒã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨ <code>fp16=True</code> å¯ç”¨æ··åˆç²¾åº¦è®­ç»ƒ, å› ä¸ºå®ƒå¯ä»¥åœ¨æœ€è¿‘çš„ GPU ä¸Šå¾ˆå¥½åœ°åŠ å¿«è®­ç»ƒé€Ÿåº¦ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹, ä½¿ç”¨çš„å­˜å‚¨åº“å°†åœ¨æ‚¨çš„å‘½åç©ºé—´ä¸­, å¹¶ä»¥æ‚¨è®¾ç½®çš„è¾“å‡ºç›®å½•å‘½å, å› æ­¤åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­, å®ƒå°†åœ¨ <code>&quot;sgugger/bert-finetuned-squad&quot;</code> ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ é€’ <code>hub_model_id</code> æ¥è¦†ç›–å®ƒ; ä¾‹å¦‚, ä¸ºäº†å°†æ¨¡å‹æ¨é€åˆ° <code>huggingface_course</code> ç»„ç»‡, æˆ‘ä»¬ä½¿ç”¨äº† <code>hub_model_id=&quot;huggingface_course/bert-finetuned-squad&quot;</code> (è¿™æ˜¯æˆ‘ä»¬åœ¨æœ¬èŠ‚å¼€å¤´é“¾æ¥çš„æ¨¡å‹)ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ å¦‚æœæ‚¨ä½¿ç”¨çš„è¾“å‡ºç›®å½•å­˜åœ¨, åˆ™å®ƒéœ€è¦æ˜¯æ‚¨è¦æ¨é€åˆ°çš„å­˜å‚¨åº“çš„æœ¬åœ°å…‹éš† (å› æ­¤, å¦‚æœåœ¨å®šä¹‰ <code>Trainer</code> æ—¶å‡ºé”™, è¯·è®¾ç½®æ–°åç§°)ã€‚</p></div>
<p>æœ€å, æˆ‘ä»¬åªéœ€å°†æ‰€æœ‰å†…å®¹ä¼ é€’ç»™ <code>Trainer</code> ç±»å¹¶å¯åŠ¨è®­ç»ƒ:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model=model,
    args=args,
    train_dataset=train_dataset,
    eval_dataset=validation_dataset,
    tokenizer=tokenizer,
)
trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>è¯·æ³¨æ„, åœ¨è¿›è¡Œè®­ç»ƒæ—¶, æ¯æ¬¡ä¿å­˜æ¨¡å‹æ—¶ (è¿™é‡Œæ˜¯æ¯ä¸ª epoch) å®ƒéƒ½ä¼šåœ¨åå°ä¸Šä¼ åˆ° Hubã€‚è¿™æ ·, å¦‚æœ‰å¿…è¦, ä½ å°†èƒ½å¤Ÿåœ¨å¦ä¸€å°æœºå™¨ä¸Šæ¢å¤è®­ç»ƒã€‚æ•´ä¸ªåŸ¹è®­éœ€è¦ä¸€æ®µæ—¶é—´ (åœ¨ Titan RTX ä¸Šéœ€è¦ä¸€ä¸ªå¤šå°æ—¶), å› æ­¤æ‚¨å¯ä»¥å–æ¯å’–å•¡æˆ–é‡è¯»è¯¾ç¨‹ä¸­æ‚¨å‘ç°åœ¨è¿›è¡Œè¿‡ç¨‹ä¸­æ›´å…·æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†å†…å®¹ã€‚å¦è¯·æ³¨æ„, ä¸€æ—¦ç¬¬ä¸€ä¸ª epoch å®Œæˆ, ä½ å°†çœ‹åˆ°ä¸€äº›æƒé‡ä¸Šä¼ åˆ° Hub, ä½ å¯ä»¥å¼€å§‹åœ¨å…¶é¡µé¢ä¸Šä½¿ç”¨ä½ çš„æ¨¡å‹ã€‚</p>
<p>ä¸€æ—¦è®­ç»ƒå®Œæˆ, æˆ‘ä»¬ç»ˆäºå¯ä»¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹(å¹¶ç¥ˆç¥·æˆ‘ä»¬æ²¡æœ‰æŠŠæ‰€æœ‰çš„è®¡ç®—æ—¶é—´éƒ½èŠ±åœ¨ä»»ä½•äº‹æƒ…ä¸Š)ã€‚<code>Trainer</code> çš„ <code>predict()</code> æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå…ƒç»„, å…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ å°†æ˜¯æ¨¡å‹çš„é¢„æµ‹ (è¿™é‡Œæ˜¯å¸¦æœ‰å¼€å§‹å’Œç»“æŸ logits çš„å¯¹)ã€‚æˆ‘ä»¬å°†å…¶å‘é€ç»™ <code>compute_metrics()</code> å‡½æ•°:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions, _ = trainer.predict(validation_dataset)
start_logits, end_logits = predictions
compute_metrics(start_logits, end_logits, validation_dataset, raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;exact_match&#x27;</span>: <span class="hljs-number">81.18259224219489</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">88.67381321905516</span>}<!-- HTML_TAG_END --></pre></div>
<p>å¾ˆå¥½! ä½œä¸ºæ¯”è¾ƒ, BERT æ–‡ç« ä¸­æŠ¥å‘Šçš„è¯¥æ¨¡å‹çš„åŸºçº¿åˆ†æ•°æ˜¯ 80.8 å’Œ 88.5, æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>æœ€å, æˆ‘ä»¬ä½¿ç”¨ <code>push_to_hub()</code> æ–¹æ³•ç¡®ä¿æˆ‘ä»¬ä¸Šä¼ æ¨¡å‹çš„æœ€æ–°ç‰ˆæœ¬:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub(commit_message=<span class="hljs-string">&quot;Training complete&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>å¦‚æœä½ æƒ³æ£€æŸ¥å®ƒ, è¿™å°†è¿”å›å®ƒåˆšåˆšæ‰§è¡Œçš„æäº¤çš„ URL:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;https://huggingface.co/sgugger/bert-finetuned-squad/commit/9dcee1fbc25946a6ed4bb32efb1bd71d5fa90b68&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p><code>Trainer</code> è¿˜èµ·è‰äº†åŒ…å«æ‰€æœ‰è¯„ä¼°ç»“æœçš„æ¨¡å‹å¡å¹¶ä¸Šä¼ ã€‚</p>
<p>åœ¨è¿™ä¸ªé˜¶æ®µ, ä½ å¯ä»¥ä½¿ç”¨æ¨¡å‹ä¸­å¿ƒä¸Šçš„æ¨ç†å°éƒ¨ä»¶æ¥æµ‹è¯•æ¨¡å‹å¹¶ä¸æ‚¨çš„æœ‹å‹ã€å®¶äººå’Œæœ€å–œæ¬¢çš„å® ç‰©åˆ†äº«ã€‚ä½ å·²ç»æˆåŠŸåœ°å¾®è°ƒäº†ä¸€ä¸ªé—®ç­”ä»»åŠ¡çš„æ¨¡å‹ â€” æ­å–œ!</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>è½®åˆ°ä½ äº†!</strong> å°è¯•å¦ä¸€ç§æ¨¡å‹æ¶æ„, çœ‹çœ‹å®ƒæ˜¯å¦åœ¨æ­¤ä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½!</p></div>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°äº†è§£è®­ç»ƒå¾ªç¯, æˆ‘ä»¬ç°åœ¨å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ ğŸ¤— Accelerate æ¥åšåŒæ ·çš„äº‹æƒ…ã€‚</p>
<h2 id="">è‡ªå®šä¹‰è®­ç»ƒå¾ªç¯</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„è®­ç»ƒå¾ªç¯, è¿™æ ·æ‚¨å°±å¯ä»¥è½»æ¾åœ°è‡ªå®šä¹‰æ‰€éœ€çš„éƒ¨åˆ†ã€‚å®ƒçœ‹èµ·æ¥å¾ˆåƒ <a href="/course/chapter3/4">ç¬¬ä¸‰ç« </a> ä¸­çš„è®­ç»ƒå¾ªç¯, é™¤äº†è¯„ä¼°å¾ªç¯ã€‚æˆ‘ä»¬å°†èƒ½å¤Ÿå®šæœŸè¯„ä¼°æ¨¡å‹, å› ä¸ºæˆ‘ä»¬ä¸å†å— <code>Trainer</code> ç±»çš„é™åˆ¶ã€‚</p>
<h3 id="">ä¸ºè®­ç»ƒåšå‡†å¤‡</h3>
<p>é¦–å…ˆ, æˆ‘ä»¬éœ€è¦ä»æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æ„å»º <code>DataLoader</code>ã€‚æˆ‘ä»¬å°†è¿™äº›æ•°æ®é›†çš„æ ¼å¼è®¾ç½®ä¸º <code>&quot;torch&quot;</code>, å¹¶åˆ é™¤æ¨¡å‹æœªä½¿ç”¨çš„éªŒè¯é›†ä¸­çš„åˆ—ã€‚ç„¶å, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Transformers æä¾›çš„ <code>default_data_collator</code> ä½œä¸º <code>collate_fn</code>, å¹¶æ‰“ä¹±è®­ç»ƒé›†, ä½†ä¸æ‰“ä¹±éªŒè¯é›†58:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> default_data_collator

train_dataset.set_format(<span class="hljs-string">&quot;torch&quot;</span>)
validation_set = validation_dataset.remove_columns([<span class="hljs-string">&quot;example_id&quot;</span>, <span class="hljs-string">&quot;offset_mapping&quot;</span>])
validation_set.set_format(<span class="hljs-string">&quot;torch&quot;</span>)

train_dataloader = DataLoader(
    train_dataset,
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=default_data_collator,
    batch_size=<span class="hljs-number">8</span>,
)
eval_dataloader = DataLoader(
    validation_set, collate_fn=default_data_collator, batch_size=<span class="hljs-number">8</span>
)<!-- HTML_TAG_END --></pre></div>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é‡æ–°å®ä¾‹åŒ–æˆ‘ä»¬çš„æ¨¡å‹, ä»¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šç»§ç»­ä¹‹å‰çš„å¾®è°ƒ, è€Œæ˜¯å†æ¬¡ä» BERT é¢„è®­ç»ƒæ¨¡å‹å¼€å§‹:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForQuestionAnswering.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>ç„¶åæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¼˜åŒ–å™¨ã€‚åƒå¾€å¸¸ä¸€æ ·, æˆ‘ä»¬ä½¿ç”¨ç»å…¸çš„ <code>AdamW</code>, å®ƒä¸ Adam ç±»ä¼¼, ä½†å¯¹æƒé‡è¡°å‡çš„åº”ç”¨æ–¹å¼è¿›è¡Œäº†ä¿®å¤:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>ä¸€æ—¦æˆ‘ä»¬æ‹¥æœ‰æ‰€æœ‰è¿™äº›å¯¹è±¡, æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬å‘é€ç»™ <code>accelerator.prepare()</code> æ–¹æ³•ã€‚è¯·è®°ä½, å¦‚æœæ‚¨æƒ³åœ¨ Colab ç¬”è®°æœ¬ä¸­çš„ TPU ä¸Šè¿›è¡Œè®­ç»ƒ, æ‚¨éœ€è¦å°†æ‰€æœ‰è¿™äº›ä»£ç ç§»åŠ¨åˆ°ä¸€ä¸ªè®­ç»ƒå‡½æ•°ä¸­, å¹¶ä¸”ä¸åº”è¯¥æ‰§è¡Œä»»ä½•å®ä¾‹åŒ– <code>Accelerator</code> çš„å•å…ƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ é€’ <code>fp16=True</code> ç»™ <code>Accelerator</code> (æˆ–è€…, å¦‚æœä½ å°†ä»£ç ä½œä¸ºè„šæœ¬æ‰§è¡Œ, åªéœ€ç¡®ä¿é€‚å½“åœ°å¡«å†™ ğŸ¤— Accelerate <code>config</code> )ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator(fp16=<span class="hljs-literal">True</span>)
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>
<p>ä»å‰é¢å‡ èŠ‚ä¸­ä½ åº”è¯¥çŸ¥é“, æˆ‘ä»¬åªèƒ½ä½¿ç”¨ <code>train_dataloader</code> é•¿åº¦æ¥è®¡ç®—ç»è¿‡ <code>accelerator.prepare()</code> æ–¹æ³•åçš„è®­ç»ƒæ­¥éª¤çš„æ•°é‡ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸å‰å‡ èŠ‚ç›¸åŒçš„çº¿æ€§æ—¶é—´è¡¨:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">3</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>è¦å°†æˆ‘ä»¬çš„æ¨¡å‹æ¨é€åˆ° Hub, æˆ‘ä»¬éœ€è¦åœ¨å·¥ä½œæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª <code>Repository</code> å¯¹è±¡ã€‚å¦‚æœä½ å°šæœªç™»å½•, è¯·å…ˆç™»å½• Hugging Face Hubã€‚æˆ‘ä»¬å°†æ ¹æ®æˆ‘ä»¬æƒ³è¦ä¸ºæ¨¡å‹æä¾›çš„æ¨¡å‹ ID ç¡®å®šå­˜å‚¨åº“åç§° (éšæ„ç”¨ä½ è‡ªå·±çš„é€‰æ‹©æ›¿æ¢ <code>repo_name</code>; å®ƒåªéœ€è¦åŒ…å«ä½ çš„ç”¨æˆ·å, è¿™å°±æ˜¯å‡½æ•° <code>get_full_repo_name()</code> æ‰€åšçš„):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository, get_full_repo_name

model_name = <span class="hljs-string">&quot;bert-finetuned-squad-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;sgugger/bert-finetuned-squad-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥å°†è¯¥å­˜å‚¨åº“å…‹éš†åˆ°æœ¬åœ°æ–‡ä»¶å¤¹ä¸­ã€‚å¦‚æœå®ƒå·²ç»å­˜åœ¨, è¿™ä¸ªæœ¬åœ°æ–‡ä»¶å¤¹åº”è¯¥æ˜¯æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„å­˜å‚¨åº“çš„å…‹éš†:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->output_dir = <span class="hljs-string">&quot;bert-finetuned-squad-accelerate&quot;</span>
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡è°ƒç”¨ <code>repo.push_to_hub()</code> æ–¹æ³•ä¸Šä¼ æˆ‘ä»¬ä¿å­˜åœ¨ <code>output_dir</code> ä¸­çš„ä»»ä½•å†…å®¹ã€‚è¿™å°†å¸®åŠ©æˆ‘ä»¬åœ¨æ¯ä¸ª epoch ç»“æŸæ—¶ä¸Šä¼ ä¸­é—´æ¨¡å‹ã€‚</p>
<h2 id="">è®­ç»ƒå¾ªç¯</h2>
<p>æˆ‘ä»¬ç°åœ¨å‡†å¤‡ç¼–å†™å®Œæ•´çš„è®­ç»ƒå¾ªç¯ã€‚åœ¨å®šä¹‰äº†ä¸€ä¸ªè¿›åº¦æ¡æ¥è·Ÿè¸ªè®­ç»ƒè¿›è¡Œå, å¾ªç¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†:</p>
<ul><li>è®­ç»ƒæœ¬èº«æ˜¯å¯¹ <code>train_dataloader</code> çš„ç»å…¸è¿­ä»£, å‰å‘ä¼ é€’æ¨¡å‹, ç„¶ååå‘ä¼ é€’å’Œä¼˜åŒ–å™¨æ­¥éª¤ã€‚</li>
<li>åœ¨è®¡ç®—ä¸­, æˆ‘ä»¬åœ¨å°† <code>start_logits</code> å’Œ <code>end_logits</code> çš„æ‰€æœ‰å€¼è½¬æ¢ä¸º NumPy æ•°ç»„ä¹‹å‰, æ”¶é›†å®ƒä»¬çš„æ‰€æœ‰å€¼ã€‚è¯„ä¼°å¾ªç¯å®Œæˆå,æˆ‘ä»¬å°†è¿æ¥æ‰€æœ‰ç»“æœã€‚è¯·æ³¨æ„, æˆ‘ä»¬éœ€è¦æˆªæ–­, å› ä¸º <code>Accelerator</code> å¯èƒ½åœ¨æœ€åæ·»åŠ äº†ä¸€äº›ç¤ºä¾‹, ä»¥ç¡®ä¿æˆ‘ä»¬åœ¨æ¯ä¸ªè¿‡ç¨‹ä¸­æ‹¥æœ‰ç›¸åŒæ•°é‡çš„ç¤ºä¾‹ã€‚</li>
<li>ä¿å­˜å’Œä¸Šä¼ , è¿™é‡Œæˆ‘ä»¬å…ˆä¿å­˜æ¨¡å‹å’Œåˆ†è¯å™¨, ç„¶åè°ƒç”¨ <code>repo.push_to_hub()</code>ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€åšçš„é‚£æ ·, æˆ‘ä»¬ä½¿ç”¨å‚æ•° <code>blocking=False</code> æ¥å‘Šè¯‰ ğŸ¤— Hub åº“æ¨å…¥ä¸€ä¸ªå¼‚æ­¥è¿›ç¨‹ã€‚è¿™æ ·, è®­ç»ƒæ­£å¸¸ç»§ç»­, å¹¶ä¸”è¿™ä¸ª (é•¿) æŒ‡ä»¤åœ¨åå°æ‰§è¡Œã€‚</li></ul>
<p>è¿™æ˜¯è®­ç»ƒå¾ªç¯çš„å®Œæ•´ä»£ç :</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Training</span>
    model.train()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_dataloader):
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># Evaluation</span>
    model.<span class="hljs-built_in">eval</span>()
    start_logits = []
    end_logits = []
    accelerator.<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Evaluation!&quot;</span>)
    <span class="hljs-keyword">for</span> batch <span class="hljs-keyword">in</span> tqdm(eval_dataloader):
        <span class="hljs-keyword">with</span> torch.no_grad():
            outputs = model(**batch)

        start_logits.append(accelerator.gather(outputs.start_logits).cpu().numpy())
        end_logits.append(accelerator.gather(outputs.end_logits).cpu().numpy())

    start_logits = np.concatenate(start_logits)
    end_logits = np.concatenate(end_logits)
    start_logits = start_logits[: <span class="hljs-built_in">len</span>(validation_dataset)]
    end_logits = end_logits[: <span class="hljs-built_in">len</span>(validation_dataset)]

    metrics = compute_metrics(
        start_logits, end_logits, validation_dataset, raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>]
    )
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;epoch <span class="hljs-subst">{epoch}</span>:&quot;</span>, metrics)

    <span class="hljs-comment"># Save and upload</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>
<p>å¦‚æœè¿™æ˜¯æ‚¨ç¬¬ä¸€æ¬¡çœ‹åˆ°ä½¿ç”¨ ğŸ¤— Accelerate ä¿å­˜çš„æ¨¡å‹, è®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´æ£€æŸ¥ä¸€ä¸‹å®ƒé™„å¸¦çš„ä¸‰è¡Œä»£ç :</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->accelerator.wait_for_everyone()
unwrapped_model = accelerator.unwrap_model(model)
unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)<!-- HTML_TAG_END --></pre></div>
<p>ç¬¬ä¸€è¡Œæ˜¯ä¸è¨€è‡ªæ˜çš„: å®ƒå‘Šè¯‰æ‰€æœ‰è¿›ç¨‹è¦ç­‰åˆ°æ¯ä¸ªäººéƒ½å¤„äºé‚£ä¸ªé˜¶æ®µæ‰èƒ½ç»§ç»­ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬åœ¨ä¿å­˜ä¹‹å‰åœ¨æ¯ä¸ªè¿‡ç¨‹ä¸­éƒ½æœ‰ç›¸åŒçš„æ¨¡å‹ã€‚ç„¶åæˆ‘ä»¬è·å– <code>unwrapped_model</code>, è¿™æ˜¯æˆ‘ä»¬å®šä¹‰çš„åŸºç¡€æ¨¡å‹ã€‚ <code>accelerator.prepare()</code> æ–¹æ³•å°†æ¨¡å‹æ›´æ”¹ä¸ºåœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­å·¥ä½œ, å› æ­¤å®ƒå°†ä¸å†æœ‰ <code>save_pretrained()</code> æ–¹æ³•; <code>accelerator.unwrap_model()</code> æ–¹æ³•ä¼šæ’¤é”€è¯¥æ­¥éª¤ã€‚æœ€å, æˆ‘ä»¬è°ƒç”¨ <code>save_pretrained()</code>, ä½†å‘Šè¯‰è¯¥æ–¹æ³•ä½¿ç”¨ <code>accelerator.save()</code> è€Œä¸æ˜¯ <code>torch.save()</code>ã€‚</p>
<p>å®Œæˆå, ä½ åº”è¯¥æ‹¥æœ‰ä¸€ä¸ªæ¨¡å‹, è¯¥æ¨¡å‹äº§ç”Ÿçš„ç»“æœä¸ä½¿ç”¨ <code>Trainer</code> è®­ç»ƒçš„æ¨¡å‹éå¸¸ç›¸ä¼¼ã€‚ä½ å¯ä»¥åœ¨ <a href="https://huggingface.co/huggingface-course/bert-finetuned-squad-accelerate" rel="nofollow"><em>huggingface-course/bert-finetuned-squad-accelerate</em></a> ä¸ŠæŸ¥çœ‹æˆ‘ä»¬ä½¿ç”¨æ­¤ä»£ç è®­ç»ƒçš„æ¨¡å‹ã€‚å¦‚æœä½ æƒ³æµ‹è¯•å¯¹è®­ç»ƒå¾ªç¯çš„ä»»ä½•è°ƒæ•´, ä½ å¯ä»¥é€šè¿‡ç¼–è¾‘ä¸Šé¢æ˜¾ç¤ºçš„ä»£ç ç›´æ¥å®ç°å®ƒä»¬!</p>
<h2 id="">ä½¿ç”¨å¾®è°ƒæ¨¡å‹</h2>
<p>æˆ‘ä»¬å·²ç»å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•å°†æˆ‘ä»¬åœ¨æ¨¡å‹ä¸­å¿ƒå¾®è°ƒçš„æ¨¡å‹ä¸æ¨ç†å°éƒ¨ä»¶ä¸€èµ·ä½¿ç”¨ã€‚è¦åœ¨ <code>pipeline</code> ä¸­æœ¬åœ°ä½¿ç”¨å®ƒ, ä½ åªéœ€è¦æŒ‡å®šæ¨¡å‹æ ‡è¯†ç¬¦:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

<span class="hljs-comment"># Replace this with your own checkpoint</span>
model_checkpoint = <span class="hljs-string">&quot;huggingface-course/bert-finetuned-squad&quot;</span>
question_answerer = pipeline(<span class="hljs-string">&quot;question-answering&quot;</span>, model=model_checkpoint)

context = <span class="hljs-string">&quot;&quot;&quot;
ğŸ¤— Transformers is backed by the three most popular deep learning libraries â€” Jax, PyTorch and TensorFlow â€” with a seamless integration
between them. It&#x27;s straightforward to train your models with one before loading them for inference with the other.
&quot;&quot;&quot;</span>
question = <span class="hljs-string">&quot;Which deep learning libraries back ğŸ¤— Transformers?&quot;</span>
question_answerer(question=question, context=context)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;score&#x27;</span>: <span class="hljs-number">0.9979003071784973</span>,
 <span class="hljs-string">&#x27;start&#x27;</span>: <span class="hljs-number">78</span>,
 <span class="hljs-string">&#x27;end&#x27;</span>: <span class="hljs-number">105</span>,
 <span class="hljs-string">&#x27;answer&#x27;</span>: <span class="hljs-string">&#x27;Jax, PyTorch and TensorFlow&#x27;</span>}<!-- HTML_TAG_END --></pre></div>
<p>å¾ˆæ£’! æˆ‘ä»¬çš„æ¨¡å‹ä¸è¯¥ç®¡é“çš„é»˜è®¤æ¨¡å‹ä¸€æ ·æœ‰æ•ˆ!</p>


		<script type="module" data-hydrate="11z32vu">
		import { start } from "/docs/course/main/zh-CN/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="11z32vu"]').parentNode,
			paths: {"base":"/docs/course/main/zh-CN","assets":"/docs/course/main/zh-CN"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/zh-CN/_app/pages/chapter7/7.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
