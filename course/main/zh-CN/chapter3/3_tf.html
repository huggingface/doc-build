<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;keras&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;è®­ç»ƒæ¨¡å‹&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æå‡è®­ç»ƒçš„æ•ˆæœ&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ¨¡å‹é¢„æµ‹&quot;}],&quot;title&quot;:&quot;ä½¿ç”¨ Keras å¾®è°ƒä¸€ä¸ªæ¨¡å‹&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/pages/chapter3/3_tf.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/CourseFloatingBanner-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/zh-CN/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="keras" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#keras"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ä½¿ç”¨ Keras å¾®è°ƒä¸€ä¸ªæ¨¡å‹
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://discuss.huggingface.co/t/chapter-3-questions" target="_blank"><img alt="Ask a Question" class="!m-0" src="https://img.shields.io/badge/Ask%20a%20question-ffcb4c.svg?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgLTEgMTA0IDEwNiI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMyMzFmMjA7fS5jbHMtMntmaWxsOiNmZmY5YWU7fS5jbHMtM3tmaWxsOiMwMGFlZWY7fS5jbHMtNHtmaWxsOiMwMGE5NGY7fS5jbHMtNXtmaWxsOiNmMTVkMjI7fS5jbHMtNntmaWxsOiNlMzFiMjM7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5EaXNjb3Vyc2VfbG9nbzwvdGl0bGU+PGcgaWQ9IkxheWVyXzIiPjxnIGlkPSJMYXllcl8zIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik01MS44NywwQzIzLjcxLDAsMCwyMi44MywwLDUxYzAsLjkxLDAsNTIuODEsMCw1Mi44MWw1MS44Ni0uMDVjMjguMTYsMCw1MS0yMy43MSw1MS01MS44N1M4MCwwLDUxLjg3LDBaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNTIuMzcsMTkuNzRBMzEuNjIsMzEuNjIsMCwwLDAsMjQuNTgsNjYuNDFsLTUuNzIsMTguNEwzOS40LDgwLjE3YTMxLjYxLDMxLjYxLDAsMSwwLDEzLTYwLjQzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMyIgZD0iTTc3LjQ1LDMyLjEyYTMxLjYsMzEuNiwwLDAsMS0zOC4wNSw0OEwxOC44Niw4NC44MmwyMC45MS0yLjQ3QTMxLjYsMzEuNiwwLDAsMCw3Ny40NSwzMi4xMloiLz48cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Ik03MS42MywyNi4yOUEzMS42LDMxLjYsMCwwLDEsMzguOCw3OEwxOC44Niw4NC44MiwzOS40LDgwLjE3QTMxLjYsMzEuNiwwLDAsMCw3MS42MywyNi4yOVoiLz48cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Ik0yNi40Nyw2Ny4xMWEzMS42MSwzMS42MSwwLDAsMSw1MS0zNUEzMS42MSwzMS42MSwwLDAsMCwyNC41OCw2Ni40MWwtNS43MiwxOC40WiIvPjxwYXRoIGNsYXNzPSJjbHMtNiIgZD0iTTI0LjU4LDY2LjQxQTMxLjYxLDMxLjYxLDAsMCwxLDcxLjYzLDI2LjI5YTMxLjYxLDMxLjYxLDAsMCwwLTQ5LDM5LjYzbC0zLjc2LDE4LjlaIi8+PC9nPjwvZz48L3N2Zz4="></a>
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3_tf.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter3/section3_tf.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>å®Œæˆä¸Šä¸€èŠ‚ä¸­çš„æ‰€æœ‰æ•°æ®é¢„å¤„ç†å·¥ä½œåï¼Œæ‚¨åªå‰©ä¸‹æœ€åçš„å‡ ä¸ªæ­¥éª¤æ¥è®­ç»ƒæ¨¡å‹ã€‚ ä½†æ˜¯è¯·æ³¨æ„ï¼Œ<code>model.fit()</code> å‘½ä»¤åœ¨ CPU ä¸Šè¿è¡Œä¼šéå¸¸ç¼“æ…¢ã€‚ å¦‚æœæ‚¨æ²¡æœ‰GPUï¼Œåˆ™å¯ä»¥åœ¨ <a href="https://colab.research.google.com/" rel="nofollow">Google Colab</a> ä¸Šä½¿ç”¨å…è´¹çš„ GPU æˆ– TPU(éœ€è¦æ¢¯å­)ã€‚</p>
<p>è¿™ä¸€èŠ‚çš„ä»£ç ç¤ºä¾‹å‡è®¾æ‚¨å·²ç»æ‰§è¡Œäº†ä¸Šä¸€èŠ‚ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚ ä¸‹é¢ä¸€ä¸ªç®€çŸ­çš„æ‘˜è¦ï¼ŒåŒ…å«äº†åœ¨å¼€å§‹å­¦ä¹ è¿™ä¸€èŠ‚ä¹‹å‰æ‚¨éœ€è¦çš„æ‰§è¡Œçš„ä»£ç ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, DataCollatorWithPadding
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
checkpoint = <span class="hljs-string">&quot;bert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> tokenizer(example[<span class="hljs-string">&quot;sentence1&quot;</span>], example[<span class="hljs-string">&quot;sentence2&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)

data_collator = DataCollatorWithPadding(tokenizer=tokenizer, return_tensors=<span class="hljs-string">&quot;tf&quot;</span>)

tf_train_dataset = tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;attention_mask&quot;</span>, <span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;token_type_ids&quot;</span>],
    label_cols=[<span class="hljs-string">&quot;labels&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=data_collator,
    batch_size=<span class="hljs-number">8</span>,
)

tf_validation_dataset = tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>].to_tf_dataset(
    columns=[<span class="hljs-string">&quot;attention_mask&quot;</span>, <span class="hljs-string">&quot;input_ids&quot;</span>, <span class="hljs-string">&quot;token_type_ids&quot;</span>],
    label_cols=[<span class="hljs-string">&quot;labels&quot;</span>],
    shuffle=<span class="hljs-literal">False</span>,
    collate_fn=data_collator,
    batch_size=<span class="hljs-number">8</span>,
)<!-- HTML_TAG_END --></pre></div>
<h3 id="">è®­ç»ƒæ¨¡å‹</h3>
<p>ä»ğŸ¤— Transformers å¯¼å…¥çš„ TensorFlow æ¨¡å‹å·²ç»æ˜¯ Keras æ¨¡å‹ã€‚ ä¸‹é¢çš„è§†é¢‘æ˜¯å¯¹ Keras çš„ç®€çŸ­ä»‹ç»ã€‚</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/rnTGBy2ax1c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>è¿™æ„å‘³ç€ï¼Œä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ•°æ®ï¼Œå°±éœ€è¦å¾ˆå°‘çš„å·¥ä½œå°±å¯ä»¥å¼€å§‹å¯¹å…¶è¿›è¡Œè®­ç»ƒã€‚</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/AUozVp78dhk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>å’Œ<a href="/course/chapter2">ç¬¬äºŒç« </a>ä½¿ç”¨çš„æ–¹æ³•ä¸€æ ·, æˆ‘ä»¬å°†ä½¿ç”¨äºŒåˆ†ç±»çš„ <code>TFAutoModelForSequenceClassification</code>ç±»: </p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TFAutoModelForSequenceClassification

model = TFAutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div>
<p>æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œä¸ <a href="/course/chapter2">ç¬¬äºŒç« </a> ä¸åŒçš„æ˜¯ï¼Œæ‚¨åœ¨å®ä¾‹åŒ–æ­¤é¢„è®­ç»ƒæ¨¡å‹åä¼šæ”¶åˆ°è­¦å‘Šã€‚ è¿™æ˜¯å› ä¸º BERT æ²¡æœ‰å¯¹å¥å­å¯¹è¿›è¡Œåˆ†ç±»è¿›è¡Œé¢„è®­ç»ƒï¼Œæ‰€ä»¥é¢„è®­ç»ƒæ¨¡å‹çš„ head å·²ç»è¢«ä¸¢å¼ƒï¼Œè€Œæ˜¯æ’å…¥äº†ä¸€ä¸ªé€‚åˆåºåˆ—åˆ†ç±»çš„æ–° headã€‚ è­¦å‘Šè¡¨æ˜ä¸€äº›æƒé‡æ²¡æœ‰ä½¿ç”¨ï¼ˆå¯¹åº”äºä¸¢å¼ƒçš„é¢„è®­ç»ƒå¤´ï¼‰ï¼Œè€Œå…¶ä»–ä¸€äº›æƒé‡æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼ˆæ–°å¤´çš„æƒé‡ï¼‰ã€‚ æœ€åé¼“åŠ±æ‚¨è®­ç»ƒæ¨¡å‹ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬ç°åœ¨è¦åšçš„ã€‚</p>
<p>è¦åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸Šå¾®è°ƒæ¨¡å‹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸Šè°ƒç”¨ <code>compile()</code> æ–¹æ³•ï¼Œç„¶åå°†æˆ‘ä»¬çš„æ•°æ®ä¼ é€’ç»™ <code>fit()</code> æ–¹æ³•ã€‚ è¿™å°†å¯åŠ¨å¾®è°ƒè¿‡ç¨‹ï¼ˆåœ¨ GPU ä¸Šåº”è¯¥éœ€è¦å‡ åˆ†é’Ÿï¼‰å¹¶è¾“å‡ºè®­ç»ƒlossï¼Œä»¥åŠæ¯ä¸ª epoch ç»“æŸæ—¶çš„éªŒè¯lossã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>è¯·æ³¨æ„ğŸ¤— Transformers æ¨¡å‹å…·æœ‰å¤§å¤šæ•° Keras æ¨¡å‹æ‰€æ²¡æœ‰çš„ç‰¹æ®Šèƒ½åŠ›â€”â€”å®ƒä»¬å¯ä»¥è‡ªåŠ¨ä½¿ç”¨å†…éƒ¨è®¡ç®—çš„lossã€‚ å¦‚æœæ‚¨æ²¡æœ‰åœ¨ <code>compile()</code> ä¸­è®¾ç½®æŸå¤±å‡½æ•°ï¼Œä»–ä»¬å°†é»˜è®¤ä½¿ç”¨å†…éƒ¨è®¡ç®—çš„æŸå¤±ã€‚ è¯·æ³¨æ„ï¼Œè¦ä½¿ç”¨å†…éƒ¨æŸå¤±ï¼Œæ‚¨éœ€è¦å°†æ ‡ç­¾ä½œä¸ºè¾“å…¥çš„ä¸€éƒ¨åˆ†ä¼ é€’ï¼Œè€Œä¸æ˜¯ä½œä¸ºå•ç‹¬çš„æ ‡ç­¾ï¼ˆè¿™æ˜¯åœ¨ Keras æ¨¡å‹ä¸­ä½¿ç”¨æ ‡ç­¾çš„æ­£å¸¸æ–¹å¼ï¼‰ã€‚ æ‚¨å°†åœ¨è¯¾ç¨‹çš„ç¬¬ 2 éƒ¨åˆ†ä¸­çœ‹åˆ°è¿™æ–¹é¢çš„ç¤ºä¾‹ï¼Œå…¶ä¸­å®šä¹‰æ­£ç¡®çš„æŸå¤±å‡½æ•°å¯èƒ½å¾ˆæ£˜æ‰‹ã€‚ ç„¶è€Œï¼Œå¯¹äºåºåˆ—åˆ†ç±»ï¼Œæ ‡å‡†çš„ Keras æŸå¤±å‡½æ•°å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åœ¨è¿™é‡Œä½¿ç”¨å®ƒã€‚</p></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tensorflow.keras.losses <span class="hljs-keyword">import</span> SparseCategoricalCrossentropy

model.<span class="hljs-built_in">compile</span>(
    optimizer=<span class="hljs-string">&quot;adam&quot;</span>,
    loss=SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>),
    metrics=[<span class="hljs-string">&quot;accuracy&quot;</span>],
)
model.fit(
    tf_train_dataset,
    validation_data=tf_validation_dataset,
)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip course-tip-orange bg-gradient-to-br dark:bg-gradient-to-r before:border-orange-500 dark:before:border-orange-800 from-orange-50 dark:from-gray-900 to-white dark:to-gray-950 border border-orange-50 text-orange-700 dark:text-gray-400"><p>è¯·æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸å¸¸è§çš„é™·é˜±â€”â€”ä½ åªæ˜¯<em>å¯ä»¥</em>å°†æŸå¤±çš„åç§°ä½œä¸ºå­—ç¬¦ä¸²ä¼ é€’ç»™ Kerasï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ï¼ŒKeras ä¼šå‡è®¾ä½ å·²ç»å¯¹è¾“å‡ºåº”ç”¨äº† softmaxã€‚ ç„¶è€Œï¼Œè®¸å¤šæ¨¡å‹åœ¨åº”ç”¨ softmax ä¹‹å‰å°±è¾“å‡ºï¼Œä¹Ÿç§°ä¸º <em>logits</em>ã€‚ æˆ‘ä»¬éœ€è¦å‘Šè¯‰æŸå¤±å‡½æ•°æˆ‘ä»¬çš„æ¨¡å‹æ˜¯å¦ç»è¿‡äº†softmaxï¼Œå”¯ä¸€çš„æ–¹æ³•æ˜¯ç›´æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯ç”¨å­—ç¬¦ä¸²çš„åç§°ã€‚</p></div>
<h3 id="">æå‡è®­ç»ƒçš„æ•ˆæœ</h3>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/cpzq6ESSM5c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>å¦‚æœæ‚¨å°è¯•ä¸Šé¢çš„ä»£ç ï¼Œå®ƒè‚¯å®šä¼šè¿è¡Œï¼Œä½†æ‚¨ä¼šå‘ç°lossåªæ˜¯ç¼“æ…¢æˆ–é›¶æ˜Ÿåœ°ä¸‹é™ã€‚ ä¸»è¦åŸå› æ˜¯<em>å­¦ä¹ ç‡</em>ã€‚ ä¸lossä¸€æ ·ï¼Œå½“æˆ‘ä»¬å°†ä¼˜åŒ–å™¨çš„åç§°ä½œä¸ºå­—ç¬¦ä¸²ä¼ é€’ç»™ Keras æ—¶ï¼ŒKeras ä¼šåˆå§‹åŒ–è¯¥ä¼˜åŒ–å™¨å…·æœ‰æ‰€æœ‰å‚æ•°çš„é»˜è®¤å€¼ï¼ŒåŒ…æ‹¬å­¦ä¹ ç‡ã€‚ ä½†æ˜¯ï¼Œæ ¹æ®é•¿æœŸç»éªŒï¼Œæˆ‘ä»¬çŸ¥é“Transformer æ¨¡å‹æ›´é€‚åˆä½¿ç”¨æ¯” Adam çš„é»˜è®¤å€¼ï¼ˆ1e-3ï¼‰ä¹Ÿå†™æˆä¸º 10 çš„ -3 æ¬¡æ–¹ï¼Œæˆ– 0.001ï¼Œä½å¾—å¤šçš„å­¦ä¹ ç‡ã€‚ 5e-5 (0.00005) æ¯”é»˜è®¤å€¼å¤§çº¦ä½ 20 å€ï¼Œæ˜¯ä¸€ä¸ªæ›´å¥½çš„èµ·ç‚¹ã€‚</p>
<p>é™¤äº†é™ä½å­¦ä¹ ç‡ï¼Œæˆ‘ä»¬è¿˜æœ‰ç¬¬äºŒä¸ªæŠ€å·§ï¼šæˆ‘ä»¬å¯ä»¥æ…¢æ…¢é™ä½å­¦ä¹ ç‡ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚ åœ¨æ–‡çŒ®ä¸­ï¼Œæ‚¨æœ‰æ—¶ä¼šçœ‹åˆ°è¿™è¢«ç§°ä¸º <em>decaying</em> æˆ– <em>annealing</em>å­¦ä¹ ç‡ã€‚ åœ¨ Keras ä¸­ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <em>learning rate scheduler</em>ã€‚ ä¸€ä¸ªå¥½ç”¨çš„æ˜¯<code>PolynomialDecay</code>â€”â€”å°½ç®¡æœ‰è¿™ä¸ªåå­—ï¼Œä½†åœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼Œå®ƒåªæ˜¯ç®€å•åœ°ä»åˆå§‹å€¼çº¿æ€§è¡°å‡å­¦ä¹ ç‡å€¼åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„æœ€ç»ˆå€¼ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ä½†æ˜¯ï¼Œ ä¸ºäº†æ­£ç¡®ä½¿ç”¨è°ƒåº¦ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰å®ƒè®­ç»ƒçš„æ¬¡æ•°ã€‚ æˆ‘ä»¬å°†åœ¨ä¸‹é¢ä¸ºå…¶è®¡ç®—â€œnum_train_stepsâ€ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tensorflow.keras.optimizers.schedules <span class="hljs-keyword">import</span> PolynomialDecay

batch_size = <span class="hljs-number">8</span>
num_epochs = <span class="hljs-number">3</span>
<span class="hljs-comment"># è®­ç»ƒæ­¥æ•°æ˜¯æ•°æ®é›†ä¸­çš„æ ·æœ¬æ•°é™¤ä»¥batch sizeå†ä¹˜ä»¥ epochã€‚</span>
<span class="hljs-comment"># æ³¨æ„è¿™é‡Œçš„tf_train_datasetæ˜¯ä¸€ä¸ªè½¬åŒ–ä¸ºbatchåçš„ tf.data.Datasetï¼Œ</span>
<span class="hljs-comment"># ä¸æ˜¯åŸæ¥çš„ Hugging Face Datasetï¼Œæ‰€ä»¥å®ƒçš„ len() å·²ç»æ˜¯ num_samples // batch_sizeã€‚</span>
num_train_steps = <span class="hljs-built_in">len</span>(tf_train_dataset) * num_epochs
lr_scheduler = PolynomialDecay(
    initial_learning_rate=<span class="hljs-number">5e-5</span>, end_learning_rate=<span class="hljs-number">0.0</span>, decay_steps=num_train_steps
)
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam

opt = Adam(learning_rate=lr_scheduler)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ¤— Transformers åº“è¿˜æœ‰ä¸€ä¸ª <code>create_optimizer()</code> å‡½æ•°ï¼Œå®ƒå°†åˆ›å»ºä¸€ä¸ªå…·æœ‰å­¦ä¹ ç‡è¡°å‡çš„ <code>AdamW</code> ä¼˜åŒ–å™¨ã€‚ è¿™æ˜¯ä¸€ä¸ªä¾¿æ·çš„æ–¹å¼ï¼Œæ‚¨å°†åœ¨æœ¬è¯¾ç¨‹çš„åç»­éƒ¨åˆ†ä¸­è¯¦ç»†äº†è§£ã€‚</p></div>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å…¨æ–°çš„ä¼˜åŒ–å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨å®ƒè¿›è¡Œè®­ç»ƒã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬é‡æ–°åŠ è½½æ¨¡å‹ï¼Œä»¥é‡ç½®æˆ‘ä»¬åˆšåˆšè¿›è¡Œçš„è®­ç»ƒè¿è¡Œå¯¹æƒé‡çš„æ›´æ”¹ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°çš„ä¼˜åŒ–å™¨å¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf

model = TFAutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)
loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>)
model.<span class="hljs-built_in">compile</span>(optimizer=opt, loss=loss, metrics=[<span class="hljs-string">&quot;accuracy&quot;</span>])<!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å†æ¬¡è¿›è¡Œfitï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model.fit(tf_train_dataset, validation_data=tf_validation_dataset, epochs=<span class="hljs-number">3</span>)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ å¦‚æœæ‚¨æƒ³åœ¨è®­ç»ƒæœŸé—´è‡ªåŠ¨å°†æ¨¡å‹ä¸Šä¼ åˆ° Hubï¼Œæ‚¨å¯ä»¥åœ¨ <code>model.fit()</code> æ–¹æ³•ä¸­ä¼ é€’ <code>PushToHubCallback</code>ã€‚ æˆ‘ä»¬å°†åœ¨ <a href="/course/chapter4/3">ç¬¬å››ç« </a> ä¸­è¿›è¡Œä»‹ç»</p></div>
<h3 id="">æ¨¡å‹é¢„æµ‹</h3>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/nx10eh4CoOs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>è®­ç»ƒå’Œè§‚å¯Ÿçš„lossä¸‹é™éƒ½éå¸¸å¥½ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³ä»è®­ç»ƒåçš„æ¨¡å‹ä¸­è·å¾—è¾“å‡ºï¼Œæˆ–è€…è®¡ç®—ä¸€äº›æŒ‡æ ‡ï¼Œæˆ–è€…åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨æ¨¡å‹å‘¢ï¼Ÿ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>predict()</code> æ–¹æ³•ã€‚ è¿™å°†è¿”å›æ¨¡å‹çš„è¾“å‡ºå¤´çš„<em>logits</em>æ•°å€¼ï¼Œæ¯ä¸ªç±»ä¸€ä¸ªã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->preds = model.predict(tf_validation_dataset)[<span class="hljs-string">&quot;logits&quot;</span>]<!-- HTML_TAG_END --></pre></div>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™äº› logit è½¬æ¢ä¸ºæ¨¡å‹çš„ç±»åˆ«é¢„æµ‹ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ argmax æ‰¾åˆ°æœ€é«˜çš„ logitï¼Œå®ƒå¯¹åº”äºæœ€æœ‰å¯èƒ½çš„ç±»åˆ«ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->class_preds = np.argmax(preds, axis=<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(preds.shape, class_preds.shape)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">408</span>, <span class="hljs-number">2</span>) (<span class="hljs-number">408</span>,)<!-- HTML_TAG_END --></pre></div>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿™äº› <code>preds</code> æ¥è®¡ç®—ä¸€äº›æŒ‡æ ‡ï¼ æˆ‘ä»¬å¯ä»¥åƒåŠ è½½æ•°æ®é›†ä¸€æ ·è½»æ¾åœ°åŠ è½½ä¸ MRPC æ•°æ®é›†ç›¸å…³çš„æŒ‡æ ‡ï¼Œè¿™æ¬¡ä½¿ç”¨çš„æ˜¯ <code>evaluate.load()</code> å‡½æ•°ã€‚ è¿”å›çš„å¯¹è±¡æœ‰ä¸€ä¸ª <code>compute()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œåº¦é‡è®¡ç®—ï¼š</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
metric.compute(predictions=class_preds, references=raw_datasets[<span class="hljs-string">&quot;validation&quot;</span>][<span class="hljs-string">&quot;label&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8578431372549019</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8996539792387542</span>}<!-- HTML_TAG_END --></pre></div>
<p>æ‚¨è·å¾—çš„ç¡®åˆ‡ç»“æœå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæ¨¡å‹å¤´çš„éšæœºåˆå§‹åŒ–å¯èƒ½ä¼šæ”¹å˜å®ƒè·å¾—çš„æŒ‡æ ‡ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡ä¸º 85.78%ï¼ŒF1 å¾—åˆ†ä¸º 89.97ã€‚ è¿™äº›æ˜¯ç”¨äºè¯„ä¼° GLUE åŸºå‡†çš„ MRPC æ•°æ®é›†ç»“æœçš„ä¸¤ä¸ªæŒ‡æ ‡ã€‚ <a href="https://arxiv.org/pdf/1810.04805.pdf" rel="nofollow">BERT è®ºæ–‡</a> ä¸­çš„è¡¨æ ¼æŠ¥å‘Šäº†åŸºæœ¬æ¨¡å‹çš„ F1 åˆ†æ•°ä¸º 88.9ã€‚ é‚£æ˜¯ <code>uncased</code> æ¨¡å‹ï¼Œè€Œæˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„æ˜¯ <code>cased</code> æ¨¡å‹ï¼Œè¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šè·å¾—æ›´å¥½çš„ç»“æœã€‚</p>
<p>ä½¿ç”¨ Keras API è¿›è¡Œå¾®è°ƒçš„ä»‹ç»åˆ°æ­¤ç»“æŸã€‚ ç¬¬ 7 ç« å°†ç»™å‡ºå¯¹å¤§å¤šæ•°å¸¸è§ NLP ä»»åŠ¡æ‰§è¡Œæ­¤æ“ä½œçš„ç¤ºä¾‹ã€‚å¦‚æœæ‚¨æƒ³åœ¨ Keras API ä¸Šç£¨ç»ƒè‡ªå·±çš„æŠ€èƒ½ï¼Œè¯·å°è¯•ä½¿ç¬¬äºŒèŠ‚æ‰€ä½¿ç”¨çš„çš„æ•°æ®å¤„ç†åœ¨ GLUE SST-2 æ•°æ®é›†ä¸Šå¾®è°ƒæ¨¡å‹ã€‚</p>


		<script type="module" data-hydrate="pspi4k">
		import { start } from "/docs/course/main/zh-CN/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="pspi4k"]').parentNode,
			paths: {"base":"/docs/course/main/zh-CN","assets":"/docs/course/main/zh-CN"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/zh-CN/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/zh-CN/_app/pages/chapter3/3_tf.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
