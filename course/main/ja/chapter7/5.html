<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¤šè¨€èªã‚³ãƒ¼ãƒ‘ã‚¹ã®æº–å‚™&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;æ–‡ç« è¦ç´„ç”¨ãƒ¢ãƒ‡ãƒ«&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†&quot;},{&quot;local&quot;:&quot;&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å¼·åŠ›ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ä½œæˆ&quot;}],&quot;title&quot;:&quot;æ–‡ç« è¦ç´„ã®ãŸã‚ã®æŒ‡æ¨™&quot;},{&quot;local&quot;:&quot;trainer-api-mt5&quot;,&quot;title&quot;:&quot;Trainer API ã‚’ä½¿ã£ã¦ mT5 ã‚’å¾®èª¿æ•´ã™ã‚‹&quot;},{&quot;local&quot;:&quot;kerasmt5&quot;,&quot;title&quot;:&quot;Kerasã§mT5ã‚’å¾®èª¿æ•´ã™ã‚‹&quot;},{&quot;local&quot;:&quot;mt5-accelerate&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãŸã‚ã®æº–å‚™&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;å­¦ç¿’ãƒ«ãƒ¼ãƒ—&quot;}],&quot;title&quot;:&quot;mT5ãƒ¢ãƒ‡ãƒ«ã‚’ ğŸ¤— Accelerate ã‚’ä½¿ã£ã¦å¾®èª¿æ•´ã™ã‚‹&quot;},{&quot;local&quot;:&quot;&quot;,&quot;title&quot;:&quot;ã‚ãªãŸã®å¾®èª¿æ•´ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹&quot;}],&quot;title&quot;:&quot;è¦ç´„&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/pages/chapter7/5.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/CourseFloatingBanner-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/main/ja/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 id="">è¦ç´„</h1>


<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://discuss.huggingface.co/t/chapter-7-questions" target="_blank"><img alt="Ask a Question" class="!m-0" src="https://img.shields.io/badge/Ask%20a%20question-ffcb4c.svg?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgLTEgMTA0IDEwNiI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMyMzFmMjA7fS5jbHMtMntmaWxsOiNmZmY5YWU7fS5jbHMtM3tmaWxsOiMwMGFlZWY7fS5jbHMtNHtmaWxsOiMwMGE5NGY7fS5jbHMtNXtmaWxsOiNmMTVkMjI7fS5jbHMtNntmaWxsOiNlMzFiMjM7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5EaXNjb3Vyc2VfbG9nbzwvdGl0bGU+PGcgaWQ9IkxheWVyXzIiPjxnIGlkPSJMYXllcl8zIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik01MS44NywwQzIzLjcxLDAsMCwyMi44MywwLDUxYzAsLjkxLDAsNTIuODEsMCw1Mi44MWw1MS44Ni0uMDVjMjguMTYsMCw1MS0yMy43MSw1MS01MS44N1M4MCwwLDUxLjg3LDBaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNTIuMzcsMTkuNzRBMzEuNjIsMzEuNjIsMCwwLDAsMjQuNTgsNjYuNDFsLTUuNzIsMTguNEwzOS40LDgwLjE3YTMxLjYxLDMxLjYxLDAsMSwwLDEzLTYwLjQzWiIvPjxwYXRoIGNsYXNzPSJjbHMtMyIgZD0iTTc3LjQ1LDMyLjEyYTMxLjYsMzEuNiwwLDAsMS0zOC4wNSw0OEwxOC44Niw4NC44MmwyMC45MS0yLjQ3QTMxLjYsMzEuNiwwLDAsMCw3Ny40NSwzMi4xMloiLz48cGF0aCBjbGFzcz0iY2xzLTQiIGQ9Ik03MS42MywyNi4yOUEzMS42LDMxLjYsMCwwLDEsMzguOCw3OEwxOC44Niw4NC44MiwzOS40LDgwLjE3QTMxLjYsMzEuNiwwLDAsMCw3MS42MywyNi4yOVoiLz48cGF0aCBjbGFzcz0iY2xzLTUiIGQ9Ik0yNi40Nyw2Ny4xMWEzMS42MSwzMS42MSwwLDAsMSw1MS0zNUEzMS42MSwzMS42MSwwLDAsMCwyNC41OCw2Ni40MWwtNS43MiwxOC40WiIvPjxwYXRoIGNsYXNzPSJjbHMtNiIgZD0iTTI0LjU4LDY2LjQxQTMxLjYxLDMxLjYxLDAsMCwxLDcxLjYzLDI2LjI5YTMxLjYxLDMxLjYxLDAsMCwwLTQ5LDM5LjYzbC0zLjc2LDE4LjlaIi8+PC9nPjwvZz48L3N2Zz4="></a>
	<a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter7/section5_pt.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter7/section5_pt.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Transformerãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€é•·ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦ç´„ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚ã“ã‚Œã¯ã€<em>æ–‡ç« è¦ç´„</em> ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã‚‹ã‚¿ã‚¹ã‚¯ã§ã™ã€‚ ã“ã‚Œã¯ã€é•·ã„æ–‡ç« ã‚’ç†è§£ã—ãŸã‚Šã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¸»è¦ãªãƒˆãƒ”ãƒƒã‚¯ã‚’è£œè¶³ã™ã‚‹ä¸€è²«æ€§ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆã—ãŸã‚Šã™ã‚‹ãªã©ã€ã•ã¾ã–ã¾ãªèƒ½åŠ›ã‚’å¿…è¦ã¨ã™ã‚‹ãŸã‚ã€æœ€ã‚‚å›°é›£ãªNLPã‚¿ã‚¹ã‚¯ã®1ã¤ã§ã™ã€‚ ãŸã ã—ã€ãƒ†ã‚­ã‚¹ãƒˆã®è¦ç´„ã¯ã€ã†ã¾ãè¡Œã‘ã°ã€é ˜åŸŸã®å°‚é–€å®¶ãŒé•·ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è©³ç´°ã«èª­ã‚€è² æ‹…ã‚’è»½æ¸›ã™ã‚‹ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—ã§ãã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã«ãªã‚Šã¾ã™ã€‚</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/yHnr5Dk2zCI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><a href="https://huggingface.co/models?pipeline_tag=summarization&sort=downloads" rel="nofollow">ãƒã‚®ãƒ³ã‚°ãƒ•ã‚§ã‚¤ã‚¹ ãƒãƒ–</a>ã«ã¯ã€è¦ç´„ç”¨ã«å¾®èª¿æ•´ã•ã‚ŒãŸã•ã¾ã–ã¾ãªãƒ¢ãƒ‡ãƒ«ãŒã™ã§ã«å­˜åœ¨ã—ã¾ã™ãŒã€ã“ã‚Œã‚‰ã®ã»ã¨ã‚“ã©ã¯è‹±èªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã®ã¿é©ã—ã¦ã„ã¾ã™ã€‚ ã—ãŸãŒã£ã¦ã€ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã²ã­ã‚Šã‚’åŠ ãˆã‚‹ãŸã‚ã«ã€è‹±èªã¨ã‚¹ãƒšã‚¤ãƒ³èªã®ãƒã‚¤ãƒªãƒ³ã‚¬ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¾ã™ã€‚ ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®çµ‚ã‚ã‚Šã¾ã§ã«ã€ã“ã“ã«ç¤ºã™ã‚ˆã†ãªã‚«ã‚¹ã‚¿ãƒãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¦ç´„ã§ãã‚‹<a href="https://huggingface.co/huggingface-course/mt5-small-finetuned-amazon-en-es" rel="nofollow">ãƒ¢ãƒ‡ãƒ«</a>ãŒã§ãã‚ãŒã‚Šã¾ã™ã€‚ </p>
<iframe src="https://hf.space/gradioiframe/course-demos/mt5-small-finetuned-amazon-en-es/+" frameborder="0" height="400" title="Gradio app" class="block dark:hidden container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>
<p>ã“ã‚Œã‹ã‚‰èª¬æ˜ã™ã‚‹ã‚ˆã†ã«ã€ã“ã‚Œã‚‰ã®è¦ç´„ã¯ã€é¡§å®¢ãŒè£½å“ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿æ™‚ã«ã¤ã‘ãŸã‚¿ã‚¤ãƒˆãƒ«æ–‡ã‚’ä½¿ã£ã¦å­¦ç¿’ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ç°¡æ½”ã§ã™ã€‚ ã“ã®ã‚¿ã‚¹ã‚¯ã«é©ã—ãŸå¤šè¨€èªã‚³ãƒ¼ãƒ‘ã‚¹ã‚’ã¾ã¨ã‚ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</p>
<h2 id="">å¤šè¨€èªã‚³ãƒ¼ãƒ‘ã‚¹ã®æº–å‚™</h2>
<p><a href="https://huggingface.co/datasets/amazon_reviews_multi" rel="nofollow">Multilingual Amazon Reviews Corpus</a>ã‚’ä½¿ç”¨ã—ã¦ã€å¤šè¨€èªè¦ç´„å™¨ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã¯ã€6ã¤ã®è¨€èªã§ã®Amazonè£½å“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ§‹æˆã•ã‚Œã¦ãŠã‚Šã€é€šå¸¸ã€å¤šè¨€èªåˆ†é¡å­ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ ãŸã ã—ã€å„ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã¯çŸ­ã„ã‚¿ã‚¤ãƒˆãƒ«ãŒä»˜ã„ã¦ã„ã‚‹ãŸã‚ã€ãƒ¢ãƒ‡ãƒ«ãŒå­¦ç¿’å¯¾è±¡ã¨ã™ã‚‹è¦ç´„æ–‡ã¨ã—ã¦ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ é–‹å§‹ã™ã‚‹ã«ã¯ã€ãƒã‚®ãƒ³ã‚°ãƒ•ã‚§ã‚¤ã‚¹ ãƒãƒ–ã‹ã‚‰è‹±èªã¨ã‚¹ãƒšã‚¤ãƒ³èªã®ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

spanish_dataset = load_dataset(<span class="hljs-string">&quot;amazon_reviews_multi&quot;</span>, <span class="hljs-string">&quot;es&quot;</span>)
english_dataset = load_dataset(<span class="hljs-string">&quot;amazon_reviews_multi&quot;</span>, <span class="hljs-string">&quot;en&quot;</span>)
english_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">200000</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">5000</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;review_id&#x27;</span>, <span class="hljs-string">&#x27;product_id&#x27;</span>, <span class="hljs-string">&#x27;reviewer_id&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>, <span class="hljs-string">&#x27;review_body&#x27;</span>, <span class="hljs-string">&#x27;review_title&#x27;</span>, <span class="hljs-string">&#x27;language&#x27;</span>, <span class="hljs-string">&#x27;product_category&#x27;</span>],
        num_rows: <span class="hljs-number">5000</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>ã”è¦§ã®é€šã‚Šã€å„è¨€èªã® <code>train</code> åˆ†å‰²ã«ã¯ 200,000 ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã‚ã‚Šã€ <code>validation</code> ã¨ <code>test</code> åˆ†å‰²ã«ã¯ãã‚Œãã‚Œ 5,000 ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ç§é”ãŒå†…å®¹ã‚’çŸ¥ã‚ŠãŸã„ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã¯ <code>review_body</code> ã¨ <code>review_title</code> ã‚«ãƒ©ãƒ ã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚<a href="/course/ja/chapter5">ç¬¬5ç« </a> ã§å­¦ã‚“ã æ‰‹æ³•ã§ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚»ãƒƒãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚µãƒ³ãƒ—ãƒ«ã‚’å–å¾—ã™ã‚‹ç°¡å˜ãªé–¢æ•°ã‚’ä½œæˆã—ã€ã„ãã¤ã‹ã®ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">show_samples</span>(<span class="hljs-params">dataset, num_samples=<span class="hljs-number">3</span>, seed=<span class="hljs-number">42</span></span>):
    sample = dataset[<span class="hljs-string">&quot;train&quot;</span>].shuffle(seed=seed).select(<span class="hljs-built_in">range</span>(num_samples))
    <span class="hljs-keyword">for</span> example <span class="hljs-keyword">in</span> sample:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt; Title: <span class="hljs-subst">{example[<span class="hljs-string">&#x27;review_title&#x27;</span>]}</span>&#x27;&quot;</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt; Review: <span class="hljs-subst">{example[<span class="hljs-string">&#x27;review_body&#x27;</span>]}</span>&#x27;&quot;</span>)


show_samples(english_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: Worked in front position, not rear&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: 3 stars because these are not rear brakes as stated in the item description. At least the mount adapter only worked on the front fork of the bike that I got it for.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: meh&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Does itâ€™s job and itâ€™s gorgeous but mine is falling apart, I had to basically put it together again with hot glue&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Can\&#x27;t beat these for the money&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Bought this for handling miscellaneous aircraft parts and hanger &quot;stuff&quot; that I needed to organize; it really fit the bill. The unit arrived quickly, was well packaged and arrived intact (always a good sign). There are five wall mounts-- three on the top and two on the bottom. I wanted to mount it on the wall, so all I had to do was to remove the top two layers of plastic drawers, as well as the bottom corner drawers, place it when I wanted and mark it; I then used some of the new plastic screw in wall anchors (the 50 pound variety) and it easily mounted to the wall. Some have remarked that they wanted dividers for the drawers, and that they made those. Good idea. My application was that I needed something that I can see the contents at about eye level, so I wanted the fuller-sized drawers. I also like that these are the new plastic that doesn\&#x27;t get brittle and split like my older plastic drawers did. I like the all-plastic construction. It\&#x27;s heavy duty enough to hold metal parts, but being made of plastic it\&#x27;s not as heavy as a metal frame, so you can easily mount it to the wall and still load it up with heavy stuff, or light stuff. No problem there. For the money, you can\&#x27;t beat it. Best one of these I\&#x27;ve bought to date-- and I\&#x27;ve been using some version of these for over forty years.&#x27;</span><!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>ã‚ãªãŸã®ç•ªã§ã™ï¼ </strong> <code>Dataset.shuffle()</code> ã‚³ãƒãƒ³ãƒ‰ã®ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ã€ã‚³ãƒ¼ãƒ‘ã‚¹ã®ä»–ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚èª¿ã¹ã¦ã¿ã¦ãã ã•ã„ã€‚ã‚‚ã—ã‚ãªãŸãŒã‚¹ãƒšã‚¤ãƒ³èªã‚’è©±ã›ã‚‹ãªã‚‰ã€<code>spanish_dataset</code> ã«ã‚ã‚‹ã„ãã¤ã‹ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¦‹ã¦ã€ã‚¿ã‚¤ãƒˆãƒ«ã‚‚å¦¥å½“ãªè¦ç´„ã«è¦‹ãˆã‚‹ã‹ã©ã†ã‹ç¢ºã‹ã‚ã¦ã¿ã¦ãã ã•ã„ã€‚</p></div>
<p>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ã€è‚¯å®šçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã‹ã‚‰å¦å®šçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã¾ã§ï¼ˆãã—ã¦ãã®ä¸­é–“ã«ã‚ã‚‹å…¨ã¦ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ï¼‰ã€ä¸€èˆ¬çš„ã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§è¦‹ã‚‰ã‚Œã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å¤šæ§˜æ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ ã€Œmehã€ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã¯ã‚ã¾ã‚Šæœ‰ç›Šãªæƒ…å ±ã‚’ç¤ºã™ã‚¿ã‚¤ãƒˆãƒ«ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ä»–ã®ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼è‡ªä½“ã®é©åˆ‡ãªè¦ç´„ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚40ä¸‡ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã¹ã¦ã«ã¤ã„ã¦è¦ç´„ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹ã“ã¨ã¯ã€å˜ä¸€ã®GPUã§ã¯ã‚ã¾ã‚Šã«ã‚‚æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã‚‹ãŸã‚ã€ãã®ä»£ã‚ã‚Šã«ã€å˜ä¸€è£½å“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã¤ã„ã¦è¦ç´„ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚ã©ã®ã‚ˆã†ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰é¸æŠã§ãã‚‹ã‹ã‚’çŸ¥ã‚‹ãŸã‚ã«ã€<code>english_dataset</code> ã‚’ <code>pandas.DataFrame</code> ã«å¤‰æ›ã—ã¦ã€è£½å“ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->english_dataset.set_format(<span class="hljs-string">&quot;pandas&quot;</span>)
english_df = english_dataset[<span class="hljs-string">&quot;train&quot;</span>][:]
<span class="hljs-comment"># Show counts for top 20 products</span>
english_df[<span class="hljs-string">&quot;product_category&quot;</span>].value_counts()[:<span class="hljs-number">20</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->home                      <span class="hljs-number">17679</span>
apparel                   <span class="hljs-number">15951</span>
wireless                  <span class="hljs-number">15717</span>
other                     <span class="hljs-number">13418</span>
beauty                    <span class="hljs-number">12091</span>
drugstore                 <span class="hljs-number">11730</span>
kitchen                   <span class="hljs-number">10382</span>
toy                        <span class="hljs-number">8745</span>
sports                     <span class="hljs-number">8277</span>
automotive                 <span class="hljs-number">7506</span>
lawn_and_garden            <span class="hljs-number">7327</span>
home_improvement           <span class="hljs-number">7136</span>
pet_products               <span class="hljs-number">7082</span>
digital_ebook_purchase     <span class="hljs-number">6749</span>
pc                         <span class="hljs-number">6401</span>
electronics                <span class="hljs-number">6186</span>
office_product             <span class="hljs-number">5521</span>
shoes                      <span class="hljs-number">5197</span>
grocery                    <span class="hljs-number">4730</span>
book                       <span class="hljs-number">3756</span>
Name: product_category, dtype: int64<!-- HTML_TAG_END --></pre></div>
<p>è‹±èªã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§æœ€ã‚‚äººæ°—ã®ã‚ã‚‹å•†å“ã¯ã€å®¶åº­ç”¨å“ã€è¡£é¡ã€ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹é›»å­æ©Ÿå™¨ã«é–¢ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ã—ã‹ã—ã€Amazonæœ¬æ¥ã®ãƒ†ãƒ¼ãƒã«æ²¿ã£ã¦ã€æ›¸è©•ã®è¦ç´„ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã—ã‚‡ã†ã€‚çµå±€ã®ã¨ã“ã‚ã€æ›¸ç±ã¯ã“ã®ä¼šç¤¾ãŒè¨­ç«‹ã•ã‚ŒãŸéš›ã®å•†å“ãªã®ã§ã™! 2ã¤ã®è£½å“ã‚«ãƒ†ã‚´ãƒª(<code>book</code> ã¨ <code>digital_ebook_purchase</code>) ãŒå½“ã¦ã¯ã¾ã‚‹ã®ã§ã€ã“ã‚Œã‚‰ã®è£½å“ã«ã¤ã„ã¦ä¸¡è¨€èªã§ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<a href="/course/ja/chapter5">ç¬¬5ç« </a> ã§è¦‹ãŸã‚ˆã†ã«ã€ <code>Dataset.filter()</code> é–¢æ•°ã‚’ä½¿ã†ã¨éå¸¸ã«åŠ¹ç‡çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ã‚¹ãƒ©ã‚¤ã‚¹ã§ãã‚‹ã®ã§ã€ã“ã‚Œã‚’è¡Œã†ãŸã‚ã®ç°¡å˜ãªé–¢æ•°ã‚’å®šç¾©ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_books</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> (
        example[<span class="hljs-string">&quot;product_category&quot;</span>] == <span class="hljs-string">&quot;book&quot;</span>
        <span class="hljs-keyword">or</span> example[<span class="hljs-string">&quot;product_category&quot;</span>] == <span class="hljs-string">&quot;digital_ebook_purchase&quot;</span>
    )<!-- HTML_TAG_END --></pre></div>
<p>ã“ã®é–¢æ•°ã‚’ <code>english_dataset</code> ã¨ <code>spanish_dataset</code> ã«é©ç”¨ã™ã‚‹ã¨ã€æ›¸ç±ã®ã‚«ãƒ†ã‚´ãƒªã‚’å«ã‚€è¡Œã ã‘ãŒçµæœã«å«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ã™ã‚‹å‰ã«ã€<code>english_dataset</code> ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ <code>&quot;pandas&quot;</code> ã‹ã‚‰ <code>&quot;arrow&quot;</code> ã«æˆ»ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->english_dataset.reset_format()<!-- HTML_TAG_END --></pre></div>
<p>æ¬¡ã«ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ã‚’é©ç”¨ã—ã€ã‚µãƒ‹ãƒ†ã‚£ãƒ¼ãƒã‚§ãƒƒã‚¯ã¨ã—ã¦ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚µãƒ³ãƒ—ãƒ«ãŒæœ¬å½“ã«æœ¬ã«é–¢ã™ã‚‹ã‚‚ã®ã‹ã©ã†ã‹ã‚’èª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->spanish_books = spanish_dataset.<span class="hljs-built_in">filter</span>(filter_books)
english_books = english_dataset.<span class="hljs-built_in">filter</span>(filter_books)
show_samples(english_books)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: I\&#x27;m dissapointed.&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I guess I had higher expectations for this book from the reviews. I really thought I\&#x27;d at least like it. The plot idea was great. I loved Ash but, it just didnt go anywhere. Most of the book was about their radio show and talking to callers. I wanted the author to dig deeper so we could really get to know the characters. All we know about Grace is that she is attractive looking, Latino and is kind of a brat. I\&#x27;m dissapointed.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Good art, good price, poor design&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I had gotten the DC Vintage calendar the past two years, but it was on backorder forever this year and I saw they had shrunk the dimensions for no good reason. This one has good art choices but the design has the fold going through the picture, so it\&#x27;s less aesthetically pleasing, especially if you want to keep a picture to hang. For the price, a good calendar&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: Helpful&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Nearly all the tips useful and. I consider myself an intermediate to advanced user of OneNote. I would highly recommend.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå³å¯†ã«æœ¬ã«ã¤ã„ã¦ã§ã¯ãªãã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚„OneNoteã®ã‚ˆã†ãªé›»å­ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚ˆã†ãªã‚‚ã®ã‚’å‚ç…§ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ãã‚Œã§ã‚‚ã€ã“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯è¦ç´„ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ã®ã«é©ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚ã“ã®ã‚¿ã‚¹ã‚¯ã«é©ã—ãŸæ§˜ã€…ãªãƒ¢ãƒ‡ãƒ«ã‚’è¦‹ã‚‹å‰ã«ã€æœ€å¾Œã®ãƒ‡ãƒ¼ã‚¿æº–å‚™ã¨ã—ã¦ã€è‹±èªã¨ã‚¹ãƒšã‚¤ãƒ³èªã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’1ã¤ã® <code>DatasetDict</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦çµåˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ğŸ¤— Datasetsã«ã¯ä¾¿åˆ©ãª <code>concatenate_datasets()</code> é–¢æ•°ãŒã‚ã‚Šã€ï¼ˆãã®åã®é€šã‚Šï¼‰2ã¤ã® <code>Dataset</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é‡ã­åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒã‚¤ãƒªãƒ³ã‚¬ãƒ«ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€å„åˆ†å‰²ã‚’ãƒ«ãƒ¼ãƒ—ã—ã€ãã®åˆ†å‰²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’é€£çµã—ã€ãƒ¢ãƒ‡ãƒ«ãŒå˜ä¸€è¨€èªã«éå‰°é©åˆã—ãªã„ã‚ˆã†ã«çµæœã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> concatenate_datasets, DatasetDict

books_dataset = DatasetDict()

<span class="hljs-keyword">for</span> split <span class="hljs-keyword">in</span> english_books.keys():
    books_dataset[split] = concatenate_datasets(
        [english_books[split], spanish_books[split]]
    )
    books_dataset[split] = books_dataset[split].shuffle(seed=<span class="hljs-number">42</span>)

<span class="hljs-comment"># Peek at a few examples</span>
show_samples(books_dataset)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt; Title: Easy to follow!!!!&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: I loved The dash diet weight loss Solution. Never hungry. I would recommend this diet. Also the menus are well rounded. Try it. Has lots of the information need thanks.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: PARCIALMENTE DAÃ‘ADO&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: Me llegÃ³ el dÃ­a que tocaba, junto a otros libros que pedÃ­, pero la caja llegÃ³ en mal estado lo cual daÃ±Ã³ las esquinas de los libros porque venÃ­an sin protecciÃ³n (forro).&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt; Title: no lo he podido descargar&#x27;</span>
<span class="hljs-string">&#x27;&gt;&gt; Review: igual que el anterior&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã¯ç¢ºã‹ã«è‹±èªã¨ã‚¹ãƒšã‚¤ãƒ³èªã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæ··åœ¨ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ã­ï¼
ã•ã¦ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚³ãƒ¼ãƒ‘ã‚¹ãŒã§ããŸã®ã§ã€æœ€å¾Œã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãã®ã‚¿ã‚¤ãƒˆãƒ«ã«å«ã¾ã‚Œã‚‹å˜èªã®åˆ†å¸ƒã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã¯è¦ç´„ã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦ç‰¹ã«é‡è¦ã§ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦å‚è€ƒã«ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ä¸­ã«çŸ­ã™ãã‚‹è¦ç´„ãŒå¤šã„ã¨ã€è¦ç´„ç”Ÿæˆæ™‚ã«1ã¤ã‹2ã¤ã®å˜èªã—ã‹å‡ºåŠ›ã—ãªã„ã‚ˆã†ãƒ¢ãƒ‡ãƒ«ã‚’åã‚‰ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¸‹ã®ãƒ—ãƒ­ãƒƒãƒˆã¯å˜èªã®åˆ†å¸ƒã‚’ç¤ºã—ã¦ãŠã‚Šã€ã‚¿ã‚¤ãƒˆãƒ«ãŒ1-2å˜èªã ã‘ã«å¤§ããåã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/review-lengths.svg" alt="Word count distributions for the review titles and texts.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/review-lengths-dark.svg" alt="Word count distributions for the review titles and texts."></div>
<p>ã“ã®å•é¡Œã«å¯¾å‡¦ã—ã€ç§é”ã®ãƒ¢ãƒ‡ãƒ«ãŒã‚ˆã‚Šèˆˆå‘³æ·±ã„è¦ç´„ã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ã€éå¸¸ã«çŸ­ã„ã‚¿ã‚¤ãƒˆãƒ«ã‚’æŒã¤ä¾‹ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚è‹±èªã¨ã‚¹ãƒšã‚¤ãƒ³èªã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ‰±ã£ã¦ã„ã‚‹ã®ã§ã€ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç©ºç™½ã§åˆ†å‰²ã™ã‚‹å¤§ã¾ã‹ãªçµŒé¨“å‰‡ã‚’å…ƒã«ã€ä¿¡é ¼ã§ãã‚‹ <code>Dataset.filter()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ç”¨ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->books_dataset = books_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">len</span>(x[<span class="hljs-string">&quot;review_title&quot;</span>].split()) &gt; <span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div>
<p>ã•ã¦ã€ã‚³ãƒ¼ãƒ‘ã‚¹ãŒã§ããŸã¨ã“ã‚ã§ã€ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã‚’ä½¿ã£ã¦ã€Transformerã®ãƒ¢ãƒ‡ãƒ«ã‚’å¾®èª¿æ•´ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<h2 id="">æ–‡ç« è¦ç´„ç”¨ãƒ¢ãƒ‡ãƒ«</h2>
<p>è€ƒãˆã¦ã¿ã‚Œã°ã€æ–‡ç« ã®è¦ç´„ã¯æ©Ÿæ¢°ç¿»è¨³ã¨ä¼¼ãŸã‚ˆã†ãªç¨®é¡ã®ã‚¿ã‚¹ã‚¯ã§ã™ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚ˆã†ãªãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãŒã‚ã‚Šã€ãã‚Œã‚’å…¥åŠ›æ–‡å†…ã®é¡•è‘—ãªç‰¹å¾´ã‚’ã¨ã‚‰ãˆãŸçŸ­ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã€Œç¿»è¨³ã€ã—ãŸã„ã®ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€è¦ç´„ã®ãŸã‚ã®ã»ã¨ã‚“ã©ã®Transformerãƒ¢ãƒ‡ãƒ«ã¯<a href="/course/ja/chapter1">ç¬¬1ç« </a>ã§æœ€åˆã«å‡ºä¼šã£ãŸã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã¨ãƒ‡ã‚³ãƒ¼ãƒ€ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€GPTãƒ¢ãƒ‡ãƒ«ç¾¤ã®ã‚ˆã†ãªä¾‹å¤–ã‚‚ã‚ã‚Šã€å°‘æ•°ã‚·ãƒ§ãƒƒãƒˆå­¦ç¿’è¨­å®šã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ä»¥ä¸‹ã®è¡¨ã¯ã€è¦ç´„ã®ãŸã‚ã«å¾®èª¿æ•´ãŒå¯èƒ½ãªã€ã‚ˆãä½¿ã‚ã‚Œã‚‹äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ä¸€è¦§ã§ã™ã€‚</p>
<table><thead><tr><th align="center">Transformer model</th>
<th>Description</th>
<th align="center">Multilingual?</th></tr></thead>
<tbody><tr><td align="center"><a href="https://huggingface.co/gpt2-xl" rel="nofollow">GPT-2</a></td>
<td>Although trained as an auto-regressive language model, you can make GPT-2 generate summaries by appending â€œTL;DRâ€ at the end of the input text.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/google/pegasus-large" rel="nofollow">PEGASUS</a></td>
<td>Uses a pretraining objective to predict masked sentences in multi-sentence texts. This pretraining objective is closer to summarization than vanilla language modeling and scores highly on popular benchmarks.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/t5-base" rel="nofollow">T5</a></td>
<td>A universal Transformer architecture that formulates all tasks in a text-to-text framework; e.g., the input format for the model to summarize a document is <code>summarize: ARTICLE</code>.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/google/mt5-base" rel="nofollow">mT5</a></td>
<td>A multilingual version of T5, pretrained on the multilingual Common Crawl corpus (mC4), covering 101 languages.</td>
<td align="center">âœ…</td></tr>
<tr><td align="center"><a href="https://huggingface.co/facebook/bart-base" rel="nofollow">BART</a></td>
<td>A novel Transformer architecture with both an encoder and a decoder stack trained to reconstruct corrupted input that combines the pretraining schemes of BERT and GPT-2.</td>
<td align="center">âŒ</td></tr>
<tr><td align="center"><a href="https://huggingface.co/facebook/mbart-large-50" rel="nofollow">mBART-50</a></td>
<td>A multilingual version of BART, pretrained on 50 languages.</td>
<td align="center">âœ…</td></tr></tbody></table>
<p>ã“ã®è¡¨ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€è¦ç´„ã®ãŸã‚ã®Transformerãƒ¢ãƒ‡ãƒ«ã®å¤§åŠã¯ï¼ˆãã—ã¦å®Ÿéš›ã€ã»ã¨ã‚“ã©ã®NLPã‚¿ã‚¹ã‚¯ã‚‚ï¼‰å˜è¨€èªç‰ˆã§ã™ã€‚ã“ã‚Œã¯ã‚¿ã‚¹ã‚¯ãŒè‹±èªã‚„ãƒ‰ã‚¤ãƒ„èªã®ã‚ˆã†ãªåˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã®å¤šã„ã€Œé«˜ãƒªã‚½ãƒ¼ã‚¹ã€è¨€èªã§ã‚ã‚‹å ´åˆã¯è‰¯ã„ã®ã§ã™ãŒã€ä¸–ç•Œä¸­ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ä½•åƒã‚‚ã®ä»–ã®è¨€èªã§ã¯ãã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¹¸ã„ãªã“ã¨ã«ã€mT5ã‚„mBARTã®ã‚ˆã†ãªå¤šè¨€èªTransformerãƒ¢ãƒ‡ãƒ«ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã¯è¨€èªãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã‚’ä½¿ã£ã¦äº‹å‰ã«å­¦ç¿’ã•ã‚Œã¾ã™ãŒã€ã²ã­ã‚ŠãŒåŠ ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚1ã¤ã®è¨€èªã®ã‚³ãƒ¼ãƒ‘ã‚¹ã§å­¦ç¿’ã™ã‚‹ã®ã§ã¯ãªãã€50ä»¥ä¸Šã®è¨€èªã®ãƒ†ã‚­ã‚¹ãƒˆã§ä¸€åº¦ã«å…±åŒå­¦ç¿’ã—ã¦ã„ã‚‹ã®ã§ã™ï¼</p>
<p>ã“ã“ã§ã¯ã€T5ã‚’ãƒ™ãƒ¼ã‚¹ã«ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã¸ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§äº‹å‰å­¦ç¿’ã•ã‚ŒãŸèˆˆå‘³æ·±ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚ã‚‹mT5ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚T5ã§ã¯ã€ã™ã¹ã¦ã®è‡ªç„¶è¨€èªå‡¦ç†ã‚¿ã‚¹ã‚¯ã¯ã€Œè¦ç´„ï¼šã€ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¥é ­è¾ã§å®šå¼åŒ–ã•ã‚Œã€ç”Ÿæˆã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«é©å¿œã•ã›ã‚‹ã‚ˆã†ãƒ¢ãƒ‡ãƒ«ã«æ¡ä»¶ä»˜ã‘ã•ã‚Œã¾ã™ã€‚ä¸‹å›³ã«ç¤ºã™ã‚ˆã†ã«ã€T5ã¯éå¸¸ã«æ±ç”¨æ€§ãŒé«˜ãã€1ã¤ã®ãƒ¢ãƒ‡ãƒ«ã§å¤šãã®ã‚¿ã‚¹ã‚¯ã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>
<div class="flex justify-center"><img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/t5.svg" alt="Different tasks performed by the T5 architecture.">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter7/t5-dark.svg" alt="Different tasks performed by the T5 architecture."></div>
<p>mT5ã¯æ¥é ­è¾ã‚’ä½¿ç”¨ã—ã¾ã›ã‚“ãŒã€T5ã®å¤šç”¨é€”æ€§ã‚’å…±æœ‰ã—ã€å¤šè¨€èªã§ã‚ã‚‹ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚ã•ã¦ã€ãƒ¢ãƒ‡ãƒ«ã‚’é¸ã‚“ã ã¨ã“ã‚ã§ã€å­¦ç¿’ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ã«å–ã‚Šã‹ã‹ã‚Šã¾ã—ã‚‡ã†ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>ã‚ãªãŸã®ç•ªã§ã™ï¼ </strong> ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’çµ‚ãˆãŸã‚‰ã€åŒã˜æ‰‹æ³•ã§mBARTã‚’å¾®èª¿æ•´ã—ã¦ã€mT5ãŒmBARTã¨æ¯”è¼ƒã—ã¦ã©ã®ç¨‹åº¦å„ªã‚Œã¦ã„ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãƒœãƒ¼ãƒŠã‚¹ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã€è‹±èªã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã ã‘ã§T5ã‚’å¾®èª¿æ•´ã—ã¦ã¿ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚T5ã«ã¯ç‰¹åˆ¥ãªæ¥é ­è¾ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒã‚ã‚‹ã®ã§ã€ä»¥ä¸‹ã®å‰å‡¦ç†ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯å…¥åŠ›ä¾‹ã®å‰ã«<code>summarize:</code>ã‚’ä»˜ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p></div>
<h2 id="">ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†</h2>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/1m7BerpSq8A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>æ¬¡ã®ã‚¿ã‚¹ã‚¯ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚ã„ã¤ã‚‚ã®ã‚ˆã†ã«ã€äº‹å‰ã«å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚ã“ã“ã§ã¯ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ <code>mt5-small</code> ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_checkpoint = <span class="hljs-string">&quot;google/mt5-small&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ NLPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸæ®µéšã§ã¯ã€ã€Œå°ã•ãªã€ãƒ¢ãƒ‡ãƒ«ã®ã‚¯ãƒ©ã‚¹ã‚’å°‘é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚µãƒ³ãƒ—ãƒ«ã§å­¦ç¿’ã•ã›ã‚‹ã®ãŒã‚ˆã„æ–¹æ³•ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ„ãƒ¼ãƒ»ã‚¨ãƒ³ãƒ‰ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«å‘ã‘ãŸãƒ‡ãƒãƒƒã‚°ã¨åå¾©ã‚’ã‚ˆã‚Šé€Ÿãè¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚çµæœã«è‡ªä¿¡ãŒæŒã¦ãŸã‚‰ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã€ã„ã¤ã§ã‚‚ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p></div>
<p>å°‘é‡ã®ã‚µãƒ³ãƒ—ãƒ«ã§mT5ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->inputs = tokenizer(<span class="hljs-string">&quot;I loved reading the Hunger Games!&quot;</span>)
inputs<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;input_ids&#x27;</span>: [<span class="hljs-number">336</span>, <span class="hljs-number">259</span>, <span class="hljs-number">28387</span>, <span class="hljs-number">11807</span>, <span class="hljs-number">287</span>, <span class="hljs-number">62893</span>, <span class="hljs-number">295</span>, <span class="hljs-number">12507</span>, <span class="hljs-number">1</span>], <span class="hljs-string">&#x27;attention_mask&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]}<!-- HTML_TAG_END --></pre></div>
<p>ã“ã“ã§ã€<a href="/course/ja/chapter3">ç¬¬3ç« </a> ã®æœ€åˆã®å¾®èª¿æ•´ã®å®Ÿé¨“ã§é­é‡ã—ãŸã€ãŠãªã˜ã¿ã® <code>input_ids</code> ã¨ <code>attention_mask</code> ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®å…¥åŠ›IDã‚’ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã® <code>convert_ids_to_tokens()</code> é–¢æ•°ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ã€ã©ã®ã‚ˆã†ãªãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ãªã®ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenizer.convert_ids_to_tokens(inputs.input_ids)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;â–I&#x27;</span>, <span class="hljs-string">&#x27;â–&#x27;</span>, <span class="hljs-string">&#x27;loved&#x27;</span>, <span class="hljs-string">&#x27;â–reading&#x27;</span>, <span class="hljs-string">&#x27;â–the&#x27;</span>, <span class="hljs-string">&#x27;â–Hung&#x27;</span>, <span class="hljs-string">&#x27;er&#x27;</span>, <span class="hljs-string">&#x27;â–Games&#x27;</span>, <span class="hljs-string">&#x27;&lt;/s&gt;&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>Unicodeã®ç‰¹æ®Šæ–‡å­— <code>â–</code> ã¨ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®çµ‚ã‚ã‚Šã‚’æ„å‘³ã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ <code>&lt;/s&gt;</code> ã¯ã€SentencePieceãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’æ‰±ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ <a href="/course/ja/chapter6">ç¬¬6ç« </a> ã§èª¬æ˜ã—ãŸãƒ¦ãƒ‹ã‚°ãƒ©ãƒ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ‹ã‚°ãƒ©ãƒ ã¯å¤šè¨€èªã‚³ãƒ¼ãƒ‘ã‚¹ã«ç‰¹ã«æœ‰åŠ¹ã§ã™ã€‚ãƒ¦ãƒ‹ã‚°ãƒ©ãƒ ã«ã‚ˆã‚ŠSentencePieceã¯å£èª¿ã€å¥èª­ç‚¹ã€ç©ºç™½ãªã©ã«ä¾å­˜ã—ãªããªã‚‹ã®ã§ã€æ—¥æœ¬èªã®ã‚ˆã†ã«ç©ºç™½æ–‡å­—ã‚’æŒãŸãªã„å¤šãã®è¨€èªã«å¯¾ã—ã¦åŠ¹æœçš„ã«ãªã‚Šã¾ã™ã€‚</p>
<p>ã“ã®ã‚³ãƒ¼ãƒ‘ã‚¹ã‚’ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã™ã‚‹ãŸã‚ã«ã€è¦ç´„ã«é–¢é€£ã™ã‚‹äº›ç´°ãªå•é¡Œã«å¯¾å‡¦ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãƒ©ãƒ™ãƒ«ã‚‚ãƒ†ã‚­ã‚¹ãƒˆãªã®ã§ã€ãƒ¢ãƒ‡ãƒ«ã®æœ€å¤§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚ºã‚’è¶…ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãã®ã‚¿ã‚¤ãƒˆãƒ«ã®ä¸¡æ–¹ã«åˆ‡ã‚Šè©°ã‚ã‚’é©ç”¨ã—ã¦ã€éåº¦ã«é•·ã„å…¥åŠ›ã‚’ãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã•ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ğŸ¤— Transformers ã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¯ã€å…¥åŠ›ã¨ä¸¦è¡Œã—ã¦ãƒ©ãƒ™ãƒ«ã‚’ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ä¾¿åˆ©ãª <code>as_target_tokenizer()</code> é–¢æ•°ã‚’æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã¯é€šå¸¸ã€ã¾ãšå…¥åŠ›ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€æ¬¡ã«ãƒ©ãƒ™ãƒ«ã‚’åˆ¥ã®åˆ—ã¨ã—ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å‰å‡¦ç†é–¢æ•°ã®å†…éƒ¨ã§ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚</p>
<p>ä»¥ä¸‹ã¯ã€mT5 ç”¨ã®ãã®ã‚ˆã†ãªé–¢æ•°ã®ä¾‹ã§ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->max_input_length = <span class="hljs-number">512</span>
max_target_length = <span class="hljs-number">30</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_function</span>(<span class="hljs-params">examples</span>):
    model_inputs = tokenizer(
        examples[<span class="hljs-string">&quot;review_body&quot;</span>], max_length=max_input_length, truncation=<span class="hljs-literal">True</span>
    )
    <span class="hljs-comment"># Set up the tokenizer for targets</span>
    <span class="hljs-keyword">with</span> tokenizer.as_target_tokenizer():
        labels = tokenizer(
            examples[<span class="hljs-string">&quot;review_title&quot;</span>], max_length=max_target_length, truncation=<span class="hljs-literal">True</span>
        )

    model_inputs[<span class="hljs-string">&quot;labels&quot;</span>] = labels[<span class="hljs-string">&quot;input_ids&quot;</span>]
    <span class="hljs-keyword">return</span> model_inputs<!-- HTML_TAG_END --></pre></div>
<p>ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã®ã‹ç†è§£ã™ã‚‹ãŸã‚ã«ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã¾ãšæœ€åˆã«ã€<code>max_input_length</code>ã¨<code>max_target_length</code>ã®å€¤ã‚’å®šç¾©ã—ã¾ã—ãŸã€‚ã“ã‚Œã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ã‚¿ã‚¤ãƒˆãƒ«ã®é•·ã•ã®ä¸Šé™ã‚’è¨­å®šã™ã‚‹ã‚‚ã®ã§ã™ã€‚é€šå¸¸ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æœ¬æ–‡ã¯ã‚¿ã‚¤ãƒˆãƒ«ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«å¤§ãã„ã®ã§ã€ã“ã‚Œã‚‰ã®å€¤ã‚’é©å®œã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ã¦ã„ã¾ã™ã€‚æ¬¡ã«ã€<code>preprocess_function()</code> è‡ªèº«ã§ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæœ€åˆã«ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã•ã‚Œã€æ¬¡ã« <code>as_target_tokenizer()</code> ã§ã‚¿ã‚¤ãƒˆãƒ«ãŒãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<p><code>preprocess_function()</code> ãŒã‚ã‚Œã°ã€ã‚ã¨ã¯ã“ã®ã‚³ãƒ¼ã‚¹ã§æ•£ã€…ä½¿ã£ã¦ããŸä¾¿åˆ©ãª <code>Dataset.map()</code> é–¢æ•°ã‚’ä½¿ã£ã¦ã‚³ãƒ¼ãƒ‘ã‚¹å…¨ä½“ã‚’ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã™ã‚‹ã®ã¯ç°¡å˜ãªã“ã¨ã§ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets = books_dataset.<span class="hljs-built_in">map</span>(preprocess_function, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>ã•ã¦ã€ã‚³ãƒ¼ãƒ‘ã‚¹ã®å‰å‡¦ç†ãŒçµ‚ã‚ã£ãŸã¨ã“ã‚ã§ã€è¦ç´„ã«ã‚ˆãä½¿ã‚ã‚Œã‚‹ã„ãã¤ã‹ã®æŒ‡æ¨™ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã‹ã‚‰è¦‹ã‚‹ã‚ˆã†ã«ã€æ©Ÿæ¢°ãŒç”Ÿæˆã—ãŸæ–‡ç« ã®å“è³ªã‚’æ¸¬ã‚‹éš›ã«ã€ä¸‡èƒ½ã®æ‰‹æ³•ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ ä¸Šã® <code>Dataset.map()</code> é–¢æ•°ã§ <code>batched=True</code> ã‚’ä½¿ã£ã¦ã„ã‚‹ã“ã¨ã«ãŠæ°—ã¥ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã‚µãƒ³ãƒ—ãƒ«ã‚’1,000ã®ãƒãƒƒãƒï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€ğŸ¤— Transformersã®é«˜é€Ÿãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ãŒæŒã¤ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰æ©Ÿèƒ½ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚å¯èƒ½ã§ã‚ã‚Œã°ã€å‰å‡¦ç†ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ãŸã‚ã« <code>batched=True</code> ã‚’ä½¿ã£ã¦ã¿ã¦ãã ã•ã„!</p></div>
<h2 id="">æ–‡ç« è¦ç´„ã®ãŸã‚ã®æŒ‡æ¨™</h2>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/TMshhnrEXlg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>ã“ã®ã‚³ãƒ¼ã‚¹ã§å–ã‚Šä¸Šã’ãŸä»–ã®ã»ã¨ã‚“ã©ã®ã‚¿ã‚¹ã‚¯ã¨æ¯”è¼ƒã—ã¦ã€è¦ç´„ã‚„ç¿»è¨³ã®ã‚ˆã†ãªãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã‚¿ã‚¹ã‚¯ã®æ€§èƒ½æ¸¬å®šã¯ãã‚Œã»ã©ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€ã€Œãƒãƒ³ã‚¬ãƒ¼ã‚²ãƒ¼ãƒ ã‚’èª­ã‚€ã®ãŒå¥½ãã ã€ã¨ã„ã†ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã‚ã£ãŸã¨ã—ã¦ã€ã€Œãƒãƒ³ã‚¬ãƒ¼ã‚²ãƒ¼ãƒ ãŒå¤§å¥½ãã ã€ã€Œãƒãƒ³ã‚¬ãƒ¼ã‚²ãƒ¼ãƒ ã¯ç´ æ™´ã‚‰ã—ã„èª­ã¿ç‰©ã ã€ãªã©ã€æœ‰åŠ¹ãªè¦ç´„ãŒè¤‡æ•°å­˜åœ¨ã—ã¾ã™ã€‚æ˜ã‚‰ã‹ã«ã€ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ã¨ãƒ©ãƒ™ãƒ«ã®é–“ã«ã‚ã‚‹ç¨®ã®å®Œå…¨ãªä¸€è‡´ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã¯è‰¯ã„è§£æ±ºç­–ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç§ãŸã¡ã¯çš†ã€ç‹¬è‡ªã®æ–‡ä½“ã‚’æŒã£ã¦ã„ã‚‹ã®ã§ã€ãã®ã‚ˆã†ãªæ¸¬å®šæŒ‡æ¨™ã‚’ç”¨ã„ã¦ã¯äººé–“ã§ã•ãˆã†ã¾ãã„ã‹ãªã„ã§ã—ã‚‡ã†ã€‚</p>
<p>è¦ç´„ã®ãŸã‚ã«ã€æœ€ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹æŒ‡æ¨™ã®1ã¤ãŒ<a href="https://en.wikipedia.org/wiki/ROUGE_(metric)" rel="nofollow">ROUGE score</a> (Recall-Oriented Understudy for Gisting Evaluationã®ç•¥)ã§ã™ã€‚ã“ã®æŒ‡æ¨™ã®èƒŒå¾Œã«ã‚ã‚‹åŸºæœ¬çš„ãªè€ƒãˆæ–¹ã¯ã€ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ã‚’ã€é€šå¸¸äººé–“ãŒä½œæˆã™ã‚‹ã—ãŸå‚ç…§è¦ç´„ã®ã‚»ãƒƒãƒˆã¨æ¯”è¼ƒã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚’ã‚ˆã‚Šæ­£ç¢ºã«ã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®2ã¤ã®è¦ç´„ã‚’æ¯”è¼ƒã—ãŸã„ã¨ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->generated_summary = <span class="hljs-string">&quot;I absolutely loved reading the Hunger Games&quot;</span>
reference_summary = <span class="hljs-string">&quot;I loved reading the Hunger Games&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>æ¯”è¼ƒã™ã‚‹ä¸€ã¤ã®æ–¹æ³•ã¨ã—ã¦ã€é‡è¤‡ã—ã¦ã„ã‚‹å˜èªã®æ•°ã‚’æ•°ãˆã‚‹ã“ã¨ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ãŒã€ã“ã®å ´åˆã€6å€‹ã¨ãªã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯å°‘ã—ç²—ã„ã®ã§ã€ä»£ã‚ã‚Šã«ROUGEã¯é‡ãªã‚Šåˆã£ãŸéƒ¨åˆ†ã® <em>é©åˆç‡</em> ã¨ <em>å†ç¾ç‡</em> ã®ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã‚’åŸºæœ¬ã¨ã—ã¦ã„ã¾ã™ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ™‹ ã‚‚ã—ã‚ãªãŸãŒé©åˆç‡ã‚„å†ç¾ç‡ã«ã¤ã„ã¦åˆã‚ã¦èã„ãŸã¨ã—ã¦ã‚‚å¿ƒé…ã—ãªã„ã§ãã ã•ã„ã€‚ã™ã¹ã¦ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹ãŸã‚ã«ã€ã„ãã¤ã‹ã®æ˜ç¢ºãªä¾‹ã‚’ä¸€ç·’ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã‚‰ã®æŒ‡æ¨™ã¯é€šå¸¸åˆ†é¡ã‚¿ã‚¹ã‚¯ã§é­é‡ã™ã‚‹ã®ã§ã€ãã®åˆ†é¡ã‚¿ã‚¹ã‚¯ã®å ´åˆã«é©åˆç‡ã¨å†ç¾ç‡ãŒã©ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç†è§£ã—ãŸã„å ´åˆã¯ã€ <code>scikit-learn</code> <a href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html" rel="nofollow">guides</a> ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</p></div>
<p>ROUGEã§ã¯ã€ç”Ÿæˆã—ãŸè¦ç´„ã«å‚ç…§å…ƒã®è¦ç´„ãŒã©ã‚Œã ã‘å–ã‚Šè¾¼ã¾ã‚ŒãŸã‹ã‚’å†ç¾ç‡ã§æ¸¬å®šã—ã¾ã™ã€‚å˜èªã‚’æ¯”è¼ƒã™ã‚‹ã ã‘ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã®å¼ã«ã‚ˆã£ã¦å†ç¾ç‡ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
<!-- HTML_TAG_START --><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi></mrow><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext>â€‰</mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mtext>â€‰</mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mtext>â€‰</mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi><mtext>â€‰</mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \mathrm{Recall} = \frac{\mathrm{Number\,of\,overlapping\, words}}{\mathrm{Total\, number\, of\, words\, in\, reference\, summary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathrm">Recall</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Total</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">in</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">reference</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">summary</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">overlapping</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!-- HTML_TAG_END --></p>
<p>ä¸Šè¨˜ã®ç°¡å˜ãªä¾‹ã§ã¯ã€ã“ã®å¼ã¯6/6 = 1ã®å®Œå…¨ãªå†ç¾ç‡ã‚’ä¸ãˆã¾ã™ã€‚ã¤ã¾ã‚Šã€å‚ç…§è¦ç´„ã®ã™ã¹ã¦ã®å˜èªãŒãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ç´ æ™´ã‚‰ã—ã„ã“ã¨ã ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚‚ã—ç§é”ã®ãƒ¢ãƒ‡ãƒ«ãŒç”Ÿæˆã—ãŸè¦ç´„ãŒã€Œãƒãƒ³ã‚¬ãƒ¼ã‚²ãƒ¼ãƒ ã‚’ä¸€æ™©ä¸­èª­ã‚€ã®ãŒæœ¬å½“ã«æœ¬å½“ã«å¥½ãã ã£ãŸã€ã§ã‚ã£ãŸã¨ã—ãŸã‚‰ã©ã†ã§ã—ã‚‡ã†ã€‚ã“ã®å ´åˆã‚‚å®Œç’§ãªå†ç¾ç‡ãŒå¾—ã‚‰ã‚Œã¾ã™ãŒã€å†—é•·ã§ã‚ã‚‹ãŸã‚ã€é–“é•ã„ãªãã‚ˆã‚Šæ‚ªã„è¦ç´„ã¨ãªã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªã‚·ãƒŠãƒªã‚ªã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ã€æˆ‘ã€…ã¯ç§é”ã¯é©åˆç‡ã‚‚è¨ˆç®—ã—ã¾ã™ã€‚ã“ã‚Œã¯ROUGEã®æ–‡è„ˆã«ãŠã„ã¦ã€ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ãŒã©ã‚Œã ã‘é–¢é€£ã—ã¦ã„ãŸã‹ã‚’æ¸¬å®šã™ã‚‹ã‚‚ã®ã§ã™ã€‚
<!-- HTML_TAG_START --><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi></mrow><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mtext>â€‰</mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mtext>â€‰</mtext><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mtext>â€‰</mtext><mi mathvariant="normal">w</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">s</mi><mtext>â€‰</mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mtext>â€‰</mtext><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mtext>â€‰</mtext><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">y</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \mathrm{Precision} = \frac{\mathrm{Number\,of\,overlapping\, words}}{\mathrm{Total\, number\, of\, words\, in\, generated\, summary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathrm">Precision</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Total</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">in</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">generated</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">summary</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">Number</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.07778em;">of</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">overlapping</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">words</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!-- HTML_TAG_END --></p>
<p>ã“ã‚Œã‚’å†—é•·ãªè¦ç´„ã«é©ç”¨ã™ã‚‹ã¨ã€é©åˆç‡ã¯6/10 = 0.6ã¨ãªã‚Šã€çŸ­ã„è¦ç´„ã§å¾—ã‚‰ã‚ŒãŸ6/7 = 0.86ã‚ˆã‚Šã‚‚ã‹ãªã‚Šæ‚ªããªã‚Šã¾ã™ã€‚å®Ÿéš›ã«ã¯ã€é€šå¸¸ã€é©åˆç‡ã¨å†ç¾ç‡ã®ä¸¡æ–¹ãŒè¨ˆç®—ã•ã‚Œã€ãã—ã¦ã€F1ã‚¹ã‚³ã‚¢ï¼ˆç²¾åº¦ã¨ãƒªã‚³ãƒ¼ãƒ«ã®èª¿å’Œå¹³å‡ï¼‰ãŒå ±å‘Šã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ğŸ¤— Datasetsã§ã€ã¾ãš <code>rouge_score</code> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§ç°¡å˜ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!pip install rouge_score<!-- HTML_TAG_END --></pre></div>
<p>ãã—ã¦ã€ROUGEæŒ‡æ¨™ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

rouge_score = evaluate.load(<span class="hljs-string">&quot;rouge&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ãã—ã¦ã€<code>rouge_score.compute()</code>é–¢æ•°ã‚’ä½¿ã£ã¦ã€ã™ã¹ã¦ã®æŒ‡æ¨™ã‚’ä¸€åº¦ã«è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->scores = rouge_score.compute(
    predictions=[generated_summary], references=[reference_summary]
)
scores<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;rouge1&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)),
 <span class="hljs-string">&#x27;rouge2&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>), mid=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>), high=Score(precision=<span class="hljs-number">0.67</span>, recall=<span class="hljs-number">0.8</span>, fmeasure=<span class="hljs-number">0.73</span>)),
 <span class="hljs-string">&#x27;rougeL&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)),
 <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: AggregateScore(low=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), mid=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>), high=Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>))}<!-- HTML_TAG_END --></pre></div>
<p>ãŠã£ã¨ã€ã“ã®å‡ºåŠ›ã«ã¯å¤šãã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã­ã€‚</p>
<p>ã“ã‚Œã¯å…¨ã¦ä½•ã‚’æ„å‘³ã™ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿã¾ãšã€ğŸ¤— Datasetsã¯é©åˆç‡ã€å†ç¾ç‡ã€F1ã‚¹ã‚³ã‚¢ã®ä¿¡é ¼åŒºé–“ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ <code>low</code>ã€<code>mid</code>ã€<code>high</code> ã®å±æ€§ã§ã™ã€‚ã•ã‚‰ã«ã€ğŸ¤— Datasetsã¯ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ã¨å‚ç…§ã•ã‚ŒãŸè¦ç´„ã‚’æ¯”è¼ƒã™ã‚‹éš›ã«ã€ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®ãƒ†ã‚­ã‚¹ãƒˆã®ç²’åº¦ã«åŸºã¥ã„ãŸæ§˜ã€…ãªROUGEã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¾ã™ã€‚<code>rouge1</code>ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ¦ãƒ‹ã‚°ãƒ©ãƒ ã®é‡ãªã‚Šå…·åˆã§ã™ã€‚ã“ã‚Œã¯å˜èªã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ã‚’è¨€ã„æ›ãˆãŸã ã‘ã®ã‚‚ã®ã§ã€ã¾ã•ã«ä¸Šã§èª¬æ˜ã—ãŸã‚ˆã†ãªæŒ‡æ¨™ã§ã™ã€‚ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ã‚¹ã‚³ã‚¢ã® <code>mid</code> å€¤ã‚’å¼•ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->scores[<span class="hljs-string">&quot;rouge1&quot;</span>].mid<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Score(precision=<span class="hljs-number">0.86</span>, recall=<span class="hljs-number">1.0</span>, fmeasure=<span class="hljs-number">0.92</span>)<!-- HTML_TAG_END --></pre></div>
<p>ç´ æ™´ã‚‰ã—ã„ï¼é©åˆç‡ã¨å†ç¾ç‡ã®æ•°å€¤ãŒä¸€è‡´ã—ã¾ã—ãŸã€‚ã§ã¯ã€ä»–ã®ROUGEã‚¹ã‚³ã‚¢ã«ã¤ã„ã¦ã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿ
<code>rouge2</code> ã¯ãƒ“ãƒƒã‚°ãƒ©ãƒ ï¼ˆå˜èªã®ãƒšã‚¢ã®é‡ãªã‚Šï¼‰ã®é‡ãªã‚Šã‚’æ¸¬å®šã—ã€ <code>rougeL</code> ã¨ <code>rougeLsum</code> ã¯ç”Ÿæˆã•ã‚ŒãŸã‚µãƒãƒªãƒ¼ã¨å‚ç…§ã‚µãƒãƒªãƒ¼ã§æœ€ã‚‚é•·ã„å…±é€šéƒ¨åˆ†æ–‡å­—åˆ—ã‚’æ¢ã—ã¦ã€æœ€ã‚‚é•·ããƒãƒƒãƒã™ã‚‹å˜èªåˆ—ã‚’æ¸¬å®šã—ã¾ã™ã€‚<code>rougeLsum</code> ã® â€œsumâ€ ã¯ã€ <code>rougeL</code> ãŒå€‹ã€…ã®æ–‡ã®å¹³å‡å€¤ã¨ã—ã¦è¨ˆç®—ã•ã‚Œã‚‹ã®ã«å¯¾ã—ã€ã“ã®æŒ‡æ¨™ã¯è¦ç´„å…¨ä½“ã«å¯¾ã—ã¦è¨ˆç®—ã•ã‚Œã‚‹ã¨ã„ã†äº‹å®Ÿã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>âœï¸ <strong>ã‚ãªãŸã®ç•ªã§ã™ï¼ </strong> ç”Ÿæˆã¨å‚ç…§è¦ç´„ã®ç‹¬è‡ªã®ä¾‹ã‚’ä½œæˆã—ã€çµæœã®ROUGEã‚¹ã‚³ã‚¢ãŒç²¾åº¦ã¨ãƒªã‚³ãƒ¼ãƒ«ã®å…¬å¼ã‚’åŸºã«ã—ãŸæ‰‹å‹•è¨ˆç®—ã¨ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒœãƒ¼ãƒŠã‚¹ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ“ãƒƒã‚°ãƒ©ãƒ ã«åˆ†å‰²ã—ã€<code>rouge2</code> æŒ‡æ¨™ã®é©åˆç‡ã¨åˆ¶é™ç‡ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</p></div>
<p>ã“ã®ROUGEã‚¹ã‚³ã‚¢ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¿½è·¡ã—ã¦ã„ãã¾ã™ãŒã€ãã®å‰ã«å„ªã‚ŒãŸNLPå®Ÿè·µè€…ãŒã™ã¹ãã“ã¨ã€ãã‚Œã¯å¼·åŠ›ã‹ã¤ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã™ã€‚</p>
<h3 id="">å¼·åŠ›ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ä½œæˆ</h3>
<p>ãƒ†ã‚­ã‚¹ãƒˆè¦ç´„ã®ä¸€èˆ¬çš„ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã¯ã€å˜ç´”ã«è¨˜äº‹ã®æœ€åˆã®3ã¤ã®ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã§ã€ã—ã°ã—ã° <em>lead-3</em> ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã¨å‘¼ã°ã‚Œã¾ã™ã€‚æ–‡ã®å¢ƒç•Œã‚’è¿½è·¡ã™ã‚‹ãŸã‚ã«ãƒ”ãƒªã‚ªãƒ‰ã‚’ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ã“ã®ã‚„ã‚Šæ–¹ã¯ â€œU.S.â€ ã‚„ â€œU.N.â€ ã®ã‚ˆã†ãªé ­å­—èªã§ã¯å¤±æ•—ã—ã¾ã™ã€‚ãã“ã§ã€ã“ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®å„ªã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å«ã‚€ <code>nltk</code> ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã« <code>pip</code> ã‚’ç”¨ã„ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!pip install nltk<!-- HTML_TAG_END --></pre></div>
<p>ãã—ã¦ã€å¥èª­ç‚¹è¦å‰‡ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> nltk

nltk.download(<span class="hljs-string">&quot;punkt&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>æ¬¡ã«ã€<code>nltk</code>ã‹ã‚‰ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æœ€åˆã®3æ–‡ã‚’æŠ½å‡ºã™ã‚‹ç°¡å˜ãªé–¢æ•°ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã®è¦ç´„ã§ã¯ã€å„è¦ç´„ã‚’æ”¹è¡Œã§åŒºåˆ‡ã‚‹ã®ãŒæ…£ä¾‹ãªã®ã§ã€ã“ã‚Œã‚‚å«ã‚ã¦å­¦ç¿’ä¾‹ã§ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> nltk.tokenize <span class="hljs-keyword">import</span> sent_tokenize


<span class="hljs-keyword">def</span> <span class="hljs-title function_">three_sentence_summary</span>(<span class="hljs-params">text</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(text)[:<span class="hljs-number">3</span>])


<span class="hljs-built_in">print</span>(three_sentence_summary(books_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;review_body&quot;</span>]))<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;I grew up reading Koontz, and years ago, I stopped,convinced i had &quot;outgrown&quot; him.&#x27;</span>
<span class="hljs-string">&#x27;Still,when a friend was looking for something suspenseful too read, I suggested Koontz.&#x27;</span>
<span class="hljs-string">&#x27;She found Strangers.&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã¯ã†ã¾ãã„ããã†ãªã®ã§ã€ä»Šåº¦ã¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‹ã‚‰ã“ã‚Œã‚‰ã®ã€Œè¦ç´„ã€ã‚’æŠ½å‡ºã—ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ROUGEã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_baseline</span>(<span class="hljs-params">dataset, metric</span>):
    summaries = [three_sentence_summary(text) <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> dataset[<span class="hljs-string">&quot;review_body&quot;</span>]]
    <span class="hljs-keyword">return</span> metric.compute(predictions=summaries, references=dataset[<span class="hljs-string">&quot;review_title&quot;</span>])<!-- HTML_TAG_END --></pre></div>
<p>ãã—ã¦ã€ã“ã®é–¢æ•°ã‚’ä½¿ã£ã¦æ¤œè¨¼ã‚»ãƒƒãƒˆã®ROUGEã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã€Pandasã‚’ä½¿ã£ã¦å°‘ã—ãã‚Œã„ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

score = evaluate_baseline(books_dataset[<span class="hljs-string">&quot;validation&quot;</span>], rouge_score)
rouge_names = [<span class="hljs-string">&quot;rouge1&quot;</span>, <span class="hljs-string">&quot;rouge2&quot;</span>, <span class="hljs-string">&quot;rougeL&quot;</span>, <span class="hljs-string">&quot;rougeLsum&quot;</span>]
rouge_dict = <span class="hljs-built_in">dict</span>((rn, <span class="hljs-built_in">round</span>(score[rn].mid.fmeasure * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> rn <span class="hljs-keyword">in</span> rouge_names)
rouge_dict<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">16.74</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">8.83</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">15.6</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">15.96</span>}<!-- HTML_TAG_END --></pre></div>
<p>rouge2`ã®ã‚¹ã‚³ã‚¢ãŒä»–ã‚ˆã‚Šã‹ãªã‚Šä½ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒä¸€èˆ¬çš„ã«ç°¡æ½”ã§ã‚ã‚‹ãŸã‚ã€lead-3ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãŒå†—é•·ã™ãã‚‹ã¨ã„ã†äº‹å®Ÿã‚’åæ˜ ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚ã“ã‚Œã§ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãŒã§ããŸã®ã§ã€æ¬¡ã¯mT5ã®å¾®èª¿æ•´ã‚’è¡Œã„ã¾ã™ï¼</p>
<h2 class="relative group"><a id="trainer-api-mt5" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#trainer-api-mt5"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Trainer API ã‚’ä½¿ã£ã¦ mT5 ã‚’å¾®èª¿æ•´ã™ã‚‹
	</span></h2>

<p>è¦ç´„ã®ãŸã‚ã®ãƒ¢ãƒ‡ãƒ«ã®å¾®èª¿æ•´ã¯ã€ã“ã®ç« ã§å–ã‚Šä¸Šã’ãŸä»–ã®ã‚¿ã‚¹ã‚¯ã¨éå¸¸ã«ã‚ˆãä¼¼ã¦ã„ã¾ã™ã€‚ã¾ãšæœ€åˆã«è¡Œã†ã¹ãã“ã¨ã¯ã€<code>mt5-small</code> ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰äº‹å‰å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚è¦ç´„ã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é–“ã‚¿ã‚¹ã‚¯ãªã®ã§ã€<code>AutoModelForSeq2SeqLM</code> ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯è‡ªå‹•çš„ã«é‡ã¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForSeq2SeqLM

model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸ’¡ ä¸‹æµã®ã‚¿ã‚¹ã‚¯ã§ãƒ¢ãƒ‡ãƒ«ã‚’å¾®èª¿æ•´ã«é–¢ã™ã‚‹è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚’ä¸æ€è­°ã«æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ãã‚Œã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é–“ã‚¿ã‚¹ã‚¯ã§ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã™ã¹ã¦ã®é‡ã¿ãŒä¿æŒã•ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚ã“ã‚Œã‚’<a href="/course/ja/chapter3">ç¬¬3ç« </a>ã®ãƒ†ã‚­ã‚¹ãƒˆåˆ†é¡ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚­ã‚¹ãƒˆåˆ†é¡ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€äº‹å‰å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã®å…ˆé ­ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–ã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç½®ãæ›ãˆã¦ã„ã¾ã™ã€‚</p></div>
<p>æ¬¡ã«å¿…è¦ãªã®ã¯ã€ãƒãƒ³ã‚®ãƒ³ã‚°ãƒ•ã‚§ã‚¤ã‚¹ ãƒãƒ–ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã§å®Ÿè¡Œã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> notebook_login

notebook_login()<!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œã€èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã¯ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->huggingface-<span class="hljs-keyword">cli</span> login<!-- HTML_TAG_END --></pre></div>
<p>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã«ROUGEã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã€è¦ç´„ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å¹¸ã„ãªã“ã¨ã«ã€ğŸ¤— Transformersã¯å°‚ç”¨ã® <code>Seq2SeqTrainingArguments</code> ã¨ <code>Seq2SeqTrainer</code> ã‚¯ãƒ©ã‚¹ã‚’æä¾›ã—ã€ç§ãŸã¡ã®ãŸã‚ã«è‡ªå‹•çš„ã«ã“ã‚Œã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼
ã“ã®ã‚¯ãƒ©ã‚¹ãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã‚‹ãŸã‚ã«ã€ã¾ãšå®Ÿé¨“ç”¨ã«ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ãã®ä»–ã®å¼•æ•°ã‚’å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Seq2SeqTrainingArguments

batch_size = <span class="hljs-number">8</span>
num_train_epochs = <span class="hljs-number">8</span>
<span class="hljs-comment"># Show the training loss with every epoch</span>
logging_steps = <span class="hljs-built_in">len</span>(tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>]) // batch_size
model_name = model_checkpoint.split(<span class="hljs-string">&quot;/&quot;</span>)[-<span class="hljs-number">1</span>]

args = Seq2SeqTrainingArguments(
    output_dir=<span class="hljs-string">f&quot;<span class="hljs-subst">{model_name}</span>-finetuned-amazon-en-es&quot;</span>,
    evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>,
    learning_rate=<span class="hljs-number">5.6e-5</span>,
    per_device_train_batch_size=batch_size,
    per_device_eval_batch_size=batch_size,
    weight_decay=<span class="hljs-number">0.01</span>,
    save_total_limit=<span class="hljs-number">3</span>,
    num_train_epochs=num_train_epochs,
    predict_with_generate=<span class="hljs-literal">True</span>,
    logging_steps=logging_steps,
    push_to_hub=<span class="hljs-literal">True</span>,
)<!-- HTML_TAG_END --></pre></div>
<p>ã“ã“ã§ã¯ã€ <code>predict_with_generate</code> å¼•æ•°ã‚’è¨­å®šã—ã€å„ã‚¨ãƒãƒƒã‚¯ã® ROUGE ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã§ãã‚‹ã‚ˆã†ã«ã€è©•ä¾¡ä¸­ã«è¦ç´„ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«æŒ‡ç¤ºã—ã¾ã—ãŸã€‚<a href="/course/ja/chapter1">ç¬¬1ç« </a> ã§èª¬æ˜ã—ãŸã‚ˆã†ã«ã€ãƒ‡ã‚³ãƒ¼ãƒ€ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¸€ã¤ãšã¤äºˆæ¸¬ã—ã¦æ¨è«–ã‚’è¡Œã„ã¾ã™ãŒã€ã“ã‚Œã¯ãƒ¢ãƒ‡ãƒ«ã® <code>generate()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚<code>predict_with_generate=True</code> ã‚’è¨­å®šã™ã‚‹ã¨ã€ <code>Seq2SeqTrainer</code> ãŒãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦è©•ä¾¡ã‚’è¡Œã†ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€å­¦ç¿’ç‡ã€ã‚¨ãƒãƒƒã‚¯å›æ•°ã€é‡ã¿æ¸›è¡°ãªã©ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã—ã€ <code>save_total_limit</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¦ã€å­¦ç¿’ä¸­ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’3ã¤ã¾ã§ã—ã‹ä¿å­˜ã—ãªã„ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ã“ã‚Œã¯mT5ã®ã€Œå°ã•ã„ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã•ãˆã€ãƒãƒ¼ãƒ‰ãƒ‡ã‚£ã‚¹ã‚¯ã®å®¹é‡ã‚’ç´„1GBä½¿ç”¨ã—ã¦ãŠã‚Šã€ä¿å­˜ã™ã‚‹ã‚³ãƒ”ãƒ¼ã‚’åˆ¶é™ã™ã‚Œã°ã€å°‘ã—å®¹é‡ã‚’ç¯€ç´„ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚</p>
<p><code>push_to_hub=True</code> ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å­¦ç¿’å¾Œã«ãƒ¢ãƒ‡ãƒ«ã‚’ Hub ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸‹ã®ã€ <code>output_dir</code> ã§å®šç¾©ã•ã‚ŒãŸå ´æ‰€ã«ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã•ã‚Œã¾ã™ã€‚ãªãŠã€ <code>hub_model_id</code> å¼•æ•°ã§ã€ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã„ãƒªãƒã‚¸ãƒˆãƒªã®åå‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚(ç‰¹ã«ã€çµ„ç¹”ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹å ´åˆã¯ã“ã®å¼•æ•°ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™)ã€‚ä¾‹ãˆã°ã€ãƒ¢ãƒ‡ãƒ«ã‚’ <a href="https://huggingface.co/huggingface-course" rel="nofollow"><code>huggingface-course</code> organization</a> ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹å ´åˆã€<code>Seq2SeqTrainingArguments</code> ã« <code>hub_model_id=&quot;huggingface-course/mt5-finetuned-amazon-en-es&quot;</code> ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚</p>
<p>æ¬¡ã«å¿…è¦ãªã“ã¨ã¯ã€å­¦ç¿’ä¸­ã«ãƒ¢ãƒ‡ãƒ«ã‚’è©•ä¾¡ã§ãã‚‹ã‚ˆã†ã«ã€ <code>compute_metrics()</code> é–¢æ•°ã‚’ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã«æä¾›ã™ã‚‹ã“ã¨ã§ã™ã€‚
è¦ç´„ã‚¿ã‚¹ã‚¯ã§ã¯ã€äºˆæ¸¬ã‚¿ã‚¹ã‚¯ã®ã‚ˆã†ã«ã‚·ãƒ³ãƒ—ãƒ«ã« <code>rouge_score.compute()</code> ã‚’å‘¼ã¶ã®ã¨å°‘ã—ç•°ãªã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ROUGE ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹å‰ã«ã€å‡ºåŠ›ã¨ãƒ©ãƒ™ãƒ«ã‚’ãƒ†ã‚­ã‚¹ãƒˆã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚ä»¥ä¸‹ã®é–¢æ•°ã¯ã¾ã•ã«ãã‚Œã‚’è¡Œã†ã‚‚ã®ã§ã€ã•ã‚‰ã« <code>nltk</code> ã® <code>sent_tokenize()</code> é–¢æ•°ã‚’åˆ©ç”¨ã—ã¦ã€è¦ç´„æ–‡ç« ã‚’æ”¹è¡Œã§åŒºåˆ‡ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np


<span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_pred</span>):
    predictions, labels = eval_pred
    <span class="hljs-comment"># Decode generated summaries into text</span>
    decoded_preds = tokenizer.batch_decode(predictions, skip_special_tokens=<span class="hljs-literal">True</span>)
    <span class="hljs-comment"># Replace -100 in the labels as we can&#x27;t decode them</span>
    labels = np.where(labels != -<span class="hljs-number">100</span>, labels, tokenizer.pad_token_id)
    <span class="hljs-comment"># Decode reference summaries into text</span>
    decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=<span class="hljs-literal">True</span>)
    <span class="hljs-comment"># ROUGE expects a newline after each sentence</span>
    decoded_preds = [<span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(pred.strip())) <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> decoded_preds]
    decoded_labels = [<span class="hljs-string">&quot;\n&quot;</span>.join(sent_tokenize(label.strip())) <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> decoded_labels]
    <span class="hljs-comment"># Compute ROUGE scores</span>
    result = rouge_score.compute(
        predictions=decoded_preds, references=decoded_labels, use_stemmer=<span class="hljs-literal">True</span>
    )
    <span class="hljs-comment"># Extract the median scores</span>
    result = {key: value.mid.fmeasure * <span class="hljs-number">100</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> result.items()}
    <span class="hljs-keyword">return</span> {k: <span class="hljs-built_in">round</span>(v, <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> result.items()}<!-- HTML_TAG_END --></pre></div>
<p>æ¬¡ã«ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é–“ã‚¿ã‚¹ã‚¯ã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚mT5ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ»ãƒ‡ã‚³ãƒ¼ãƒ€ã®Transformerãƒ¢ãƒ‡ãƒ«ãªã®ã§ã€ãƒãƒƒãƒã‚’æº–å‚™ã™ã‚‹éš›ã®ä¸€ã¤ã®ã¡ã‚‡ã£ã¨ã—ãŸå·®ç•°ã¯ã€ãƒ‡ã‚³ãƒ¼ãƒ‰ä¸­ã«ãƒ©ãƒ™ãƒ«ã‚’å³ã«1ã¤ã‚·ãƒ•ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ã‚³ãƒ¼ãƒ€ãŒä»¥å‰ã®çœŸå®Ÿã®ãƒ©ãƒ™ãƒ«ã—ã‹è¦‹ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã€ç¾åœ¨ã‚„å°†æ¥ã®ãƒ©ãƒ™ãƒ«ã‚’ãƒ¢ãƒ‡ãƒ«ã«è¨˜æ†¶ã•ã›ãªã„ã‚ˆã†ã«ã—ã†ã¾ã™ã€‚ã“ã‚Œã¯<a href="/course/ja/chapter7/6">å› æœè¨€èªãƒ¢ãƒ‡ãƒªãƒ³ã‚°</a>ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ã§ãƒã‚¹ã‚¯ã•ã‚ŒãŸè‡ªå·±æ³¨æ„ãŒå…¥åŠ›ã«é©ç”¨ã•ã‚Œã‚‹æ–¹æ³•ã«ä¼¼ã¦ã„ã¾ã™ã€‚</p>
<p>å¹¸é‹ãªã“ã¨ã«ã€ğŸ¤— Transformers ã¯ <code>DataCollatorForSeq2Seq</code> ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’æä¾›ã—ã€å…¥åŠ›ã¨ãƒ©ãƒ™ãƒ«ã‚’å‹•çš„ã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ãã‚Œã¾ã™ã€‚ã“ã®ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã«ã¯ã€å˜ã« <code>tokenizer</code> ã¨ <code>model</code> ã‚’æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> DataCollatorForSeq2Seq

data_collator = DataCollatorForSeq2Seq(tokenizer, model=model)<!-- HTML_TAG_END --></pre></div>
<p>ãã‚Œã§ã¯ã€ã“ã®ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒå°‘é‡ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ãƒãƒƒãƒã§ä¸ãˆãŸã¨ãã«ä½•ã‚’ç”Ÿæˆã™ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã¾ãšã€æ–‡å­—åˆ—ã‚’å«ã‚€åˆ—ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã“ã‚Œã‚‰ã®è¦ç´ ã‚’ã©ã®ã‚ˆã†ã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã‹ã‚’çŸ¥ã‚‰ãªã„ã‹ã‚‰ã§ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets = tokenized_datasets.remove_columns(
    books_dataset[<span class="hljs-string">&quot;train&quot;</span>].column_names
)<!-- HTML_TAG_END --></pre></div>
<p>ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ ã¯ <code>dict</code> ã®ãƒªã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€å„ <code>dict</code> ã¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå†…ã® 1 ã¤ã®ä¾‹ã‚’è¡¨ã—ã¦ã„ã‚‹äº‹ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«æ¸¡ã™å‰ã«æœŸå¾…é€šã‚Šã®å½¢å¼ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->features = [tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>)]
data_collator(features)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;attention_mask&#x27;</span>: tensor([[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>,
         <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
        [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>,
         <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;input_ids&#x27;</span>: tensor([[  <span class="hljs-number">1494</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">8622</span>,    <span class="hljs-number">390</span>,    <span class="hljs-number">259</span>,    <span class="hljs-number">262</span>,   <span class="hljs-number">2316</span>,   <span class="hljs-number">3435</span>,    <span class="hljs-number">955</span>,
            <span class="hljs-number">772</span>,    <span class="hljs-number">281</span>,    <span class="hljs-number">772</span>,   <span class="hljs-number">1617</span>,    <span class="hljs-number">263</span>,    <span class="hljs-number">305</span>,  <span class="hljs-number">14701</span>,    <span class="hljs-number">260</span>,   <span class="hljs-number">1385</span>,
           <span class="hljs-number">3031</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">24146</span>,    <span class="hljs-number">332</span>,   <span class="hljs-number">1037</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">43906</span>,    <span class="hljs-number">305</span>,    <span class="hljs-number">336</span>,
            <span class="hljs-number">260</span>,      <span class="hljs-number">1</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>,      <span class="hljs-number">0</span>],
        [   <span class="hljs-number">259</span>,  <span class="hljs-number">27531</span>,  <span class="hljs-number">13483</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">7505</span>,    <span class="hljs-number">260</span>, <span class="hljs-number">112240</span>,  <span class="hljs-number">15192</span>,    <span class="hljs-number">305</span>,
          <span class="hljs-number">53198</span>,    <span class="hljs-number">276</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">74060</span>,    <span class="hljs-number">263</span>,    <span class="hljs-number">260</span>,    <span class="hljs-number">459</span>,  <span class="hljs-number">25640</span>,    <span class="hljs-number">776</span>,
           <span class="hljs-number">2119</span>,    <span class="hljs-number">336</span>,    <span class="hljs-number">259</span>,   <span class="hljs-number">2220</span>,    <span class="hljs-number">259</span>,  <span class="hljs-number">18896</span>,    <span class="hljs-number">288</span>,   <span class="hljs-number">4906</span>,    <span class="hljs-number">288</span>,
           <span class="hljs-number">1037</span>,   <span class="hljs-number">3931</span>,    <span class="hljs-number">260</span>,   <span class="hljs-number">7083</span>, <span class="hljs-number">101476</span>,   <span class="hljs-number">1143</span>,    <span class="hljs-number">260</span>,      <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;labels&#x27;</span>: tensor([[ <span class="hljs-number">7483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">2364</span>, <span class="hljs-number">15695</span>,     <span class="hljs-number">1</span>,  -<span class="hljs-number">100</span>],
        [  <span class="hljs-number">259</span>, <span class="hljs-number">27531</span>, <span class="hljs-number">13483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">7505</span>,     <span class="hljs-number">1</span>]]), <span class="hljs-string">&#x27;decoder_input_ids&#x27;</span>: tensor([[    <span class="hljs-number">0</span>,  <span class="hljs-number">7483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">2364</span>, <span class="hljs-number">15695</span>,     <span class="hljs-number">1</span>],
        [    <span class="hljs-number">0</span>,   <span class="hljs-number">259</span>, <span class="hljs-number">27531</span>, <span class="hljs-number">13483</span>,   <span class="hljs-number">259</span>,  <span class="hljs-number">7505</span>]])}<!-- HTML_TAG_END --></pre></div>
<p>ã“ã“ã§æ³¨ç›®ã™ã¹ãã¯ã€æœ€åˆã®ä¾‹ã¯2ç•ªç›®ã®ä¾‹ã‚ˆã‚Šã‚‚é•·ã„ã®ã§ã€2ç•ªç›®ã®ä¾‹ã® <code>input_ids</code> ã¨ <code>attention_mask</code> ã¯å³å´ã« <code>[PAD]</code> ãƒˆãƒ¼ã‚¯ãƒ³ (ID ã¯ <code>0</code>) ã§ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚åŒæ§˜ã«ã€<code>labels</code> ã¯ <code>-100</code> ã§ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ãƒˆãƒ¼ã‚¯ãƒ³ãŒæå¤±é–¢æ•°ã«ã‚ˆã£ã¦ç„¡è¦–ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã§ã™ã€‚ãã—ã¦æœ€å¾Œã«ã€æ–°ã—ã„ <code>decoder_input_ids</code> ã‚’è¦‹ã‚‹ã¨ã€æœ€åˆã®ã‚¨ãƒ³ãƒˆãƒªã« <code>[PAD]</code> ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æŒ¿å…¥ã—ã¦ãƒ©ãƒ™ãƒ«ã‚’å³ã«ã‚·ãƒ•ãƒˆã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<p>ã“ã‚Œã§ã‚ˆã†ã‚„ãã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã«å¿…è¦ãªææ–™ãŒæƒã„ã¾ã—ãŸã€‚ã‚ã¨ã¯ã€æ¨™æº–çš„ãªå¼•æ•°ã§ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ã‚’å®Ÿä½“åŒ–ã™ã‚‹ã ã‘ã§ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Seq2SeqTrainer

trainer = Seq2SeqTrainer(
    model,
    args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)<!-- HTML_TAG_END --></pre></div>
<p>ãã—ã¦ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ©ãƒ³ã‚’é–‹å§‹ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>å­¦ç¿’ä¸­ã¯ã‚¨ãƒãƒƒã‚¯æ¯ã«å­¦ç¿’æå¤±ãŒæ¸›å°‘ã—ã€ROUGE ã‚¹ã‚³ã‚¢ãŒå¢—åŠ ã™ã‚‹ã®ãŒåˆ†ã‹ã‚‹ã¯ãšã§ã™ã€‚å­¦ç¿’ãŒå®Œäº†ã—ãŸã‚‰ã€<code>Trainer.evaluate()</code>ã‚’å®Ÿè¡Œã—ã¦æœ€çµ‚çš„ãª ROUGE ã‚¹ã‚³ã‚¢ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.evaluate()<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;eval_loss&#x27;</span>: <span class="hljs-number">3.028524398803711</span>,
 <span class="hljs-string">&#x27;eval_rouge1&#x27;</span>: <span class="hljs-number">16.9728</span>,
 <span class="hljs-string">&#x27;eval_rouge2&#x27;</span>: <span class="hljs-number">8.2969</span>,
 <span class="hljs-string">&#x27;eval_rougeL&#x27;</span>: <span class="hljs-number">16.8366</span>,
 <span class="hljs-string">&#x27;eval_rougeLsum&#x27;</span>: <span class="hljs-number">16.851</span>,
 <span class="hljs-string">&#x27;eval_gen_len&#x27;</span>: <span class="hljs-number">10.1597</span>,
 <span class="hljs-string">&#x27;eval_runtime&#x27;</span>: <span class="hljs-number">6.1054</span>,
 <span class="hljs-string">&#x27;eval_samples_per_second&#x27;</span>: <span class="hljs-number">38.982</span>,
 <span class="hljs-string">&#x27;eval_steps_per_second&#x27;</span>: <span class="hljs-number">4.914</span>}<!-- HTML_TAG_END --></pre></div>
<p>ã‚¹ã‚³ã‚¢ã‹ã‚‰ã€ç§é”ã®ãƒ¢ãƒ‡ãƒ«ãŒlead-3ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’è¦‹äº‹ã«ä¸Šå›ã£ãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã„ã„ã§ã™ã­ï¼
æœ€å¾Œã«ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ¢ãƒ‡ãƒ«ã®é‡ã¿ã‚’ãƒãƒ–ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.push_to_hub(<span class="hljs-attribute">commit_message</span>=<span class="hljs-string">&quot;Training complete&quot;</span>, <span class="hljs-attribute">tags</span>=<span class="hljs-string">&quot;summarization&quot;</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;https://huggingface.co/huggingface-course/mt5-finetuned-amazon-en-es/commit/aa0536b829b28e73e1e4b94b8a5aacec420d40e0&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã¯ã€ãƒãƒ–ã«ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å‰ã«ã€ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ <code>output_dir</code> ã«ä¿å­˜ã™ã‚‹ã‚‚ã®ã§ã™ã€‚å¼•æ•°ã« <code>tags</code> ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€Hub ä¸Šã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãŒ mT5 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆç”¨ã§ã¯ãªãã€è¦ç´„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç”¨ã®ã‚‚ã®ã«ãªã‚‹ã“ã¨ã‚‚ç¢ºèªã§ãã¾ã™ (ãƒ¢ãƒ‡ãƒ«ã‚¿ã‚°ã«é–¢ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã¯ã€ <a href="https://huggingface.co/docs/hub/main#how-is-a-models-type-of-inference-api-and-widget-determined" rel="nofollow">ğŸ¤— Hub documentation</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„)ã€‚
<code>trainer.push_to_hub()</code> ã®å‡ºåŠ›ã¯ Git ã®ã‚³ãƒŸãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã¸ã® URL ã§ã€ãƒ¢ãƒ‡ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã«åŠ ãˆã‚‰ã‚ŒãŸå¤‰æ›´ã‚’ç°¡å˜ã«ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼</p>
<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æœ€å¾Œã«ã€ğŸ¤— Accelerate ãŒæä¾›ã™ã‚‹ä½ãƒ¬ãƒ™ãƒ«ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ mT5 ã‚’å¾®èª¿æ•´ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<h2 class="relative group"><a id="mt5-accelerate" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#mt5-accelerate"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>mT5ãƒ¢ãƒ‡ãƒ«ã‚’ ğŸ¤— Accelerate ã‚’ä½¿ã£ã¦å¾®èª¿æ•´ã™ã‚‹
	</span></h2>

<p>ğŸ¤— Accelerateã‚’ä½¿ã£ãŸãƒ¢ãƒ‡ãƒ«ã®å¾®èª¿æ•´ã¯ã€<a href="/course/ja/chapter3">ç¬¬3ç« </a>ã§è¡Œã£ãŸãƒ†ã‚­ã‚¹ãƒˆåˆ†é¡ã®ä¾‹ã¨éå¸¸ã«ã‚ˆãä¼¼ã¦ã„ã¾ã™ã€‚ä¸»ãªé•ã„ã¯ã€å­¦ç¿’æ™‚ã«è¦ç´„ã‚’æ˜ç¤ºçš„ã«ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã¨ã€ROUGEã‚¹ã‚³ã‚¢ã®è¨ˆç®—æ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã™ï¼ˆ<code>Seq2SeqTrainer</code>ãŒç”Ÿæˆã®é¢å€’ã‚’ã¿ã¦ãã‚ŒãŸã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ï¼‰ã€‚ã§ã¯ã€ã“ã®2ã¤ã®è¦ä»¶ã‚’ğŸ¤— Accelerateã§ã©ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãŸã‚ã®æº–å‚™</h3>
<p>ã¾ãšæœ€åˆã«è¡Œã†ã¹ãã“ã¨ã¯ã€å„åˆ†å‰²ã«å¯¾ã—ã¦ <code>DataLoader</code> ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã™ã€‚PyTorchã®ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã¯ãƒ†ãƒ³ã‚½ãƒ«ã®ãƒãƒƒãƒã‚’æƒ³å®šã—ã¦ã„ã‚‹ã®ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ <code>&quot;torch&quot;</code> ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_datasets.set_format(<span class="hljs-string">&quot;torch&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã§ãƒ†ãƒ³ã‚½ãƒ«ã ã‘ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒã§ããŸã®ã§ã€æ¬¡ã«ã‚„ã‚‹ã“ã¨ã¯ <code>DataCollatorForSeq2Seq</code> ã‚’å†ã³å®Ÿä½“åŒ–ã™ã‚‹ã“ã¨ã§ã™ã€‚ãã®ãŸã‚ã«ã¯ã€æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ­ãƒ¼ãƒ‰ã—ç›´ã—ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)<!-- HTML_TAG_END --></pre></div>
<p>æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’å®Ÿæ…‹åŒ–ã—ã€ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader

batch_size = <span class="hljs-number">8</span>
train_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    shuffle=<span class="hljs-literal">True</span>,
    collate_fn=data_collator,
    batch_size=batch_size,
)
eval_dataloader = DataLoader(
    tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>], collate_fn=data_collator, batch_size=batch_size
)<!-- HTML_TAG_END --></pre></div>
<p>æ¬¡ã«è¡Œã†ã“ã¨ã¯ã€ä½¿ç”¨ã™ã‚‹ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã™ã€‚ä»–ã®ä¾‹ã¨åŒæ§˜ã«ã€ã»ã¨ã‚“ã©ã®å•é¡Œã§ã†ã¾ãæ©Ÿèƒ½ã™ã‚‹ <code>AdamW</code> ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> AdamW

optimizer = AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<!-- HTML_TAG_END --></pre></div>
<p>æœ€å¾Œã«ã€ãƒ¢ãƒ‡ãƒ«ã€ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãƒ¼ã€ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ã‚’ <code>accelerator.prepare()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> accelerate <span class="hljs-keyword">import</span> Accelerator

accelerator = Accelerator()
model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(
    model, optimizer, train_dataloader, eval_dataloader
)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>ğŸš¨ TPUã§ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹å ´åˆã¯ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦å°‚ç”¨ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°é–¢æ•°ã«ç§»å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è©³ã—ãã¯<a href="/course/ja/chapter3">ç¬¬3ç« </a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p></div>
<p>ã•ã¦ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æº–å‚™ãŒã§ããŸã®ã§ã€æ®‹ã™ã¯3ã¤ã§ã™ã€‚</p>
<ul><li>å­¦ç¿’ç‡ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹ã€‚</li>
<li>è©•ä¾¡ç”¨ã®è¦ç´„ã‚’å¾Œå‡¦ç†ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹ã€‚</li>
<li>ãƒãƒ–ä¸Šã«ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ—ãƒƒã‚·ãƒ¥ã§ãã‚‹ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã€‚</li></ul>
<p>å­¦ç¿’ç‡ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ã€å‰ç¯€ã¾ã§ã®æ¨™æº–çš„ãªç·šå½¢ãªã‚‚ã®ã‚’ä½¿ã†ã“ã¨ã«ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> get_scheduler

num_train_epochs = <span class="hljs-number">10</span>
num_update_steps_per_epoch = <span class="hljs-built_in">len</span>(train_dataloader)
num_training_steps = num_train_epochs * num_update_steps_per_epoch

lr_scheduler = get_scheduler(
    <span class="hljs-string">&quot;linear&quot;</span>,
    optimizer=optimizer,
    num_warmup_steps=<span class="hljs-number">0</span>,
    num_training_steps=num_training_steps,
)<!-- HTML_TAG_END --></pre></div>
<p>å¾Œå‡¦ç†ã¨ã—ã¦ã€ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ã‚’æ”¹è¡Œã§åŒºåˆ‡ã‚‰ã‚ŒãŸæ–‡ã«åˆ†å‰²ã™ã‚‹é–¢æ•°ãŒå¿…è¦ã§ã™ã€‚ã“ã‚Œã¯ROUGEæŒ‡æ¨™ãŒæœŸå¾…ã™ã‚‹å½¢å¼ã§ã‚ã‚Šã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã®æ–­ç‰‡ã§ã“ã‚Œã‚’å®Ÿç¾ã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">postprocess_text</span>(<span class="hljs-params">preds, labels</span>):
    preds = [pred.strip() <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> preds]
    labels = [label.strip() <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]

    <span class="hljs-comment"># ROUGE expects a newline after each sentence</span>
    preds = [<span class="hljs-string">&quot;\n&quot;</span>.join(nltk.sent_tokenize(pred)) <span class="hljs-keyword">for</span> pred <span class="hljs-keyword">in</span> preds]
    labels = [<span class="hljs-string">&quot;\n&quot;</span>.join(nltk.sent_tokenize(label)) <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> labels]

    <span class="hljs-keyword">return</span> preds, labels<!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã¯ã€ <code>Seq2SeqTrainer</code> ã® <code>compute_metrics()</code> é–¢æ•°ã‚’ã©ã®ã‚ˆã†ã«å®šç¾©ã—ãŸã‹ã‚’æ€ã„å‡ºã›ã°ã€è¦‹è¦šãˆãŒã‚ã‚‹ã¯ãšã§ã™ã€‚</p>
<p>æœ€å¾Œã«ã€ãƒã‚®ãƒ³ã‚°ãƒ•ã‚§ã‚¤ã‚¹ ãƒãƒ–ã«ãƒ¢ãƒ‡ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã¯ã€é©åˆ‡ãªã‚¿ã‚¤ãƒˆãƒ«ã®ğŸ¤— ãƒãƒ– ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
ç§ãŸã¡ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®åå‰ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã ã‘ã§ã™ã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯ã€ãƒªãƒã‚¸ãƒˆãƒª ID ã¨ãƒ¦ãƒ¼ã‚¶ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ãŒã‚ã‚Šã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> get_full_repo_name

model_name = <span class="hljs-string">&quot;test-bert-finetuned-squad-accelerate&quot;</span>
repo_name = get_full_repo_name(model_name)
repo_name<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;lewtun/mt5-finetuned-amazon-en-es-accelerate&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ã“ã®ãƒªãƒã‚¸ãƒˆãƒªåã‚’ä½¿ã£ã¦ã€resultsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã€å­¦ç¿’ç”¨æˆæœç‰©ã‚’æ ¼ç´ã—ã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> huggingface_hub <span class="hljs-keyword">import</span> Repository

output_dir = <span class="hljs-string">&quot;results-mt5-finetuned-squad-accelerate&quot;</span>
repo = Repository(output_dir, clone_from=repo_name)<!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ä¸­ã« <code>repo.push_to_hub()</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã€æˆæœç‰©ã‚’ãƒãƒ–ã«ãƒ—ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼
ãã‚Œã§ã¯ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ›¸ãå‡ºã—ã€åˆ†æã‚’çµ‚ãˆã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="">å­¦ç¿’ãƒ«ãƒ¼ãƒ—</h3>
<p>è¦ç´„ã®ãŸã‚ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€ç§ãŸã¡ãŒé­é‡ã—ãŸä»–ã®ğŸ¤— Accelerateã®ä¾‹ã¨éå¸¸ã«ã‚ˆãä¼¼ã¦ãŠã‚Šã€å¤§ãã4ã¤ã®ä¸»è¦ãªã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†ã‹ã‚Œã¦ã„ã¾ã™ã€‚</p>
<ol><li>å„ã‚¨ãƒãƒƒã‚¯ã”ã¨ã« <code>train_dataloader</code> ã«ã‚ã‚‹ã™ã¹ã¦ã®ä¾‹ã«å¯¾ã—ã¦ç¹°ã‚Šè¿”ã—å‡¦ç†ã‚’è¡Œã„ã€ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ã€‚</li>
<li>å„ã‚¨ãƒãƒƒã‚¯çµ‚äº†æ™‚ã«ã€ã¾ãšãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã—ã€ãã‚Œã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã«ã™ã‚‹ã“ã¨ã§ãƒ¢ãƒ‡ãƒ«ã®è¦ç´„ã‚’ç”Ÿæˆã™ã‚‹ã€‚(å‚è€ƒè¦ç´„ã‚‚)ã€‚</li>
<li>å…ˆã«è¦‹ãŸã®ã¨åŒã˜æ‰‹æ³•ã§ROUGEã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹ã€‚</li>
<li>ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ä¿å­˜ã—ã€ã™ã¹ã¦ã‚’ãƒãƒ–ã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚ã“ã“ã§ã¯ã€ã‚¨ãƒãƒƒã‚¯æ¯ã«ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ <em>éåŒæœŸ</em> ã«ãƒ—ãƒƒã‚·ãƒ¥ã§ãã‚‹ã‚ˆã†ã«ã€<code>Repository</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® <code>blocking=False</code> ã¨ã„ã†ä¾¿åˆ©ãªå¼•æ•°ã«é ¼ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€GBã‚µã‚¤ã‚ºã®ãƒ¢ãƒ‡ãƒ«ã§ç™ºç”Ÿã™ã‚‹é…ã„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’å¾…ã¤ã“ã¨ãªãã€å­¦ç¿’ã‚’ç¶™ç¶šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</li></ol>
<p>ã“ã‚Œã‚‰ã®æ‰‹é †ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

progress_bar = tqdm(<span class="hljs-built_in">range</span>(num_training_steps))

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_train_epochs):
    <span class="hljs-comment"># Training</span>
    model.train()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(train_dataloader):
        outputs = model(**batch)
        loss = outputs.loss
        accelerator.backward(loss)

        optimizer.step()
        lr_scheduler.step()
        optimizer.zero_grad()
        progress_bar.update(<span class="hljs-number">1</span>)

    <span class="hljs-comment"># Evaluation</span>
    model.<span class="hljs-built_in">eval</span>()
    <span class="hljs-keyword">for</span> step, batch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(eval_dataloader):
        <span class="hljs-keyword">with</span> torch.no_grad():
            generated_tokens = accelerator.unwrap_model(model).generate(
                batch[<span class="hljs-string">&quot;input_ids&quot;</span>],
                attention_mask=batch[<span class="hljs-string">&quot;attention_mask&quot;</span>],
            )

            generated_tokens = accelerator.pad_across_processes(
                generated_tokens, dim=<span class="hljs-number">1</span>, pad_index=tokenizer.pad_token_id
            )
            labels = batch[<span class="hljs-string">&quot;labels&quot;</span>]

            <span class="hljs-comment"># If we did not pad to max length, we need to pad the labels too</span>
            labels = accelerator.pad_across_processes(
                batch[<span class="hljs-string">&quot;labels&quot;</span>], dim=<span class="hljs-number">1</span>, pad_index=tokenizer.pad_token_id
            )

            generated_tokens = accelerator.gather(generated_tokens).cpu().numpy()
            labels = accelerator.gather(labels).cpu().numpy()

            <span class="hljs-comment"># Replace -100 in the labels as we can&#x27;t decode them</span>
            labels = np.where(labels != -<span class="hljs-number">100</span>, labels, tokenizer.pad_token_id)
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(generated_tokens, <span class="hljs-built_in">tuple</span>):
                generated_tokens = generated_tokens[<span class="hljs-number">0</span>]
            decoded_preds = tokenizer.batch_decode(
                generated_tokens, skip_special_tokens=<span class="hljs-literal">True</span>
            )
            decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=<span class="hljs-literal">True</span>)

            decoded_preds, decoded_labels = postprocess_text(
                decoded_preds, decoded_labels
            )

            rouge_score.add_batch(predictions=decoded_preds, references=decoded_labels)

    <span class="hljs-comment"># Compute metrics</span>
    result = rouge_score.compute()
    <span class="hljs-comment"># Extract the median ROUGE scores</span>
    result = {key: value.mid.fmeasure * <span class="hljs-number">100</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> result.items()}
    result = {k: <span class="hljs-built_in">round</span>(v, <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> result.items()}
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Epoch <span class="hljs-subst">{epoch}</span>:&quot;</span>, result)

    <span class="hljs-comment"># Save and upload</span>
    accelerator.wait_for_everyone()
    unwrapped_model = accelerator.unwrap_model(model)
    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)
    <span class="hljs-keyword">if</span> accelerator.is_main_process:
        tokenizer.save_pretrained(output_dir)
        repo.push_to_hub(
            commit_message=<span class="hljs-string">f&quot;Training in progress epoch <span class="hljs-subst">{epoch}</span>&quot;</span>, blocking=<span class="hljs-literal">False</span>
        )<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Epoch <span class="hljs-number">0</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">5.6351</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">1.1625</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">5.4866</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">5.5005</span>}
Epoch <span class="hljs-number">1</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">9.8646</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">3.4106</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">9.9439</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">9.9306</span>}
Epoch <span class="hljs-number">2</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">11.0872</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">3.3273</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">11.0508</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">10.9468</span>}
Epoch <span class="hljs-number">3</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">11.8587</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">4.8167</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">11.7986</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">11.7518</span>}
Epoch <span class="hljs-number">4</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">12.9842</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">5.5887</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">12.7546</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">12.7029</span>}
Epoch <span class="hljs-number">5</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.4628</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.4598</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.312</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.2913</span>}
Epoch <span class="hljs-number">6</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">12.9131</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">5.8914</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">12.6896</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">12.5701</span>}
Epoch <span class="hljs-number">7</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.3079</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.2994</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.1536</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.1194</span>}
Epoch <span class="hljs-number">8</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">13.96</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">6.5998</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">13.9123</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.7744</span>}
Epoch <span class="hljs-number">9</span>: {<span class="hljs-string">&#x27;rouge1&#x27;</span>: <span class="hljs-number">14.1192</span>, <span class="hljs-string">&#x27;rouge2&#x27;</span>: <span class="hljs-number">7.0059</span>, <span class="hljs-string">&#x27;rougeL&#x27;</span>: <span class="hljs-number">14.1172</span>, <span class="hljs-string">&#x27;rougeLsum&#x27;</span>: <span class="hljs-number">13.9509</span>}<!-- HTML_TAG_END --></pre></div>
<p>ãã‚Œã§çµ‚ã‚ã‚Šã§ã™ã€‚ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€<code>Trainer</code>ã§å¾—ãŸã‚‚ã®ã¨ã‚ˆãä¼¼ãŸãƒ¢ãƒ‡ãƒ«ã¨çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>
<h2 id="">ã‚ãªãŸã®å¾®èª¿æ•´ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹</h2>
<p>ãƒ¢ãƒ‡ãƒ«ã‚’ãƒãƒ–ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ãŸã‚‰ã€æ¨è«–ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‹ <code>pipeline</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ã£ã¦ã€æ¬¡ã®ã‚ˆã†ã«æ“ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> pipeline

hub_model_id = <span class="hljs-string">&quot;huggingface-course/mt5-small-finetuned-amazon-en-es&quot;</span>
summarizer = pipeline(<span class="hljs-string">&quot;summarization&quot;</span>, model=hub_model_id)<!-- HTML_TAG_END --></pre></div>
<p>è¦ç´„ã®å“è³ªã«ã¤ã„ã¦æ„Ÿè§¦ã‚’å¾—ã‚‹ãŸã‚ã«ã€ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆï¼ˆãƒ¢ãƒ‡ãƒ«ã¯è¦‹ãŸäº‹ãŒãªã„ï¼‰ã‹ã‚‰ã„ãã¤ã‹ã®ä¾‹ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«é€ã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚æœ€åˆã«ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã‚¿ã‚¤ãƒˆãƒ«ã€ç”Ÿæˆã•ã‚ŒãŸè¦ç´„ã‚’ä¸€ç·’ã«è¡¨ç¤ºã™ã‚‹ç°¡å˜ãªé–¢æ•°ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_summary</span>(<span class="hljs-params">idx</span>):
    review = books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_body&quot;</span>]
    title = books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_title&quot;</span>]
    summary = summarizer(books_dataset[<span class="hljs-string">&quot;test&quot;</span>][idx][<span class="hljs-string">&quot;review_body&quot;</span>])[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;summary_text&quot;</span>]
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;&#x27;&gt;&gt;&gt; Review: <span class="hljs-subst">{review}</span>&#x27;&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; Title: <span class="hljs-subst">{title}</span>&#x27;&quot;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\n&#x27;&gt;&gt;&gt; Summary: <span class="hljs-subst">{summary}</span>&#x27;&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>è‹±èªã®ä¾‹ã‚’ä¸€ã¤è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->print_summary(<span class="hljs-number">100</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Review: Nothing special at all about this product... the book is too small and stiff and hard to write in. The huge sticker on the back doesnâ€™t come off and looks super tacky. I would not purchase this again. I could have just bought a journal from the dollar store and it would be basically the same thing. Itâ€™s also really expensive for what it is.&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Title: Not impressed at all... buy something else&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Summary: Nothing special at all about this product&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>ã“ã‚Œã¯æ‚ªãã‚ã‚Šã¾ã›ã‚“! ç§ãŸã¡ã®ãƒ¢ãƒ‡ãƒ«ã¯å®Ÿéš›ã«æ–°ã—ã„å˜èªã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ä¸€éƒ¨ã‚’è£œå¼·ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€æŠ½è±¡çš„ãªè¦ç´„ã‚’è¡Œã†ã“ã¨ãŒã§ããŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€ç§ãŸã¡ã®ãƒ¢ãƒ‡ãƒ«ã®æœ€ã‚‚ã‚¯ãƒ¼ãƒ«ãªç‚¹ã¯ã€ãƒã‚¤ãƒªãƒ³ã‚¬ãƒ«ã§ã‚ã‚‹ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¹ãƒšã‚¤ãƒ³èªã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®è¦ç´„ã‚‚ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->print_summary(<span class="hljs-number">0</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&#x27;&gt;&gt;&gt; Review: Es una trilogia que se hace muy facil de leer. Me ha gustado, no me esperaba el final para nada&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Title: Buena literatura para adolescentes&#x27;</span>

<span class="hljs-string">&#x27;&gt;&gt;&gt; Summary: Muy facil de leer&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>è¦ç´„ã¯è‹±èªã§ã€ŒVery easy to readã€ã¨è¨³ã•ã‚Œã€ã“ã®è¦ç´„ã®å ´åˆã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ–‡ä¸­ã‹ã‚‰ç›´æ¥æŠ½å‡ºã•ã‚ŒãŸã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯mT5ãƒ¢ãƒ‡ãƒ«ã®å¤šç”¨é€”æ€§ã‚’ç¤ºã—ã¦ãŠã‚Šã€å¤šè¨€èªã‚³ãƒ¼ãƒ‘ã‚¹ã‚’æ‰±ã†ã“ã¨ãŒã©ã®ã‚ˆã†ãªã‚‚ã®ã‹ã‚’ä½“é¨“ã—ã¦ã„ãŸã ã‘ãŸã¨æ€ã„ã¾ã™ã€‚</p>
<p>æ¬¡ã«ã€ã‚‚ã†å°‘ã—è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã§ã‚ã‚‹ã€ã‚¼ãƒ­ã‹ã‚‰è¨€èªãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹äº‹ã«ç›®ã‚’å‘ã‘ã¾ã™ã€‚</p>


		<script type="module" data-hydrate="4bbij3">
		import { start } from "/docs/course/main/ja/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="4bbij3"]').parentNode,
			paths: {"base":"/docs/course/main/ja","assets":"/docs/course/main/ja"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/main/ja/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/main/ja/_app/pages/chapter7/5.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
