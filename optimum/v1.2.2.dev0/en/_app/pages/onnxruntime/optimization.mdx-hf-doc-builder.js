import{S as pt,i as st,s as dt,e as n,k as p,w as T,t as s,M as lt,c as i,d as o,m as d,a as r,x as R,h as l,b as m,G as e,g as P,y as w,L as ht,q as N,o as k,B as E,v as ct}from"../../chunks/vendor-hf-doc-builder.js";import{D as q}from"../../chunks/Docstring-hf-doc-builder.js";import{I as mt}from"../../chunks/IconCopyLink-hf-doc-builder.js";function ut(Be){let f,oe,_,x,G,L,_e,B,ge,ne,u,xe,J,ve,ze,D,Oe,be,ie,g,v,W,U,$e,j,ye,re,a,I,Te,K,Re,Pe,z,C,we,X,Ne,Q,ke,Ee,Le,O,A,De,S,Ue,Y,Ie,Ce,Xe,b,H,Ae,Z,Se,He,$,V,Ve,ee,Fe,Me,y,F,qe,te,Ge,ae;return L=new mt({}),U=new mt({}),I=new q({props:{name:"class optimum.onnxruntime.ORTOptimizer",anchor:"optimum.onnxruntime.ORTOptimizer",parameters:[{name:"tokenizer",val:": PreTrainedTokenizer"},{name:"model",val:": PreTrainedModel"},{name:"feature",val:": str = 'default'"},{name:"opset",val:": typing.Optional[int] = None"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L34"}}),C=new q({props:{name:"export",anchor:"optimum.onnxruntime.ORTOptimizer.export",parameters:[{name:"onnx_model_path",val:": typing.Union[str, os.PathLike]"},{name:"onnx_optimized_model_output_path",val:": typing.Union[str, os.PathLike]"},{name:"optimization_config",val:": OptimizationConfig"},{name:"use_external_data_format",val:": bool = False"}],parametersDescription:[{anchor:"optimum.onnxruntime.ORTOptimizer.export.onnx_model_path",description:`<strong>onnx_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
The path used to save the model exported to an ONNX Intermediate Representation (IR).`,name:"onnx_model_path"},{anchor:"optimum.onnxruntime.ORTOptimizer.export.onnx_optimized_model_output_path",description:`<strong>onnx_optimized_model_output_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
The path used to save the optimized model exported to an ONNX Intermediate Representation (IR).`,name:"onnx_optimized_model_output_path"},{anchor:"optimum.onnxruntime.ORTOptimizer.export.optimization_config",description:`<strong>optimization_config</strong> (<code>OptimizationConfig</code>) &#x2014;
The configuration containing the parameters related to optimization.`,name:"optimization_config"},{anchor:"optimum.onnxruntime.ORTOptimizer.export.use_external_data_format",description:`<strong>use_external_data_format</strong> (<code>bool</code>, defaults to <code>False</code>) &#x2014;
Whether uto se external data format to store model which size is &gt;= 2Gb.`,name:"use_external_data_format"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L89",returnDescription:`
<p>The path of the resulting optimized model.</p>
`}}),A=new q({props:{name:"from_pretrained",anchor:"optimum.onnxruntime.ORTOptimizer.from_pretrained",parameters:[{name:"model_name_or_path",val:": typing.Union[str, os.PathLike]"},{name:"feature",val:": str"},{name:"opset",val:": typing.Optional[int] = None"}],parametersDescription:[{anchor:"optimum.onnxruntime.ORTOptimizer.from_pretrained.model_name_or_path",description:`<strong>model_name_or_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Repository name in the Hugging Face Hub or path to a local directory hosting the model.`,name:"model_name_or_path"},{anchor:"optimum.onnxruntime.ORTOptimizer.from_pretrained.feature",description:`<strong>feature</strong> (<code>str</code>) &#x2014;
Feature to use when exporting the model.`,name:"feature"},{anchor:"optimum.onnxruntime.ORTOptimizer.from_pretrained.opset",description:`<strong>opset</strong> (<code>int</code>, <em>optional</em>) &#x2014;
ONNX opset version to export the model with.`,name:"opset"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L39",returnDescription:`
<p>An instance of <code>ORTOptimizer</code>.</p>
`}}),H=new q({props:{name:"get_fused_operators",anchor:"optimum.onnxruntime.ORTOptimizer.get_fused_operators",parameters:[{name:"onnx_model_path",val:": typing.Union[str, os.PathLike]"}],parametersDescription:[{anchor:"optimum.onnxruntime.ORTOptimizer.get_fused_operators.onnx_model_path",description:`<strong>onnx_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Path of the ONNX model.`,name:"onnx_model_path"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L155",returnDescription:`
<p>The dictionary mapping the name of the fused operators to their number of apparition in the model.</p>
`}}),V=new q({props:{name:"get_nodes_number_difference",anchor:"optimum.onnxruntime.ORTOptimizer.get_nodes_number_difference",parameters:[{name:"onnx_model_path",val:": typing.Union[str, os.PathLike]"},{name:"onnx_optimized_model_path",val:": typing.Union[str, os.PathLike]"}],parametersDescription:[{anchor:"optimum.onnxruntime.ORTOptimizer.get_nodes_number_difference.onnx_model_path",description:`<strong>onnx_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Path of the ONNX model.`,name:"onnx_model_path"},{anchor:"optimum.onnxruntime.ORTOptimizer.get_nodes_number_difference.onnx_optimized_model_path",description:`<strong>onnx_optimized_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Path of the optimized ONNX model.`,name:"onnx_optimized_model_path"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L174",returnDescription:`
<p>The difference in the number of nodes between the original and the optimized model.</p>
`}}),F=new q({props:{name:"get_operators_difference",anchor:"optimum.onnxruntime.ORTOptimizer.get_operators_difference",parameters:[{name:"onnx_model_path",val:": typing.Union[str, os.PathLike]"},{name:"onnx_optimized_model_path",val:": typing.Union[str, os.PathLike]"}],parametersDescription:[{anchor:"optimum.onnxruntime.ORTOptimizer.get_operators_difference.onnx_model_path",description:`<strong>onnx_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Path of the ONNX model.`,name:"onnx_model_path"},{anchor:"optimum.onnxruntime.ORTOptimizer.get_operators_difference.onnx_optimized_model_path",description:`<strong>onnx_optimized_model_path</strong> (<code>Union[str, os.PathLike]</code>) &#x2014;
Path of the optimized ONNX model.`,name:"onnx_optimized_model_path"}],source:"https://github.com/huggingface/optimum/blob/v1.2.2.dev0/src/optimum/onnxruntime/optimization.py#L203",returnDescription:`
<p>The dictionary mapping the operators name to the difference in the number of corresponding nodes between the
original and the optimized model.</p>
`}}),{c(){f=n("meta"),oe=p(),_=n("h1"),x=n("a"),G=n("span"),T(L.$$.fragment),_e=p(),B=n("span"),ge=s("Optimization"),ne=p(),u=n("p"),xe=s("\u{1F917} Optimum provides an "),J=n("code"),ve=s("optimum.onnxruntime"),ze=s(" package that enables you to apply graph optimization on many model hosted on the \u{1F917} hub using the "),D=n("a"),Oe=s("ONNX Runtime"),be=s(" model optimization tool."),ie=p(),g=n("h2"),v=n("a"),W=n("span"),T(U.$$.fragment),$e=p(),j=n("span"),ye=s("ORTOptimizer"),re=p(),a=n("div"),T(I.$$.fragment),Te=p(),K=n("p"),Re=s("Handles the ONNX Runtime optimization process for models shared on huggingface.co/models."),Pe=p(),z=n("div"),T(C.$$.fragment),we=p(),X=n("p"),Ne=s("Optimize a model given the optimization specifications defined in "),Q=n("code"),ke=s("optimization_config"),Ee=s("."),Le=p(),O=n("div"),T(A.$$.fragment),De=p(),S=n("p"),Ue=s("Instantiate a "),Y=n("code"),Ie=s("ORTOptimizer"),Ce=s(" from a pretrained pytorch model and tokenizer."),Xe=p(),b=n("div"),T(H.$$.fragment),Ae=p(),Z=n("p"),Se=s("Compute the dictionary mapping the name of the fused operators to their number of apparition in the model."),He=p(),$=n("div"),T(V.$$.fragment),Ve=p(),ee=n("p"),Fe=s("Compute the difference in the number of nodes between the original and the optimized model."),Me=p(),y=n("div"),T(F.$$.fragment),qe=p(),te=n("p"),Ge=s(`Compute the dictionary mapping the operators name to the difference in the number of corresponding nodes between
the original and the optimized model.`),this.h()},l(t){const c=lt('[data-svelte="svelte-1phssyn"]',document.head);f=i(c,"META",{name:!0,content:!0}),c.forEach(o),oe=d(t),_=i(t,"H1",{class:!0});var me=r(_);x=i(me,"A",{id:!0,class:!0,href:!0});var Je=r(x);G=i(Je,"SPAN",{});var We=r(G);R(L.$$.fragment,We),We.forEach(o),Je.forEach(o),_e=d(me),B=i(me,"SPAN",{});var je=r(B);ge=l(je,"Optimization"),je.forEach(o),me.forEach(o),ne=d(t),u=i(t,"P",{});var M=r(u);xe=l(M,"\u{1F917} Optimum provides an "),J=i(M,"CODE",{});var Ke=r(J);ve=l(Ke,"optimum.onnxruntime"),Ke.forEach(o),ze=l(M," package that enables you to apply graph optimization on many model hosted on the \u{1F917} hub using the "),D=i(M,"A",{href:!0,rel:!0});var Qe=r(D);Oe=l(Qe,"ONNX Runtime"),Qe.forEach(o),be=l(M," model optimization tool."),M.forEach(o),ie=d(t),g=i(t,"H2",{class:!0});var pe=r(g);v=i(pe,"A",{id:!0,class:!0,href:!0});var Ye=r(v);W=i(Ye,"SPAN",{});var Ze=r(W);R(U.$$.fragment,Ze),Ze.forEach(o),Ye.forEach(o),$e=d(pe),j=i(pe,"SPAN",{});var et=r(j);ye=l(et,"ORTOptimizer"),et.forEach(o),pe.forEach(o),re=d(t),a=i(t,"DIV",{class:!0});var h=r(a);R(I.$$.fragment,h),Te=d(h),K=i(h,"P",{});var tt=r(K);Re=l(tt,"Handles the ONNX Runtime optimization process for models shared on huggingface.co/models."),tt.forEach(o),Pe=d(h),z=i(h,"DIV",{class:!0});var se=r(z);R(C.$$.fragment,se),we=d(se),X=i(se,"P",{});var de=r(X);Ne=l(de,"Optimize a model given the optimization specifications defined in "),Q=i(de,"CODE",{});var ot=r(Q);ke=l(ot,"optimization_config"),ot.forEach(o),Ee=l(de,"."),de.forEach(o),se.forEach(o),Le=d(h),O=i(h,"DIV",{class:!0});var le=r(O);R(A.$$.fragment,le),De=d(le),S=i(le,"P",{});var he=r(S);Ue=l(he,"Instantiate a "),Y=i(he,"CODE",{});var nt=r(Y);Ie=l(nt,"ORTOptimizer"),nt.forEach(o),Ce=l(he," from a pretrained pytorch model and tokenizer."),he.forEach(o),le.forEach(o),Xe=d(h),b=i(h,"DIV",{class:!0});var ce=r(b);R(H.$$.fragment,ce),Ae=d(ce),Z=i(ce,"P",{});var it=r(Z);Se=l(it,"Compute the dictionary mapping the name of the fused operators to their number of apparition in the model."),it.forEach(o),ce.forEach(o),He=d(h),$=i(h,"DIV",{class:!0});var ue=r($);R(V.$$.fragment,ue),Ve=d(ue),ee=i(ue,"P",{});var rt=r(ee);Fe=l(rt,"Compute the difference in the number of nodes between the original and the optimized model."),rt.forEach(o),ue.forEach(o),Me=d(h),y=i(h,"DIV",{class:!0});var fe=r(y);R(F.$$.fragment,fe),qe=d(fe),te=i(fe,"P",{});var at=r(te);Ge=l(at,`Compute the dictionary mapping the operators name to the difference in the number of corresponding nodes between
the original and the optimized model.`),at.forEach(o),fe.forEach(o),h.forEach(o),this.h()},h(){m(f,"name","hf:doc:metadata"),m(f,"content",JSON.stringify(ft)),m(x,"id","optimization"),m(x,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),m(x,"href","#optimization"),m(_,"class","relative group"),m(D,"href","https://github.com/microsoft/onnxruntime/tree/master/onnxruntime/python/tools/transformers"),m(D,"rel","nofollow"),m(v,"id","optimum.onnxruntime.ORTOptimizer"),m(v,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),m(v,"href","#optimum.onnxruntime.ORTOptimizer"),m(g,"class","relative group"),m(z,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8"),m(O,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8"),m(b,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8"),m($,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8"),m(y,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8"),m(a,"class","docstring border-l-2 border-t-2 pl-4 pt-3.5 border-gray-100 rounded-tl-xl mb-6 mt-8")},m(t,c){e(document.head,f),P(t,oe,c),P(t,_,c),e(_,x),e(x,G),w(L,G,null),e(_,_e),e(_,B),e(B,ge),P(t,ne,c),P(t,u,c),e(u,xe),e(u,J),e(J,ve),e(u,ze),e(u,D),e(D,Oe),e(u,be),P(t,ie,c),P(t,g,c),e(g,v),e(v,W),w(U,W,null),e(g,$e),e(g,j),e(j,ye),P(t,re,c),P(t,a,c),w(I,a,null),e(a,Te),e(a,K),e(K,Re),e(a,Pe),e(a,z),w(C,z,null),e(z,we),e(z,X),e(X,Ne),e(X,Q),e(Q,ke),e(X,Ee),e(a,Le),e(a,O),w(A,O,null),e(O,De),e(O,S),e(S,Ue),e(S,Y),e(Y,Ie),e(S,Ce),e(a,Xe),e(a,b),w(H,b,null),e(b,Ae),e(b,Z),e(Z,Se),e(a,He),e(a,$),w(V,$,null),e($,Ve),e($,ee),e(ee,Fe),e(a,Me),e(a,y),w(F,y,null),e(y,qe),e(y,te),e(te,Ge),ae=!0},p:ht,i(t){ae||(N(L.$$.fragment,t),N(U.$$.fragment,t),N(I.$$.fragment,t),N(C.$$.fragment,t),N(A.$$.fragment,t),N(H.$$.fragment,t),N(V.$$.fragment,t),N(F.$$.fragment,t),ae=!0)},o(t){k(L.$$.fragment,t),k(U.$$.fragment,t),k(I.$$.fragment,t),k(C.$$.fragment,t),k(A.$$.fragment,t),k(H.$$.fragment,t),k(V.$$.fragment,t),k(F.$$.fragment,t),ae=!1},d(t){o(f),t&&o(oe),t&&o(_),E(L),t&&o(ne),t&&o(u),t&&o(ie),t&&o(g),E(U),t&&o(re),t&&o(a),E(I),E(C),E(A),E(H),E(V),E(F)}}}const ft={local:"optimization",sections:[{local:"optimum.onnxruntime.ORTOptimizer",title:"ORTOptimizer"}],title:"Optimization"};function _t(Be){return ct(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class zt extends pt{constructor(f){super();st(this,f,_t,ut,dt,{})}}export{zt as default,ft as metadata};
