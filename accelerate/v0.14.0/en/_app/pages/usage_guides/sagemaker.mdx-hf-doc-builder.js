import{S as ur,i as fr,s as mr,e as t,k as h,w as d,t as i,M as dr,c as n,d as a,m as u,a as r,x as g,h as p,b as c,G as s,g as o,y as v,q as $,o as y,B as _,v as gr}from"../../chunks/vendor-hf-doc-builder.js";import{T as en}from"../../chunks/Tip-hf-doc-builder.js";import{I as x}from"../../chunks/IconCopyLink-hf-doc-builder.js";import{C as ce}from"../../chunks/CodeBlock-hf-doc-builder.js";function vr(Y){let f,E;return{c(){f=t("p"),E=i("\u{1F917} Accelerate is not saving any of your credentials.")},l(m){f=n(m,"P",{});var b=r(f);E=p(b,"\u{1F917} Accelerate is not saving any of your credentials."),b.forEach(a)},m(m,b){o(m,f,b),s(f,E)},d(m){m&&a(f)}}}function $r(Y){let f,E,m,b,S;return{c(){f=t("p"),E=i(`SageMaker doesn\u2019t support argparse actions. If you want to use, for example, boolean hyperparameters, you need to
specify type as bool in your script and provide an explicit True or False value for this hyperparameter. `),m=t("a"),b=i("[REF]"),S=i("."),this.h()},l(w){f=n(w,"P",{});var j=r(f);E=p(j,`SageMaker doesn\u2019t support argparse actions. If you want to use, for example, boolean hyperparameters, you need to
specify type as bool in your script and provide an explicit True or False value for this hyperparameter. `),m=n(j,"A",{href:!0,rel:!0});var P=r(m);b=p(P,"[REF]"),P.forEach(a),S=p(j,"."),j.forEach(a),this.h()},h(){c(m,"href","https://sagemaker.readthedocs.io/en/stable/frameworks/pytorch/using_pytorch.html#prepare-a-pytorch-training-script"),c(m,"rel","nofollow")},m(w,j){o(w,f,j),s(f,E),s(f,m),s(m,b),s(f,S)},d(w){w&&a(f)}}}function yr(Y){let f,E,m,b,S;return{c(){f=t("p"),E=i("If you run one of the example scripts, don\u2019t forget to add "),m=t("code"),b=i("accelerator.save('/opt/ml/model')"),S=i(" to it.")},l(w){f=n(w,"P",{});var j=r(f);E=p(j,"If you run one of the example scripts, don\u2019t forget to add "),m=n(j,"CODE",{});var P=r(m);b=p(P,"accelerator.save('/opt/ml/model')"),P.forEach(a),S=p(j," to it."),j.forEach(a)},m(w,j){o(w,f,j),s(f,E),s(f,m),s(m,b),s(f,S)},d(w){w&&a(f)}}}function _r(Y){let f,E,m,b,S,w,j,P,Ls,La,D,zs,he,Ns,Is,ue,Os,Hs,za,z,B,Ye,fe,qs,Be,Rs,Na,N,K,Ke,me,Fs,Ze,Us,Ia,Z,Gs,de,Ws,Ys,Oa,J,Bs,Je,Ks,Zs,Ha,ge,qa,k,Js,Qe,Qs,Vs,Ve,Xs,et,Xe,at,st,ea,tt,nt,Ra,ve,Fa,Q,rt,aa,lt,ot,Ua,I,V,sa,$e,it,ta,pt,Ga,Le,ct,Wa,ye,Ya,ze,ht,Ba,X,Ka,O,ee,na,_e,ut,ra,ft,Za,C,mt,la,dt,gt,oa,vt,$t,Ja,be,Qa,ae,Va,H,se,ia,we,yt,pa,_t,Xa,Ne,bt,es,je,as,Ie,wt,ss,Oe,ca,jt,ts,te,ns,Ee,rs,He,Et,ls,ke,os,q,ne,ha,Ae,kt,ua,At,is,R,re,fa,Se,St,ma,xt,ps,M,Pt,da,Dt,Ct,ga,Mt,Tt,cs,xe,hs,F,le,va,Pe,Lt,$a,zt,us,qe,ya,Nt,fs,U,oe,_a,De,It,ba,Ot,ms,A,Ht,wa,qt,Rt,ja,Ft,Ut,Ea,Gt,Wt,ka,Yt,Bt,ds,G,ie,Aa,Ce,Kt,Sa,Zt,gs,Re,xa,Jt,vs,W,pe,Pa,Me,Qt,Da,Vt,$s,Fe,Ca,Xt,ys;return w=new x({}),fe=new x({}),me=new x({}),ge=new ce({props:{code:'pip install "accelerate[sagemaker]" --upgrade',highlighted:'pip install <span class="hljs-string">&quot;accelerate[sagemaker]&quot;</span> --upgrade'}}),ve=new ce({props:{code:"accelerate",highlighted:'<span class="hljs-attribute">accelerate</span>'}}),$e=new x({}),ye=new ce({props:{code:`accelerate config
# In which compute environment are you running? ([0] This machine, [1] AWS (Amazon SageMaker)): 1`,highlighted:`accelerate config
<span class="hljs-comment"># In which compute environment are you running? ([0] This machine, [1] AWS (Amazon SageMaker)): 1</span>`}}),X=new en({props:{$$slots:{default:[vr]},$$scope:{ctx:Y}}}),_e=new x({}),be=new ce({props:{code:"- torch.save('/opt/ml/model`)\n+ accelerator.save('/opt/ml/model')",highlighted:'<span class="hljs-deletion">- torch.save(&#x27;/opt/ml/model`)</span>\n<span class="hljs-addition">+ accelerator.save(&#x27;/opt/ml/model&#x27;)</span>'}}),ae=new en({props:{warning:!0,$$slots:{default:[$r]},$$scope:{ctx:Y}}}),we=new x({}),je=new ce({props:{code:"accelerate launch path_to_script.py --args_to_the_script",highlighted:'accelerate <span class="hljs-built_in">launch</span> path_to_script.py <span class="hljs-comment">--args_to_the_script</span>'}}),te=new en({props:{$$slots:{default:[yr]},$$scope:{ctx:Y}}}),Ee=new ce({props:{code:"accelerate launch ./examples/sagemaker_example.py",highlighted:"accelerate launch ./examples/sagemaker_example.py"}}),ke=new ce({props:{code:`Configuring Amazon SageMaker environment
Converting Arguments to Hyperparameters
Creating Estimator
2021-04-08 11:56:50 Starting - Starting the training job...
2021-04-08 11:57:13 Starting - Launching requested ML instancesProfilerReport-1617883008: InProgress
.........
2021-04-08 11:58:54 Starting - Preparing the instances for training.........
2021-04-08 12:00:24 Downloading - Downloading input data
2021-04-08 12:00:24 Training - Downloading the training image..................
2021-04-08 12:03:39 Training - Training image download completed. Training in progress..
........
epoch 0: {'accuracy': 0.7598039215686274, 'f1': 0.8178438661710037}
epoch 1: {'accuracy': 0.8357843137254902, 'f1': 0.882249560632689}
epoch 2: {'accuracy': 0.8406862745098039, 'f1': 0.8869565217391304}
........
2021-04-08 12:05:40 Uploading - Uploading generated training model
2021-04-08 12:05:40 Completed - Training job completed
Training seconds: 331
Billable seconds: 331
You can find your model data at: s3://your-bucket/accelerate-sagemaker-1-2021-04-08-11-56-47-108/output/model.tar.gz`,highlighted:`Configuring Amazon SageMaker environment
Converting Arguments <span class="hljs-keyword">to</span> Hyperparameters
Creating Estimator
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">11</span>:<span class="hljs-number">56</span>:<span class="hljs-number">50</span> Starting - Starting the training job<span class="hljs-params">...</span>
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">11</span>:<span class="hljs-number">57</span>:<span class="hljs-number">13</span> Starting - Launching requested ML instancesProfilerReport<span class="hljs-number">-1617883008</span>: InProgress
<span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">54</span> Starting - Preparing the instances for training<span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">12</span>:<span class="hljs-number">00</span>:<span class="hljs-number">24</span> Downloading - Downloading input <span class="hljs-built_in">data</span>
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">12</span>:<span class="hljs-number">00</span>:<span class="hljs-number">24</span> Training - Downloading the training image<span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">12</span>:<span class="hljs-number">03</span>:<span class="hljs-number">39</span> Training - Training image download completed. Training <span class="hljs-keyword">in</span> progress..
<span class="hljs-params">...</span><span class="hljs-params">...</span>..
epoch <span class="hljs-number">0</span>: {<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.7598039215686274</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8178438661710037</span>}
epoch <span class="hljs-number">1</span>: {<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8357843137254902</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.882249560632689</span>}
epoch <span class="hljs-number">2</span>: {<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8406862745098039</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8869565217391304</span>}
<span class="hljs-params">...</span><span class="hljs-params">...</span>..
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">12</span>:<span class="hljs-number">05</span>:<span class="hljs-number">40</span> Uploading - Uploading generated training model
<span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-08</span> <span class="hljs-number">12</span>:<span class="hljs-number">05</span>:<span class="hljs-number">40</span> Completed - Training job completed
Training seconds: <span class="hljs-number">331</span>
Billable seconds: <span class="hljs-number">331</span>
You can find your model <span class="hljs-built_in">data</span> at: s3:<span class="hljs-comment">//your-bucket/accelerate-sagemaker-1-2021-04-08-11-56-47-108/output/model.tar.gz</span>`}}),Ae=new x({}),Se=new x({}),xe=new ce({props:{code:`base_job_name: accelerate-sagemaker-1
compute_environment: AMAZON_SAGEMAKER
distributed_type: DATA_PARALLEL
ec2_instance_type: ml.p3.16xlarge
iam_role_name: xxxxx
image_uri: null
mixed_precision: fp16
num_machines: 1
profile: xxxxx
py_version: py38
pytorch_version: 1.10.2
region: us-east-1
transformers_version: 4.17.0
use_cpu: false`,highlighted:`<span class="hljs-attr">base_job_name:</span> <span class="hljs-string">accelerate-sagemaker-1</span>
<span class="hljs-attr">compute_environment:</span> <span class="hljs-string">AMAZON_SAGEMAKER</span>
<span class="hljs-attr">distributed_type:</span> <span class="hljs-string">DATA_PARALLEL</span>
<span class="hljs-attr">ec2_instance_type:</span> <span class="hljs-string">ml.p3.16xlarge</span>
<span class="hljs-attr">iam_role_name:</span> <span class="hljs-string">xxxxx</span>
<span class="hljs-attr">image_uri:</span> <span class="hljs-literal">null</span>
<span class="hljs-attr">mixed_precision:</span> <span class="hljs-string">fp16</span>
<span class="hljs-attr">num_machines:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">profile:</span> <span class="hljs-string">xxxxx</span>
<span class="hljs-attr">py_version:</span> <span class="hljs-string">py38</span>
<span class="hljs-attr">pytorch_version:</span> <span class="hljs-number">1.10</span><span class="hljs-number">.2</span>
<span class="hljs-attr">region:</span> <span class="hljs-string">us-east-1</span>
<span class="hljs-attr">transformers_version:</span> <span class="hljs-number">4.17</span><span class="hljs-number">.0</span>
<span class="hljs-attr">use_cpu:</span> <span class="hljs-literal">false</span>`}}),Pe=new x({}),De=new x({}),Ce=new x({}),Me=new x({}),{c(){f=t("meta"),E=h(),m=t("h1"),b=t("a"),S=t("span"),d(w.$$.fragment),j=h(),P=t("span"),Ls=i("Amazon SageMaker"),La=h(),D=t("p"),zs=i("Hugging Face and Amazon introduced new "),he=t("a"),Ns=i("Hugging Face Deep Learning Containers (DLCs)"),Is=i(` to
make it easier than ever to train Hugging Face Transformer models in `),ue=t("a"),Os=i("Amazon SageMaker"),Hs=i("."),za=h(),z=t("h2"),B=t("a"),Ye=t("span"),d(fe.$$.fragment),qs=h(),Be=t("span"),Rs=i("Getting Started"),Na=h(),N=t("h3"),K=t("a"),Ke=t("span"),d(me.$$.fragment),Fs=h(),Ze=t("span"),Us=i("Setup & Installation"),Ia=h(),Z=t("p"),Gs=i(`Before you can run your \u{1F917} Accelerate scripts on Amazon SageMaker you need to sign up for an AWS account. If you do not
have an AWS account yet learn more `),de=t("a"),Ws=i("here"),Ys=i("."),Oa=h(),J=t("p"),Bs=i("After you have your AWS Account you need to install the "),Je=t("code"),Ks=i("sagemaker"),Zs=i(" sdk for \u{1F917} Accelerate with:"),Ha=h(),d(ge.$$.fragment),qa=h(),k=t("p"),Js=i("\u{1F917} Accelerate currently uses the \u{1F917} DLCs, with "),Qe=t("code"),Qs=i("transformers"),Vs=i(", "),Ve=t("code"),Xs=i("datasets"),et=i(" and "),Xe=t("code"),at=i("tokenizers"),st=i(` pre-installed. \u{1F917}
Accelerate is not in the DLC yet (will soon be added!) so to use it within Amazon SageMaker you need to create a
`),ea=t("code"),tt=i("requirements.txt"),nt=i(" in the same directory where your training script is located and add it as dependency:"),Ra=h(),d(ve.$$.fragment),Fa=h(),Q=t("p"),rt=i("You should also add any other dependencies you have to this "),aa=t("code"),lt=i("requirements.txt"),ot=i("."),Ua=h(),I=t("h3"),V=t("a"),sa=t("span"),d($e.$$.fragment),it=h(),ta=t("span"),pt=i("Configure \u{1F917} Accelerate"),Ga=h(),Le=t("p"),ct=i(`You can configure the launch configuration for Amazon SageMaker the same as you do for non SageMaker training jobs with
the \u{1F917} Accelerate CLI:`),Wa=h(),d(ye.$$.fragment),Ya=h(),ze=t("p"),ht=i("\u{1F917} Accelerate will go through a questionnaire about your Amazon SageMaker setup and create a config file you can edit."),Ba=h(),d(X.$$.fragment),Ka=h(),O=t("h3"),ee=t("a"),na=t("span"),d(_e.$$.fragment),ut=h(),ra=t("span"),ft=i("Prepare a \u{1F917} Accelerate fine-tuning script"),Za=h(),C=t("p"),mt=i(`The training script is very similar to a training script you might run outside of SageMaker, but to save your model
after training you need to specify either `),la=t("code"),dt=i("/opt/ml/model"),gt=i(" or use "),oa=t("code"),vt=i('os.environ["SM_MODEL_DIR"]'),$t=i(` as your save
directory. After training, artifacts in this directory are uploaded to S3:`),Ja=h(),d(be.$$.fragment),Qa=h(),d(ae.$$.fragment),Va=h(),H=t("h3"),se=t("a"),ia=t("span"),d(we.$$.fragment),yt=h(),pa=t("span"),_t=i("Launch Training"),Xa=h(),Ne=t("p"),bt=i("You can launch your training with \u{1F917} Accelerate CLI with:"),es=h(),d(je.$$.fragment),as=h(),Ie=t("p"),wt=i(`This will launch your training script using your configuration. The only thing you have to do is provide all the
arguments needed by your training script as named arguments.`),ss=h(),Oe=t("p"),ca=t("strong"),jt=i("Examples"),ts=h(),d(te.$$.fragment),ns=h(),d(Ee.$$.fragment),rs=h(),He=t("p"),Et=i("Outputs:"),ls=h(),d(ke.$$.fragment),os=h(),q=t("h2"),ne=t("a"),ha=t("span"),d(Ae.$$.fragment),kt=h(),ua=t("span"),At=i("Advanced Features"),is=h(),R=t("h3"),re=t("a"),fa=t("span"),d(Se.$$.fragment),St=h(),ma=t("span"),xt=i("Distributed Training: Data Parallelism"),ps=h(),M=t("p"),Pt=i("Set up the accelerate config by running "),da=t("code"),Dt=i("accelerate config"),Ct=i(` and answer the SageMaker questions and set it up.
To use SageMaker DDP, select it when asked
`),ga=t("code"),Mt=i("What is the distributed mode? ([0] No distributed training, [1] data parallelism):"),Tt=i(`.
Example config below:`),cs=h(),d(xe.$$.fragment),hs=h(),F=t("h3"),le=t("a"),va=t("span"),d(Pe.$$.fragment),Lt=h(),$a=t("span"),zt=i("Distributed Training: Model Parallelism"),us=h(),qe=t("p"),ya=t("em"),Nt=i("currently in development, will be supported soon."),fs=h(),U=t("h3"),oe=t("a"),_a=t("span"),d(De.$$.fragment),It=h(),ba=t("span"),Ot=i("Python packages and dependencies"),ms=h(),A=t("p"),Ht=i("\u{1F917} Accelerate currently uses the \u{1F917} DLCs, with "),wa=t("code"),qt=i("transformers"),Rt=i(", "),ja=t("code"),Ft=i("datasets"),Ut=i(" and "),Ea=t("code"),Gt=i("tokenizers"),Wt=i(` pre-installed. If you
want to use different/other Python packages you can do this by adding them to the `),ka=t("code"),Yt=i("requirements.txt"),Bt=i(`. These packages
will be installed before your training script is started.`),ds=h(),G=t("h3"),ie=t("a"),Aa=t("span"),d(Ce.$$.fragment),Kt=h(),Sa=t("span"),Zt=i("Remote scripts: Use scripts located on Github"),gs=h(),Re=t("p"),xa=t("em"),Jt=i("undecided if feature is needed. Contact us if you would like this feature."),vs=h(),W=t("h3"),pe=t("a"),Pa=t("span"),d(Me.$$.fragment),Qt=h(),Da=t("span"),Vt=i("Use Spot Instances"),$s=h(),Fe=t("p"),Ca=t("em"),Xt=i("undecided if feature is needed. Contact us if you would like this feature."),this.h()},l(e){const l=dr('[data-svelte="svelte-1phssyn"]',document.head);f=n(l,"META",{name:!0,content:!0}),l.forEach(a),E=u(e),m=n(e,"H1",{class:!0});var Te=r(m);b=n(Te,"A",{id:!0,class:!0,href:!0});var Ma=r(b);S=n(Ma,"SPAN",{});var Ta=r(S);g(w.$$.fragment,Ta),Ta.forEach(a),Ma.forEach(a),j=u(Te),P=n(Te,"SPAN",{});var an=r(P);Ls=p(an,"Amazon SageMaker"),an.forEach(a),Te.forEach(a),La=u(e),D=n(e,"P",{});var Ue=r(D);zs=p(Ue,"Hugging Face and Amazon introduced new "),he=n(Ue,"A",{href:!0,rel:!0});var sn=r(he);Ns=p(sn,"Hugging Face Deep Learning Containers (DLCs)"),sn.forEach(a),Is=p(Ue,` to
make it easier than ever to train Hugging Face Transformer models in `),ue=n(Ue,"A",{href:!0,rel:!0});var tn=r(ue);Os=p(tn,"Amazon SageMaker"),tn.forEach(a),Hs=p(Ue,"."),Ue.forEach(a),za=u(e),z=n(e,"H2",{class:!0});var _s=r(z);B=n(_s,"A",{id:!0,class:!0,href:!0});var nn=r(B);Ye=n(nn,"SPAN",{});var rn=r(Ye);g(fe.$$.fragment,rn),rn.forEach(a),nn.forEach(a),qs=u(_s),Be=n(_s,"SPAN",{});var ln=r(Be);Rs=p(ln,"Getting Started"),ln.forEach(a),_s.forEach(a),Na=u(e),N=n(e,"H3",{class:!0});var bs=r(N);K=n(bs,"A",{id:!0,class:!0,href:!0});var on=r(K);Ke=n(on,"SPAN",{});var pn=r(Ke);g(me.$$.fragment,pn),pn.forEach(a),on.forEach(a),Fs=u(bs),Ze=n(bs,"SPAN",{});var cn=r(Ze);Us=p(cn,"Setup & Installation"),cn.forEach(a),bs.forEach(a),Ia=u(e),Z=n(e,"P",{});var ws=r(Z);Gs=p(ws,`Before you can run your \u{1F917} Accelerate scripts on Amazon SageMaker you need to sign up for an AWS account. If you do not
have an AWS account yet learn more `),de=n(ws,"A",{href:!0,rel:!0});var hn=r(de);Ws=p(hn,"here"),hn.forEach(a),Ys=p(ws,"."),ws.forEach(a),Oa=u(e),J=n(e,"P",{});var js=r(J);Bs=p(js,"After you have your AWS Account you need to install the "),Je=n(js,"CODE",{});var un=r(Je);Ks=p(un,"sagemaker"),un.forEach(a),Zs=p(js," sdk for \u{1F917} Accelerate with:"),js.forEach(a),Ha=u(e),g(ge.$$.fragment,e),qa=u(e),k=n(e,"P",{});var T=r(k);Js=p(T,"\u{1F917} Accelerate currently uses the \u{1F917} DLCs, with "),Qe=n(T,"CODE",{});var fn=r(Qe);Qs=p(fn,"transformers"),fn.forEach(a),Vs=p(T,", "),Ve=n(T,"CODE",{});var mn=r(Ve);Xs=p(mn,"datasets"),mn.forEach(a),et=p(T," and "),Xe=n(T,"CODE",{});var dn=r(Xe);at=p(dn,"tokenizers"),dn.forEach(a),st=p(T,` pre-installed. \u{1F917}
Accelerate is not in the DLC yet (will soon be added!) so to use it within Amazon SageMaker you need to create a
`),ea=n(T,"CODE",{});var gn=r(ea);tt=p(gn,"requirements.txt"),gn.forEach(a),nt=p(T," in the same directory where your training script is located and add it as dependency:"),T.forEach(a),Ra=u(e),g(ve.$$.fragment,e),Fa=u(e),Q=n(e,"P",{});var Es=r(Q);rt=p(Es,"You should also add any other dependencies you have to this "),aa=n(Es,"CODE",{});var vn=r(aa);lt=p(vn,"requirements.txt"),vn.forEach(a),ot=p(Es,"."),Es.forEach(a),Ua=u(e),I=n(e,"H3",{class:!0});var ks=r(I);V=n(ks,"A",{id:!0,class:!0,href:!0});var $n=r(V);sa=n($n,"SPAN",{});var yn=r(sa);g($e.$$.fragment,yn),yn.forEach(a),$n.forEach(a),it=u(ks),ta=n(ks,"SPAN",{});var _n=r(ta);pt=p(_n,"Configure \u{1F917} Accelerate"),_n.forEach(a),ks.forEach(a),Ga=u(e),Le=n(e,"P",{});var bn=r(Le);ct=p(bn,`You can configure the launch configuration for Amazon SageMaker the same as you do for non SageMaker training jobs with
the \u{1F917} Accelerate CLI:`),bn.forEach(a),Wa=u(e),g(ye.$$.fragment,e),Ya=u(e),ze=n(e,"P",{});var wn=r(ze);ht=p(wn,"\u{1F917} Accelerate will go through a questionnaire about your Amazon SageMaker setup and create a config file you can edit."),wn.forEach(a),Ba=u(e),g(X.$$.fragment,e),Ka=u(e),O=n(e,"H3",{class:!0});var As=r(O);ee=n(As,"A",{id:!0,class:!0,href:!0});var jn=r(ee);na=n(jn,"SPAN",{});var En=r(na);g(_e.$$.fragment,En),En.forEach(a),jn.forEach(a),ut=u(As),ra=n(As,"SPAN",{});var kn=r(ra);ft=p(kn,"Prepare a \u{1F917} Accelerate fine-tuning script"),kn.forEach(a),As.forEach(a),Za=u(e),C=n(e,"P",{});var Ge=r(C);mt=p(Ge,`The training script is very similar to a training script you might run outside of SageMaker, but to save your model
after training you need to specify either `),la=n(Ge,"CODE",{});var An=r(la);dt=p(An,"/opt/ml/model"),An.forEach(a),gt=p(Ge," or use "),oa=n(Ge,"CODE",{});var Sn=r(oa);vt=p(Sn,'os.environ["SM_MODEL_DIR"]'),Sn.forEach(a),$t=p(Ge,` as your save
directory. After training, artifacts in this directory are uploaded to S3:`),Ge.forEach(a),Ja=u(e),g(be.$$.fragment,e),Qa=u(e),g(ae.$$.fragment,e),Va=u(e),H=n(e,"H3",{class:!0});var Ss=r(H);se=n(Ss,"A",{id:!0,class:!0,href:!0});var xn=r(se);ia=n(xn,"SPAN",{});var Pn=r(ia);g(we.$$.fragment,Pn),Pn.forEach(a),xn.forEach(a),yt=u(Ss),pa=n(Ss,"SPAN",{});var Dn=r(pa);_t=p(Dn,"Launch Training"),Dn.forEach(a),Ss.forEach(a),Xa=u(e),Ne=n(e,"P",{});var Cn=r(Ne);bt=p(Cn,"You can launch your training with \u{1F917} Accelerate CLI with:"),Cn.forEach(a),es=u(e),g(je.$$.fragment,e),as=u(e),Ie=n(e,"P",{});var Mn=r(Ie);wt=p(Mn,`This will launch your training script using your configuration. The only thing you have to do is provide all the
arguments needed by your training script as named arguments.`),Mn.forEach(a),ss=u(e),Oe=n(e,"P",{});var Tn=r(Oe);ca=n(Tn,"STRONG",{});var Ln=r(ca);jt=p(Ln,"Examples"),Ln.forEach(a),Tn.forEach(a),ts=u(e),g(te.$$.fragment,e),ns=u(e),g(Ee.$$.fragment,e),rs=u(e),He=n(e,"P",{});var zn=r(He);Et=p(zn,"Outputs:"),zn.forEach(a),ls=u(e),g(ke.$$.fragment,e),os=u(e),q=n(e,"H2",{class:!0});var xs=r(q);ne=n(xs,"A",{id:!0,class:!0,href:!0});var Nn=r(ne);ha=n(Nn,"SPAN",{});var In=r(ha);g(Ae.$$.fragment,In),In.forEach(a),Nn.forEach(a),kt=u(xs),ua=n(xs,"SPAN",{});var On=r(ua);At=p(On,"Advanced Features"),On.forEach(a),xs.forEach(a),is=u(e),R=n(e,"H3",{class:!0});var Ps=r(R);re=n(Ps,"A",{id:!0,class:!0,href:!0});var Hn=r(re);fa=n(Hn,"SPAN",{});var qn=r(fa);g(Se.$$.fragment,qn),qn.forEach(a),Hn.forEach(a),St=u(Ps),ma=n(Ps,"SPAN",{});var Rn=r(ma);xt=p(Rn,"Distributed Training: Data Parallelism"),Rn.forEach(a),Ps.forEach(a),ps=u(e),M=n(e,"P",{});var We=r(M);Pt=p(We,"Set up the accelerate config by running "),da=n(We,"CODE",{});var Fn=r(da);Dt=p(Fn,"accelerate config"),Fn.forEach(a),Ct=p(We,` and answer the SageMaker questions and set it up.
To use SageMaker DDP, select it when asked
`),ga=n(We,"CODE",{});var Un=r(ga);Mt=p(Un,"What is the distributed mode? ([0] No distributed training, [1] data parallelism):"),Un.forEach(a),Tt=p(We,`.
Example config below:`),We.forEach(a),cs=u(e),g(xe.$$.fragment,e),hs=u(e),F=n(e,"H3",{class:!0});var Ds=r(F);le=n(Ds,"A",{id:!0,class:!0,href:!0});var Gn=r(le);va=n(Gn,"SPAN",{});var Wn=r(va);g(Pe.$$.fragment,Wn),Wn.forEach(a),Gn.forEach(a),Lt=u(Ds),$a=n(Ds,"SPAN",{});var Yn=r($a);zt=p(Yn,"Distributed Training: Model Parallelism"),Yn.forEach(a),Ds.forEach(a),us=u(e),qe=n(e,"P",{});var Bn=r(qe);ya=n(Bn,"EM",{});var Kn=r(ya);Nt=p(Kn,"currently in development, will be supported soon."),Kn.forEach(a),Bn.forEach(a),fs=u(e),U=n(e,"H3",{class:!0});var Cs=r(U);oe=n(Cs,"A",{id:!0,class:!0,href:!0});var Zn=r(oe);_a=n(Zn,"SPAN",{});var Jn=r(_a);g(De.$$.fragment,Jn),Jn.forEach(a),Zn.forEach(a),It=u(Cs),ba=n(Cs,"SPAN",{});var Qn=r(ba);Ot=p(Qn,"Python packages and dependencies"),Qn.forEach(a),Cs.forEach(a),ms=u(e),A=n(e,"P",{});var L=r(A);Ht=p(L,"\u{1F917} Accelerate currently uses the \u{1F917} DLCs, with "),wa=n(L,"CODE",{});var Vn=r(wa);qt=p(Vn,"transformers"),Vn.forEach(a),Rt=p(L,", "),ja=n(L,"CODE",{});var Xn=r(ja);Ft=p(Xn,"datasets"),Xn.forEach(a),Ut=p(L," and "),Ea=n(L,"CODE",{});var er=r(Ea);Gt=p(er,"tokenizers"),er.forEach(a),Wt=p(L,` pre-installed. If you
want to use different/other Python packages you can do this by adding them to the `),ka=n(L,"CODE",{});var ar=r(ka);Yt=p(ar,"requirements.txt"),ar.forEach(a),Bt=p(L,`. These packages
will be installed before your training script is started.`),L.forEach(a),ds=u(e),G=n(e,"H3",{class:!0});var Ms=r(G);ie=n(Ms,"A",{id:!0,class:!0,href:!0});var sr=r(ie);Aa=n(sr,"SPAN",{});var tr=r(Aa);g(Ce.$$.fragment,tr),tr.forEach(a),sr.forEach(a),Kt=u(Ms),Sa=n(Ms,"SPAN",{});var nr=r(Sa);Zt=p(nr,"Remote scripts: Use scripts located on Github"),nr.forEach(a),Ms.forEach(a),gs=u(e),Re=n(e,"P",{});var rr=r(Re);xa=n(rr,"EM",{});var lr=r(xa);Jt=p(lr,"undecided if feature is needed. Contact us if you would like this feature."),lr.forEach(a),rr.forEach(a),vs=u(e),W=n(e,"H3",{class:!0});var Ts=r(W);pe=n(Ts,"A",{id:!0,class:!0,href:!0});var or=r(pe);Pa=n(or,"SPAN",{});var ir=r(Pa);g(Me.$$.fragment,ir),ir.forEach(a),or.forEach(a),Qt=u(Ts),Da=n(Ts,"SPAN",{});var pr=r(Da);Vt=p(pr,"Use Spot Instances"),pr.forEach(a),Ts.forEach(a),$s=u(e),Fe=n(e,"P",{});var cr=r(Fe);Ca=n(cr,"EM",{});var hr=r(Ca);Xt=p(hr,"undecided if feature is needed. Contact us if you would like this feature."),hr.forEach(a),cr.forEach(a),this.h()},h(){c(f,"name","hf:doc:metadata"),c(f,"content",JSON.stringify(br)),c(b,"id","amazon-sagemaker"),c(b,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(b,"href","#amazon-sagemaker"),c(m,"class","relative group"),c(he,"href","https://github.com/aws/deep-learning-containers/blob/master/available_images.md#huggingface-training-containers"),c(he,"rel","nofollow"),c(ue,"href","https://aws.amazon.com/sagemaker/"),c(ue,"rel","nofollow"),c(B,"id","getting-started"),c(B,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(B,"href","#getting-started"),c(z,"class","relative group"),c(K,"id","setup-installation"),c(K,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(K,"href","#setup-installation"),c(N,"class","relative group"),c(de,"href","https://docs.aws.amazon.com/sagemaker/latest/dg/gs-set-up.html"),c(de,"rel","nofollow"),c(V,"id","configure-accelerate"),c(V,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(V,"href","#configure-accelerate"),c(I,"class","relative group"),c(ee,"id","prepare-a-accelerate-finetuning-script"),c(ee,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(ee,"href","#prepare-a-accelerate-finetuning-script"),c(O,"class","relative group"),c(se,"id","launch-training"),c(se,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(se,"href","#launch-training"),c(H,"class","relative group"),c(ne,"id","advanced-features"),c(ne,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(ne,"href","#advanced-features"),c(q,"class","relative group"),c(re,"id","distributed-training-data-parallelism"),c(re,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(re,"href","#distributed-training-data-parallelism"),c(R,"class","relative group"),c(le,"id","distributed-training-model-parallelism"),c(le,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(le,"href","#distributed-training-model-parallelism"),c(F,"class","relative group"),c(oe,"id","python-packages-and-dependencies"),c(oe,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(oe,"href","#python-packages-and-dependencies"),c(U,"class","relative group"),c(ie,"id","remote-scripts-use-scripts-located-on-github"),c(ie,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(ie,"href","#remote-scripts-use-scripts-located-on-github"),c(G,"class","relative group"),c(pe,"id","use-spot-instances"),c(pe,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),c(pe,"href","#use-spot-instances"),c(W,"class","relative group")},m(e,l){s(document.head,f),o(e,E,l),o(e,m,l),s(m,b),s(b,S),v(w,S,null),s(m,j),s(m,P),s(P,Ls),o(e,La,l),o(e,D,l),s(D,zs),s(D,he),s(he,Ns),s(D,Is),s(D,ue),s(ue,Os),s(D,Hs),o(e,za,l),o(e,z,l),s(z,B),s(B,Ye),v(fe,Ye,null),s(z,qs),s(z,Be),s(Be,Rs),o(e,Na,l),o(e,N,l),s(N,K),s(K,Ke),v(me,Ke,null),s(N,Fs),s(N,Ze),s(Ze,Us),o(e,Ia,l),o(e,Z,l),s(Z,Gs),s(Z,de),s(de,Ws),s(Z,Ys),o(e,Oa,l),o(e,J,l),s(J,Bs),s(J,Je),s(Je,Ks),s(J,Zs),o(e,Ha,l),v(ge,e,l),o(e,qa,l),o(e,k,l),s(k,Js),s(k,Qe),s(Qe,Qs),s(k,Vs),s(k,Ve),s(Ve,Xs),s(k,et),s(k,Xe),s(Xe,at),s(k,st),s(k,ea),s(ea,tt),s(k,nt),o(e,Ra,l),v(ve,e,l),o(e,Fa,l),o(e,Q,l),s(Q,rt),s(Q,aa),s(aa,lt),s(Q,ot),o(e,Ua,l),o(e,I,l),s(I,V),s(V,sa),v($e,sa,null),s(I,it),s(I,ta),s(ta,pt),o(e,Ga,l),o(e,Le,l),s(Le,ct),o(e,Wa,l),v(ye,e,l),o(e,Ya,l),o(e,ze,l),s(ze,ht),o(e,Ba,l),v(X,e,l),o(e,Ka,l),o(e,O,l),s(O,ee),s(ee,na),v(_e,na,null),s(O,ut),s(O,ra),s(ra,ft),o(e,Za,l),o(e,C,l),s(C,mt),s(C,la),s(la,dt),s(C,gt),s(C,oa),s(oa,vt),s(C,$t),o(e,Ja,l),v(be,e,l),o(e,Qa,l),v(ae,e,l),o(e,Va,l),o(e,H,l),s(H,se),s(se,ia),v(we,ia,null),s(H,yt),s(H,pa),s(pa,_t),o(e,Xa,l),o(e,Ne,l),s(Ne,bt),o(e,es,l),v(je,e,l),o(e,as,l),o(e,Ie,l),s(Ie,wt),o(e,ss,l),o(e,Oe,l),s(Oe,ca),s(ca,jt),o(e,ts,l),v(te,e,l),o(e,ns,l),v(Ee,e,l),o(e,rs,l),o(e,He,l),s(He,Et),o(e,ls,l),v(ke,e,l),o(e,os,l),o(e,q,l),s(q,ne),s(ne,ha),v(Ae,ha,null),s(q,kt),s(q,ua),s(ua,At),o(e,is,l),o(e,R,l),s(R,re),s(re,fa),v(Se,fa,null),s(R,St),s(R,ma),s(ma,xt),o(e,ps,l),o(e,M,l),s(M,Pt),s(M,da),s(da,Dt),s(M,Ct),s(M,ga),s(ga,Mt),s(M,Tt),o(e,cs,l),v(xe,e,l),o(e,hs,l),o(e,F,l),s(F,le),s(le,va),v(Pe,va,null),s(F,Lt),s(F,$a),s($a,zt),o(e,us,l),o(e,qe,l),s(qe,ya),s(ya,Nt),o(e,fs,l),o(e,U,l),s(U,oe),s(oe,_a),v(De,_a,null),s(U,It),s(U,ba),s(ba,Ot),o(e,ms,l),o(e,A,l),s(A,Ht),s(A,wa),s(wa,qt),s(A,Rt),s(A,ja),s(ja,Ft),s(A,Ut),s(A,Ea),s(Ea,Gt),s(A,Wt),s(A,ka),s(ka,Yt),s(A,Bt),o(e,ds,l),o(e,G,l),s(G,ie),s(ie,Aa),v(Ce,Aa,null),s(G,Kt),s(G,Sa),s(Sa,Zt),o(e,gs,l),o(e,Re,l),s(Re,xa),s(xa,Jt),o(e,vs,l),o(e,W,l),s(W,pe),s(pe,Pa),v(Me,Pa,null),s(W,Qt),s(W,Da),s(Da,Vt),o(e,$s,l),o(e,Fe,l),s(Fe,Ca),s(Ca,Xt),ys=!0},p(e,[l]){const Te={};l&2&&(Te.$$scope={dirty:l,ctx:e}),X.$set(Te);const Ma={};l&2&&(Ma.$$scope={dirty:l,ctx:e}),ae.$set(Ma);const Ta={};l&2&&(Ta.$$scope={dirty:l,ctx:e}),te.$set(Ta)},i(e){ys||($(w.$$.fragment,e),$(fe.$$.fragment,e),$(me.$$.fragment,e),$(ge.$$.fragment,e),$(ve.$$.fragment,e),$($e.$$.fragment,e),$(ye.$$.fragment,e),$(X.$$.fragment,e),$(_e.$$.fragment,e),$(be.$$.fragment,e),$(ae.$$.fragment,e),$(we.$$.fragment,e),$(je.$$.fragment,e),$(te.$$.fragment,e),$(Ee.$$.fragment,e),$(ke.$$.fragment,e),$(Ae.$$.fragment,e),$(Se.$$.fragment,e),$(xe.$$.fragment,e),$(Pe.$$.fragment,e),$(De.$$.fragment,e),$(Ce.$$.fragment,e),$(Me.$$.fragment,e),ys=!0)},o(e){y(w.$$.fragment,e),y(fe.$$.fragment,e),y(me.$$.fragment,e),y(ge.$$.fragment,e),y(ve.$$.fragment,e),y($e.$$.fragment,e),y(ye.$$.fragment,e),y(X.$$.fragment,e),y(_e.$$.fragment,e),y(be.$$.fragment,e),y(ae.$$.fragment,e),y(we.$$.fragment,e),y(je.$$.fragment,e),y(te.$$.fragment,e),y(Ee.$$.fragment,e),y(ke.$$.fragment,e),y(Ae.$$.fragment,e),y(Se.$$.fragment,e),y(xe.$$.fragment,e),y(Pe.$$.fragment,e),y(De.$$.fragment,e),y(Ce.$$.fragment,e),y(Me.$$.fragment,e),ys=!1},d(e){a(f),e&&a(E),e&&a(m),_(w),e&&a(La),e&&a(D),e&&a(za),e&&a(z),_(fe),e&&a(Na),e&&a(N),_(me),e&&a(Ia),e&&a(Z),e&&a(Oa),e&&a(J),e&&a(Ha),_(ge,e),e&&a(qa),e&&a(k),e&&a(Ra),_(ve,e),e&&a(Fa),e&&a(Q),e&&a(Ua),e&&a(I),_($e),e&&a(Ga),e&&a(Le),e&&a(Wa),_(ye,e),e&&a(Ya),e&&a(ze),e&&a(Ba),_(X,e),e&&a(Ka),e&&a(O),_(_e),e&&a(Za),e&&a(C),e&&a(Ja),_(be,e),e&&a(Qa),_(ae,e),e&&a(Va),e&&a(H),_(we),e&&a(Xa),e&&a(Ne),e&&a(es),_(je,e),e&&a(as),e&&a(Ie),e&&a(ss),e&&a(Oe),e&&a(ts),_(te,e),e&&a(ns),_(Ee,e),e&&a(rs),e&&a(He),e&&a(ls),_(ke,e),e&&a(os),e&&a(q),_(Ae),e&&a(is),e&&a(R),_(Se),e&&a(ps),e&&a(M),e&&a(cs),_(xe,e),e&&a(hs),e&&a(F),_(Pe),e&&a(us),e&&a(qe),e&&a(fs),e&&a(U),_(De),e&&a(ms),e&&a(A),e&&a(ds),e&&a(G),_(Ce),e&&a(gs),e&&a(Re),e&&a(vs),e&&a(W),_(Me),e&&a($s),e&&a(Fe)}}}const br={local:"amazon-sagemaker",sections:[{local:"getting-started",sections:[{local:"setup-installation",title:"Setup & Installation"},{local:"configure-accelerate",title:"Configure \u{1F917} Accelerate"},{local:"prepare-a-accelerate-finetuning-script",title:"Prepare a \u{1F917} Accelerate fine-tuning script"},{local:"launch-training",title:"Launch Training"}],title:"Getting Started"},{local:"advanced-features",sections:[{local:"distributed-training-data-parallelism",title:"Distributed Training: Data Parallelism"},{local:"distributed-training-model-parallelism",title:"Distributed Training: Model Parallelism"},{local:"python-packages-and-dependencies",title:"Python packages and dependencies"},{local:"remote-scripts-use-scripts-located-on-github",title:"Remote scripts: Use scripts located on Github"},{local:"use-spot-instances",title:"Use Spot Instances"}],title:"Advanced Features"}],title:"Amazon SageMaker"};function wr(Y){return gr(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class Sr extends ur{constructor(f){super();fr(this,f,wr,_r,mr,{})}}export{Sr as default,br as metadata};
