import{S as ot,i as lt,s as it,e as r,k as p,w as ie,t as i,M as nt,c as s,d as a,m as f,a as l,x as ne,h as n,b as o,G as t,g as m,y as ce,q as de,o as ue,B as pe,v as ct}from"../chunks/vendor-hf-doc-builder.js";import{T as dt}from"../chunks/Tip-hf-doc-builder.js";import{I as ut}from"../chunks/IconCopyLink-hf-doc-builder.js";import{C as st}from"../chunks/CodeBlock-hf-doc-builder.js";function pt(K){let d,k,u,v,w;return{c(){d=r("p"),k=i("To get a better idea of this process, make sure to check out the "),u=r("a"),v=i("Tutorials"),w=i("!"),this.h()},l(g){d=s(g,"P",{});var _=l(d);k=n(_,"To get a better idea of this process, make sure to check out the "),u=s(_,"A",{href:!0});var P=l(u);v=n(P,"Tutorials"),P.forEach(a),w=n(_,"!"),_.forEach(a),this.h()},h(){o(u,"href","basic_tutorials/overview")},m(g,_){m(g,d,_),t(d,k),t(d,u),t(u,v),t(d,w)},d(g){g&&a(d)}}}function ft(K){let d,k,u,v,w,g,_,P,fe,Q,j,he,W,C,X,h,me,U,ge,ve,F,be,_e,L,ye,we,V,$e,xe,Y,T,Z,H,Ae,ee,D,te,I,b,$,B,Ee,ke,R,Pe,Te,x,q,ze,Ce,M,De,Ie,A,N,Se,je,O,Le,Ve,E,G,He,Be,J,Re,ae;return g=new ut({}),C=new st({props:{code:`+ from accelerate import Accelerator
+ accelerator = Accelerator()

+ model, optimizer, training_dataloader, scheduler = accelerator.prepare(
+     model, optimizer, training_dataloader, scheduler
+ )

  for batch in training_dataloader:
      optimizer.zero_grad()
      inputs, targets = batch
      inputs = inputs.to(device)
      targets = targets.to(device)
      outputs = model(inputs)
      loss = loss_function(outputs, targets)
+     accelerator.backward(loss)
      optimizer.step()
      scheduler.step()`,highlighted:`<span class="hljs-addition">+ from accelerate import Accelerator</span>
<span class="hljs-addition">+ accelerator = Accelerator()</span>

<span class="hljs-addition">+ model, optimizer, training_dataloader, scheduler = accelerator.prepare(</span>
<span class="hljs-addition">+     model, optimizer, training_dataloader, scheduler</span>
<span class="hljs-addition">+ )</span>

  for batch in training_dataloader:
      optimizer.zero_grad()
      inputs, targets = batch
      inputs = inputs.to(device)
      targets = targets.to(device)
      outputs = model(inputs)
      loss = loss_function(outputs, targets)
<span class="hljs-addition">+     accelerator.backward(loss)</span>
      optimizer.step()
      scheduler.step()`}}),T=new dt({props:{$$slots:{default:[pt]},$$scope:{ctx:K}}}),D=new st({props:{code:"accelerate launch {my_script.py}",highlighted:"accelerate launch {my_script.py}"}}),{c(){d=r("meta"),k=p(),u=r("h1"),v=r("a"),w=r("span"),ie(g.$$.fragment),_=p(),P=r("span"),fe=i("Accelerate"),Q=p(),j=r("p"),he=i("\u{1F917} Accelerate is a library that enables the same PyTorch code to be run across any distributed configuration by adding just four lines of code! In short, training and inference at scale made simple, efficient and adaptable."),W=p(),ie(C.$$.fragment),X=p(),h=r("p"),me=i("Built on "),U=r("code"),ge=i("torch_xla"),ve=i(" and "),F=r("code"),be=i("torch.distributed"),_e=i(`, \u{1F917} Accelerate takes care of the heavy lifting, so you don\u2019t have to write any custom code to adapt to these platforms.
Convert existing codebases to utilize `),L=r("a"),ye=i("DeepSpeed"),we=i(", perform "),V=r("a"),$e=i("fully sharded data parallelism"),xe=i(", and have automatic support for mixed-precision training!"),Y=p(),ie(T.$$.fragment),Z=p(),H=r("p"),Ae=i("This code can then be launched on any system through Accelerate\u2019s CLI interface:"),ee=p(),ie(D.$$.fragment),te=p(),I=r("div"),b=r("div"),$=r("a"),B=r("div"),Ee=i("Tutorials"),ke=p(),R=r("p"),Pe=i("Learn the basics and become familiar with using \u{1F917} Accelerate. Start here if you are using \u{1F917} Accelerate for the first time!"),Te=p(),x=r("a"),q=r("div"),ze=i("How-to guides"),Ce=p(),M=r("p"),De=i("Practical guides to help you achieve a specific goal. Take a look at these guides to learn how to use \u{1F917} Accelerate to solve real-world problems."),Ie=p(),A=r("a"),N=r("div"),Se=i("Conceptual guides"),je=p(),O=r("p"),Le=i("High-level explanations for building a better understanding of important topics such as avoiding subtle nuances and pitfalls in distributed training and DeepSpeed."),Ve=p(),E=r("a"),G=r("div"),He=i("Reference"),Be=p(),J=r("p"),Re=i("Technical descriptions of how \u{1F917} Accelerate classes and methods work."),this.h()},l(e){const c=nt('[data-svelte="svelte-1phssyn"]',document.head);d=s(c,"META",{name:!0,content:!0}),c.forEach(a),k=f(e),u=s(e,"H1",{class:!0});var S=l(u);v=s(S,"A",{id:!0,class:!0,href:!0});var qe=l(v);w=s(qe,"SPAN",{});var Me=l(w);ne(g.$$.fragment,Me),Me.forEach(a),qe.forEach(a),_=f(S),P=s(S,"SPAN",{});var Ne=l(P);fe=n(Ne,"Accelerate"),Ne.forEach(a),S.forEach(a),Q=f(e),j=s(e,"P",{});var Oe=l(j);he=n(Oe,"\u{1F917} Accelerate is a library that enables the same PyTorch code to be run across any distributed configuration by adding just four lines of code! In short, training and inference at scale made simple, efficient and adaptable."),Oe.forEach(a),W=f(e),ne(C.$$.fragment,e),X=f(e),h=s(e,"P",{});var y=l(h);me=n(y,"Built on "),U=s(y,"CODE",{});var Ge=l(U);ge=n(Ge,"torch_xla"),Ge.forEach(a),ve=n(y," and "),F=s(y,"CODE",{});var Je=l(F);be=n(Je,"torch.distributed"),Je.forEach(a),_e=n(y,`, \u{1F917} Accelerate takes care of the heavy lifting, so you don\u2019t have to write any custom code to adapt to these platforms.
Convert existing codebases to utilize `),L=s(y,"A",{href:!0});var Ue=l(L);ye=n(Ue,"DeepSpeed"),Ue.forEach(a),we=n(y,", perform "),V=s(y,"A",{href:!0});var Fe=l(V);$e=n(Fe,"fully sharded data parallelism"),Fe.forEach(a),xe=n(y,", and have automatic support for mixed-precision training!"),y.forEach(a),Y=f(e),ne(T.$$.fragment,e),Z=f(e),H=s(e,"P",{});var Ke=l(H);Ae=n(Ke,"This code can then be launched on any system through Accelerate\u2019s CLI interface:"),Ke.forEach(a),ee=f(e),ne(D.$$.fragment,e),te=f(e),I=s(e,"DIV",{class:!0});var Qe=l(I);b=s(Qe,"DIV",{class:!0});var z=l(b);$=s(z,"A",{class:!0,href:!0});var re=l($);B=s(re,"DIV",{class:!0});var We=l(B);Ee=n(We,"Tutorials"),We.forEach(a),ke=f(re),R=s(re,"P",{class:!0});var Xe=l(R);Pe=n(Xe,"Learn the basics and become familiar with using \u{1F917} Accelerate. Start here if you are using \u{1F917} Accelerate for the first time!"),Xe.forEach(a),re.forEach(a),Te=f(z),x=s(z,"A",{class:!0,href:!0});var se=l(x);q=s(se,"DIV",{class:!0});var Ye=l(q);ze=n(Ye,"How-to guides"),Ye.forEach(a),Ce=f(se),M=s(se,"P",{class:!0});var Ze=l(M);De=n(Ze,"Practical guides to help you achieve a specific goal. Take a look at these guides to learn how to use \u{1F917} Accelerate to solve real-world problems."),Ze.forEach(a),se.forEach(a),Ie=f(z),A=s(z,"A",{class:!0,href:!0});var oe=l(A);N=s(oe,"DIV",{class:!0});var et=l(N);Se=n(et,"Conceptual guides"),et.forEach(a),je=f(oe),O=s(oe,"P",{class:!0});var tt=l(O);Le=n(tt,"High-level explanations for building a better understanding of important topics such as avoiding subtle nuances and pitfalls in distributed training and DeepSpeed."),tt.forEach(a),oe.forEach(a),Ve=f(z),E=s(z,"A",{class:!0,href:!0});var le=l(E);G=s(le,"DIV",{class:!0});var at=l(G);He=n(at,"Reference"),at.forEach(a),Be=f(le),J=s(le,"P",{class:!0});var rt=l(J);Re=n(rt,"Technical descriptions of how \u{1F917} Accelerate classes and methods work."),rt.forEach(a),le.forEach(a),z.forEach(a),Qe.forEach(a),this.h()},h(){o(d,"name","hf:doc:metadata"),o(d,"content",JSON.stringify(ht)),o(v,"id","accelerate"),o(v,"class","header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full"),o(v,"href","#accelerate"),o(u,"class","relative group"),o(L,"href","usage_guides/deepspeed"),o(V,"href","usage_guides/fsdp"),o(B,"class","w-full text-center bg-gradient-to-br from-blue-400 to-blue-500 rounded-lg py-1.5 font-semibold mb-5 text-white text-lg leading-relaxed"),o(R,"class","text-gray-700"),o($,"class","!no-underline border dark:border-gray-700 p-5 rounded-lg shadow hover:shadow-lg"),o($,"href","./basic_tutorials/overview"),o(q,"class","w-full text-center bg-gradient-to-br from-indigo-400 to-indigo-500 rounded-lg py-1.5 font-semibold mb-5 text-white text-lg leading-relaxed"),o(M,"class","text-gray-700"),o(x,"class","!no-underline border dark:border-gray-700 p-5 rounded-lg shadow hover:shadow-lg"),o(x,"href","./usage_guides/gradient_accumulation"),o(N,"class","w-full text-center bg-gradient-to-br from-pink-400 to-pink-500 rounded-lg py-1.5 font-semibold mb-5 text-white text-lg leading-relaxed"),o(O,"class","text-gray-700"),o(A,"class","!no-underline border dark:border-gray-700 p-5 rounded-lg shadow hover:shadow-lg"),o(A,"href","./concept_guides/gradient_synchronization"),o(G,"class","w-full text-center bg-gradient-to-br from-purple-400 to-purple-500 rounded-lg py-1.5 font-semibold mb-5 text-white text-lg leading-relaxed"),o(J,"class","text-gray-700"),o(E,"class","!no-underline border dark:border-gray-700 p-5 rounded-lg shadow hover:shadow-lg"),o(E,"href","./package_reference/accelerator"),o(b,"class","w-full flex flex-col space-y-4 md:space-y-0 md:grid md:grid-cols-2 md:gap-y-4 md:gap-x-5"),o(I,"class","mt-10")},m(e,c){t(document.head,d),m(e,k,c),m(e,u,c),t(u,v),t(v,w),ce(g,w,null),t(u,_),t(u,P),t(P,fe),m(e,Q,c),m(e,j,c),t(j,he),m(e,W,c),ce(C,e,c),m(e,X,c),m(e,h,c),t(h,me),t(h,U),t(U,ge),t(h,ve),t(h,F),t(F,be),t(h,_e),t(h,L),t(L,ye),t(h,we),t(h,V),t(V,$e),t(h,xe),m(e,Y,c),ce(T,e,c),m(e,Z,c),m(e,H,c),t(H,Ae),m(e,ee,c),ce(D,e,c),m(e,te,c),m(e,I,c),t(I,b),t(b,$),t($,B),t(B,Ee),t($,ke),t($,R),t(R,Pe),t(b,Te),t(b,x),t(x,q),t(q,ze),t(x,Ce),t(x,M),t(M,De),t(b,Ie),t(b,A),t(A,N),t(N,Se),t(A,je),t(A,O),t(O,Le),t(b,Ve),t(b,E),t(E,G),t(G,He),t(E,Be),t(E,J),t(J,Re),ae=!0},p(e,[c]){const S={};c&2&&(S.$$scope={dirty:c,ctx:e}),T.$set(S)},i(e){ae||(de(g.$$.fragment,e),de(C.$$.fragment,e),de(T.$$.fragment,e),de(D.$$.fragment,e),ae=!0)},o(e){ue(g.$$.fragment,e),ue(C.$$.fragment,e),ue(T.$$.fragment,e),ue(D.$$.fragment,e),ae=!1},d(e){a(d),e&&a(k),e&&a(u),pe(g),e&&a(Q),e&&a(j),e&&a(W),pe(C,e),e&&a(X),e&&a(h),e&&a(Y),pe(T,e),e&&a(Z),e&&a(H),e&&a(ee),pe(D,e),e&&a(te),e&&a(I)}}}const ht={local:"accelerate",title:"Accelerate"};function mt(K){return ct(()=>{new URLSearchParams(window.location.search).get("fw")}),[]}class yt extends ot{constructor(d){super();lt(this,d,mt,ft,it,{})}}export{yt as default,ht as metadata};
